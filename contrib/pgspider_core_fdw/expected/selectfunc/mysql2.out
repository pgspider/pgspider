--Testcase 1:
SET datestyle=ISO;
--Testcase 2:
SET timezone='Japan';
--Testcase 3:
CREATE EXTENSION pgspider_core_fdw;
--Testcase 4:
CREATE SERVER pgspider_core_svr FOREIGN DATA WRAPPER pgspider_core_fdw OPTIONS (host '127.0.0.1');
--Testcase 5:
CREATE USER MAPPING FOR CURRENT_USER SERVER pgspider_core_svr;
----------------------------------------------------------
-- test structure
-- PGSpider Top Node -> Child PGSpider Node -> Data source
-- stub functions are provided by pgspider_fdw
----------------------------------------------------------
-- Data source: mysql
--Testcase 6:
CREATE FOREIGN TABLE s3 (id int, tag1 text, value1 float, value2 int, value3 float, value4 int, str1 text, str2 text, __spd_url text) SERVER pgspider_core_svr;
--Testcase 7:
CREATE FOREIGN TABLE ftextsearch (id int, content text, __spd_url text) SERVER pgspider_core_svr;
--Testcase 8:
CREATE EXTENSION pgspider_fdw;
--Testcase 9:
CREATE SERVER pgspider_svr FOREIGN DATA WRAPPER pgspider_fdw OPTIONS (host '127.0.0.1', port '5433', dbname 'postgres');
--Testcase 10:
CREATE USER MAPPING FOR CURRENT_USER SERVER pgspider_svr;
--Testcase 11:
CREATE FOREIGN TABLE s3__pgspider_svr__0 (id int, tag1 text, value1 float, value2 int, value3 float, value4 int, str1 text, str2 text, __spd_url text) SERVER pgspider_svr OPTIONS (table_name 's3mysql');
--Testcase 12:
CREATE FOREIGN TABLE ftextsearch__pgspider_svr__0 (id int, content text) SERVER pgspider_svr OPTIONS (table_name 'ftextsearch');
-- s3 (value1 as float8, value2 as bigint)
--Testcase 13:
\d s3;
                          Foreign table "public.s3"
  Column   |       Type       | Collation | Nullable | Default | FDW options 
-----------+------------------+-----------+----------+---------+-------------
 id        | integer          |           |          |         | 
 tag1      | text             |           |          |         | 
 value1    | double precision |           |          |         | 
 value2    | integer          |           |          |         | 
 value3    | double precision |           |          |         | 
 value4    | integer          |           |          |         | 
 str1      | text             |           |          |         | 
 str2      | text             |           |          |         | 
 __spd_url | text             |           |          |         | 
Server: pgspider_core_svr

--Testcase 14:
SELECT * FROM s3 ORDER BY 1,2,3,4,5,6,7,8,9;
 id | tag1 | value1 | value2 | value3 | value4 |   str1    |   str2    |        __spd_url         
----+------+--------+--------+--------+--------+-----------+-----------+--------------------------
  0 | a    |    0.1 |    100 |   -0.1 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  1 | a    |    0.2 |    100 |   -0.2 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  2 | a    |    0.3 |    100 |   -0.3 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  3 | b    |    1.1 |    200 |   -1.1 |   -200 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  4 | b    |    2.2 |    200 |   -2.2 |   -200 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  5 | b    |    3.3 |    200 |   -3.3 |   -200 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
(6 rows)

-- select float8() (not pushdown, remove float8, explain)
--Testcase 15:
EXPLAIN VERBOSE
SELECT float8(value1), float8(value2), float8(value3), float8(value4) FROM s3;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=32)
   Output: value1, (float8(value2)), value3, (float8(value4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, float8(value2), value3, float8(value4) FROM public.s3mysql
(4 rows)

-- select float8() (not pushdown, remove float8, result)
--Testcase 16:
SELECT * FROM (
SELECT float8(value1), float8(value2), float8(value3), float8(value4) FROM s3
) AS t ORDER BY 1,2,3,4;
 float8 | float8 | float8 | float8 
--------+--------+--------+--------
    0.1 |    100 |   -0.1 |   -100
    0.2 |    100 |   -0.2 |   -100
    0.3 |    100 |   -0.3 |   -100
    1.1 |    200 |   -1.1 |   -200
    2.2 |    200 |   -2.2 |   -200
    3.3 |    200 |   -3.3 |   -200
(6 rows)

-- select abs (builtin function, explain)
--Testcase 17:
EXPLAIN VERBOSE
SELECT abs(value1), abs(value2), abs(value3), abs(value4) FROM s3;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.52 rows=3413 width=24)
   Output: (abs(value1)), (abs(value2)), (abs(value3)), (abs(value4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT abs(value1), abs(value2), abs(value3), abs(value4) FROM public.s3mysql
(4 rows)

-- select abs (buitin function, result)
--Testcase 18:
SELECT * FROM (
SELECT abs(value1), abs(value2), abs(value3), abs(value4) FROM s3
) AS t ORDER BY 1,2,3,4;
         abs         | abs |         abs         | abs 
---------------------+-----+---------------------+-----
 0.10000000149011612 | 100 | 0.10000000149011612 | 100
 0.20000000298023224 | 100 | 0.20000000298023224 | 100
 0.30000001192092896 | 100 | 0.30000001192092896 | 100
   1.100000023841858 | 200 |   1.100000023841858 | 200
   2.200000047683716 | 200 |   2.200000047683716 | 200
   3.299999952316284 | 200 |   3.299999952316284 | 200
(6 rows)

-- select abs (builtin function, not pushdown constraints, explain)
--Testcase 19:
EXPLAIN VERBOSE
SELECT abs(value1), abs(value2), abs(value3), abs(value4) FROM s3 WHERE to_hex(value2) != '64';
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.41 rows=3396 width=24)
   Output: (abs(value1)), (abs(value2)), (abs(value3)), (abs(value4))
   Filter: (to_hex(s3.value2) <> '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT abs(value1), abs(value2), abs(value3), abs(value4), value2 FROM public.s3mysql
(5 rows)

-- select abs (builtin function, not pushdown constraints, result)
--Testcase 20:
SELECT * FROM (
SELECT abs(value1), abs(value2), abs(value3), abs(value4) FROM s3 WHERE to_hex(value2) != '64'
) AS t ORDER BY 1,2,3,4;
        abs        | abs |        abs        | abs 
-------------------+-----+-------------------+-----
 1.100000023841858 | 200 | 1.100000023841858 | 200
 2.200000047683716 | 200 | 2.200000047683716 | 200
 3.299999952316284 | 200 | 3.299999952316284 | 200
(3 rows)

-- select abs (builtin function, pushdown constraints, explain)
--Testcase 21:
EXPLAIN VERBOSE
SELECT abs(value1), abs(value2), abs(value3), abs(value4) FROM s3 WHERE value2 != 200;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..254.54 rows=3396 width=24)
   Output: (abs(value1)), (abs(value2)), (abs(value3)), (abs(value4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT abs(value1), abs(value2), abs(value3), abs(value4) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select abs (builtin function, pushdown constraints, result)
--Testcase 22:
SELECT * FROM (
SELECT abs(value1), abs(value2), abs(value3), abs(value4) FROM s3 WHERE value2 != 200
) AS t ORDER BY 1,2,3,4;
         abs         | abs |         abs         | abs 
---------------------+-----+---------------------+-----
 0.10000000149011612 | 100 | 0.10000000149011612 | 100
 0.20000000298023224 | 100 | 0.20000000298023224 | 100
 0.30000001192092896 | 100 | 0.30000001192092896 | 100
(3 rows)

-- select log (builtin function, numeric cast, explain)
-- log_<base>(v) : postgresql (base, v), mysql (base, v)
--Testcase 23:
EXPLAIN VERBOSE
SELECT value1, log(value1::numeric, value2::numeric) FROM s3 WHERE value1 != 1;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.05 rows=3396 width=40)
   Output: value1, (log((value1)::numeric, (value2)::numeric))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, log(value1::numeric, value2::numeric) FROM public.s3mysql WHERE ((value1 <> 1::double precision))
(4 rows)

-- select log (builtin function, numeric cast, result)
--Testcase 24:
SELECT value1, log(value1::numeric, value2::numeric) FROM s3 WHERE value1 != 1;
 value1 |         log         
--------+---------------------
    0.1 | -2.0000000129429845
    0.2 |  -2.861353142638945
    0.3 |  -3.824978705027617
    1.1 |  55.590244111799876
    2.2 |   6.719852571927687
    3.3 |   4.437739945920098
(6 rows)

-- select log (builtin function,  float8, explain)
--Testcase 25:
EXPLAIN VERBOSE
SELECT value1, log(value1::numeric, 0.1) FROM s3 WHERE value1 != 1;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.56 rows=3396 width=40)
   Output: value1, (log((value1)::numeric, 0.1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, log(value1::numeric, 0.1) FROM public.s3mysql WHERE ((value1 <> 1::double precision))
(4 rows)

-- select log (builtin function, float8, result)
--Testcase 26:
SELECT value1, log(value1::numeric, 0.1) FROM s3 WHERE value1 != 1;
 value1 |         log         
--------+---------------------
    0.1 |   1.000000006471492
    0.2 |   1.430676571319472
    0.3 |   1.912489352513808
    1.1 | -24.158852434150408
    2.2 | -2.9203672201537807
    3.3 | -1.9285884818027121
(6 rows)

-- select log (builtin function, bigint, explain)
--Testcase 27:
EXPLAIN VERBOSE
SELECT value1, log(value2::numeric, 3) FROM s3 WHERE value1 != 1;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.56 rows=3396 width=40)
   Output: value1, (log((value2)::numeric, '3'::numeric))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, log(value2::numeric, 3::numeric) FROM public.s3mysql WHERE ((value1 <> 1::double precision))
(4 rows)

-- select log (builtin function, bigint, result)
--Testcase 28:
SELECT value1, log(value2::numeric, 3) FROM s3 WHERE value1 != 1;
 value1 |         log         
--------+---------------------
    0.1 | 0.23856062735983122
    0.2 | 0.23856062735983122
    0.3 | 0.23856062735983122
    1.1 | 0.20735116692035352
    2.2 | 0.20735116692035352
    3.3 | 0.20735116692035352
(6 rows)

-- select log (builtin function, mix type, explain)
--Testcase 29:
EXPLAIN VERBOSE
SELECT value1, log(value1::numeric, value2::numeric) FROM s3 WHERE value1 != 1;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.05 rows=3396 width=40)
   Output: value1, (log((value1)::numeric, (value2)::numeric))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, log(value1::numeric, value2::numeric) FROM public.s3mysql WHERE ((value1 <> 1::double precision))
(4 rows)

-- select log (builtin function, mix type, result)
--Testcase 30:
SELECT value1, log(value1::numeric, value2::numeric) FROM s3 WHERE value1 != 1;
 value1 |         log         
--------+---------------------
    0.1 | -2.0000000129429845
    0.2 |  -2.861353142638945
    0.3 |  -3.824978705027617
    1.1 |  55.590244111799876
    2.2 |   6.719852571927687
    3.3 |   4.437739945920098
(6 rows)

-- select log(v) -- built in function
-- log(v): postgreSQL base 10 logarithm
--Testcase 31:
EXPLAIN VERBOSE
SELECT log(value2) FROM s3 WHERE value1 != 1;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.56 rows=3396 width=8)
   Output: (log((value2)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log(value2) FROM public.s3mysql WHERE ((value1 <> 1::double precision))
(4 rows)

--Testcase 32:
SELECT log(value2) FROM s3 WHERE value1 != 1;
        log         
--------------------
                  2
                  2
                  2
 2.3010299956639813
 2.3010299956639813
 2.3010299956639813
(6 rows)

-- select log (builtin function, explain)
--Testcase 33:
EXPLAIN VERBOSE
SELECT log(value1), log(value2), log(0.5) FROM s3;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=48)
   Output: (log(value1)), (log((value2)::double precision)), '-0.3010299956639812'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log(value1), log(value2), (-0.3010299956639812) FROM public.s3mysql
(4 rows)

-- select log (builtin function, result)
--Testcase 34:
SELECT log(value1), log(value2), log(0.5) FROM s3;
         log          |        log         |         log         
----------------------+--------------------+---------------------
   -0.999999993528508 |                  2 | -0.3010299956639812
  -0.6989699978645267 |                  2 | -0.3010299956639812
  -0.5228787280230257 |                  2 | -0.3010299956639812
 0.041392694571304324 | 2.3010299956639813 | -0.3010299956639812
  0.34242269023528554 | 2.3010299956639813 | -0.3010299956639812
   0.5185139336025012 | 2.3010299956639813 | -0.3010299956639812
(6 rows)

-- select log (builtin function, not pushdown constraints, explain)
--Testcase 35:
EXPLAIN VERBOSE
SELECT log(value1), log(value2), log(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.32 rows=17 width=48)
   Output: (log(value1)), (log((value2)::double precision)), '-0.3010299956639812'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log(value1), log(value2), (-0.3010299956639812), value2 FROM public.s3mysql
(5 rows)

-- select log (builtin function, not pushdown constraints, result)
--Testcase 36:
SELECT log(value1), log(value2), log(0.5) FROM s3 WHERE to_hex(value2) = '64';
         log         | log |         log         
---------------------+-----+---------------------
  -0.999999993528508 |   2 | -0.3010299956639812
 -0.6989699978645267 |   2 | -0.3010299956639812
 -0.5228787280230257 |   2 | -0.3010299956639812
(3 rows)

-- select log (builtin function, pushdown constraints, explain)
--Testcase 37:
EXPLAIN VERBOSE
SELECT log(value1), log(value2), log(0.5) FROM s3 WHERE value2 != 200;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.05 rows=3396 width=48)
   Output: (log(value1)), (log((value2)::double precision)), '-0.3010299956639812'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log(value1), log(value2), (-0.3010299956639812) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select log (builtin function, pushdown constraints, result)
--Testcase 38:
SELECT log(value1), log(value2), log(0.5) FROM s3 WHERE value2 != 200;
         log         | log |         log         
---------------------+-----+---------------------
  -0.999999993528508 |   2 | -0.3010299956639812
 -0.6989699978645267 |   2 | -0.3010299956639812
 -0.5228787280230257 |   2 | -0.3010299956639812
(3 rows)

-- select log (builtin function, log in constraints, explain)
--Testcase 39:
EXPLAIN VERBOSE
SELECT log(value1), log(value2), log(0.5) FROM s3 WHERE log(value1) != 1;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..254.59 rows=3396 width=48)
   Output: (log(value1)), (log((value2)::double precision)), '-0.3010299956639812'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log(value1), log(value2), (-0.3010299956639812) FROM public.s3mysql WHERE ((log(value1) <> 1::double precision))
(4 rows)

-- select log (builtin function, log in constraints, result)
--Testcase 40:
SELECT log(value1), log(value2), log(0.5) FROM s3 WHERE log(value1) != 1;
         log          |        log         |         log         
----------------------+--------------------+---------------------
   -0.999999993528508 |                  2 | -0.3010299956639812
  -0.6989699978645267 |                  2 | -0.3010299956639812
  -0.5228787280230257 |                  2 | -0.3010299956639812
 0.041392694571304324 | 2.3010299956639813 | -0.3010299956639812
  0.34242269023528554 | 2.3010299956639813 | -0.3010299956639812
   0.5185139336025012 | 2.3010299956639813 | -0.3010299956639812
(6 rows)

-- select log (builtin function, log in constraints, explain)
--Testcase 41:
EXPLAIN VERBOSE
SELECT log(value1), log(value2), log(0.5) FROM s3 WHERE log(5) > value1;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..183.96 rows=1138 width=48)
   Output: (log(value1)), (log((value2)::double precision)), '-0.3010299956639812'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log(value1), log(value2), (-0.3010299956639812) FROM public.s3mysql WHERE ((0.6989700043360189::double precision > value1))
(4 rows)

-- select log (builtin function, log in constraints, result)
--Testcase 42:
SELECT log(value1), log(value2), log(0.5) FROM s3 WHERE log(5) > value1;
         log         | log |         log         
---------------------+-----+---------------------
  -0.999999993528508 |   2 | -0.3010299956639812
 -0.6989699978645267 |   2 | -0.3010299956639812
 -0.5228787280230257 |   2 | -0.3010299956639812
(3 rows)

-- select log as nest function with agg (pushdown, explain)
--Testcase 43:
EXPLAIN VERBOSE
SELECT sum(value3),log(sum(value2)) FROM s3;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (log((sum(value2))::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), log(sum(value2)) FROM public.s3mysql
(6 rows)

-- select log as nest function with agg (pushdown, result)
--Testcase 44:
SELECT sum(value3),log(sum(value2)) FROM s3;
        sum         |        log         
--------------------+--------------------
 -7.200000040233135 | 2.9542425094393248
(1 row)

-- select log as nest with log2 (pushdown, explain)
--Testcase 45:
EXPLAIN VERBOSE
SELECT value1, log(log2(value1)),log(log2(1/value1)) FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (log(log2(value1))), (log(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, log(public.log2(value1)), log(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select log as nest with log2 (pushdown, result)
--Testcase 46:
SELECT value1, log(log2(value1)),log(log2(1/value1)) FROM s3;
 value1 |         log          |         log         
--------+----------------------+---------------------
    0.1 |                      |  0.5213902248437915
    0.2 |                      |  0.3658487624250164
    0.3 |                      | 0.23979120168873308
    1.1 |  -0.8616860734308339 |                    
    2.2 | 0.055952762624044534 |                    
    3.3 |   0.2361506589779823 |                    
(6 rows)

-- select log with non pushdown func and explicit constant (explain)
--Testcase 47:
EXPLAIN VERBOSE
SELECT log(value2), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=48)
   Output: (log((value2)::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log(value2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select log with non pushdown func and explicit constant (result)
--Testcase 48:
SELECT log(value2), pi(), 4.1 FROM s3;
        log         |        pi         | ?column? 
--------------------+-------------------+----------
                  2 | 3.141592653589793 |      4.1
                  2 | 3.141592653589793 |      4.1
                  2 | 3.141592653589793 |      4.1
 2.3010299956639813 | 3.141592653589793 |      4.1
 2.3010299956639813 | 3.141592653589793 |      4.1
 2.3010299956639813 | 3.141592653589793 |      4.1
(6 rows)

-- select log with order by (explain)
--Testcase 49:
EXPLAIN VERBOSE
SELECT value3, log(1-value3) FROM s3 ORDER BY log(1-value3);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value3, (log(('1'::double precision - value3)))
   Sort Key: (log(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value3, (log(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value3, log((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select log with order by (result)
--Testcase 50:
SELECT value3, log(1-value3) FROM s3 ORDER BY log(1-value3);
 value3 |         log         
--------+---------------------
   -0.1 |  0.0413926857465425
   -0.2 | 0.07918124712620683
   -0.3 | 0.11394335628929342
   -1.1 | 0.32221929966457985
   -2.2 |   0.505149984791398
   -3.3 |  0.6334684507635924
(6 rows)

-- select log with order by index (result)
--Testcase 51:
SELECT value3, log(1-value3) FROM s3 ORDER BY 2,1;
 value3 |         log         
--------+---------------------
   -0.1 |  0.0413926857465425
   -0.2 | 0.07918124712620683
   -0.3 | 0.11394335628929342
   -1.1 | 0.32221929966457985
   -2.2 |   0.505149984791398
   -3.3 |  0.6334684507635924
(6 rows)

-- select log with order by index (result)
--Testcase 52:
SELECT value3, log(1-value3) FROM s3 ORDER BY 1,2;
 value3 |         log         
--------+---------------------
   -3.3 |  0.6334684507635924
   -2.2 |   0.505149984791398
   -1.1 | 0.32221929966457985
   -0.3 | 0.11394335628929342
   -0.2 | 0.07918124712620683
   -0.1 |  0.0413926857465425
(6 rows)

-- select log with group by (explain)
--Testcase 53:
EXPLAIN VERBOSE
SELECT count(value1), log(1-value3) FROM s3 GROUP BY log(1-value3);
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (log(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), log((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select log with group by (result)
--Testcase 54:
SELECT count(value1), log(1-value3) FROM s3 GROUP BY log(1-value3);
 count |         log         
-------+---------------------
     1 |  0.0413926857465425
     1 | 0.07918124712620683
     1 | 0.11394335628929342
     1 | 0.32221929966457985
     1 |   0.505149984791398
     1 |  0.6334684507635924
(6 rows)

-- select log with group by index (result)
--Testcase 55:
SELECT value1, log(1-value3) FROM s3 GROUP BY 2,1;
 value1 |         log         
--------+---------------------
    0.1 |  0.0413926857465425
    0.2 | 0.07918124712620683
    0.3 | 0.11394335628929342
    1.1 | 0.32221929966457985
    2.2 |   0.505149984791398
    3.3 |  0.6334684507635924
(6 rows)

-- select log with group by index (result)
--Testcase 56:
SELECT value1, log(1-value3) FROM s3 GROUP BY 1,2;
 value1 |         log         
--------+---------------------
    0.1 |  0.0413926857465425
    0.2 | 0.07918124712620683
    0.3 | 0.11394335628929342
    1.1 | 0.32221929966457985
    2.2 |   0.505149984791398
    3.3 |  0.6334684507635924
(6 rows)

-- select log with group by having (explain)
--Testcase 57:
EXPLAIN VERBOSE
SELECT count(value1), log(1-value3) FROM s3 GROUP BY log(1-value3) HAVING log(avg(value1)) > 0;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (log(('1'::double precision - value3)))
   Filter: (log((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), log((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select log with group by having (result)
--Testcase 58:
SELECT count(value1), log(1-value3) FROM s3 GROUP BY log(1-value3) HAVING log(avg(value1)) > 0;
 count |         log         
-------+---------------------
     1 | 0.32221929966457985
     1 |   0.505149984791398
     1 |  0.6334684507635924
(3 rows)

-- select log with group by index having (result)
--Testcase 59:
SELECT value3, log(1-value3) FROM s3 GROUP BY 2,1 HAVING log(1-value3) < 0;
 value3 | log 
--------+-----
(0 rows)

-- select log with group by index having (result)
--Testcase 60:
SELECT value3, log(1-value3) FROM s3 GROUP BY 1,2 HAVING value3 > 1;
 value3 | log 
--------+-----
(0 rows)

-- select log and as
--Testcase 61:
SELECT log(value1) as log1 FROM s3;
         log1         
----------------------
   -0.999999993528508
  -0.6989699978645267
  -0.5228787280230257
 0.041392694571304324
  0.34242269023528554
   0.5185139336025012
(6 rows)

-- select abs as nest function with agg (pushdown, explain)
--Testcase 62:
EXPLAIN VERBOSE
SELECT sum(value3),abs(sum(value3)) FROM s3;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (abs(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), abs(sum(value3)) FROM public.s3mysql
(6 rows)

-- select abs as nest function with agg (pushdown, result)
--Testcase 63:
SELECT sum(value3),abs(sum(value3)) FROM s3;
        sum         |        abs        
--------------------+-------------------
 -7.200000040233135 | 7.200000040233135
(1 row)

-- select abs as nest with log2 (pushdown, explain)
--Testcase 64:
EXPLAIN VERBOSE
SELECT value1, abs(log2(value1)),abs(log2(1/value1)) FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (abs(log2(value1))), (abs(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, abs(public.log2(value1)), abs(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select abs as nest with log2 (pushdown, result)
--Testcase 65:
SELECT value1, abs(log2(value1)),abs(log2(1/value1)) FROM s3;
 value1 |         abs         |        abs         
--------+---------------------+--------------------
    0.1 |   3.321928073389531 |  3.321928073389531
    0.2 |   2.321928073389531 |  2.321928073389531
    0.3 |   1.736965536838657 | 1.7369655368386572
    1.1 | 0.13750355501950745 | 0.1375035550195074
    2.2 |  1.1375035550195074 | 1.1375035550195074
    3.3 |   1.722466003624709 | 1.7224660036247088
(6 rows)

-- select abs with non pushdown func and explicit constant (explain)
--Testcase 66:
EXPLAIN VERBOSE
SELECT abs(value3), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (abs(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT abs(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select abs with non pushdown func and explicit constant (result)
--Testcase 67:
SELECT abs(value3), pi(), 4.1 FROM s3;
         abs         |        pi         | ?column? 
---------------------+-------------------+----------
 0.10000000149011612 | 3.141592653589793 |      4.1
 0.20000000298023224 | 3.141592653589793 |      4.1
 0.30000001192092896 | 3.141592653589793 |      4.1
   1.100000023841858 | 3.141592653589793 |      4.1
   2.200000047683716 | 3.141592653589793 |      4.1
   3.299999952316284 | 3.141592653589793 |      4.1
(6 rows)

-- select sqrt as nest function with agg and explicit constant (pushdown, explain)
--Testcase 68:
EXPLAIN VERBOSE
SELECT sqrt(count(value1)), pi(), 4.1 FROM s3;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=48)
   Output: (sqrt((count(value1))::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sqrt(count(value1)), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(6 rows)

-- select sqrt as nest function with agg and explicit constant (pushdown, result)
--Testcase 69:
SELECT sqrt(count(value1)), pi(), 4.1 FROM s3;
       sqrt        |        pi         | ?column? 
-------------------+-------------------+----------
 2.449489742783178 | 3.141592653589793 |      4.1
(1 row)

-- select sqrt as nest function with agg and explicit constant and tag (error, explain)
--Testcase 70:
EXPLAIN VERBOSE
SELECT sqrt(count(value1)), pi(), 4.1, tag1 FROM s3;
ERROR:  column "s3.tag1" must appear in the GROUP BY clause or be used in an aggregate function
LINE 2: SELECT sqrt(count(value1)), pi(), 4.1, tag1 FROM s3;
                                               ^
-- select abs with order by (explain)
--Testcase 71:
EXPLAIN VERBOSE
SELECT value3, abs(1-value3) FROM s3 ORDER BY abs(1-value3);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value3, (abs(('1'::double precision - value3)))
   Sort Key: (abs(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value3, (abs(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value3, abs((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select abs with order by (result)
--Testcase 72:
SELECT value3, abs(1-value3) FROM s3 ORDER BY abs(1-value3);
 value3 |        abs         
--------+--------------------
   -0.1 | 1.1000000014901161
   -0.2 | 1.2000000029802322
   -0.3 |  1.300000011920929
   -1.1 |  2.100000023841858
   -2.2 |  3.200000047683716
   -3.3 |  4.299999952316284
(6 rows)

-- select abs with order by index (result)
--Testcase 73:
SELECT value3, abs(1-value3) FROM s3 ORDER BY 2,1;
 value3 |        abs         
--------+--------------------
   -0.1 | 1.1000000014901161
   -0.2 | 1.2000000029802322
   -0.3 |  1.300000011920929
   -1.1 |  2.100000023841858
   -2.2 |  3.200000047683716
   -3.3 |  4.299999952316284
(6 rows)

-- select abs with order by index (result)
--Testcase 74:
SELECT value3, abs(1-value3) FROM s3 ORDER BY 1,2;
 value3 |        abs         
--------+--------------------
   -3.3 |  4.299999952316284
   -2.2 |  3.200000047683716
   -1.1 |  2.100000023841858
   -0.3 |  1.300000011920929
   -0.2 | 1.2000000029802322
   -0.1 | 1.1000000014901161
(6 rows)

-- select abs and as
--Testcase 75:
SELECT * FROM (
SELECT abs(value3) as abs1 FROM s3
) AS t ORDER BY 1;
        abs1         
---------------------
 0.10000000149011612
 0.20000000298023224
 0.30000001192092896
   1.100000023841858
   2.200000047683716
   3.299999952316284
(6 rows)

-- select abs with arithmetic and tag in the middle (explain)
--Testcase 76:
EXPLAIN VERBOSE
SELECT abs(value1) + 1, value2, tag1, sqrt(value2) FROM s3;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.52 rows=3413 width=52)
   Output: ((abs(value1) + '1'::double precision)), value2, tag1, (sqrt((value2)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT (abs(value1) + 1::double precision), value2, tag1, sqrt(value2) FROM public.s3mysql
(4 rows)

-- select abs with arithmetic and tag in the middle (result)
--Testcase 77:
SELECT * FROM (
SELECT abs(value1) + 1, value2, tag1, sqrt(value2) FROM s3
) AS t ORDER BY 1,2,3,4;
      ?column?      | value2 | tag1 |        sqrt        
--------------------+--------+------+--------------------
 1.1000000014901161 |    100 | a    |                 10
 1.2000000029802322 |    100 | a    |                 10
  1.300000011920929 |    100 | a    |                 10
  2.100000023841858 |    200 | b    | 14.142135623730951
  3.200000047683716 |    200 | b    | 14.142135623730951
  4.299999952316284 |    200 | b    | 14.142135623730951
(6 rows)

-- select with order by limit (explain)
--Testcase 78:
EXPLAIN VERBOSE
SELECT abs(value1), abs(value3), sqrt(value2) FROM s3 ORDER BY abs(value3) LIMIT 1;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Limit  (cost=263.58..263.59 rows=1 width=24)
   Output: (abs(value1)), (abs(value3)), (sqrt((value2)::double precision))
   ->  Sort  (cost=263.58..272.12 rows=3413 width=24)
         Output: (abs(value1)), (abs(value3)), (sqrt((value2)::double precision))
         Sort Key: (abs(s3.value3))
         ->  Foreign Scan on public.s3  (cost=100.00..246.52 rows=3413 width=24)
               Output: (abs(value1)), (abs(value3)), (sqrt((value2)::double precision))
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT abs(value1), abs(value3), sqrt(value2) FROM public.s3mysql
(9 rows)

-- select with order by limit (result)
--Testcase 79:
SELECT abs(value1), abs(value3), sqrt(value2) FROM s3 ORDER BY abs(value3) LIMIT 1;
         abs         |         abs         | sqrt 
---------------------+---------------------+------
 0.10000000149011612 | 0.10000000149011612 |   10
(1 row)

-- select mixing with non pushdown func (all not pushdown, explain)
--Testcase 80:
EXPLAIN VERBOSE
SELECT abs(value1), sqrt(value2), cosd(id+40) FROM s3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=24)
   Output: (abs(value1)), (sqrt((value2)::double precision)), (cosd(((id + 40))::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT abs(value1), sqrt(value2), cosd((id + 40)) FROM public.s3mysql
(4 rows)

-- select mixing with non pushdown func (result)
--Testcase 81:
SELECT abs(value1), sqrt(value2), cosd(id+40) FROM s3;
 abs |        sqrt        |        cosd        
-----+--------------------+--------------------
 0.1 |                 10 | 0.7660444431189779
 0.2 |                 10 | 0.7547095802227719
 0.3 |                 10 | 0.7431448254773942
 1.1 | 14.142135623730951 | 0.7313537016191705
 2.2 | 14.142135623730951 | 0.7193398003386511
 3.3 | 14.142135623730951 | 0.7071067811865475
(6 rows)

-- select conv (stub function, int column, explain)
--Testcase 82:
EXPLAIN VERBOSE
SELECT conv(id, 10, 2), id FROM s3 WHERE value2 != 100 ORDER BY id, conv(id, 10, 2);
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Sort  (cost=1268.75..1277.24 rows=3396 width=36)
   Output: (conv(id, 10, 2)), id
   Sort Key: s3.id, (conv(s3.id, 10, 2))
   ->  Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=36)
         Output: (conv(id, 10, 2)), id
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.conv(id, 10, 2), id FROM public.s3mysql WHERE ((value2 <> 100))
(7 rows)

-- select conv (stub function, int column, result)
--Testcase 83:
SELECT conv(id, 10, 2), id FROM s3 WHERE value2 != 100 ORDER BY id, conv(id, 10, 2);
 conv | id 
------+----
 11   |  3
 100  |  4
 101  |  5
(3 rows)

-- select conv (stub function, text column, explain)
--Testcase 84:
EXPLAIN VERBOSE
SELECT conv(str1, 18, 8), str1 FROM s3 WHERE value2 != 200;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=64)
   Output: (conv(str1, 18, 8)), str1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.conv(str1, 18, 8), str1 FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select conv (stub function, text column, result)
--Testcase 85:
SELECT conv(str1, 18, 8), str1 FROM s3 WHERE value2 != 200;
 conv |   str1    
------+-----------
 0    | ---XYZ---
 0    | ---XYZ---
 0    | ---XYZ---
(3 rows)

-- select conv (stub function, const integer, explain)
--Testcase 86:
EXPLAIN VERBOSE
SELECT conv(15, 16, 3), tag1 FROM s3 WHERE value2 != 200 LIMIT 1;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Limit  (cost=100.00..100.29 rows=1 width=64)
   Output: (conv(15, 16, 3)), tag1
   ->  Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=64)
         Output: (conv(15, 16, 3)), tag1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.conv(15, 16, 3), tag1 FROM public.s3mysql WHERE ((value2 <> 200))
(6 rows)

-- select conv (stub function, const integer, result)
--Testcase 87:
SELECT conv(15, 16, 3), tag1 FROM s3 WHERE value2 != 200 LIMIT 1;
 conv | tag1 
------+------
 210  | a
(1 row)

-- select conv (stub function, const text, explain)
--Testcase 88:
EXPLAIN VERBOSE
SELECT conv('6hE', 30, -9), str2 FROM s3 WHERE value2 != 200 LIMIT 1;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Limit  (cost=100.00..100.29 rows=1 width=64)
   Output: (conv('6hE'::text, 30, '-9'::integer)), str2
   ->  Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=64)
         Output: (conv('6hE'::text, 30, '-9'::integer)), str2
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.conv('6hE'::text, 30, (-9)), str2 FROM public.s3mysql WHERE ((value2 <> 200))
(6 rows)

-- select conv (stub function, const text, explain)
--Testcase 89:
SELECT conv('6hE', 30, -9), str2 FROM s3 WHERE value2 != 200 LIMIT 1;
 conv |   str2    
------+-----------
 8112 |    XYZ   
(1 row)

-- select conv (stub function, calculate, explain)
--Testcase 90:
EXPLAIN VERBOSE
SELECT conv(value2 + '10', 10, 10), value2 FROM s3 WHERE value2 != 50;
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1078.07 rows=3396 width=36)
   Output: (conv((value2 + 10), 10, 10)), value2
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.conv((value2 + 10), 10, 10), value2 FROM public.s3mysql WHERE ((value2 <> 50))
(4 rows)

-- select conv (stub function, calculate, explain)
--Testcase 91:
SELECT conv(value2 + '10', 10, 10), value2 FROM s3 WHERE value2 != 50;
 conv | value2 
------+--------
 110  |    100
 110  |    100
 110  |    100
 210  |    200
 210  |    200
 210  |    200
(6 rows)

-- conv() in where clause
-- where conv (stub function, int column, explain)
--Testcase 92:
EXPLAIN VERBOSE
SELECT * FROM s3 WHERE conv(value2,10,20) = '50';
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1006.25 rows=17 width=156)
   Output: id, tag1, value1, value2, value3, value4, str1, str2, __spd_url
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, tag1, value1, value2, value3, value4, str1, str2, __spd_url FROM public.s3mysql WHERE ((public.conv(value2, 10, 20) = '50'::text))
(4 rows)

-- where conv (stub function, int column, result)
--Testcase 93:
SELECT * FROM s3 WHERE conv(value2,10,20) = '50';
 id | tag1 | value1 | value2 | value3 | value4 |   str1    |   str2    |        __spd_url         
----+------+--------+--------+--------+--------+-----------+-----------+--------------------------
  0 | a    |    0.1 |    100 |   -0.1 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  1 | a    |    0.2 |    100 |   -0.2 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  2 | a    |    0.3 |    100 |   -0.3 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
(3 rows)

-- where conv (stub function, int column, explain)
--Testcase 94:
EXPLAIN VERBOSE
SELECT * FROM s3 WHERE conv(value2,10,20) != str1;
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1073.83 rows=3396 width=156)
   Output: id, tag1, value1, value2, value3, value4, str1, str2, __spd_url
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, tag1, value1, value2, value3, value4, str1, str2, __spd_url FROM public.s3mysql WHERE ((public.conv(value2, 10, 20) <> str1))
(4 rows)

-- where conv (stub function, int column, result)
--Testcase 95:
SELECT * FROM s3 WHERE conv(value2,10,20) != str1;
 id | tag1 | value1 | value2 | value3 | value4 |   str1    |   str2    |        __spd_url         
----+------+--------+--------+--------+--------+-----------+-----------+--------------------------
  0 | a    |    0.1 |    100 |   -0.1 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  1 | a    |    0.2 |    100 |   -0.2 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  2 | a    |    0.3 |    100 |   -0.3 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  3 | b    |    1.1 |    200 |   -1.1 |   -200 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  4 | b    |    2.2 |    200 |   -2.2 |   -200 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  5 | b    |    3.3 |    200 |   -3.3 |   -200 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
(6 rows)

-- order by conv  (stub function, int column)
-- select conv (stub function, text column, explain)
--Testcase 96:
EXPLAIN VERBOSE
SELECT conv(str1, 18, 8), str1 FROM s3 WHERE value2 != 200 ORDER BY 1;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Sort  (cost=1268.75..1277.24 rows=3396 width=64)
   Output: (conv(str1, 18, 8)), str1
   Sort Key: (conv(s3.str1, 18, 8))
   ->  Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=64)
         Output: (conv(str1, 18, 8)), str1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.conv(str1, 18, 8), str1 FROM public.s3mysql WHERE ((value2 <> 200))
(7 rows)

-- select conv (stub function, text column, result)
--Testcase 97:
SELECT conv(str1, 18, 8), str1 FROM s3 WHERE value2 != 200 ORDER BY 1;
 conv |   str1    
------+-----------
 0    | ---XYZ---
 0    | ---XYZ---
 0    | ---XYZ---
(3 rows)

-- select crc32 (stub function, int column, explain)
--Testcase 98:
EXPLAIN VERBOSE
SELECT crc32(id), id FROM s3 WHERE value2 != 100 ORDER BY id, crc32(id);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Sort  (cost=1268.75..1277.24 rows=3396 width=12)
   Output: (crc32(id)), id
   Sort Key: s3.id, (crc32(s3.id))
   ->  Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=12)
         Output: (crc32(id)), id
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.crc32(id), id FROM public.s3mysql WHERE ((value2 <> 100))
(7 rows)

-- select crc32 (stub function, int column, result)
--Testcase 99:
SELECT crc32(id), id FROM s3 WHERE value2 != 100 ORDER BY id, crc32(id);
   crc32    | id 
------------+----
 1842515611 |  3
 4088798008 |  4
 2226203566 |  5
(3 rows)

-- select crc32 (stub function, int column, explain)
--Testcase 100:
EXPLAIN VERBOSE
SELECT crc32(id), id FROM s3 WHERE value2 = 100 ORDER BY id, crc32(id);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=157.60..157.64 rows=17 width=12)
   Output: (crc32(id)), id
   Sort Key: s3.id, (crc32(s3.id))
   ->  Foreign Scan on public.s3  (cost=100.00..157.25 rows=17 width=12)
         Output: (crc32(id)), id
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.crc32(id), id FROM public.s3mysql WHERE ((value2 = 100))
(7 rows)

-- select crc32 (stub function, int column, result)
--Testcase 101:
SELECT crc32(id), id FROM s3 WHERE value2 = 100 ORDER BY id, crc32(id);
   crc32    | id 
------------+----
 4108050209 |  0
 2212294583 |  1
  450215437 |  2
(3 rows)

-- select crc32 (stub function, text column, explain)
--Testcase 102:
EXPLAIN VERBOSE
SELECT crc32(str1), str1 FROM s3 WHERE value2 != 200;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: (crc32(str1)), str1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.crc32(str1), str1 FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select crc32 (stub function, text column, result)
--Testcase 103:
SELECT crc32(str1), str1 FROM s3 WHERE value2 != 200;
   crc32    |   str1    
------------+-----------
 2107655502 | ---XYZ---
 2107655502 | ---XYZ---
 2107655502 | ---XYZ---
(3 rows)

-- select crc32 (stub function, const integer, explain)
--Testcase 104:
EXPLAIN VERBOSE
SELECT crc32(15), tag1 FROM s3 WHERE value2 != 200 LIMIT 1;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Limit  (cost=100.00..100.29 rows=1 width=40)
   Output: (crc32(15)), tag1
   ->  Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
         Output: (crc32(15)), tag1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.crc32(15), tag1 FROM public.s3mysql WHERE ((value2 <> 200))
(6 rows)

-- select crc32 (stub function, const integer, result)
--Testcase 105:
SELECT crc32(15), tag1 FROM s3 WHERE value2 != 200 LIMIT 1;
   crc32    | tag1 
------------+------
 3510096238 | a
(1 row)

-- select crc32 (stub function, const text, explain)
--Testcase 106:
EXPLAIN VERBOSE
SELECT crc32('6hE'), str2 FROM s3 WHERE value2 != 200 LIMIT 1;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Limit  (cost=100.00..100.29 rows=1 width=40)
   Output: (crc32('6hE'::text)), str2
   ->  Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
         Output: (crc32('6hE'::text)), str2
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.crc32('6hE'::text), str2 FROM public.s3mysql WHERE ((value2 <> 200))
(6 rows)

-- select crc32 (stub function, const text, explain)
--Testcase 107:
SELECT crc32('6hE'), str2 FROM s3 WHERE value2 != 200 LIMIT 1;
   crc32    |   str2    
------------+-----------
 1949635712 |    XYZ   
(1 row)

-- select crc32 (stub function, calculate, explain)
--Testcase 108:
EXPLAIN VERBOSE
SELECT crc32(value2 + '10'), value2 FROM s3 WHERE value2 != 50;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1078.07 rows=3396 width=12)
   Output: (crc32((value2 + 10))), value2
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.crc32((value2 + 10)), value2 FROM public.s3mysql WHERE ((value2 <> 50))
(4 rows)

-- select crc32 (stub function, calculate, explain)
--Testcase 109:
SELECT crc32(value2 + '10'), value2 FROM s3 WHERE value2 != 50;
   crc32   | value2 
-----------+--------
 980181419 |    100
 980181419 |    100
 980181419 |    100
 942333938 |    200
 942333938 |    200
 942333938 |    200
(6 rows)

-- select crc32 (builtin function, explain)
--Testcase 110:
EXPLAIN VERBOSE
SELECT value1, crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3625.39 rows=3413 width=40)
   Output: value1, (crc32(value2)), (crc32(value3)), (crc32(value4)), (crc32(0.5))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.crc32(value2), public.crc32(value3), public.crc32(value4), public.crc32(0.5) FROM public.s3mysql
(4 rows)

-- select crc32 (builtin function, result)
--Testcase 111:
SELECT value1, crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3;
 value1 |   crc32   |   crc32    |   crc32    |   crc32    
--------+-----------+------------+------------+------------
    0.1 | 595022058 |  229524601 | 2938773767 | 2258563469
    0.2 | 595022058 | 2493978051 | 2938773767 | 2258563469
    0.3 | 595022058 | 3818923349 | 2938773767 | 2258563469
    1.1 | 556920499 |  208416334 | 2909577054 | 2258563469
    2.2 | 556920499 | 2535702957 | 2909577054 | 2258563469
    3.3 | 556920499 | 3789986572 | 2909577054 | 2258563469
(6 rows)

-- select crc32 (builtin function, not pushdown constraints, explain)
--Testcase 112:
EXPLAIN VERBOSE
SELECT crc32(value1), crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..250.44 rows=17 width=40)
   Output: (crc32(value1)), (crc32(value2)), (crc32(value3)), (crc32(value4)), (crc32(0.5))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.crc32(value1), public.crc32(value2), public.crc32(value3), public.crc32(value4), public.crc32(0.5), value2 FROM public.s3mysql
(5 rows)

-- select crc32 (builtin function, not pushdown constraints, result)
--Testcase 113:
SELECT crc32(value1), crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3 WHERE to_hex(value2) = '64';
   crc32    |   crc32   |   crc32    |   crc32    |   crc32    
------------+-----------+------------+------------+------------
 2180199828 | 595022058 |  229524601 | 2938773767 | 2258563469
  419062830 | 595022058 | 2493978051 | 2938773767 | 2258563469
 1878873272 | 595022058 | 3818923349 | 2938773767 | 2258563469
(3 rows)

-- select crc32 (builtin function, pushdown constraints, explain)
--Testcase 114:
EXPLAIN VERBOSE
SELECT crc32(value1), crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3 WHERE value2 != 200;
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4465.58 rows=3396 width=40)
   Output: (crc32(value1)), (crc32(value2)), (crc32(value3)), (crc32(value4)), (crc32(0.5))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.crc32(value1), public.crc32(value2), public.crc32(value3), public.crc32(value4), public.crc32(0.5) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select crc32 (builtin function, pushdown constraints, result)
--Testcase 115:
SELECT crc32(value1), crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3 WHERE value2 != 200;
   crc32    |   crc32   |   crc32    |   crc32    |   crc32    
------------+-----------+------------+------------+------------
 2180199828 | 595022058 |  229524601 | 2938773767 | 2258563469
  419062830 | 595022058 | 2493978051 | 2938773767 | 2258563469
 1878873272 | 595022058 | 3818923349 | 2938773767 | 2258563469
(3 rows)

-- select crc32 (builtin function, crc32 in constraints, explain)
--Testcase 116:
EXPLAIN VERBOSE
SELECT value1, crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3 WHERE crc32(value1) != 1;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4469.83 rows=3396 width=40)
   Output: value1, (crc32(value2)), (crc32(value3)), (crc32(value4)), (crc32(0.5))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.crc32(value2), public.crc32(value3), public.crc32(value4), public.crc32(0.5) FROM public.s3mysql WHERE ((public.crc32(value1) <> 1))
(4 rows)

-- select crc32 (builtin function, crc32 in constraints, result)
--Testcase 117:
SELECT value1, crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3 WHERE crc32(value1) != 1;
 value1 |   crc32   |   crc32    |   crc32    |   crc32    
--------+-----------+------------+------------+------------
    0.1 | 595022058 |  229524601 | 2938773767 | 2258563469
    0.2 | 595022058 | 2493978051 | 2938773767 | 2258563469
    0.3 | 595022058 | 3818923349 | 2938773767 | 2258563469
    1.1 | 556920499 |  208416334 | 2909577054 | 2258563469
    2.2 | 556920499 | 2535702957 | 2909577054 | 2258563469
    3.3 | 556920499 | 3789986572 | 2909577054 | 2258563469
(6 rows)

-- select crc32 (builtin function, crc32 in constraints, explain)
--Testcase 118:
EXPLAIN VERBOSE
SELECT value1, crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3 WHERE crc32(0.5) > value1;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2175.20 rows=1138 width=40)
   Output: value1, (crc32(value2)), (crc32(value3)), (crc32(value4)), (crc32(0.5))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.crc32(value2), public.crc32(value3), public.crc32(value4), public.crc32(0.5) FROM public.s3mysql WHERE ((public.crc32(0.5) > value1))
(4 rows)

-- select crc32 (builtin function, crc32 in constraints, result)
--Testcase 119:
SELECT value1, crc32(value2), crc32(value3), crc32(value4), crc32(0.5) FROM s3 WHERE crc32(0.5) > value1;
 value1 |   crc32   |   crc32    |   crc32    |   crc32    
--------+-----------+------------+------------+------------
    0.1 | 595022058 |  229524601 | 2938773767 | 2258563469
    0.2 | 595022058 | 2493978051 | 2938773767 | 2258563469
    0.3 | 595022058 | 3818923349 | 2938773767 | 2258563469
    1.1 | 556920499 |  208416334 | 2909577054 | 2258563469
    2.2 | 556920499 | 2535702957 | 2909577054 | 2258563469
    3.3 | 556920499 | 3789986572 | 2909577054 | 2258563469
(6 rows)

-- select crc32 as nest function with agg (pushdown, explain)
--Testcase 120:
EXPLAIN VERBOSE
SELECT sum(value3),crc32(sum(value3)) FROM s3;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (crc32(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), public.crc32(sum(value3)) FROM public.s3mysql
(6 rows)

-- select crc32 as nest function with agg (pushdown, result)
--Testcase 121:
SELECT sum(value3),crc32(sum(value3)) FROM s3;
        sum         |   crc32   
--------------------+-----------
 -7.200000040233135 | 907837819
(1 row)

-- select crc32 as nest with log2 (pushdown, explain)
--Testcase 122:
EXPLAIN VERBOSE
SELECT value1, crc32(log2(value1)),crc32(log2(1/value1)) FROM s3;
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3633.92 rows=3413 width=24)
   Output: value1, (crc32(log2(value1))), (crc32(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.crc32(public.log2(value1)), public.crc32(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select crc32 as nest with log2 (pushdown, result)
--Testcase 123:
SELECT value1, crc32(log2(value1)),crc32(log2(1/value1)) FROM s3;
 value1 |   crc32    |   crc32    
--------+------------+------------
    0.1 | 2050478267 | 2049874320
    0.2 | 4254145528 | 4253569747
    0.3 |   85804108 | 3372633851
    1.1 | 2676406531 | 2592814684
    2.2 | 3647299764 | 1977188541
    3.3 | 1840977260 |  198053949
(6 rows)

-- select crc32 with non pushdown func and explicit conscrc32t (explain)
--Testcase 124:
EXPLAIN VERBOSE
SELECT value1, crc32(value3), pi(), 4.1 FROM s3;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=56)
   Output: value1, (crc32(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.crc32(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select crc32 with non pushdown func and explicit conscrc32t (result)
--Testcase 125:
SELECT value1, crc32(value3), pi(), 4.1 FROM s3;
 value1 |   crc32    |        pi         | ?column? 
--------+------------+-------------------+----------
    0.1 |  229524601 | 3.141592653589793 |      4.1
    0.2 | 2493978051 | 3.141592653589793 |      4.1
    0.3 | 3818923349 | 3.141592653589793 |      4.1
    1.1 |  208416334 | 3.141592653589793 |      4.1
    2.2 | 2535702957 | 3.141592653589793 |      4.1
    3.3 | 3789986572 | 3.141592653589793 |      4.1
(6 rows)

-- select crc32 with order by (explain)
--Testcase 126:
EXPLAIN VERBOSE
SELECT value3, crc32(1-value3) FROM s3 ORDER BY crc32(1-value3);
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=16)
   Output: value3, (crc32(('1'::double precision - value3)))
   Sort Key: (crc32(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=16)
         Output: value3, (crc32(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value3, public.crc32((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select crc32 with order by (result)
--Testcase 127:
SELECT value3, crc32(1-value3) FROM s3 ORDER BY crc32(1-value3);
 value3 |   crc32    
--------+------------
   -0.2 |  313124613
   -0.3 | 2649881391
   -3.3 | 2982988221
   -1.1 | 3134819062
   -2.2 | 3277450652
   -0.1 | 4080077135
(6 rows)

-- select crc32 with order by index (result)
--Testcase 128:
SELECT value3, crc32(1-value3) FROM s3 ORDER BY 2,1;
 value3 |   crc32    
--------+------------
   -0.2 |  313124613
   -0.3 | 2649881391
   -3.3 | 2982988221
   -1.1 | 3134819062
   -2.2 | 3277450652
   -0.1 | 4080077135
(6 rows)

-- select crc32 with order by index (result)
--Testcase 129:
SELECT value3, crc32(1-value3) FROM s3 ORDER BY 1,2;
 value3 |   crc32    
--------+------------
   -3.3 | 2982988221
   -2.2 | 3277450652
   -1.1 | 3134819062
   -0.3 | 2649881391
   -0.2 |  313124613
   -0.1 | 4080077135
(6 rows)

-- select crc32 with group by (explain)
--Testcase 130:
EXPLAIN VERBOSE
SELECT value1, crc32(1-value3) FROM s3 GROUP BY value1, crc32(1-value3);
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (crc32(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, public.crc32((1::double precision - value3)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select crc32 with group by (result)
--Testcase 131:
SELECT value1, crc32(1-value3) FROM s3 GROUP BY value1, crc32(1-value3);
 value1 |   crc32    
--------+------------
    0.1 | 4080077135
    0.2 |  313124613
    0.3 | 2649881391
    1.1 | 3134819062
    2.2 | 3277450652
    3.3 | 2982988221
(6 rows)

-- select crc32 with group by index (result)
--Testcase 132:
SELECT value1, crc32(1-value3) FROM s3 GROUP BY 2,1;
 value1 |   crc32    
--------+------------
    0.1 | 4080077135
    0.2 |  313124613
    0.3 | 2649881391
    1.1 | 3134819062
    2.2 | 3277450652
    3.3 | 2982988221
(6 rows)

-- select crc32 with group by index (result)
--Testcase 133:
SELECT value1, crc32(1-value3) FROM s3 GROUP BY 1,2;
 value1 |   crc32    
--------+------------
    0.1 | 4080077135
    0.2 |  313124613
    0.3 | 2649881391
    1.1 | 3134819062
    2.2 | 3277450652
    3.3 | 2982988221
(6 rows)

-- select crc32 with group by having (explain)
--Testcase 134:
EXPLAIN VERBOSE
SELECT value1, crc32(1-value3) FROM s3 GROUP BY value1, crc32(1-value3) HAVING avg(value1) > 0;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (crc32(('1'::double precision - value3)))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, public.crc32((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select crc32 with group by having (result)
--Testcase 135:
SELECT value1, crc32(1-value3) FROM s3 GROUP BY value1, crc32(1-value3) HAVING avg(value1) > 0;
 value1 |   crc32    
--------+------------
    0.1 | 4080077135
    0.2 |  313124613
    0.3 | 2649881391
    1.1 | 3134819062
    2.2 | 3277450652
    3.3 | 2982988221
(6 rows)

-- select crc32 with group by index having (result)
--Testcase 136:
SELECT value3, crc32(1-value3) FROM s3 GROUP BY 1,2 HAVING value3 > 1;
 value3 | crc32 
--------+-------
(0 rows)

-- select crc32 and as
--Testcase 137:
SELECT value1, crc32(value3) as crc321 FROM s3;
 value1 |   crc321   
--------+------------
    0.1 |  229524601
    0.2 | 2493978051
    0.3 | 3818923349
    1.1 |  208416334
    2.2 | 2535702957
    3.3 | 3789986572
(6 rows)

-- select log10 (builtin function, explain)
--Testcase 138:
EXPLAIN VERBOSE
SELECT log10(value1), log10(value2), log10(0.5) FROM s3;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=48)
   Output: (log10(value1)), (log10((value2)::double precision)), '-0.3010299956639812'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log10(value1), log10(value2), (-0.3010299956639812) FROM public.s3mysql
(4 rows)

-- select log10 (builtin function, result)
--Testcase 139:
SELECT log10(value1), log10(value2), log10(0.5) FROM s3;
        log10         |       log10        |        log10        
----------------------+--------------------+---------------------
   -0.999999993528508 |                  2 | -0.3010299956639812
  -0.6989699978645267 |                  2 | -0.3010299956639812
  -0.5228787280230257 |                  2 | -0.3010299956639812
 0.041392694571304324 | 2.3010299956639813 | -0.3010299956639812
  0.34242269023528554 | 2.3010299956639813 | -0.3010299956639812
   0.5185139336025012 | 2.3010299956639813 | -0.3010299956639812
(6 rows)

-- select log10 (builtin function, not pushdown constraints, explain)
--Testcase 140:
EXPLAIN VERBOSE
SELECT log10(value1), log10(value2), log10(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.32 rows=17 width=48)
   Output: (log10(value1)), (log10((value2)::double precision)), '-0.3010299956639812'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log10(value1), log10(value2), (-0.3010299956639812), value2 FROM public.s3mysql
(5 rows)

-- select log10 (builtin function, not pushdown constraints, result)
--Testcase 141:
SELECT log10(value1), log10(value2), log10(0.5) FROM s3 WHERE to_hex(value2) = '64';
        log10        | log10 |        log10        
---------------------+-------+---------------------
  -0.999999993528508 |     2 | -0.3010299956639812
 -0.6989699978645267 |     2 | -0.3010299956639812
 -0.5228787280230257 |     2 | -0.3010299956639812
(3 rows)

-- select log10 (builtin function, pushdown constraints, explain)
--Testcase 142:
EXPLAIN VERBOSE
SELECT log10(value1), log10(value2), log10(0.5) FROM s3 WHERE value2 != 200;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.05 rows=3396 width=48)
   Output: (log10(value1)), (log10((value2)::double precision)), '-0.3010299956639812'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log10(value1), log10(value2), (-0.3010299956639812) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select log10 (builtin function, pushdown constraints, result)
--Testcase 143:
SELECT log10(value1), log10(value2), log10(0.5) FROM s3 WHERE value2 != 200;
        log10        | log10 |        log10        
---------------------+-------+---------------------
  -0.999999993528508 |     2 | -0.3010299956639812
 -0.6989699978645267 |     2 | -0.3010299956639812
 -0.5228787280230257 |     2 | -0.3010299956639812
(3 rows)

-- select log10 (builtin function, log10 in constraints, explain)
--Testcase 144:
EXPLAIN VERBOSE
SELECT log10(value1), log10(value2), log10(0.5) FROM s3 WHERE log10(value1) != 1;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..254.59 rows=3396 width=48)
   Output: (log10(value1)), (log10((value2)::double precision)), '-0.3010299956639812'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log10(value1), log10(value2), (-0.3010299956639812) FROM public.s3mysql WHERE ((log10(value1) <> 1::double precision))
(4 rows)

-- select log10 (builtin function, log10 in constraints, result)
--Testcase 145:
SELECT log10(value1), log10(value2), log10(0.5) FROM s3 WHERE log10(value1) != 1;
        log10         |       log10        |        log10        
----------------------+--------------------+---------------------
   -0.999999993528508 |                  2 | -0.3010299956639812
  -0.6989699978645267 |                  2 | -0.3010299956639812
  -0.5228787280230257 |                  2 | -0.3010299956639812
 0.041392694571304324 | 2.3010299956639813 | -0.3010299956639812
  0.34242269023528554 | 2.3010299956639813 | -0.3010299956639812
   0.5185139336025012 | 2.3010299956639813 | -0.3010299956639812
(6 rows)

-- select log10 (builtin function, log10 in constraints, explain)
--Testcase 146:
EXPLAIN VERBOSE
SELECT log10(value1), log10(value2), log10(0.5) FROM s3 WHERE log10(0.5) < value1;
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..183.96 rows=1138 width=48)
   Output: (log10(value1)), (log10((value2)::double precision)), '-0.3010299956639812'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log10(value1), log10(value2), (-0.3010299956639812) FROM public.s3mysql WHERE (((-0.3010299956639812)::double precision < value1))
(4 rows)

-- select log10 (builtin function, log10 in constraints, result)
--Testcase 147:
SELECT log10(value1), log10(value2), log10(0.5) FROM s3 WHERE log10(0.5) < value1;
        log10         |       log10        |        log10        
----------------------+--------------------+---------------------
   -0.999999993528508 |                  2 | -0.3010299956639812
  -0.6989699978645267 |                  2 | -0.3010299956639812
  -0.5228787280230257 |                  2 | -0.3010299956639812
 0.041392694571304324 | 2.3010299956639813 | -0.3010299956639812
  0.34242269023528554 | 2.3010299956639813 | -0.3010299956639812
   0.5185139336025012 | 2.3010299956639813 | -0.3010299956639812
(6 rows)

-- select log10 as nest function with agg (pushdown, explain)
--Testcase 148:
EXPLAIN VERBOSE
SELECT sum(value3),log10(sum(value2)) FROM s3;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (log10((sum(value2))::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), log10(sum(value2)) FROM public.s3mysql
(6 rows)

-- select log10 as nest function with agg (pushdown, result)
--Testcase 149:
SELECT sum(value3),log10(sum(value2)) FROM s3;
        sum         |       log10        
--------------------+--------------------
 -7.200000040233135 | 2.9542425094393248
(1 row)

-- select log10 as nest with log2 (pushdown, explain)
--Testcase 150:
EXPLAIN VERBOSE
SELECT value1, log10(log2(value1)),log10(log2(1/value1)) FROM s3;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (log10(log2(value1))), (log10(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, log10(public.log2(value1)), log10(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select log10 as nest with log2 (pushdown, result)
--Testcase 151:
SELECT value1, log10(log2(value1)),log10(log2(1/value1)) FROM s3;
 value1 |        log10         |        log10        
--------+----------------------+---------------------
    0.1 |                      |  0.5213902248437915
    0.2 |                      |  0.3658487624250164
    0.3 |                      | 0.23979120168873308
    1.1 |  -0.8616860734308339 |                    
    2.2 | 0.055952762624044534 |                    
    3.3 |   0.2361506589779823 |                    
(6 rows)

-- select log10 with non pushdown func and explicit constant (explain)
--Testcase 152:
EXPLAIN VERBOSE
SELECT log10(value2), pi(), 4.1 FROM s3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=48)
   Output: (log10((value2)::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT log10(value2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select log10 with non pushdown func and explicit constant (result)
--Testcase 153:
SELECT log10(value2), pi(), 4.1 FROM s3;
       log10        |        pi         | ?column? 
--------------------+-------------------+----------
                  2 | 3.141592653589793 |      4.1
                  2 | 3.141592653589793 |      4.1
                  2 | 3.141592653589793 |      4.1
 2.3010299956639813 | 3.141592653589793 |      4.1
 2.3010299956639813 | 3.141592653589793 |      4.1
 2.3010299956639813 | 3.141592653589793 |      4.1
(6 rows)

-- select log10 with order by (explain)
--Testcase 154:
EXPLAIN VERBOSE
SELECT value3, log10(1-value3) FROM s3 ORDER BY log10(1-value3);
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value3, (log10(('1'::double precision - value3)))
   Sort Key: (log10(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value3, (log10(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value3, log10((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select log10 with order by (result)
--Testcase 155:
SELECT value3, log10(1-value3) FROM s3 ORDER BY log10(1-value3);
 value3 |        log10        
--------+---------------------
   -0.1 |  0.0413926857465425
   -0.2 | 0.07918124712620683
   -0.3 | 0.11394335628929342
   -1.1 | 0.32221929966457985
   -2.2 |   0.505149984791398
   -3.3 |  0.6334684507635924
(6 rows)

-- select log10 with order by index (result)
--Testcase 156:
SELECT value3, log10(1-value3) FROM s3 ORDER BY 2,1;
 value3 |        log10        
--------+---------------------
   -0.1 |  0.0413926857465425
   -0.2 | 0.07918124712620683
   -0.3 | 0.11394335628929342
   -1.1 | 0.32221929966457985
   -2.2 |   0.505149984791398
   -3.3 |  0.6334684507635924
(6 rows)

-- select log10 with order by index (result)
--Testcase 157:
SELECT value3, log10(1-value3) FROM s3 ORDER BY 1,2;
 value3 |        log10        
--------+---------------------
   -3.3 |  0.6334684507635924
   -2.2 |   0.505149984791398
   -1.1 | 0.32221929966457985
   -0.3 | 0.11394335628929342
   -0.2 | 0.07918124712620683
   -0.1 |  0.0413926857465425
(6 rows)

-- select log10 with group by (explain)
--Testcase 158:
EXPLAIN VERBOSE
SELECT count(value1), log10(1-value3) FROM s3 GROUP BY log10(1-value3);
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (log10(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), log10((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select log10 with group by (result)
--Testcase 159:
SELECT count(value1), log10(1-value3) FROM s3 GROUP BY log10(1-value3);
 count |        log10        
-------+---------------------
     1 |  0.0413926857465425
     1 | 0.07918124712620683
     1 | 0.11394335628929342
     1 | 0.32221929966457985
     1 |   0.505149984791398
     1 |  0.6334684507635924
(6 rows)

-- select log10 with group by index (result)
--Testcase 160:
SELECT value1, log10(1-value3) FROM s3 GROUP BY 2,1;
 value1 |        log10        
--------+---------------------
    0.1 |  0.0413926857465425
    0.2 | 0.07918124712620683
    0.3 | 0.11394335628929342
    1.1 | 0.32221929966457985
    2.2 |   0.505149984791398
    3.3 |  0.6334684507635924
(6 rows)

-- select log10 with group by index (result)
--Testcase 161:
SELECT value1, log10(1-value3) FROM s3 GROUP BY 1,2;
 value1 |        log10        
--------+---------------------
    0.1 |  0.0413926857465425
    0.2 | 0.07918124712620683
    0.3 | 0.11394335628929342
    1.1 | 0.32221929966457985
    2.2 |   0.505149984791398
    3.3 |  0.6334684507635924
(6 rows)

-- select log10 with group by having (explain)
--Testcase 162:
EXPLAIN VERBOSE
SELECT count(value1), log10(1-value3) FROM s3 GROUP BY log10(1-value3) HAVING log10(avg(value1)) > 0;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (log10(('1'::double precision - value3)))
   Filter: (log10((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), log10((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select log10 with group by having (result)
--Testcase 163:
SELECT count(value1), log10(1-value3) FROM s3 GROUP BY log10(1-value3) HAVING log10(avg(value1)) > 0;
 count |        log10        
-------+---------------------
     1 | 0.32221929966457985
     1 |   0.505149984791398
     1 |  0.6334684507635924
(3 rows)

-- select log10 with group by index having (result)
--Testcase 164:
SELECT value3, log10(1-value3) FROM s3 GROUP BY 2,1 HAVING log10(1-value3) < 0;
 value3 | log10 
--------+-------
(0 rows)

-- select log10 with group by index having (result)
--Testcase 165:
SELECT value3, log10(1-value3) FROM s3 GROUP BY 1,2 HAVING value3 > 1;
 value3 | log10 
--------+-------
(0 rows)

-- select log10 and as
--Testcase 166:
SELECT value1, log10(value1) as log101 FROM s3;
 value1 |        log101        
--------+----------------------
    0.1 |   -0.999999993528508
    0.2 |  -0.6989699978645267
    0.3 |  -0.5228787280230257
    1.1 | 0.041392694571304324
    2.2 |  0.34242269023528554
    3.3 |   0.5185139336025012
(6 rows)

-- select log2 (builtin function, explain)
--Testcase 167:
EXPLAIN VERBOSE
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4504.24 rows=3413 width=40)
   Output: (log2(value1)), (log2((value2)::double precision)), (log2((value3 + '1'::double precision))), (log2((value4)::double precision)), (log2('0.5'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.log2(value1), public.log2(value2), public.log2((value3 + 1::double precision)), public.log2(value4), public.log2(0.5::double precision) FROM public.s3mysql
(4 rows)

-- select log2 (builtin function, result)
--Testcase 168:
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3;
        log2         |       log2        |         log2         | log2 | log2 
---------------------+-------------------+----------------------+------+------
  -3.321928073389531 | 6.643856189774724 | -0.15200309583369792 |      |   -1
  -2.321928073389531 | 6.643856189774724 |  -0.3219281002618202 |      |   -1
  -1.736965536838657 | 6.643856189774724 |  -0.5145731973987085 |      |   -1
 0.13750355501950745 | 7.643856189774724 |                      |      |   -1
  1.1375035550195074 | 7.643856189774724 |                      |      |   -1
   1.722466003624709 | 7.643856189774724 |                      |      |   -1
(6 rows)

-- select log2 (builtin function, not pushdown constraints, explain)
--Testcase 169:
EXPLAIN VERBOSE
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..250.57 rows=17 width=40)
   Output: (log2(value1)), (log2((value2)::double precision)), (log2((value3 + '1'::double precision))), (log2((value4)::double precision)), (log2('0.5'::double precision))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.log2(value1), public.log2(value2), public.log2((value3 + 1::double precision)), public.log2(value4), public.log2(0.5::double precision), value2 FROM public.s3mysql
(5 rows)

-- select log2 (builtin function, not pushdown constraints, result)
--Testcase 170:
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3 WHERE to_hex(value2) = '64';
        log2        |       log2        |         log2         | log2 | log2 
--------------------+-------------------+----------------------+------+------
 -3.321928073389531 | 6.643856189774724 | -0.15200309583369792 |      |   -1
 -2.321928073389531 | 6.643856189774724 |  -0.3219281002618202 |      |   -1
 -1.736965536838657 | 6.643856189774724 |  -0.5145731973987085 |      |   -1
(3 rows)

-- select log2 (builtin function, pushdown constraints, explain)
--Testcase 171:
EXPLAIN VERBOSE
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3 WHERE value2 != 200;
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4491.05 rows=3396 width=40)
   Output: (log2(value1)), (log2((value2)::double precision)), (log2((value3 + '1'::double precision))), (log2((value4)::double precision)), (log2('0.5'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.log2(value1), public.log2(value2), public.log2((value3 + 1::double precision)), public.log2(value4), public.log2(0.5::double precision) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select log2 (builtin function, pushdown constraints, result)
--Testcase 172:
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3 WHERE value2 != 200;
        log2        |       log2        |         log2         | log2 | log2 
--------------------+-------------------+----------------------+------+------
 -3.321928073389531 | 6.643856189774724 | -0.15200309583369792 |      |   -1
 -2.321928073389531 | 6.643856189774724 |  -0.3219281002618202 |      |   -1
 -1.736965536838657 | 6.643856189774724 |  -0.5145731973987085 |      |   -1
(3 rows)

-- select log2 (builtin function, log2 in constraints, explain)
--Testcase 173:
EXPLAIN VERBOSE
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3 WHERE log2(value1) != 1;
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..5344.30 rows=3396 width=40)
   Output: (log2(value1)), (log2((value2)::double precision)), (log2((value3 + '1'::double precision))), (log2((value4)::double precision)), (log2('0.5'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.log2(value1), public.log2(value2), public.log2((value3 + 1::double precision)), public.log2(value4), public.log2(0.5::double precision) FROM public.s3mysql WHERE ((public.log2(value1) <> 1::double precision))
(4 rows)

-- select log2 (builtin function, log2 in constraints, result)
--Testcase 174:
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3 WHERE log2(value1) != 1;
        log2         |       log2        |         log2         | log2 | log2 
---------------------+-------------------+----------------------+------+------
  -3.321928073389531 | 6.643856189774724 | -0.15200309583369792 |      |   -1
  -2.321928073389531 | 6.643856189774724 |  -0.3219281002618202 |      |   -1
  -1.736965536838657 | 6.643856189774724 |  -0.5145731973987085 |      |   -1
 0.13750355501950745 | 7.643856189774724 |                      |      |   -1
  1.1375035550195074 | 7.643856189774724 |                      |      |   -1
   1.722466003624709 | 7.643856189774724 |                      |      |   -1
(6 rows)

-- select log2 (builtin function, log2 in constraints, explain)
--Testcase 175:
EXPLAIN VERBOSE
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3 WHERE log2(0.5) < value1;
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2459.71 rows=1138 width=40)
   Output: (log2(value1)), (log2((value2)::double precision)), (log2((value3 + '1'::double precision))), (log2((value4)::double precision)), (log2('0.5'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.log2(value1), public.log2(value2), public.log2((value3 + 1::double precision)), public.log2(value4), public.log2(0.5::double precision) FROM public.s3mysql WHERE ((public.log2(0.5::double precision) < value1))
(4 rows)

-- select log2 (builtin function, log2 in constraints, result)
--Testcase 176:
SELECT log2(value1), log2(value2), log2(value3 + 1), log2(value4), log2(0.5) FROM s3 WHERE log2(0.5) < value1;
        log2         |       log2        |         log2         | log2 | log2 
---------------------+-------------------+----------------------+------+------
  -3.321928073389531 | 6.643856189774724 | -0.15200309583369792 |      |   -1
  -2.321928073389531 | 6.643856189774724 |  -0.3219281002618202 |      |   -1
  -1.736965536838657 | 6.643856189774724 |  -0.5145731973987085 |      |   -1
 0.13750355501950745 | 7.643856189774724 |                      |      |   -1
  1.1375035550195074 | 7.643856189774724 |                      |      |   -1
   1.722466003624709 | 7.643856189774724 |                      |      |   -1
(6 rows)

-- select log2 as nest function with agg (pushdown, explain)
--Testcase 177:
EXPLAIN VERBOSE
SELECT sum(value3),log2(sum(value3)) FROM s3;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (log2(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), public.log2(sum(value3)) FROM public.s3mysql
(6 rows)

-- select log2 as nest function with agg (pushdown, result)
--Testcase 178:
SELECT sum(value3),log2(sum(value3)) FROM s3;
        sum         | log2 
--------------------+------
 -7.200000040233135 |     
(1 row)

-- select log2 as nest with log2 (pushdown, explain)
--Testcase 179:
EXPLAIN VERBOSE
SELECT value1, log2(log2(value1)),log2(log2(1/value1)) FROM s3;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3633.92 rows=3413 width=24)
   Output: value1, (log2(log2(value1))), (log2(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.log2(public.log2(value1)), public.log2(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select log2 as nest with log2 (pushdown, result)
--Testcase 180:
SELECT value1, log2(log2(value1)),log2(log2(1/value1)) FROM s3;
 value1 |        log2        |        log2        
--------+--------------------+--------------------
    0.1 |                    | 1.7320208363082297
    0.2 |                    |  1.215323282379434
    0.3 |                    | 0.7965691297966043
    1.1 | -2.862459176303062 |                   
    2.2 | 0.1858710541473771 |                   
    3.3 | 0.7844755086851238 |                   
(6 rows)

-- select log2 with non pushdown func and explicit constant (explain)
--Testcase 181:
EXPLAIN VERBOSE
SELECT value1, log2(value3 + 1), pi(), 4.1 FROM s3;
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=56)
   Output: value1, (log2((value3 + '1'::double precision))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.log2((value3 + 1::double precision)), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select log2 with non pushdown func and explicit constant (result)
--Testcase 182:
SELECT value1, log2(value3 + 1), pi(), 4.1 FROM s3;
 value1 |         log2         |        pi         | ?column? 
--------+----------------------+-------------------+----------
    0.1 | -0.15200309583369792 | 3.141592653589793 |      4.1
    0.2 |  -0.3219281002618202 | 3.141592653589793 |      4.1
    0.3 |  -0.5145731973987085 | 3.141592653589793 |      4.1
    1.1 |                      | 3.141592653589793 |      4.1
    2.2 |                      | 3.141592653589793 |      4.1
    3.3 |                      | 3.141592653589793 |      4.1
(6 rows)

-- select log2 with order by (explain)
--Testcase 183:
EXPLAIN VERBOSE
SELECT value3, log2(1-value3) FROM s3 ORDER BY log2(1-value3);
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=16)
   Output: value3, (log2(('1'::double precision - value3)))
   Sort Key: (log2(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=16)
         Output: value3, (log2(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value3, public.log2((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select log2 with order by (result)
--Testcase 184:
SELECT value3, log2(1-value3) FROM s3 ORDER BY log2(1-value3);
 value3 |        log2         
--------+---------------------
   -0.1 | 0.13750352570428323
   -0.2 | 0.26303440941676576
   -0.3 | 0.37851163648316444
   -1.1 |   1.070389344270698
   -2.2 |   1.678071926610469
   -3.3 |  2.1043366438163496
(6 rows)

-- select log2 with order by index (result)
--Testcase 185:
SELECT value3, log2(1-value3) FROM s3 ORDER BY 2,1;
 value3 |        log2         
--------+---------------------
   -0.1 | 0.13750352570428323
   -0.2 | 0.26303440941676576
   -0.3 | 0.37851163648316444
   -1.1 |   1.070389344270698
   -2.2 |   1.678071926610469
   -3.3 |  2.1043366438163496
(6 rows)

-- select log2 with order by index (result)
--Testcase 186:
SELECT value3, log2(1-value3) FROM s3 ORDER BY 1,2;
 value3 |        log2         
--------+---------------------
   -3.3 |  2.1043366438163496
   -2.2 |   1.678071926610469
   -1.1 |   1.070389344270698
   -0.3 | 0.37851163648316444
   -0.2 | 0.26303440941676576
   -0.1 | 0.13750352570428323
(6 rows)

-- select log2 with group by (explain)
--Testcase 187:
EXPLAIN VERBOSE
SELECT count(value1), log2(1-value3) FROM s3 GROUP BY log2(1-value3);
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (log2(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.log2((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select log2 with group by (result)
--Testcase 188:
SELECT count(value1), log2(1-value3) FROM s3 GROUP BY log2(1-value3);
 count |        log2         
-------+---------------------
     1 | 0.13750352570428323
     1 | 0.26303440941676576
     1 | 0.37851163648316444
     1 |   1.070389344270698
     1 |   1.678071926610469
     1 |  2.1043366438163496
(6 rows)

-- select log2 with group by index (result)
--Testcase 189:
SELECT value1, log2(1-value3) FROM s3 GROUP BY 2,1;
 value1 |        log2         
--------+---------------------
    0.1 | 0.13750352570428323
    0.2 | 0.26303440941676576
    0.3 | 0.37851163648316444
    1.1 |   1.070389344270698
    2.2 |   1.678071926610469
    3.3 |  2.1043366438163496
(6 rows)

-- select log2 with group by index (result)
--Testcase 190:
SELECT value1, log2(1-value3) FROM s3 GROUP BY 1,2;
 value1 |        log2         
--------+---------------------
    0.1 | 0.13750352570428323
    0.2 | 0.26303440941676576
    0.3 | 0.37851163648316444
    1.1 |   1.070389344270698
    2.2 |   1.678071926610469
    3.3 |  2.1043366438163496
(6 rows)

-- select log2 with group by having (explain)
--Testcase 191:
EXPLAIN VERBOSE
SELECT count(value1), log2(1-value3) FROM s3 GROUP BY log2(1-value3) HAVING avg(value1) > 0;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (log2(('1'::double precision - value3)))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.log2((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select log2 with group by having (result)
--Testcase 192:
SELECT count(value1), log2(1-value3) FROM s3 GROUP BY log2(1-value3) HAVING avg(value1) > 0;
 count |        log2         
-------+---------------------
     1 | 0.13750352570428323
     1 | 0.26303440941676576
     1 | 0.37851163648316444
     1 |   1.070389344270698
     1 |   1.678071926610469
     1 |  2.1043366438163496
(6 rows)

-- select log2 with group by index having (result)
--Testcase 193:
SELECT value1, log2(1-value1) FROM s3 GROUP BY 1,2 HAVING value1 < 1;
 value1 |         log2         
--------+----------------------
    0.1 | -0.15200309583369792
    0.2 |  -0.3219281002618202
    0.3 |  -0.5145731973987085
(3 rows)

-- select log2 and as (return NULL with negative number)
--Testcase 194:
SELECT value1, value3 + 1, log2(value3 + 1) as log21 FROM s3;
 value1 |       ?column?       |        log21         
--------+----------------------+----------------------
    0.1 |   0.8999999985098839 | -0.15200309583369792
    0.2 |   0.7999999970197678 |  -0.3219281002618202
    0.3 |    0.699999988079071 |  -0.5145731973987085
    1.1 | -0.10000002384185791 |                     
    2.2 |  -1.2000000476837158 |                     
    3.3 |   -2.299999952316284 |                     
(6 rows)

-- select pi (builtin function, explain)
--Testcase 195:
EXPLAIN VERBOSE
SELECT pi() FROM s3 WHERE value2 != 200 LIMIT 1;
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Limit  (cost=100.00..100.04 rows=1 width=8)
   Output: '3.141592653589793'::double precision
   ->  Foreign Scan on public.s3  (cost=100.00..220.58 rows=3396 width=8)
         Output: '3.141592653589793'::double precision
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value2 FROM public.s3mysql WHERE ((value2 <> 200))
(6 rows)

-- select pi (builtin function, result)
--Testcase 196:
SELECT pi() FROM s3 WHERE value2 != 200 LIMIT 1;
        pi         
-------------------
 3.141592653589793
(1 row)

-- where pi (builtin function)
--Testcase 197:
EXPLAIN VERBOSE
SELECT id FROM s3 WHERE pi() > id LIMIT 1;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Limit  (cost=100.00..100.07 rows=1 width=4)
   Output: id
   ->  Foreign Scan on public.s3  (cost=100.00..183.95 rows=1138 width=4)
         Output: id
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id FROM public.s3mysql WHERE ((3.141592653589793::double precision > id))
(6 rows)

--Testcase 198:
SELECT id FROM s3 WHERE pi() > id LIMIT 1;
 id 
----
  0
(1 row)

-- select pi (stub function, explain)
--Testcase 199:
EXPLAIN VERBOSE
SELECT mysql_pi() FROM s3 WHERE value2 != 200 LIMIT 1;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Limit  (cost=100.00..100.29 rows=1 width=8)
   Output: (mysql_pi())
   ->  Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=8)
         Output: (mysql_pi())
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_pi() FROM public.s3mysql WHERE ((value2 <> 200))
(6 rows)

-- select pi (stub function, result)
--Testcase 200:
SELECT mysql_pi() FROM s3 WHERE value2 != 200 LIMIT 1;
 mysql_pi 
----------
 3.141593
(1 row)

-- where pi (stub function)
--Testcase 201:
EXPLAIN VERBOSE
SELECT value1 FROM s3 WHERE mysql_pi() > value1 LIMIT 1;
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Limit  (cost=100.00..100.82 rows=1 width=8)
   Output: value1
   ->  Foreign Scan on public.s3  (cost=100.00..1028.67 rows=1138 width=8)
         Output: value1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1 FROM public.s3mysql WHERE ((public.mysql_pi() > value1))
(6 rows)

--Testcase 202:
SELECT value1 FROM s3 WHERE mysql_pi() > value1 LIMIT 1;
 value1 
--------
    0.1
(1 row)

-- where pi (stub function) order by
--Testcase 203:
EXPLAIN VERBOSE
SELECT value1 FROM s3 WHERE mysql_pi() > value1 ORDER BY 1;
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=1086.44..1089.28 rows=1138 width=8)
   Output: value1
   Sort Key: s3.value1
   ->  Foreign Scan on public.s3  (cost=100.00..1028.67 rows=1138 width=8)
         Output: value1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1 FROM public.s3mysql WHERE ((public.mysql_pi() > value1))
(7 rows)

--Testcase 204:
SELECT value1 FROM s3 WHERE mysql_pi() > value1 ORDER BY 1;
 value1 
--------
    0.1
    0.2
    0.3
    1.1
    2.2
(5 rows)

-- slect stub function, order by pi (stub function)
--Testcase 205:
EXPLAIN VERBOSE
SELECT mysql_pi(), log2(value1) FROM s3 ORDER BY 1,2;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=16)
   Output: (mysql_pi()), (log2(value1))
   Sort Key: (mysql_pi()), (log2(s3.value1))
   ->  Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=16)
         Output: (mysql_pi()), (log2(value1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_pi(), public.log2(value1) FROM public.s3mysql
(7 rows)

--Testcase 206:
SELECT mysql_pi(), log2(value1) FROM s3 ORDER BY 1,2;
 mysql_pi |        log2         
----------+---------------------
 3.141593 |  -3.321928073389531
 3.141593 |  -2.321928073389531
 3.141593 |  -1.736965536838657
 3.141593 | 0.13750355501950745
 3.141593 |  1.1375035550195074
 3.141593 |   1.722466003624709
(6 rows)

-- select pow (builtin function, explain)
--Testcase 207:
EXPLAIN VERBOSE
SELECT pow(value1, 2), pow(value2, 2), pow(value3, 2), pow(value4, 2) FROM s3;
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=32)
   Output: (pow(value1, '2'::double precision)), (pow((value2)::double precision, '2'::double precision)), (pow(value3, '2'::double precision)), (pow((value4)::double precision, '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT pow(value1, 2::double precision), pow(value2, 2::double precision), pow(value3, 2::double precision), pow(value4, 2::double precision) FROM public.s3mysql
(4 rows)

-- select pow (builtin function, result)
--Testcase 208:
SELECT pow(value1, 2), pow(value2, 2), pow(value3, 2), pow(value4, 2) FROM s3;
         pow          |  pow  |         pow          |  pow  
----------------------+-------+----------------------+-------
 0.010000000298023226 | 10000 | 0.010000000298023226 | 10000
 0.040000001192092904 | 10000 | 0.040000001192092904 | 10000
  0.09000000715255752 | 10000 |  0.09000000715255752 | 10000
    1.210000052452088 | 40000 |    1.210000052452088 | 40000
    4.840000209808352 | 40000 |    4.840000209808352 | 40000
   10.889999685287478 | 40000 |   10.889999685287478 | 40000
(6 rows)

-- select pow (builtin function, not pushdown constraints, explain)
--Testcase 209:
EXPLAIN VERBOSE
SELECT pow(value1, 2), pow(value2, 2), pow(value3, 2), pow(value4, 2) FROM s3 WHERE to_hex(value2) != '64';
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.39 rows=3396 width=32)
   Output: (pow(value1, '2'::double precision)), (pow((value2)::double precision, '2'::double precision)), (pow(value3, '2'::double precision)), (pow((value4)::double precision, '2'::double precision))
   Filter: (to_hex(s3.value2) <> '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT pow(value1, 2::double precision), pow(value2, 2::double precision), pow(value3, 2::double precision), pow(value4, 2::double precision), value2 FROM public.s3mysql
(5 rows)

-- select pow (builtin function, not pushdown constraints, result)
--Testcase 210:
SELECT pow(value1, 2), pow(value2, 2), pow(value3, 2), pow(value4, 2) FROM s3 WHERE to_hex(value2) != '64';
        pow         |  pow  |        pow         |  pow  
--------------------+-------+--------------------+-------
  1.210000052452088 | 40000 |  1.210000052452088 | 40000
  4.840000209808352 | 40000 |  4.840000209808352 | 40000
 10.889999685287478 | 40000 | 10.889999685287478 | 40000
(3 rows)

-- select pow (builtin function, pushdown constraints, explain)
--Testcase 211:
EXPLAIN VERBOSE
SELECT pow(value1, 2), pow(value2, 2), pow(value3, 2), pow(value4, 2) FROM s3 WHERE value2 != 200;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=32)
   Output: (pow(value1, '2'::double precision)), (pow((value2)::double precision, '2'::double precision)), (pow(value3, '2'::double precision)), (pow((value4)::double precision, '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT pow(value1, 2::double precision), pow(value2, 2::double precision), pow(value3, 2::double precision), pow(value4, 2::double precision) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select pow (builtin function, pushdown constraints, result)
--Testcase 212:
SELECT pow(value1, 2), pow(value2, 2), pow(value3, 2), pow(value4, 2) FROM s3 WHERE value2 != 200;
         pow          |  pow  |         pow          |  pow  
----------------------+-------+----------------------+-------
 0.010000000298023226 | 10000 | 0.010000000298023226 | 10000
 0.040000001192092904 | 10000 | 0.040000001192092904 | 10000
  0.09000000715255752 | 10000 |  0.09000000715255752 | 10000
(3 rows)

-- select pow as nest function with agg (pushdown, explain)
--Testcase 213:
EXPLAIN VERBOSE
SELECT sum(value3),pow(sum(value3), 2) FROM s3;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (pow(sum(value3), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), pow(sum(value3), 2::double precision) FROM public.s3mysql
(6 rows)

-- select pow as nest function with agg (pushdown, result)
--Testcase 214:
SELECT sum(value3),pow(sum(value3), 2) FROM s3;
        sum         |        pow        
--------------------+-------------------
 -7.200000040233135 | 51.84000057935715
(1 row)

-- select pow as nest with log2 (pushdown, explain)
--Testcase 215:
EXPLAIN VERBOSE
SELECT value1, pow(log2(value1), 2),pow(log2(1/value1), 2) FROM s3;
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (pow(log2(value1), '2'::double precision)), (pow(log2(('1'::double precision / value1)), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, pow(public.log2(value1), 2::double precision), pow(public.log2((1::double precision / value1)), 2::double precision) FROM public.s3mysql
(4 rows)

-- select pow as nest with log2 (pushdown, result)
--Testcase 216:
SELECT value1, pow(log2(value1), 2),pow(log2(1/value1), 2) FROM s3;
 value1 |         pow          |        pow         
--------+----------------------+--------------------
    0.1 |   11.035206124773483 | 11.035206124773483
    0.2 |     5.39134997799442 |   5.39134997799442
    0.3 |   3.0170492761652037 | 3.0170492761652046
    1.1 | 0.018907227643002712 | 0.0189072276430027
    2.2 |   1.2939143376820175 | 1.2939143376820175
    3.3 |    2.966889133642876 | 2.9668891336428755
(6 rows)

-- select pow with non pushdown func and explicit constant (explain)
--Testcase 217:
EXPLAIN VERBOSE
SELECT pow(value3, 2), pi(), 4.1 FROM s3;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (pow(value3, '2'::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT pow(value3, 2::double precision), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select pow with non pushdown func and explicit constant (result)
--Testcase 218:
SELECT pow(value3, 2), pi(), 4.1 FROM s3;
         pow          |        pi         | ?column? 
----------------------+-------------------+----------
 0.010000000298023226 | 3.141592653589793 |      4.1
 0.040000001192092904 | 3.141592653589793 |      4.1
  0.09000000715255752 | 3.141592653589793 |      4.1
    1.210000052452088 | 3.141592653589793 |      4.1
    4.840000209808352 | 3.141592653589793 |      4.1
   10.889999685287478 | 3.141592653589793 |      4.1
(6 rows)

-- select pow with order by (explain)
--Testcase 219:
EXPLAIN VERBOSE
SELECT value3, pow(1-value3, 2) FROM s3 ORDER BY pow(1-value3, 2);
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value3, (pow(('1'::double precision - value3), '2'::double precision))
   Sort Key: (pow(('1'::double precision - s3.value3), '2'::double precision))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value3, (pow(('1'::double precision - value3), '2'::double precision))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value3, pow((1::double precision - value3), 2::double precision) FROM public.s3mysql
(7 rows)

-- select pow with order by (result)
--Testcase 220:
SELECT value3, pow(1-value3, 2) FROM s3 ORDER BY pow(1-value3, 2);
 value3 |        pow         
--------+--------------------
   -0.1 | 1.2100000032782554
   -0.2 | 1.4400000071525574
   -0.3 | 1.6900000309944154
   -1.1 |  4.410000100135804
   -2.2 | 10.240000305175784
   -3.3 | 18.489999589920046
(6 rows)

-- select pow with order by index (result)
--Testcase 221:
SELECT value3, pow(1-value3, 2) FROM s3 ORDER BY 2,1;
 value3 |        pow         
--------+--------------------
   -0.1 | 1.2100000032782554
   -0.2 | 1.4400000071525574
   -0.3 | 1.6900000309944154
   -1.1 |  4.410000100135804
   -2.2 | 10.240000305175784
   -3.3 | 18.489999589920046
(6 rows)

-- select pow with order by index (result)
--Testcase 222:
SELECT value3, pow(1-value3, 2) FROM s3 ORDER BY 1,2;
 value3 |        pow         
--------+--------------------
   -3.3 | 18.489999589920046
   -2.2 | 10.240000305175784
   -1.1 |  4.410000100135804
   -0.3 | 1.6900000309944154
   -0.2 | 1.4400000071525574
   -0.1 | 1.2100000032782554
(6 rows)

-- select pow and as
--Testcase 223:
SELECT pow(value3, 2) as pow1 FROM s3;
         pow1         
----------------------
 0.010000000298023226
 0.040000001192092904
  0.09000000715255752
    1.210000052452088
    4.840000209808352
   10.889999685287478
(6 rows)

-- We only test rand with constant and column because it will be stable
-- select rand (stub function, rand with column, explain)
--Testcase 224:
EXPLAIN VERBOSE
SELECT id, rand(id), rand(3) FROM s3 WHERE value2 != 200;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1927.07 rows=3396 width=20)
   Output: id, (rand((id)::double precision)), (rand('3'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.rand(id), public.rand(3::double precision) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select rand (stub function, rand with column, result)
--Testcase 225:
SELECT id, rand(id), rand(3) FROM s3 WHERE value2 != 200;
 id |        rand         |        rand         
----+---------------------+---------------------
  0 | 0.15522042769493574 |  0.9057697559760601
  1 | 0.40540353712197724 | 0.37307905813034536
  2 |  0.6555866465490187 | 0.14808605345719125
(3 rows)

-- rand() in WHERE clause only EXPLAIN, execute will return different result
--Testcase 226:
EXPLAIN VERBOSE
SELECT id, rand(id), rand(3), rand() FROM s3 WHERE rand() > 0.5;
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1885.02 rows=1138 width=28)
   Output: id, (rand((id)::double precision)), (rand('3'::double precision)), (rand())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.rand(id), public.rand(3::double precision), public.rand() FROM public.s3mysql WHERE ((public.rand() > 0.5::double precision))
(4 rows)

-- select rand (stub function, explain)
--Testcase 227:
EXPLAIN VERBOSE
SELECT value1, rand(value1), rand(value2), rand(value3), rand(value4) FROM s3;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3642.45 rows=3413 width=40)
   Output: value1, (rand(value1)), (rand((value2)::double precision)), (rand(value3)), (rand((value4)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.rand(value1), public.rand(value2), public.rand(value3), public.rand(value4) FROM public.s3mysql
(4 rows)

-- select rand (stub function, result)
--Testcase 228:
SELECT value1, rand(value1), rand(value2), rand(value3), rand(value4) FROM s3;
 value1 |        rand         |        rand         |        rand         |        rand         
--------+---------------------+---------------------+---------------------+---------------------
    0.1 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
    0.2 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
    0.3 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
    1.1 | 0.40540353712197724 | 0.19184226839974733 |  0.9050373219931845 | 0.11859859071541447
    2.2 |  0.6555866465490187 | 0.19184226839974733 |  0.6548542125661431 | 0.11859859071541447
    3.3 |  0.9057697559760601 | 0.19184226839974733 | 0.40467110313910165 | 0.11859859071541447
(6 rows)

-- select rand (stub function, not pushdown constraints, explain)
--Testcase 229:
EXPLAIN VERBOSE
SELECT rand(value1), rand(value2), rand(value3), rand(value4), rand(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..250.53 rows=17 width=40)
   Output: (rand(value1)), (rand((value2)::double precision)), (rand(value3)), (rand((value4)::double precision)), (rand('0.5'::double precision))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.rand(value1), public.rand(value2), public.rand(value3), public.rand(value4), public.rand(0.5::double precision), value2 FROM public.s3mysql
(5 rows)

-- select rand (stub function, not pushdown constraints, result)
--Testcase 230:
SELECT rand(value1), rand(value2), rand(value3), rand(value4), rand(0.5) FROM s3 WHERE to_hex(value2) = '64';
        rand         |        rand         |        rand         |        rand         |        rand         
---------------------+---------------------+---------------------+---------------------+---------------------
 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026 | 0.40540353712197724
 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026 |  0.8716141803857071
 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026 |  0.1418603212962489
(3 rows)

-- select rand (stub function, pushdown constraints, explain)
--Testcase 231:
EXPLAIN VERBOSE
SELECT rand(value1), rand(value2), rand(value3), rand(value4), rand(0.5) FROM s3 WHERE value2 != 200;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4482.56 rows=3396 width=40)
   Output: (rand(value1)), (rand((value2)::double precision)), (rand(value3)), (rand((value4)::double precision)), (rand('0.5'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.rand(value1), public.rand(value2), public.rand(value3), public.rand(value4), public.rand(0.5::double precision) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select rand (stub function, pushdown constraints, result)
--Testcase 232:
SELECT rand(value1), rand(value2), rand(value3), rand(value4), rand(0.5) FROM s3 WHERE value2 != 200;
        rand         |        rand         |        rand         |        rand         |        rand         
---------------------+---------------------+---------------------+---------------------+---------------------
 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026 | 0.40540353712197724
 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026 |  0.8716141803857071
 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026 |  0.1418603212962489
(3 rows)

-- select rand (stub function, rand in constraints, explain)
--Testcase 233:
EXPLAIN VERBOSE
SELECT value1, rand(value1), rand(value2), rand(value3), rand(value4) FROM s3 WHERE rand(value1) != 1;
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4486.81 rows=3396 width=40)
   Output: value1, (rand(value1)), (rand((value2)::double precision)), (rand(value3)), (rand((value4)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.rand(value1), public.rand(value2), public.rand(value3), public.rand(value4) FROM public.s3mysql WHERE ((public.rand(value1) <> 1::double precision))
(4 rows)

-- select rand (stub function, rand in constraints, result)
--Testcase 234:
SELECT value1, rand(value1), rand(value2), rand(value3), rand(value4) FROM s3 WHERE rand(value1) != 1;
 value1 |        rand         |        rand         |        rand         |        rand         
--------+---------------------+---------------------+---------------------+---------------------
    0.1 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
    0.2 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
    0.3 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
    1.1 | 0.40540353712197724 | 0.19184226839974733 |  0.9050373219931845 | 0.11859859071541447
    2.2 |  0.6555866465490187 | 0.19184226839974733 |  0.6548542125661431 | 0.11859859071541447
    3.3 |  0.9057697559760601 | 0.19184226839974733 | 0.40467110313910165 | 0.11859859071541447
(6 rows)

-- select rand (stub function, rand in constraints, explain)
--Testcase 235:
EXPLAIN VERBOSE
SELECT value1, rand(value1), rand(value2), rand(value3), rand(value4) FROM s3 WHERE rand(0.5) > value1 - 1;
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2180.89 rows=1138 width=40)
   Output: value1, (rand(value1)), (rand((value2)::double precision)), (rand(value3)), (rand((value4)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.rand(value1), public.rand(value2), public.rand(value3), public.rand(value4) FROM public.s3mysql WHERE ((public.rand(0.5::double precision) > (value1 - 1::double precision)))
(4 rows)

-- select rand (stub function, rand in constraints, result)
--Testcase 236:
SELECT value1, rand(value1), rand(value2), rand(value3), rand(value4) FROM s3 WHERE rand(0.5) > value1 - 1;
 value1 |        rand         |        rand         |        rand         |        rand         
--------+---------------------+---------------------+---------------------+---------------------
    0.1 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
    0.2 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
    0.3 | 0.15522042769493574 | 0.17353134804734155 | 0.15522042769493574 | 0.13690951106782026
(3 rows)

-- select rand as nest function with agg (pushdown, explain)
--Testcase 237:
EXPLAIN VERBOSE
SELECT sum(value3),rand(sum(value3)) FROM s3;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (rand(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), public.rand(sum(value3)) FROM public.s3mysql
(6 rows)

-- select rand as nest function with agg (pushdown, result)
--Testcase 238:
SELECT sum(value3),rand(sum(value3)) FROM s3;
        sum         |        rand        
--------------------+--------------------
 -7.200000040233135 | 0.4039386654309357
(1 row)

-- select rand as nest with log2 (pushdown, explain)
--Testcase 239:
EXPLAIN VERBOSE
SELECT value1, rand(log2(value1)),rand(log2(1/value1)) FROM s3;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3633.92 rows=3413 width=24)
   Output: value1, (rand(log2(value1))), (rand(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.rand(public.log2(value1)), public.rand(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select rand as nest with log2 (pushdown, result)
--Testcase 240:
SELECT value1, rand(log2(value1)),rand(log2(1/value1)) FROM s3;
 value1 |        rand         |        rand         
--------+---------------------+---------------------
    0.1 | 0.40467110313910165 |  0.9057697559760601
    0.2 |  0.6548542125661431 |  0.6555866465490187
    0.3 |  0.6548542125661431 |  0.6555866465490187
    1.1 | 0.15522042769493574 | 0.15522042769493574
    2.2 | 0.40540353712197724 |  0.9050373219931845
    3.3 |  0.6555866465490187 |  0.6548542125661431
(6 rows)

-- select rand with non pushdown func and explicit constant (explain)
--Testcase 241:
EXPLAIN VERBOSE
SELECT value1, rand(value3), pi(), 4.1 FROM s3;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=56)
   Output: value1, (rand(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.rand(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select rand with non pushdown func and explicit constant (result)
--Testcase 242:
SELECT value1, rand(value3), pi(), 4.1 FROM s3;
 value1 |        rand         |        pi         | ?column? 
--------+---------------------+-------------------+----------
    0.1 | 0.15522042769493574 | 3.141592653589793 |      4.1
    0.2 | 0.15522042769493574 | 3.141592653589793 |      4.1
    0.3 | 0.15522042769493574 | 3.141592653589793 |      4.1
    1.1 |  0.9050373219931845 | 3.141592653589793 |      4.1
    2.2 |  0.6548542125661431 | 3.141592653589793 |      4.1
    3.3 | 0.40467110313910165 | 3.141592653589793 |      4.1
(6 rows)

-- select rand with order by (explain)
--Testcase 243:
EXPLAIN VERBOSE
SELECT value3, rand(1-value3) FROM s3 ORDER BY rand(1-value3);
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=16)
   Output: value3, (rand(('1'::double precision - value3)))
   Sort Key: (rand(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=16)
         Output: value3, (rand(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value3, public.rand((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select rand with order by (result)
--Testcase 244:
SELECT value3, rand(1-value3) FROM s3 ORDER BY rand(1-value3);
 value3 |        rand         
--------+---------------------
   -3.3 | 0.15595286540310166
   -0.1 | 0.40540353712197724
   -0.2 | 0.40540353712197724
   -0.3 | 0.40540353712197724
   -1.1 |  0.6555866465490187
   -2.2 |  0.9057697559760601
(6 rows)

-- select rand with order by index (result)
--Testcase 245:
SELECT value3, rand(1-value3) FROM s3 ORDER BY 2,1;
 value3 |        rand         
--------+---------------------
   -3.3 | 0.15595286540310166
   -0.3 | 0.40540353712197724
   -0.2 | 0.40540353712197724
   -0.1 | 0.40540353712197724
   -1.1 |  0.6555866465490187
   -2.2 |  0.9057697559760601
(6 rows)

-- select rand with order by index (result)
--Testcase 246:
SELECT value3, rand(1-value3) FROM s3 ORDER BY 1,2;
 value3 |        rand         
--------+---------------------
   -3.3 | 0.15595286540310166
   -2.2 |  0.9057697559760601
   -1.1 |  0.6555866465490187
   -0.3 | 0.40540353712197724
   -0.2 | 0.40540353712197724
   -0.1 | 0.40540353712197724
(6 rows)

-- select rand with group by (explain)
--Testcase 247:
EXPLAIN VERBOSE
SELECT value1, rand(1-value3) FROM s3 GROUP BY value1, rand(1-value3);
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (rand(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, public.rand((1::double precision - value3)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select rand with group by (result)
--Testcase 248:
SELECT value1, rand(1-value3) FROM s3 GROUP BY value1, rand(1-value3);
 value1 |        rand         
--------+---------------------
    0.1 | 0.40540353712197724
    0.2 | 0.40540353712197724
    0.3 | 0.40540353712197724
    1.1 |  0.6555866465490187
    2.2 |  0.9057697559760601
    3.3 | 0.15595286540310166
(6 rows)

-- select rand with group by index (result)
--Testcase 249:
SELECT value1, rand(1-value3) FROM s3 GROUP BY 2,1;
 value1 |        rand         
--------+---------------------
    0.1 | 0.40540353712197724
    0.2 | 0.40540353712197724
    0.3 | 0.40540353712197724
    1.1 |  0.6555866465490187
    2.2 |  0.9057697559760601
    3.3 | 0.15595286540310166
(6 rows)

-- select rand with group by index (result)
--Testcase 250:
SELECT value1, rand(1-value3) FROM s3 GROUP BY 1,2;
 value1 |        rand         
--------+---------------------
    0.1 | 0.40540353712197724
    0.2 | 0.40540353712197724
    0.3 | 0.40540353712197724
    1.1 |  0.6555866465490187
    2.2 |  0.9057697559760601
    3.3 | 0.15595286540310166
(6 rows)

-- select rand with group by having (explain)
--Testcase 251:
EXPLAIN VERBOSE
SELECT value1, rand(1-value3) FROM s3 GROUP BY value1, rand(1-value3) HAVING avg(value1) > 0;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (rand(('1'::double precision - value3)))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, public.rand((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select rand with group by having (result)
--Testcase 252:
SELECT value1, rand(1-value3) FROM s3 GROUP BY value1, rand(1-value3) HAVING avg(value1) > 0;
 value1 |        rand         
--------+---------------------
    0.1 | 0.40540353712197724
    0.2 | 0.40540353712197724
    0.3 | 0.40540353712197724
    1.1 |  0.6555866465490187
    2.2 |  0.9057697559760601
    3.3 | 0.15595286540310166
(6 rows)

-- select rand with group by index having (result)
--Testcase 253:
SELECT value1, rand(1-value1) FROM s3 GROUP BY 1,2 HAVING value1 < 1;
 value1 |        rand         
--------+---------------------
    0.1 | 0.40540353712197724
    0.2 | 0.40540353712197724
    0.3 | 0.40540353712197724
(3 rows)

-- select rand and as
--Testcase 254:
SELECT value1, rand(value3) as rand1 FROM s3;
 value1 |        rand1        
--------+---------------------
    0.1 | 0.15522042769493574
    0.2 | 0.15522042769493574
    0.3 | 0.15522042769493574
    1.1 |  0.9050373219931845
    2.2 |  0.6548542125661431
    3.3 | 0.40467110313910165
(6 rows)

-- select truncate (stub function, explain)
--Testcase 255:
EXPLAIN VERBOSE
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3;
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4495.70 rows=3413 width=40)
   Output: (truncate(value1, 2)), (truncate((value2)::double precision, 2)), (truncate(value3, 2)), (truncate((value4)::double precision, 2)), (truncate('5'::double precision, 2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.truncate(value1, 2), public.truncate(value2, 2), public.truncate(value3, 2), public.truncate(value4, 2), public.truncate(5::double precision, 2) FROM public.s3mysql
(4 rows)

-- select truncate (stub function, result)
--Testcase 256:
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3;
 truncate | truncate | truncate | truncate | truncate 
----------+----------+----------+----------+----------
      0.1 |      100 |     -0.1 |     -100 |        5
      0.2 |      100 |     -0.2 |     -100 |        5
      0.3 |      100 |     -0.3 |     -100 |        5
      1.1 |      200 |     -1.1 |     -200 |        5
      2.2 |      200 |     -2.2 |     -200 |        5
     3.29 |      200 |    -3.29 |     -200 |        5
(6 rows)

-- select truncate (stub function, not pushdown constraints, explain)
--Testcase 257:
EXPLAIN VERBOSE
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3 WHERE to_hex(value2) = '64';
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..250.53 rows=17 width=40)
   Output: (truncate(value1, 2)), (truncate((value2)::double precision, 2)), (truncate(value3, 2)), (truncate((value4)::double precision, 2)), (truncate('5'::double precision, 2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.truncate(value1, 2), public.truncate(value2, 2), public.truncate(value3, 2), public.truncate(value4, 2), public.truncate(5::double precision, 2), value2 FROM public.s3mysql
(5 rows)

-- select truncate (stub function, not pushdown constraints, result)
--Testcase 258:
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3 WHERE to_hex(value2) = '64';
 truncate | truncate | truncate | truncate | truncate 
----------+----------+----------+----------+----------
      0.1 |      100 |     -0.1 |     -100 |        5
      0.2 |      100 |     -0.2 |     -100 |        5
      0.3 |      100 |     -0.3 |     -100 |        5
(3 rows)

-- select truncate (stub function, pushdown constraints, explain)
--Testcase 259:
EXPLAIN VERBOSE
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3 WHERE value2 != 200;
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4482.56 rows=3396 width=40)
   Output: (truncate(value1, 2)), (truncate((value2)::double precision, 2)), (truncate(value3, 2)), (truncate((value4)::double precision, 2)), (truncate('5'::double precision, 2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.truncate(value1, 2), public.truncate(value2, 2), public.truncate(value3, 2), public.truncate(value4, 2), public.truncate(5::double precision, 2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select truncate (stub function, pushdown constraints, result)
--Testcase 260:
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3 WHERE value2 != 200;
 truncate | truncate | truncate | truncate | truncate 
----------+----------+----------+----------+----------
      0.1 |      100 |     -0.1 |     -100 |        5
      0.2 |      100 |     -0.2 |     -100 |        5
      0.3 |      100 |     -0.3 |     -100 |        5
(3 rows)

-- select truncate (stub function, truncate in constraints, explain)
--Testcase 261:
EXPLAIN VERBOSE
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3 WHERE truncate(value1, 2) != 1;
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..5335.81 rows=3396 width=40)
   Output: (truncate(value1, 2)), (truncate((value2)::double precision, 2)), (truncate(value3, 2)), (truncate((value4)::double precision, 2)), (truncate('5'::double precision, 2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.truncate(value1, 2), public.truncate(value2, 2), public.truncate(value3, 2), public.truncate(value4, 2), public.truncate(5::double precision, 2) FROM public.s3mysql WHERE ((public.truncate(value1, 2) <> 1::double precision))
(4 rows)

-- select truncate (stub function, truncate in constraints, result)
--Testcase 262:
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3 WHERE truncate(value1, 2) != 1;
 truncate | truncate | truncate | truncate | truncate 
----------+----------+----------+----------+----------
      0.1 |      100 |     -0.1 |     -100 |        5
      0.2 |      100 |     -0.2 |     -100 |        5
      0.3 |      100 |     -0.3 |     -100 |        5
      1.1 |      200 |     -1.1 |     -200 |        5
      2.2 |      200 |     -2.2 |     -200 |        5
     3.29 |      200 |    -3.29 |     -200 |        5
(6 rows)

-- select truncate (stub function, truncate in constraints, explain)
--Testcase 263:
EXPLAIN VERBOSE
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3 WHERE truncate(5, 2) > value1;
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2456.86 rows=1138 width=40)
   Output: (truncate(value1, 2)), (truncate((value2)::double precision, 2)), (truncate(value3, 2)), (truncate((value4)::double precision, 2)), (truncate('5'::double precision, 2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.truncate(value1, 2), public.truncate(value2, 2), public.truncate(value3, 2), public.truncate(value4, 2), public.truncate(5::double precision, 2) FROM public.s3mysql WHERE ((public.truncate(5::double precision, 2) > value1))
(4 rows)

-- select truncate (stub function, truncate in constraints, result)
--Testcase 264:
SELECT truncate(value1, 2), truncate(value2, 2), truncate(value3, 2), truncate(value4, 2), truncate(5, 2) FROM s3 WHERE truncate(5, 2) > value1;
 truncate | truncate | truncate | truncate | truncate 
----------+----------+----------+----------+----------
      0.1 |      100 |     -0.1 |     -100 |        5
      0.2 |      100 |     -0.2 |     -100 |        5
      0.3 |      100 |     -0.3 |     -100 |        5
      1.1 |      200 |     -1.1 |     -200 |        5
      2.2 |      200 |     -2.2 |     -200 |        5
     3.29 |      200 |    -3.29 |     -200 |        5
(6 rows)

-- select truncate as nest function with agg (pushdown, explain)
--Testcase 265:
EXPLAIN VERBOSE
SELECT sum(value3),truncate(sum(value3), 2) FROM s3;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (truncate(sum(value3), 2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), public.truncate(sum(value3), 2) FROM public.s3mysql
(6 rows)

-- select truncate as nest function with agg (pushdown, result)
--Testcase 266:
SELECT sum(value3),truncate(sum(value3), 2) FROM s3;
        sum         | truncate 
--------------------+----------
 -7.200000040233135 |     -7.2
(1 row)

-- select truncate as nest with log2 (pushdown, explain)
--Testcase 267:
EXPLAIN VERBOSE
SELECT truncate(log2(value1), 2),truncate(log2(1/value1), 2) FROM s3;
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3633.92 rows=3413 width=16)
   Output: (truncate(log2(value1), 2)), (truncate(log2(('1'::double precision / value1)), 2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.truncate(public.log2(value1), 2), public.truncate(public.log2((1::double precision / value1)), 2) FROM public.s3mysql
(4 rows)

-- select truncate as nest with log2 (pushdown, result)
--Testcase 268:
SELECT truncate(log2(value1), 2),truncate(log2(1/value1), 2) FROM s3;
 truncate | truncate 
----------+----------
    -3.32 |     3.32
    -2.32 |     2.32
    -1.73 |     1.73
     0.13 |    -0.13
     1.13 |    -1.13
     1.72 |    -1.72
(6 rows)

-- select truncate with non pushdown func and explicit constant (explain)
--Testcase 269:
EXPLAIN VERBOSE
SELECT truncate(value3, 2), pi(), 4.1 FROM s3;
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=48)
   Output: (truncate(value3, 2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.truncate(value3, 2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select truncate with non pushdown func and explicit constant (result)
--Testcase 270:
SELECT truncate(value3, 2), pi(), 4.1 FROM s3;
 truncate |        pi         | ?column? 
----------+-------------------+----------
     -0.1 | 3.141592653589793 |      4.1
     -0.2 | 3.141592653589793 |      4.1
     -0.3 | 3.141592653589793 |      4.1
     -1.1 | 3.141592653589793 |      4.1
     -2.2 | 3.141592653589793 |      4.1
    -3.29 | 3.141592653589793 |      4.1
(6 rows)

-- select truncate with order by (explain)
--Testcase 271:
EXPLAIN VERBOSE
SELECT value3, truncate(1-value3, 2) FROM s3 ORDER BY truncate(1-value3, 2);
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=16)
   Output: value3, (truncate(('1'::double precision - value3), 2))
   Sort Key: (truncate(('1'::double precision - s3.value3), 2))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=16)
         Output: value3, (truncate(('1'::double precision - value3), 2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value3, public.truncate((1::double precision - value3), 2) FROM public.s3mysql
(7 rows)

-- select truncate with order by (result)
--Testcase 272:
SELECT value3, truncate(1-value3, 2) FROM s3 ORDER BY truncate(1-value3, 2);
 value3 | truncate 
--------+----------
   -0.1 |      1.1
   -0.2 |      1.2
   -0.3 |      1.3
   -1.1 |      2.1
   -2.2 |      3.2
   -3.3 |     4.29
(6 rows)

-- select truncate with order by index (result)
--Testcase 273:
SELECT value3, truncate(1-value3, 2) FROM s3 ORDER BY 2,1;
 value3 | truncate 
--------+----------
   -0.1 |      1.1
   -0.2 |      1.2
   -0.3 |      1.3
   -1.1 |      2.1
   -2.2 |      3.2
   -3.3 |     4.29
(6 rows)

-- select truncate with order by index (result)
--Testcase 274:
SELECT value3, truncate(1-value3, 2) FROM s3 ORDER BY 1,2;
 value3 | truncate 
--------+----------
   -3.3 |     4.29
   -2.2 |      3.2
   -1.1 |      2.1
   -0.3 |      1.3
   -0.2 |      1.2
   -0.1 |      1.1
(6 rows)

-- select truncate with group by (explain)
--Testcase 275:
EXPLAIN VERBOSE
SELECT count(value1), truncate(1-value3, 2) FROM s3 GROUP BY truncate(1-value3, 2);
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (truncate(('1'::double precision - value3), 2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.truncate((1::double precision - value3), 2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select truncate with group by (result)
--Testcase 276:
SELECT count(value1), truncate(1-value3, 2) FROM s3 GROUP BY truncate(1-value3, 2);
 count | truncate 
-------+----------
     1 |      1.1
     1 |      1.2
     1 |      1.3
     1 |      2.1
     1 |      3.2
     1 |     4.29
(6 rows)

-- select truncate with group by index (result)
--Testcase 277:
SELECT value3, truncate(1-value3, 2) FROM s3 GROUP BY 2,1;
 value3 | truncate 
--------+----------
   -0.1 |      1.1
   -0.2 |      1.2
   -0.3 |      1.3
   -1.1 |      2.1
   -2.2 |      3.2
   -3.3 |     4.29
(6 rows)

-- select truncate with group by index (result)
--Testcase 278:
SELECT value3, truncate(1-value3, 2) FROM s3 GROUP BY 1,2;
 value3 | truncate 
--------+----------
   -0.1 |      1.1
   -0.2 |      1.2
   -0.3 |      1.3
   -1.1 |      2.1
   -2.2 |      3.2
   -3.3 |     4.29
(6 rows)

-- select truncate with group by having (explain)
--Testcase 279:
EXPLAIN VERBOSE
SELECT count(value1), truncate(1-value3, 2) FROM s3 GROUP BY truncate(1-value3, 2) HAVING avg(value1) > 0;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (truncate(('1'::double precision - value3), 2))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.truncate((1::double precision - value3), 2), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select truncate with group by having (result)
--Testcase 280:
SELECT count(value1), truncate(1-value3, 2) FROM s3 GROUP BY truncate(1-value3, 2) HAVING avg(value1) > 0;
 count | truncate 
-------+----------
     1 |      1.1
     1 |      1.2
     1 |      1.3
     1 |      2.1
     1 |      3.2
     1 |     4.29
(6 rows)

-- select truncate with group by index having (result)
--Testcase 281:
SELECT value3, truncate(1-value3, 2) FROM s3 GROUP BY 2,1 HAVING truncate(1-value3, 2) > 0;
 value3 | truncate 
--------+----------
   -0.1 |      1.1
   -0.2 |      1.2
   -0.3 |      1.3
   -1.1 |      2.1
   -2.2 |      3.2
   -3.3 |     4.29
(6 rows)

-- select truncate with group by index having (result)
--Testcase 282:
SELECT value3, truncate(1-value3, 2) FROM s3 GROUP BY 1,2 HAVING value3 > 1;
 value3 | truncate 
--------+----------
(0 rows)

-- select truncate and as
--Testcase 283:
SELECT truncate(value3, 2) as truncate1 FROM s3;
 truncate1 
-----------
      -0.1
      -0.2
      -0.3
      -1.1
      -2.2
     -3.29
(6 rows)

-- select round (builtin function, explain)
--Testcase 284:
EXPLAIN VERBOSE
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3;
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=64)
   Output: (round(value1)), (round((value2)::double precision)), (round(value3)), (round((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(value1), round(value2), round(value3), round(value4), 1::numeric FROM public.s3mysql
(4 rows)

-- select round (builtin function, result)
--Testcase 285:
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3;
 round | round | round | round | round 
-------+-------+-------+-------+-------
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
     1 |   200 |    -1 |  -200 |     1
     2 |   200 |    -2 |  -200 |     1
     3 |   200 |    -3 |  -200 |     1
(6 rows)

-- select round (builtin function, not pushdown constraints, explain)
--Testcase 286:
EXPLAIN VERBOSE
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=64)
   Output: (round(value1)), (round((value2)::double precision)), (round(value3)), (round((value4)::double precision)), '1'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(value1), round(value2), round(value3), round(value4), 1::numeric, value2 FROM public.s3mysql
(5 rows)

-- select round (builtin function, not pushdown constraints, result)
--Testcase 287:
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3 WHERE to_hex(value2) = '64';
 round | round | round | round | round 
-------+-------+-------+-------+-------
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
(3 rows)

-- select round (builtin function, pushdown constraints, explain)
--Testcase 288:
EXPLAIN VERBOSE
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3 WHERE value2 != 200;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=64)
   Output: (round(value1)), (round((value2)::double precision)), (round(value3)), (round((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(value1), round(value2), round(value3), round(value4), 1::numeric FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select round (builtin function, pushdown constraints, result)
--Testcase 289:
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3 WHERE value2 != 200;
 round | round | round | round | round 
-------+-------+-------+-------+-------
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
(3 rows)

-- select round (builtin function, round in constraints, explain)
--Testcase 290:
EXPLAIN VERBOSE
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3 WHERE round(value1) != 1;
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=64)
   Output: (round(value1)), (round((value2)::double precision)), (round(value3)), (round((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(value1), round(value2), round(value3), round(value4), 1::numeric FROM public.s3mysql WHERE ((round(value1) <> 1::double precision))
(4 rows)

-- select round (builtin function, round in constraints, result)
--Testcase 291:
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3 WHERE round(value1) != 1;
 round | round | round | round | round 
-------+-------+-------+-------+-------
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
     2 |   200 |    -2 |  -200 |     1
     3 |   200 |    -3 |  -200 |     1
(5 rows)

-- select round (builtin function, round in constraints, explain)
--Testcase 292:
EXPLAIN VERBOSE
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3 WHERE round(0.5) > value1;
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=64)
   Output: (round(value1)), (round((value2)::double precision)), (round(value3)), (round((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(value1), round(value2), round(value3), round(value4), 1::numeric FROM public.s3mysql WHERE ((1::double precision > value1))
(4 rows)

-- select round (builtin function, round in constraints, result)
--Testcase 293:
SELECT round(value1), round(value2), round(value3), round(value4), round(0.5) FROM s3 WHERE round(0.5) > value1;
 round | round | round | round | round 
-------+-------+-------+-------+-------
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
     0 |   100 |    -0 |  -100 |     1
(3 rows)

-- select round as nest function with agg (pushdown, explain)
--Testcase 294:
EXPLAIN VERBOSE
SELECT sum(value3),round(sum(value3)) FROM s3;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (round(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), round(sum(value3)) FROM public.s3mysql
(6 rows)

-- select round as nest function with agg (pushdown, result)
--Testcase 295:
SELECT sum(value3),round(sum(value3)) FROM s3;
        sum         | round 
--------------------+-------
 -7.200000040233135 |    -7
(1 row)

-- select round as nest with log2 (pushdown, explain)
--Testcase 296:
EXPLAIN VERBOSE
SELECT round(log2(value1)),round(log2(1/value1)) FROM s3;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (round(log2(value1))), (round(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(public.log2(value1)), round(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select round as nest with log2 (pushdown, result)
--Testcase 297:
SELECT round(log2(value1)),round(log2(1/value1)) FROM s3;
 round | round 
-------+-------
    -3 |     3
    -2 |     2
    -2 |     2
     0 |    -0
     1 |    -1
     2 |    -2
(6 rows)

-- select round with non pushdown func and explicit constant (explain)
--Testcase 298:
EXPLAIN VERBOSE
SELECT round(value3), pi(), 4.1 FROM s3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (round(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select round with non pushdown func and explicit constant (result)
--Testcase 299:
SELECT round(value3), pi(), 4.1 FROM s3;
 round |        pi         | ?column? 
-------+-------------------+----------
    -0 | 3.141592653589793 |      4.1
    -0 | 3.141592653589793 |      4.1
    -0 | 3.141592653589793 |      4.1
    -1 | 3.141592653589793 |      4.1
    -2 | 3.141592653589793 |      4.1
    -3 | 3.141592653589793 |      4.1
(6 rows)

-- select round with order by (explain)
--Testcase 300:
EXPLAIN VERBOSE
SELECT value1, round(1-value3) FROM s3 ORDER BY round(1-value3);
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (round(('1'::double precision - value3)))
   Sort Key: (round(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (round(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, round((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select round with order by (result)
--Testcase 301:
SELECT value1, round(1-value3) FROM s3 ORDER BY round(1-value3);
 value1 | round 
--------+-------
    0.1 |     1
    0.2 |     1
    0.3 |     1
    1.1 |     2
    2.2 |     3
    3.3 |     4
(6 rows)

-- select round with order by index (result)
--Testcase 302:
SELECT value1, round(1-value3) FROM s3 ORDER BY 2,1;
 value1 | round 
--------+-------
    0.1 |     1
    0.2 |     1
    0.3 |     1
    1.1 |     2
    2.2 |     3
    3.3 |     4
(6 rows)

-- select round with order by index (result)
--Testcase 303:
SELECT value1, round(1-value3) FROM s3 ORDER BY 1,2;
 value1 | round 
--------+-------
    0.1 |     1
    0.2 |     1
    0.3 |     1
    1.1 |     2
    2.2 |     3
    3.3 |     4
(6 rows)

-- select round with group by (explain)
--Testcase 304:
EXPLAIN VERBOSE
SELECT count(value1), round(1-value3) FROM s3 GROUP BY round(1-value3);
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (round(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), round((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select round with group by (result)
--Testcase 305:
SELECT count(value1), round(1-value3) FROM s3 GROUP BY round(1-value3);
 count | round 
-------+-------
     3 |     1
     1 |     2
     1 |     3
     1 |     4
(4 rows)

-- select round with group by index (result)
--Testcase 306:
SELECT value1, round(1-value3) FROM s3 GROUP BY 2,1;
 value1 | round 
--------+-------
    0.1 |     1
    0.2 |     1
    0.3 |     1
    1.1 |     2
    2.2 |     3
    3.3 |     4
(6 rows)

-- select round with group by index (result)
--Testcase 307:
SELECT value1, round(1-value3) FROM s3 GROUP BY 1,2;
 value1 | round 
--------+-------
    0.1 |     1
    0.2 |     1
    0.3 |     1
    1.1 |     2
    2.2 |     3
    3.3 |     4
(6 rows)

-- select round with group by having (explain)
--Testcase 308:
EXPLAIN VERBOSE
SELECT count(value1), round(1-value3) FROM s3 GROUP BY round(1-value3) HAVING round(avg(value1)) > 0;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (round(('1'::double precision - value3)))
   Filter: (round((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), round((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select round with group by having (result)
--Testcase 309:
SELECT count(value1), round(1-value3) FROM s3 GROUP BY round(1-value3) HAVING round(avg(value1)) > 0;
 count | round 
-------+-------
     1 |     2
     1 |     3
     1 |     4
(3 rows)

-- select round with group by index having (result)
--Testcase 310:
SELECT value1, round(1-value3) FROM s3 GROUP BY 2,1 HAVING round(1-value3) > 0;
 value1 | round 
--------+-------
    0.1 |     1
    0.2 |     1
    0.3 |     1
    1.1 |     2
    2.2 |     3
    3.3 |     4
(6 rows)

-- select round with group by index having (result)
--Testcase 311:
SELECT value1, round(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | round 
--------+-------
    1.1 |     2
    2.2 |     3
    3.3 |     4
(3 rows)

-- select round and as
--Testcase 312:
SELECT round(value3) as round1 FROM s3;
 round1 
--------
     -0
     -0
     -0
     -1
     -2
     -3
(6 rows)

-- select acos (builtin function, explain)
--Testcase 313:
EXPLAIN VERBOSE
SELECT value1, acos(value3), acos(0.5) FROM s3;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=24)
   Output: value1, (acos(value3)), '1.0471975511965979'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, acos(value3), 1.0471975511965979::double precision FROM public.s3mysql
(4 rows)

-- select acos (builtin function, result)
--Testcase 314:
SELECT value1, acos(value3), acos(0.5) FROM s3;
 value1 |        acos        |        acos        
--------+--------------------+--------------------
    0.1 | 1.6709637494540794 | 1.0471975511965979
    0.2 | 1.7721542506269141 | 1.0471975511965979
    0.3 | 1.8754889933068233 | 1.0471975511965979
    1.1 |                    | 1.0471975511965979
    2.2 |                    | 1.0471975511965979
    3.3 |                    | 1.0471975511965979
(6 rows)

-- select acos (builtin function, not pushdown constraints, explain)
--Testcase 315:
EXPLAIN VERBOSE
SELECT acos(value1), acos(value3), acos(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.28 rows=17 width=24)
   Output: (acos(value1)), (acos(value3)), '1.0471975511965979'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT acos(value1), acos(value3), 1.0471975511965979::double precision, value2 FROM public.s3mysql
(5 rows)

-- select acos (builtin function, not pushdown constraints, result)
--Testcase 316:
SELECT acos(value1), acos(value3), acos(0.5) FROM s3 WHERE to_hex(value2) = '64';
        acos        |        acos        |        acos        
--------------------+--------------------+--------------------
 1.4706289041357137 | 1.6709637494540794 | 1.0471975511965979
  1.369438402962879 | 1.7721542506269141 | 1.0471975511965979
   1.26610366028297 | 1.8754889933068233 | 1.0471975511965979
(3 rows)

-- select acos (builtin function, pushdown constraints, explain)
--Testcase 317:
EXPLAIN VERBOSE
SELECT acos(value1), acos(value3), acos(0.5) FROM s3 WHERE value2 != 200;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.56 rows=3396 width=24)
   Output: (acos(value1)), (acos(value3)), '1.0471975511965979'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT acos(value1), acos(value3), 1.0471975511965979::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select acos (builtin function, pushdown constraints, result)
--Testcase 318:
SELECT acos(value1), acos(value3), acos(0.5) FROM s3 WHERE value2 != 200;
        acos        |        acos        |        acos        
--------------------+--------------------+--------------------
 1.4706289041357137 | 1.6709637494540794 | 1.0471975511965979
  1.369438402962879 | 1.7721542506269141 | 1.0471975511965979
   1.26610366028297 | 1.8754889933068233 | 1.0471975511965979
(3 rows)

-- select acos (builtin function, acos in constraints, explain)
--Testcase 319:
EXPLAIN VERBOSE
SELECT acos(value1), acos(value3), acos(0.5) FROM s3 WHERE acos(value1) != 1;
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.09 rows=3396 width=24)
   Output: (acos(value1)), (acos(value3)), '1.0471975511965979'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT acos(value1), acos(value3), 1.0471975511965979::double precision FROM public.s3mysql WHERE ((acos(value1) <> 1::double precision))
(4 rows)

-- select acos (builtin function, acos in constraints, result)
--Testcase 320:
SELECT acos(value1), acos(value3), acos(0.5) FROM s3 WHERE acos(value1) != 1;
        acos        |        acos        |        acos        
--------------------+--------------------+--------------------
 1.4706289041357137 | 1.6709637494540794 | 1.0471975511965979
  1.369438402962879 | 1.7721542506269141 | 1.0471975511965979
   1.26610366028297 | 1.8754889933068233 | 1.0471975511965979
(3 rows)

-- select acos (builtin function, acos in constraints, explain)
--Testcase 321:
EXPLAIN VERBOSE
SELECT acos(value1), acos(value3), acos(0.5) FROM s3 WHERE acos(0.5) > value1;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..181.11 rows=1138 width=24)
   Output: (acos(value1)), (acos(value3)), '1.0471975511965979'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT acos(value1), acos(value3), 1.0471975511965979::double precision FROM public.s3mysql WHERE ((1.0471975511965979::double precision > value1))
(4 rows)

-- select acos (builtin function, acos in constraints, result)
--Testcase 322:
SELECT acos(value1), acos(value3), acos(0.5) FROM s3 WHERE acos(0.5) > value1;
        acos        |        acos        |        acos        
--------------------+--------------------+--------------------
 1.4706289041357137 | 1.6709637494540794 | 1.0471975511965979
  1.369438402962879 | 1.7721542506269141 | 1.0471975511965979
   1.26610366028297 | 1.8754889933068233 | 1.0471975511965979
(3 rows)

-- select acos as nest function with agg (pushdown, explain)
--Testcase 323:
EXPLAIN VERBOSE
SELECT sum(value3),acos(sum(value1)) FROM s3 WHERE value2 != 200;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (acos(sum(value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), acos(sum(value1)) FROM public.s3mysql WHERE ((value2 <> 200))
(6 rows)

-- select acos as nest function with agg (pushdown, result)
--Testcase 324:
SELECT sum(value3),acos(sum(value1)) FROM s3 WHERE value2 != 200;
         sum         |        acos        
---------------------+--------------------
 -0.6000000163912773 | 0.9272951975125154
(1 row)

-- select acos as nest with log2 (pushdown, explain)
--Testcase 325:
EXPLAIN VERBOSE
SELECT value1, acos(log2(value1)),acos(log2(1/value1)) FROM s3;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (acos(log2(value1))), (acos(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, acos(public.log2(value1)), acos(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select acos as nest with log2 (pushdown, result)
--Testcase 326:
SELECT value1, acos(log2(value1)),acos(log2(1/value1)) FROM s3;
 value1 |        acos        |        acos        
--------+--------------------+--------------------
    0.1 |                    |                   
    0.2 |                    |                   
    0.3 |                    |                   
    1.1 | 1.4328557412659095 | 1.7087369123238838
    2.2 |                    |                   
    3.3 |                    |                   
(6 rows)

-- select acos with non pushdown func and explicit constant (explain)
--Testcase 327:
EXPLAIN VERBOSE
SELECT acos(value3), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (acos(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT acos(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select acos with non pushdown func and explicit constant (result)
--Testcase 328:
SELECT acos(value3), pi(), 4.1 FROM s3;
        acos        |        pi         | ?column? 
--------------------+-------------------+----------
 1.6709637494540794 | 3.141592653589793 |      4.1
 1.7721542506269141 | 3.141592653589793 |      4.1
 1.8754889933068233 | 3.141592653589793 |      4.1
                    | 3.141592653589793 |      4.1
                    | 3.141592653589793 |      4.1
                    | 3.141592653589793 |      4.1
(6 rows)

-- select acos with order by (explain)
--Testcase 329:
EXPLAIN VERBOSE
SELECT value1, acos(1-value1) FROM s3 ORDER BY acos(1-value1);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (acos(('1'::double precision - value1)))
   Sort Key: (acos(('1'::double precision - s3.value1)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (acos(('1'::double precision - value1)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, acos((1::double precision - value1)) FROM public.s3mysql
(7 rows)

-- select acos with order by (result)
--Testcase 330:
SELECT value1, acos(1-value1) FROM s3 ORDER BY acos(1-value1);
 value1 |        acos         
--------+---------------------
    0.1 | 0.45102681521482324
    0.2 |  0.6435011137603381
    0.3 |  0.7953988468767829
    1.1 |  1.6709637719184252
    2.2 |                    
    3.3 |                    
(6 rows)

-- select acos with order by index (result)
--Testcase 331:
SELECT value1, acos(1-value1) FROM s3 ORDER BY 2,1;
 value1 |        acos         
--------+---------------------
    0.1 | 0.45102681521482324
    0.2 |  0.6435011137603381
    0.3 |  0.7953988468767829
    1.1 |  1.6709637719184252
    2.2 |                    
    3.3 |                    
(6 rows)

-- select acos with order by index (result)
--Testcase 332:
SELECT value1, acos(1-value1) FROM s3 ORDER BY 1,2;
 value1 |        acos         
--------+---------------------
    0.1 | 0.45102681521482324
    0.2 |  0.6435011137603381
    0.3 |  0.7953988468767829
    1.1 |  1.6709637719184252
    2.2 |                    
    3.3 |                    
(6 rows)

-- select acos with group by (explain)
--Testcase 333:
EXPLAIN VERBOSE
SELECT count(value1), acos(1-value1) FROM s3 GROUP BY acos(1-value1);
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (acos(('1'::double precision - value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), acos((1::double precision - value1)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select acos with group by (result)
--Testcase 334:
SELECT count(value1), acos(1-value1) FROM s3 GROUP BY acos(1-value1);
 count |        acos         
-------+---------------------
     1 | 0.45102681521482324
     1 |  0.6435011137603381
     1 |  0.7953988468767829
     1 |  1.6709637719184252
     2 |                    
(5 rows)

-- select acos with group by index (result)
--Testcase 335:
SELECT value1, acos(1-value1) FROM s3 GROUP BY 2,1;
 value1 |        acos         
--------+---------------------
    0.1 | 0.45102681521482324
    0.2 |  0.6435011137603381
    0.3 |  0.7953988468767829
    1.1 |  1.6709637719184252
    2.2 |                    
    3.3 |                    
(6 rows)

-- select acos with group by index (result)
--Testcase 336:
SELECT value1, acos(1-value1) FROM s3 GROUP BY 1,2;
 value1 |        acos         
--------+---------------------
    0.1 | 0.45102681521482324
    0.2 |  0.6435011137603381
    0.3 |  0.7953988468767829
    1.1 |  1.6709637719184252
    2.2 |                    
    3.3 |                    
(6 rows)

-- select acos with group by having (explain)
--Testcase 337:
EXPLAIN VERBOSE
SELECT count(value1), acos(1-value1) FROM s3 GROUP BY acos(1-value1) HAVING avg(value1) > 0;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (acos(('1'::double precision - value1)))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), acos((1::double precision - value1)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select acos with group by having (result)
--Testcase 338:
SELECT count(value1), acos(1-value1) FROM s3 GROUP BY acos(1-value1) HAVING avg(value1) > 0;
 count |        acos         
-------+---------------------
     1 | 0.45102681521482324
     1 |  0.6435011137603381
     1 |  0.7953988468767829
     1 |  1.6709637719184252
     2 |                    
(5 rows)

-- select acos with group by index having (result)
--Testcase 339:
SELECT value1, acos(1-value1) FROM s3 GROUP BY 2,1 HAVING acos(1-value1) > 0;
 value1 |        acos         
--------+---------------------
    0.1 | 0.45102681521482324
    0.2 |  0.6435011137603381
    0.3 |  0.7953988468767829
    1.1 |  1.6709637719184252
(4 rows)

-- select acos with group by index having (result)
--Testcase 340:
SELECT value1, acos(1-value1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |        acos        
--------+--------------------
    1.1 | 1.6709637719184252
    2.2 |                   
    3.3 |                   
(3 rows)

-- select acos and as
--Testcase 341:
SELECT acos(value3) as acos1 FROM s3;
       acos1        
--------------------
 1.6709637494540794
 1.7721542506269141
 1.8754889933068233
                   
                   
                   
(6 rows)

-- select asin (builtin function, explain)
--Testcase 342:
EXPLAIN VERBOSE
SELECT asin(value1), asin(value3), asin(0.5) FROM s3;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=24)
   Output: (asin(value1)), (asin(value3)), '0.5235987755982989'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT asin(value1), asin(value3), 0.5235987755982989::double precision FROM public.s3mysql
(4 rows)

-- select asin (builtin function, result)
--Testcase 343:
SELECT asin(value1), asin(value3), asin(0.5) FROM s3;
        asin         |         asin         |        asin        
---------------------+----------------------+--------------------
 0.10016742265918284 | -0.10016742265918284 | 0.5235987755982989
  0.2013579238320176 |  -0.2013579238320176 | 0.5235987755982989
  0.3046926665119266 |  -0.3046926665119266 | 0.5235987755982989
                     |                      | 0.5235987755982989
                     |                      | 0.5235987755982989
                     |                      | 0.5235987755982989
(6 rows)

-- select asin (builtin function, not pushdown constraints, explain)
--Testcase 344:
EXPLAIN VERBOSE
SELECT asin(value1), asin(value3), asin(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.28 rows=17 width=24)
   Output: (asin(value1)), (asin(value3)), '0.5235987755982989'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT asin(value1), asin(value3), 0.5235987755982989::double precision, value2 FROM public.s3mysql
(5 rows)

-- select asin (builtin function, not pushdown constraints, result)
--Testcase 345:
SELECT asin(value1), asin(value3), asin(0.5) FROM s3 WHERE to_hex(value2) = '64';
        asin         |         asin         |        asin        
---------------------+----------------------+--------------------
 0.10016742265918284 | -0.10016742265918284 | 0.5235987755982989
  0.2013579238320176 |  -0.2013579238320176 | 0.5235987755982989
  0.3046926665119266 |  -0.3046926665119266 | 0.5235987755982989
(3 rows)

-- select asin (builtin function, pushdown constraints, explain)
--Testcase 346:
EXPLAIN VERBOSE
SELECT asin(value1), asin(value3), asin(0.5) FROM s3 WHERE value2 != 200;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.56 rows=3396 width=24)
   Output: (asin(value1)), (asin(value3)), '0.5235987755982989'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT asin(value1), asin(value3), 0.5235987755982989::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select asin (builtin function, pushdown constraints, result)
--Testcase 347:
SELECT asin(value1), asin(value3), asin(0.5) FROM s3 WHERE value2 != 200;
        asin         |         asin         |        asin        
---------------------+----------------------+--------------------
 0.10016742265918284 | -0.10016742265918284 | 0.5235987755982989
  0.2013579238320176 |  -0.2013579238320176 | 0.5235987755982989
  0.3046926665119266 |  -0.3046926665119266 | 0.5235987755982989
(3 rows)

-- select asin (builtin function, asin in constraints, explain)
--Testcase 348:
EXPLAIN VERBOSE
SELECT asin(value1), asin(value3), asin(0.5) FROM s3 WHERE asin(value1) != 1;
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.09 rows=3396 width=24)
   Output: (asin(value1)), (asin(value3)), '0.5235987755982989'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT asin(value1), asin(value3), 0.5235987755982989::double precision FROM public.s3mysql WHERE ((asin(value1) <> 1::double precision))
(4 rows)

-- select asin (builtin function, asin in constraints, result)
--Testcase 349:
SELECT asin(value1), asin(value3), asin(0.5) FROM s3 WHERE asin(value1) != 1;
        asin         |         asin         |        asin        
---------------------+----------------------+--------------------
 0.10016742265918284 | -0.10016742265918284 | 0.5235987755982989
  0.2013579238320176 |  -0.2013579238320176 | 0.5235987755982989
  0.3046926665119266 |  -0.3046926665119266 | 0.5235987755982989
(3 rows)

-- select asin (builtin function, asin in constraints, explain)
--Testcase 350:
EXPLAIN VERBOSE
SELECT asin(value1), asin(value3), asin(0.5) FROM s3 WHERE asin(0.5) > value1;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..181.11 rows=1138 width=24)
   Output: (asin(value1)), (asin(value3)), '0.5235987755982989'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT asin(value1), asin(value3), 0.5235987755982989::double precision FROM public.s3mysql WHERE ((0.5235987755982989::double precision > value1))
(4 rows)

-- select asin (builtin function, asin in constraints, result)
--Testcase 351:
SELECT asin(value1), asin(value3), asin(0.5) FROM s3 WHERE asin(0.5) > value1;
        asin         |         asin         |        asin        
---------------------+----------------------+--------------------
 0.10016742265918284 | -0.10016742265918284 | 0.5235987755982989
  0.2013579238320176 |  -0.2013579238320176 | 0.5235987755982989
  0.3046926665119266 |  -0.3046926665119266 | 0.5235987755982989
(3 rows)

-- select asin as nest function with agg (pushdown, explain)
--Testcase 352:
EXPLAIN VERBOSE
SELECT sum(value3),asin(sum(value1)) FROM s3 WHERE value2 != 200;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (asin(sum(value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), asin(sum(value1)) FROM public.s3mysql WHERE ((value2 <> 200))
(6 rows)

-- select asin as nest function with agg (pushdown, result)
--Testcase 353:
SELECT sum(value3),asin(sum(value1)) FROM s3 WHERE value2 != 200;
         sum         |        asin        
---------------------+--------------------
 -0.6000000163912773 | 0.6435011292823812
(1 row)

-- select asin as nest with log2 (pushdown, explain)
--Testcase 354:
EXPLAIN VERBOSE
SELECT value1, asin(log2(value1)),asin(log2(1/value1)) FROM s3;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (asin(log2(value1))), (asin(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, asin(public.log2(value1)), asin(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select asin as nest with log2 (pushdown, result)
--Testcase 355:
SELECT value1, asin(log2(value1)),asin(log2(1/value1)) FROM s3;
 value1 |        asin        |         asin         
--------+--------------------+----------------------
    0.1 |                    |                     
    0.2 |                    |                     
    0.3 |                    |                     
    1.1 | 0.1379405855289872 | -0.13794058552898714
    2.2 |                    |                     
    3.3 |                    |                     
(6 rows)

-- select asin with non pushdown func and explicit constant (explain)
--Testcase 356:
EXPLAIN VERBOSE
SELECT value1, asin(value3), pi(), 4.1 FROM s3;
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=56)
   Output: value1, (asin(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, asin(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select asin with non pushdown func and explicit constant (result)
--Testcase 357:
SELECT value1, asin(value3), pi(), 4.1 FROM s3;
 value1 |         asin         |        pi         | ?column? 
--------+----------------------+-------------------+----------
    0.1 | -0.10016742265918284 | 3.141592653589793 |      4.1
    0.2 |  -0.2013579238320176 | 3.141592653589793 |      4.1
    0.3 |  -0.3046926665119266 | 3.141592653589793 |      4.1
    1.1 |                      | 3.141592653589793 |      4.1
    2.2 |                      | 3.141592653589793 |      4.1
    3.3 |                      | 3.141592653589793 |      4.1
(6 rows)

-- select asin with order by (explain)
--Testcase 358:
EXPLAIN VERBOSE
SELECT value1, asin(1-value1) FROM s3 ORDER BY asin(1-value1);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (asin(('1'::double precision - value1)))
   Sort Key: (asin(('1'::double precision - s3.value1)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (asin(('1'::double precision - value1)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, asin((1::double precision - value1)) FROM public.s3mysql
(7 rows)

-- select asin with order by (result)
--Testcase 359:
SELECT value1, asin(1-value1) FROM s3 ORDER BY asin(1-value1);
 value1 |         asin         
--------+----------------------
    1.1 | -0.10016744512352861
    0.3 |   0.7753974799181138
    0.2 |   0.9272952130345585
    0.1 |   1.1197695115800734
    2.2 |                     
    3.3 |                     
(6 rows)

-- select asin with order by index (result)
--Testcase 360:
SELECT value1, asin(1-value1) FROM s3 ORDER BY 2,1;
 value1 |         asin         
--------+----------------------
    1.1 | -0.10016744512352861
    0.3 |   0.7753974799181138
    0.2 |   0.9272952130345585
    0.1 |   1.1197695115800734
    2.2 |                     
    3.3 |                     
(6 rows)

-- select asin with order by index (result)
--Testcase 361:
SELECT value1, asin(1-value1) FROM s3 ORDER BY 1,2;
 value1 |         asin         
--------+----------------------
    0.1 |   1.1197695115800734
    0.2 |   0.9272952130345585
    0.3 |   0.7753974799181138
    1.1 | -0.10016744512352861
    2.2 |                     
    3.3 |                     
(6 rows)

-- select asin with group by (explain)
--Testcase 362:
EXPLAIN VERBOSE
SELECT value1, asin(1-value1) FROM s3 GROUP BY value1, asin(1-value1);
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (asin(('1'::double precision - value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, asin((1::double precision - value1)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select asin with group by (result)
--Testcase 363:
SELECT value1, asin(1-value1) FROM s3 GROUP BY value1, asin(1-value1);
 value1 |         asin         
--------+----------------------
    0.1 |   1.1197695115800734
    0.2 |   0.9272952130345585
    0.3 |   0.7753974799181138
    1.1 | -0.10016744512352861
    2.2 |                     
    3.3 |                     
(6 rows)

-- select asin with group by index (result)
--Testcase 364:
SELECT value1, asin(1-value1) FROM s3 GROUP BY 2,1;
 value1 |         asin         
--------+----------------------
    0.1 |   1.1197695115800734
    0.2 |   0.9272952130345585
    0.3 |   0.7753974799181138
    1.1 | -0.10016744512352861
    2.2 |                     
    3.3 |                     
(6 rows)

-- select asin with group by index (result)
--Testcase 365:
SELECT value1, asin(1-value1) FROM s3 GROUP BY 1,2;
 value1 |         asin         
--------+----------------------
    0.1 |   1.1197695115800734
    0.2 |   0.9272952130345585
    0.3 |   0.7753974799181138
    1.1 | -0.10016744512352861
    2.2 |                     
    3.3 |                     
(6 rows)

-- select asin with group by having (explain)
--Testcase 366:
EXPLAIN VERBOSE
SELECT value1, asin(1-value1) FROM s3 GROUP BY value1, asin(1-value1) HAVING avg(value1) > 0;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (asin(('1'::double precision - value1)))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, asin((1::double precision - value1)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select asin with group by having (result)
--Testcase 367:
SELECT value1, asin(1-value1) FROM s3 GROUP BY value1, asin(1-value1) HAVING avg(value1) > 0;
 value1 |         asin         
--------+----------------------
    0.1 |   1.1197695115800734
    0.2 |   0.9272952130345585
    0.3 |   0.7753974799181138
    1.1 | -0.10016744512352861
    2.2 |                     
    3.3 |                     
(6 rows)

-- select asin with group by index having (result)
--Testcase 368:
SELECT value1, asin(1-value1) FROM s3 GROUP BY 2,1 HAVING asin(1-value1) > 0;
 value1 |        asin        
--------+--------------------
    0.1 | 1.1197695115800734
    0.2 | 0.9272952130345585
    0.3 | 0.7753974799181138
(3 rows)

-- select asin with group by index having (result)
--Testcase 369:
SELECT value1, asin(1-value1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |         asin         
--------+----------------------
    1.1 | -0.10016744512352861
    2.2 |                     
    3.3 |                     
(3 rows)

-- select asin and as
--Testcase 370:
SELECT value1, asin(value3) as asin1 FROM s3;
 value1 |        asin1         
--------+----------------------
    0.1 | -0.10016742265918284
    0.2 |  -0.2013579238320176
    0.3 |  -0.3046926665119266
    1.1 |                     
    2.2 |                     
    3.3 |                     
(6 rows)

-- select atan (builtin function, explain)
--Testcase 371:
EXPLAIN VERBOSE
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3;
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=40)
   Output: (atan(value1)), (atan((value2)::double precision)), (atan(value3)), (atan((value4)::double precision)), '0.4636476090008061'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan(value1), atan(value2), atan(value3), atan(value4), 0.4636476090008061::double precision FROM public.s3mysql
(4 rows)

-- select atan (builtin function, result)
--Testcase 372:
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3;
        atan         |        atan        |         atan         |        atan         |        atan        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.09966865396652452 | 1.5607966601082315 | -0.09966865396652452 | -1.5607966601082315 | 0.4636476090008061
 0.19739556271548866 | 1.5607966601082315 | -0.19739556271548866 | -1.5607966601082315 | 0.4636476090008061
 0.29145680541449914 | 1.5607966601082315 | -0.29145680541449914 | -1.5607966601082315 | 0.4636476090008061
  0.8329812774626025 | 1.5657963684609384 |  -0.8329812774626025 | -1.5657963684609384 | 0.4636476090008061
  1.1441688418330402 | 1.5657963684609384 |  -1.1441688418330402 | -1.5657963684609384 | 0.4636476090008061
  1.2765617576733037 | 1.5657963684609384 |  -1.2765617576733037 | -1.5657963684609384 | 0.4636476090008061
(6 rows)

-- select atan (builtin function, not pushdown constraints, explain)
--Testcase 373:
EXPLAIN VERBOSE
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (atan(value1)), (atan((value2)::double precision)), (atan(value3)), (atan((value4)::double precision)), '0.4636476090008061'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan(value1), atan(value2), atan(value3), atan(value4), 0.4636476090008061::double precision, value2 FROM public.s3mysql
(5 rows)

-- select atan (builtin function, not pushdown constraints, result)
--Testcase 374:
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3 WHERE to_hex(value2) = '64';
        atan         |        atan        |         atan         |        atan         |        atan        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.09966865396652452 | 1.5607966601082315 | -0.09966865396652452 | -1.5607966601082315 | 0.4636476090008061
 0.19739556271548866 | 1.5607966601082315 | -0.19739556271548866 | -1.5607966601082315 | 0.4636476090008061
 0.29145680541449914 | 1.5607966601082315 | -0.29145680541449914 | -1.5607966601082315 | 0.4636476090008061
(3 rows)

-- select atan (builtin function, pushdown constraints, explain)
--Testcase 375:
EXPLAIN VERBOSE
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3 WHERE value2 != 200;
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (atan(value1)), (atan((value2)::double precision)), (atan(value3)), (atan((value4)::double precision)), '0.4636476090008061'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan(value1), atan(value2), atan(value3), atan(value4), 0.4636476090008061::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select atan (builtin function, pushdown constraints, result)
--Testcase 376:
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3 WHERE value2 != 200;
        atan         |        atan        |         atan         |        atan         |        atan        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.09966865396652452 | 1.5607966601082315 | -0.09966865396652452 | -1.5607966601082315 | 0.4636476090008061
 0.19739556271548866 | 1.5607966601082315 | -0.19739556271548866 | -1.5607966601082315 | 0.4636476090008061
 0.29145680541449914 | 1.5607966601082315 | -0.29145680541449914 | -1.5607966601082315 | 0.4636476090008061
(3 rows)

-- select atan (builtin function, atan in constraints, explain)
--Testcase 377:
EXPLAIN VERBOSE
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3 WHERE atan(value1) != 1;
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=40)
   Output: (atan(value1)), (atan((value2)::double precision)), (atan(value3)), (atan((value4)::double precision)), '0.4636476090008061'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan(value1), atan(value2), atan(value3), atan(value4), 0.4636476090008061::double precision FROM public.s3mysql WHERE ((atan(value1) <> 1::double precision))
(4 rows)

-- select atan (builtin function, atan in constraints, result)
--Testcase 378:
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3 WHERE atan(value1) != 1;
        atan         |        atan        |         atan         |        atan         |        atan        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.09966865396652452 | 1.5607966601082315 | -0.09966865396652452 | -1.5607966601082315 | 0.4636476090008061
 0.19739556271548866 | 1.5607966601082315 | -0.19739556271548866 | -1.5607966601082315 | 0.4636476090008061
 0.29145680541449914 | 1.5607966601082315 | -0.29145680541449914 | -1.5607966601082315 | 0.4636476090008061
  0.8329812774626025 | 1.5657963684609384 |  -0.8329812774626025 | -1.5657963684609384 | 0.4636476090008061
  1.1441688418330402 | 1.5657963684609384 |  -1.1441688418330402 | -1.5657963684609384 | 0.4636476090008061
  1.2765617576733037 | 1.5657963684609384 |  -1.2765617576733037 | -1.5657963684609384 | 0.4636476090008061
(6 rows)

-- select atan (builtin function, atan in constraints, explain)
--Testcase 379:
EXPLAIN VERBOSE
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3 WHERE atan(0.5) > value1;
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=40)
   Output: (atan(value1)), (atan((value2)::double precision)), (atan(value3)), (atan((value4)::double precision)), '0.4636476090008061'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan(value1), atan(value2), atan(value3), atan(value4), 0.4636476090008061::double precision FROM public.s3mysql WHERE ((0.4636476090008061::double precision > value1))
(4 rows)

-- select atan (builtin function, atan in constraints, result)
--Testcase 380:
SELECT atan(value1), atan(value2), atan(value3), atan(value4), atan(0.5) FROM s3 WHERE atan(0.5) > value1;
        atan         |        atan        |         atan         |        atan         |        atan        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.09966865396652452 | 1.5607966601082315 | -0.09966865396652452 | -1.5607966601082315 | 0.4636476090008061
 0.19739556271548866 | 1.5607966601082315 | -0.19739556271548866 | -1.5607966601082315 | 0.4636476090008061
 0.29145680541449914 | 1.5607966601082315 | -0.29145680541449914 | -1.5607966601082315 | 0.4636476090008061
(3 rows)

-- select atan as nest function with agg (pushdown, explain)
--Testcase 381:
EXPLAIN VERBOSE
SELECT sum(value3),atan(sum(value3)) FROM s3;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (atan(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), atan(sum(value3)) FROM public.s3mysql
(6 rows)

-- select atan as nest function with agg (pushdown, result)
--Testcase 382:
SELECT sum(value3),atan(sum(value3)) FROM s3;
        sum         |        atan         
--------------------+---------------------
 -7.200000040233135 | -1.4327903038987915
(1 row)

-- select atan as nest with log2 (pushdown, explain)
--Testcase 383:
EXPLAIN VERBOSE
SELECT atan(log2(value1)),atan(log2(1/value1)) FROM s3;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (atan(log2(value1))), (atan(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan(public.log2(value1)), atan(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select atan as nest with log2 (pushdown, result)
--Testcase 384:
SELECT atan(log2(value1)),atan(log2(1/value1)) FROM s3;
        atan         |         atan         
---------------------+----------------------
 -1.2783948484646797 |   1.2783948484646797
 -1.1641274220634321 |   1.1641274220634321
 -1.0484236236443045 |   1.0484236236443047
 0.13664665154398273 | -0.13664665154398267
   0.849638688602701 |   -0.849638688602701
  1.0447913683536394 |  -1.0447913683536394
(6 rows)

-- select atan with non pushdown func and explicit constant (explain)
--Testcase 385:
EXPLAIN VERBOSE
SELECT atan(value3), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (atan(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select atan with non pushdown func and explicit constant (result)
--Testcase 386:
SELECT atan(value3), pi(), 4.1 FROM s3;
         atan         |        pi         | ?column? 
----------------------+-------------------+----------
 -0.09966865396652452 | 3.141592653589793 |      4.1
 -0.19739556271548866 | 3.141592653589793 |      4.1
 -0.29145680541449914 | 3.141592653589793 |      4.1
  -0.8329812774626025 | 3.141592653589793 |      4.1
  -1.1441688418330402 | 3.141592653589793 |      4.1
  -1.2765617576733037 | 3.141592653589793 |      4.1
(6 rows)

-- select atan with order by (explain)
--Testcase 387:
EXPLAIN VERBOSE
SELECT value1, atan(1-value3) FROM s3 ORDER BY atan(1-value3);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (atan(('1'::double precision - value3)))
   Sort Key: (atan(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (atan(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, atan((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select atan with order by (result)
--Testcase 388:
SELECT value1, atan(1-value3) FROM s3 ORDER BY atan(1-value3);
 value1 |        atan        
--------+--------------------
    0.1 | 0.8329812673486924
    0.2 | 0.8760580518196001
    0.3 | 0.9151007049849325
    1.1 | 1.1263771213007954
    2.2 | 1.2679114626622485
    3.3 | 1.3422996850564608
(6 rows)

-- select atan with order by index (result)
--Testcase 389:
SELECT value1, atan(1-value3) FROM s3 ORDER BY 2,1;
 value1 |        atan        
--------+--------------------
    0.1 | 0.8329812673486924
    0.2 | 0.8760580518196001
    0.3 | 0.9151007049849325
    1.1 | 1.1263771213007954
    2.2 | 1.2679114626622485
    3.3 | 1.3422996850564608
(6 rows)

-- select atan with order by index (result)
--Testcase 390:
SELECT value1, atan(1-value3) FROM s3 ORDER BY 1,2;
 value1 |        atan        
--------+--------------------
    0.1 | 0.8329812673486924
    0.2 | 0.8760580518196001
    0.3 | 0.9151007049849325
    1.1 | 1.1263771213007954
    2.2 | 1.2679114626622485
    3.3 | 1.3422996850564608
(6 rows)

-- select atan with group by (explain)
--Testcase 391:
EXPLAIN VERBOSE
SELECT count(value1), atan(1-value3) FROM s3 GROUP BY atan(1-value3);
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (atan(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), atan((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select atan with group by (result)
--Testcase 392:
SELECT count(value1), atan(1-value3) FROM s3 GROUP BY atan(1-value3);
 count |        atan        
-------+--------------------
     1 | 0.8329812673486924
     1 | 0.8760580518196001
     1 | 0.9151007049849325
     1 | 1.1263771213007954
     1 | 1.2679114626622485
     1 | 1.3422996850564608
(6 rows)

-- select atan with group by index (result)
--Testcase 393:
SELECT value1, atan(1-value3) FROM s3 GROUP BY 2,1;
 value1 |        atan        
--------+--------------------
    0.1 | 0.8329812673486924
    0.2 | 0.8760580518196001
    0.3 | 0.9151007049849325
    1.1 | 1.1263771213007954
    2.2 | 1.2679114626622485
    3.3 | 1.3422996850564608
(6 rows)

-- select atan with group by index (result)
--Testcase 394:
SELECT value1, atan(1-value3) FROM s3 GROUP BY 1,2;
 value1 |        atan        
--------+--------------------
    0.1 | 0.8329812673486924
    0.2 | 0.8760580518196001
    0.3 | 0.9151007049849325
    1.1 | 1.1263771213007954
    2.2 | 1.2679114626622485
    3.3 | 1.3422996850564608
(6 rows)

-- select atan with group by having (explain)
--Testcase 395:
EXPLAIN VERBOSE
SELECT count(value1), atan(1-value3) FROM s3 GROUP BY atan(1-value3) HAVING atan(avg(value1)) > 0;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (atan(('1'::double precision - value3)))
   Filter: (atan((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), atan((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select atan with group by having (result)
--Testcase 396:
SELECT count(value1), atan(1-value3) FROM s3 GROUP BY atan(1-value3) HAVING atan(avg(value1)) > 0;
 count |        atan        
-------+--------------------
     1 | 0.8329812673486924
     1 | 0.8760580518196001
     1 | 0.9151007049849325
     1 | 1.1263771213007954
     1 | 1.2679114626622485
     1 | 1.3422996850564608
(6 rows)

-- select atan with group by index having (result)
--Testcase 397:
SELECT value1, atan(1-value3) FROM s3 GROUP BY 2,1 HAVING atan(1-value3) > 0;
 value1 |        atan        
--------+--------------------
    0.1 | 0.8329812673486924
    0.2 | 0.8760580518196001
    0.3 | 0.9151007049849325
    1.1 | 1.1263771213007954
    2.2 | 1.2679114626622485
    3.3 | 1.3422996850564608
(6 rows)

-- select atan with group by index having (result)
--Testcase 398:
SELECT value1, atan(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |        atan        
--------+--------------------
    1.1 | 1.1263771213007954
    2.2 | 1.2679114626622485
    3.3 | 1.3422996850564608
(3 rows)

-- select atan and as
--Testcase 399:
SELECT atan(value3) as atan1 FROM s3;
        atan1         
----------------------
 -0.09966865396652452
 -0.19739556271548866
 -0.29145680541449914
  -0.8329812774626025
  -1.1441688418330402
  -1.2765617576733037
(6 rows)

-- select atan2 (builtin function, explain)
--Testcase 400:
EXPLAIN VERBOSE
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3;
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=40)
   Output: (atan2(value1, '2'::double precision)), (atan2((value2)::double precision, '2'::double precision)), (atan2(value3, '2'::double precision)), (atan2((value4)::double precision, '2'::double precision)), '1.1902899496825317'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan2(value1, 2::double precision), atan2(value2, 2::double precision), atan2(value3, 2::double precision), atan2(value4, 2::double precision), 1.1902899496825317::double precision FROM public.s3mysql
(4 rows)

-- select atan2 (builtin function, result)
--Testcase 401:
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3;
        atan2        |       atan2        |        atan2         |        atan2        |       atan2        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.04995839646514282 |  1.550798992821746 | -0.04995839646514282 |  -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 |  1.550798992821746 | -0.09966865396652452 |  -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 |  1.550798992821746 | -0.14888995343880235 |  -1.550798992821746 | 1.1902899496825317
  0.5028432200802054 | 1.5607966601082315 |  -0.5028432200802054 | -1.5607966601082315 | 1.1902899496825317
  0.8329812774626025 | 1.5607966601082315 |  -0.8329812774626025 | -1.5607966601082315 | 1.1902899496825317
  1.0259324049385556 | 1.5607966601082315 |  -1.0259324049385556 | -1.5607966601082315 | 1.1902899496825317
(6 rows)

-- select atan2 (builtin function, not pushdown constraints, explain)
--Testcase 402:
EXPLAIN VERBOSE
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3 WHERE to_hex(value2) = '64';
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (atan2(value1, '2'::double precision)), (atan2((value2)::double precision, '2'::double precision)), (atan2(value3, '2'::double precision)), (atan2((value4)::double precision, '2'::double precision)), '1.1902899496825317'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan2(value1, 2::double precision), atan2(value2, 2::double precision), atan2(value3, 2::double precision), atan2(value4, 2::double precision), 1.1902899496825317::double precision, value2 FROM public.s3mysql
(5 rows)

-- select atan2 (builtin function, not pushdown constraints, result)
--Testcase 403:
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3 WHERE to_hex(value2) = '64';
        atan2        |       atan2       |        atan2         |       atan2        |       atan2        
---------------------+-------------------+----------------------+--------------------+--------------------
 0.04995839646514282 | 1.550798992821746 | -0.04995839646514282 | -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 | 1.550798992821746 | -0.09966865396652452 | -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 | 1.550798992821746 | -0.14888995343880235 | -1.550798992821746 | 1.1902899496825317
(3 rows)

-- select atan2 (builtin function, pushdown constraints, explain)
--Testcase 404:
EXPLAIN VERBOSE
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3 WHERE value2 != 200;
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (atan2(value1, '2'::double precision)), (atan2((value2)::double precision, '2'::double precision)), (atan2(value3, '2'::double precision)), (atan2((value4)::double precision, '2'::double precision)), '1.1902899496825317'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan2(value1, 2::double precision), atan2(value2, 2::double precision), atan2(value3, 2::double precision), atan2(value4, 2::double precision), 1.1902899496825317::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select atan2 (builtin function, pushdown constraints, result)
--Testcase 405:
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3 WHERE value2 != 200;
        atan2        |       atan2       |        atan2         |       atan2        |       atan2        
---------------------+-------------------+----------------------+--------------------+--------------------
 0.04995839646514282 | 1.550798992821746 | -0.04995839646514282 | -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 | 1.550798992821746 | -0.09966865396652452 | -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 | 1.550798992821746 | -0.14888995343880235 | -1.550798992821746 | 1.1902899496825317
(3 rows)

-- select atan2 (builtin function, atan2 in constraints, explain)
--Testcase 406:
EXPLAIN VERBOSE
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3 WHERE atan2(value1, 2) != 1;
                                                                                                                                             QUERY PLAN                                                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=40)
   Output: (atan2(value1, '2'::double precision)), (atan2((value2)::double precision, '2'::double precision)), (atan2(value3, '2'::double precision)), (atan2((value4)::double precision, '2'::double precision)), '1.1902899496825317'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan2(value1, 2::double precision), atan2(value2, 2::double precision), atan2(value3, 2::double precision), atan2(value4, 2::double precision), 1.1902899496825317::double precision FROM public.s3mysql WHERE ((atan2(value1, 2::double precision) <> 1::double precision))
(4 rows)

-- select atan2 (builtin function, atan2 in constraints, result)
--Testcase 407:
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3 WHERE atan2(value1, 2) != 1;
        atan2        |       atan2        |        atan2         |        atan2        |       atan2        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.04995839646514282 |  1.550798992821746 | -0.04995839646514282 |  -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 |  1.550798992821746 | -0.09966865396652452 |  -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 |  1.550798992821746 | -0.14888995343880235 |  -1.550798992821746 | 1.1902899496825317
  0.5028432200802054 | 1.5607966601082315 |  -0.5028432200802054 | -1.5607966601082315 | 1.1902899496825317
  0.8329812774626025 | 1.5607966601082315 |  -0.8329812774626025 | -1.5607966601082315 | 1.1902899496825317
  1.0259324049385556 | 1.5607966601082315 |  -1.0259324049385556 | -1.5607966601082315 | 1.1902899496825317
(6 rows)

-- select atan2 (builtin function, atan2 in constraints, explain)
--Testcase 408:
EXPLAIN VERBOSE
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3 WHERE atan2(5, 2) > value1;
                                                                                                                                       QUERY PLAN                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=40)
   Output: (atan2(value1, '2'::double precision)), (atan2((value2)::double precision, '2'::double precision)), (atan2(value3, '2'::double precision)), (atan2((value4)::double precision, '2'::double precision)), '1.1902899496825317'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan2(value1, 2::double precision), atan2(value2, 2::double precision), atan2(value3, 2::double precision), atan2(value4, 2::double precision), 1.1902899496825317::double precision FROM public.s3mysql WHERE ((1.1902899496825317::double precision > value1))
(4 rows)

-- select atan2 (builtin function, atan2 in constraints, result)
--Testcase 409:
SELECT atan2(value1, 2), atan2(value2, 2), atan2(value3, 2), atan2(value4, 2), atan2(5, 2) FROM s3 WHERE atan2(5, 2) > value1;
        atan2        |       atan2        |        atan2         |        atan2        |       atan2        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.04995839646514282 |  1.550798992821746 | -0.04995839646514282 |  -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 |  1.550798992821746 | -0.09966865396652452 |  -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 |  1.550798992821746 | -0.14888995343880235 |  -1.550798992821746 | 1.1902899496825317
  0.5028432200802054 | 1.5607966601082315 |  -0.5028432200802054 | -1.5607966601082315 | 1.1902899496825317
(4 rows)

-- select atan2 as nest function with agg (pushdown, explain)
--Testcase 410:
EXPLAIN VERBOSE
SELECT sum(value3),atan2(sum(value3), 2) FROM s3;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (atan2(sum(value3), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), atan2(sum(value3), 2::double precision) FROM public.s3mysql
(6 rows)

-- select atan2 as nest function with agg (pushdown, result)
--Testcase 411:
SELECT sum(value3),atan2(sum(value3), 2) FROM s3;
        sum         |       atan2        
--------------------+--------------------
 -7.200000040233135 | -1.299849477897491
(1 row)

-- select atan2 as nest with log2 (pushdown, explain)
--Testcase 412:
EXPLAIN VERBOSE
SELECT atan2(log2(value1), 2),atan2(log2(1/value1), 2) FROM s3;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (atan2(log2(value1), '2'::double precision)), (atan2(log2(('1'::double precision / value1)), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan2(public.log2(value1), 2::double precision), atan2(public.log2((1::double precision / value1)), 2::double precision) FROM public.s3mysql
(4 rows)

-- select atan2 as nest with log2 (pushdown, result)
--Testcase 413:
SELECT atan2(log2(value1), 2),atan2(log2(1/value1), 2) FROM s3;
        atan2        |        atan2         
---------------------+----------------------
 -1.0288635006528577 |   1.0288635006528577
  -0.859748003088039 |    0.859748003088039
  -0.715126880832206 |    0.715126880832206
 0.06864375823738518 | -0.06864375823738515
  0.5171258967180242 |  -0.5171258967180242
  0.7109793602585378 |  -0.7109793602585378
(6 rows)

-- select atan2 with non pushdown func and atan2licit constant (explain)
--Testcase 414:
EXPLAIN VERBOSE
SELECT atan2(value3, 2), pi(), 4.1 FROM s3;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (atan2(value3, '2'::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT atan2(value3, 2::double precision), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select atan2 with non pushdown func and atan2licit constant (result)
--Testcase 415:
SELECT atan2(value3, 2), pi(), 4.1 FROM s3;
        atan2         |        pi         | ?column? 
----------------------+-------------------+----------
 -0.04995839646514282 | 3.141592653589793 |      4.1
 -0.09966865396652452 | 3.141592653589793 |      4.1
 -0.14888995343880235 | 3.141592653589793 |      4.1
  -0.5028432200802054 | 3.141592653589793 |      4.1
  -0.8329812774626025 | 3.141592653589793 |      4.1
  -1.0259324049385556 | 3.141592653589793 |      4.1
(6 rows)

-- select atan2 with order by (explain)
--Testcase 416:
EXPLAIN VERBOSE
SELECT value1, atan2(1-value3, 2) FROM s3 ORDER BY atan2(1-value3, 2);
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (atan2(('1'::double precision - value3), '2'::double precision))
   Sort Key: (atan2(('1'::double precision - s3.value3), '2'::double precision))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (atan2(('1'::double precision - value3), '2'::double precision))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, atan2((1::double precision - value3), 2::double precision) FROM public.s3mysql
(7 rows)

-- select atan2 with order by (result)
--Testcase 417:
SELECT value1, atan2(1-value3, 2) FROM s3 ORDER BY atan2(1-value3, 2);
 value1 |       atan2        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan2 with order by index (result)
--Testcase 418:
SELECT value1, atan2(1-value3, 2) FROM s3 ORDER BY 2,1;
 value1 |       atan2        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan2 with order by index (result)
--Testcase 419:
SELECT value1, atan2(1-value3, 2) FROM s3 ORDER BY 1,2;
 value1 |       atan2        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan2 with group by (explain)
--Testcase 420:
EXPLAIN VERBOSE
SELECT count(value1), atan2(1-value3, 2) FROM s3 GROUP BY atan2(1-value3, 2);
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (atan2(('1'::double precision - value3), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), atan2((1::double precision - value3), 2::double precision) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select atan2 with group by (result)
--Testcase 421:
SELECT count(value1), atan2(1-value3, 2) FROM s3 GROUP BY atan2(1-value3, 2);
 count |       atan2        
-------+--------------------
     1 | 0.5028432114998824
     1 | 0.5404195013662578
     1 | 0.5763752247813169
     1 | 0.8097835782400498
     1 | 1.0121970181484852
     1 |  1.135443047402157
(6 rows)

-- select atan2 with group by index (result)
--Testcase 422:
SELECT value1, atan2(1-value3, 2) FROM s3 GROUP BY 2,1;
 value1 |       atan2        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan2 with group by index (result)
--Testcase 423:
SELECT value1, atan2(1-value3, 2) FROM s3 GROUP BY 1,2;
 value1 |       atan2        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan2 with group by having (explain)
--Testcase 424:
EXPLAIN VERBOSE
SELECT count(value1), atan2(1-value3, 2) FROM s3 GROUP BY atan2(1-value3, 2) HAVING atan2(avg(value1), 2) > 0;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (atan2(('1'::double precision - value3), '2'::double precision))
   Filter: (atan2((avg(s3.value1)), '2'::double precision) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), atan2((1::double precision - value3), 2::double precision), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select atan2 with group by having (result)
--Testcase 425:
SELECT count(value1), atan2(1-value3, 2) FROM s3 GROUP BY atan2(1-value3, 2) HAVING atan2(avg(value1), 2) > 0;
 count |       atan2        
-------+--------------------
     1 | 0.5028432114998824
     1 | 0.5404195013662578
     1 | 0.5763752247813169
     1 | 0.8097835782400498
     1 | 1.0121970181484852
     1 |  1.135443047402157
(6 rows)

-- select atan2 with group by index having (result)
--Testcase 426:
SELECT value1, atan2(1-value3, 2) FROM s3 GROUP BY 2,1 HAVING atan2(1-value3, 2) > 0;
 value1 |       atan2        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan2 with group by index having (result)
--Testcase 427:
SELECT value1, atan2(1-value3, 2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |       atan2        
--------+--------------------
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(3 rows)

-- select atan2 and as
--Testcase 428:
SELECT atan2(value3, 2) as atan21 FROM s3;
        atan21        
----------------------
 -0.04995839646514282
 -0.09966865396652452
 -0.14888995343880235
  -0.5028432200802054
  -0.8329812774626025
  -1.0259324049385556
(6 rows)

-- select atan (stub function, explain)
--Testcase 429:
EXPLAIN VERBOSE
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3;
                                                                                                                                QUERY PLAN                                                                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4495.70 rows=3413 width=40)
   Output: (atan(value1, '2'::double precision)), (atan((value2)::double precision, '2'::double precision)), (atan(value3, '2'::double precision)), (atan((value4)::double precision, '2'::double precision)), (atan('5'::double precision, '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.atan(value1, 2::double precision), public.atan(value2, 2::double precision), public.atan(value3, 2::double precision), public.atan(value4, 2::double precision), public.atan(5::double precision, 2::double precision) FROM public.s3mysql
(4 rows)

-- select atan (stub function, result)
--Testcase 430:
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3;
        atan         |        atan        |         atan         |        atan         |        atan        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.04995839646514282 |  1.550798992821746 | -0.04995839646514282 |  -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 |  1.550798992821746 | -0.09966865396652452 |  -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 |  1.550798992821746 | -0.14888995343880235 |  -1.550798992821746 | 1.1902899496825317
  0.5028432200802054 | 1.5607966601082315 |  -0.5028432200802054 | -1.5607966601082315 | 1.1902899496825317
  0.8329812774626025 | 1.5607966601082315 |  -0.8329812774626025 | -1.5607966601082315 | 1.1902899496825317
  1.0259324049385556 | 1.5607966601082315 |  -1.0259324049385556 | -1.5607966601082315 | 1.1902899496825317
(6 rows)

-- select atan (stub function, not pushdown constraints, explain)
--Testcase 431:
EXPLAIN VERBOSE
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3 WHERE to_hex(value2) = '64';
                                                                                                                                    QUERY PLAN                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..250.53 rows=17 width=40)
   Output: (atan(value1, '2'::double precision)), (atan((value2)::double precision, '2'::double precision)), (atan(value3, '2'::double precision)), (atan((value4)::double precision, '2'::double precision)), (atan('5'::double precision, '2'::double precision))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.atan(value1, 2::double precision), public.atan(value2, 2::double precision), public.atan(value3, 2::double precision), public.atan(value4, 2::double precision), public.atan(5::double precision, 2::double precision), value2 FROM public.s3mysql
(5 rows)

-- select atan (stub function, not pushdown constraints, result)
--Testcase 432:
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3 WHERE to_hex(value2) = '64';
        atan         |       atan        |         atan         |        atan        |        atan        
---------------------+-------------------+----------------------+--------------------+--------------------
 0.04995839646514282 | 1.550798992821746 | -0.04995839646514282 | -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 | 1.550798992821746 | -0.09966865396652452 | -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 | 1.550798992821746 | -0.14888995343880235 | -1.550798992821746 | 1.1902899496825317
(3 rows)

-- select atan (stub function, pushdown constraints, explain)
--Testcase 433:
EXPLAIN VERBOSE
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3 WHERE value2 != 200;
                                                                                                                                            QUERY PLAN                                                                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4482.56 rows=3396 width=40)
   Output: (atan(value1, '2'::double precision)), (atan((value2)::double precision, '2'::double precision)), (atan(value3, '2'::double precision)), (atan((value4)::double precision, '2'::double precision)), (atan('5'::double precision, '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.atan(value1, 2::double precision), public.atan(value2, 2::double precision), public.atan(value3, 2::double precision), public.atan(value4, 2::double precision), public.atan(5::double precision, 2::double precision) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select atan (stub function, pushdown constraints, result)
--Testcase 434:
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3 WHERE value2 != 200;
        atan         |       atan        |         atan         |        atan        |        atan        
---------------------+-------------------+----------------------+--------------------+--------------------
 0.04995839646514282 | 1.550798992821746 | -0.04995839646514282 | -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 | 1.550798992821746 | -0.09966865396652452 | -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 | 1.550798992821746 | -0.14888995343880235 | -1.550798992821746 | 1.1902899496825317
(3 rows)

-- select atan (stub function, atan in constraints, explain)
--Testcase 435:
EXPLAIN VERBOSE
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3 WHERE atan(value1, 2) != 1;
                                                                                                                                                                     QUERY PLAN                                                                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..5335.81 rows=3396 width=40)
   Output: (atan(value1, '2'::double precision)), (atan((value2)::double precision, '2'::double precision)), (atan(value3, '2'::double precision)), (atan((value4)::double precision, '2'::double precision)), (atan('5'::double precision, '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.atan(value1, 2::double precision), public.atan(value2, 2::double precision), public.atan(value3, 2::double precision), public.atan(value4, 2::double precision), public.atan(5::double precision, 2::double precision) FROM public.s3mysql WHERE ((public.atan(value1, 2::double precision) <> 1::double precision))
(4 rows)

-- select atan (stub function, atan in constraints, result)
--Testcase 436:
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3 WHERE atan(value1, 2) != 1;
        atan         |        atan        |         atan         |        atan         |        atan        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.04995839646514282 |  1.550798992821746 | -0.04995839646514282 |  -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 |  1.550798992821746 | -0.09966865396652452 |  -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 |  1.550798992821746 | -0.14888995343880235 |  -1.550798992821746 | 1.1902899496825317
  0.5028432200802054 | 1.5607966601082315 |  -0.5028432200802054 | -1.5607966601082315 | 1.1902899496825317
  0.8329812774626025 | 1.5607966601082315 |  -0.8329812774626025 | -1.5607966601082315 | 1.1902899496825317
  1.0259324049385556 | 1.5607966601082315 |  -1.0259324049385556 | -1.5607966601082315 | 1.1902899496825317
(6 rows)

-- select atan (stub function, atan in constraints, explain)
--Testcase 437:
EXPLAIN VERBOSE
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3 WHERE atan(5, 2) > value1;
                                                                                                                                                                    QUERY PLAN                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2456.86 rows=1138 width=40)
   Output: (atan(value1, '2'::double precision)), (atan((value2)::double precision, '2'::double precision)), (atan(value3, '2'::double precision)), (atan((value4)::double precision, '2'::double precision)), (atan('5'::double precision, '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.atan(value1, 2::double precision), public.atan(value2, 2::double precision), public.atan(value3, 2::double precision), public.atan(value4, 2::double precision), public.atan(5::double precision, 2::double precision) FROM public.s3mysql WHERE ((public.atan(5::double precision, 2::double precision) > value1))
(4 rows)

-- select atan (stub function, atan in constraints, result)
--Testcase 438:
SELECT atan(value1, 2), atan(value2, 2), atan(value3, 2), atan(value4, 2), atan(5, 2) FROM s3 WHERE atan(5, 2) > value1;
        atan         |        atan        |         atan         |        atan         |        atan        
---------------------+--------------------+----------------------+---------------------+--------------------
 0.04995839646514282 |  1.550798992821746 | -0.04995839646514282 |  -1.550798992821746 | 1.1902899496825317
 0.09966865396652452 |  1.550798992821746 | -0.09966865396652452 |  -1.550798992821746 | 1.1902899496825317
 0.14888995343880235 |  1.550798992821746 | -0.14888995343880235 |  -1.550798992821746 | 1.1902899496825317
  0.5028432200802054 | 1.5607966601082315 |  -0.5028432200802054 | -1.5607966601082315 | 1.1902899496825317
(4 rows)

-- select atan as nest function with agg (pushdown, explain)
--Testcase 439:
EXPLAIN VERBOSE
SELECT sum(value3),atan(sum(value3), 2) FROM s3;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (atan(sum(value3), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), public.atan(sum(value3), 2::double precision) FROM public.s3mysql
(6 rows)

-- select atan as nest function with agg (pushdown, result)
--Testcase 440:
SELECT sum(value3),atan(sum(value3), 2) FROM s3;
        sum         |        atan        
--------------------+--------------------
 -7.200000040233135 | -1.299849477897491
(1 row)

-- select atan as nest with log2 (pushdown, explain)
--Testcase 441:
EXPLAIN VERBOSE
SELECT atan(log2(value1), 2),atan(log2(1/value1), 2) FROM s3;
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3633.92 rows=3413 width=16)
   Output: (atan(log2(value1), '2'::double precision)), (atan(log2(('1'::double precision / value1)), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.atan(public.log2(value1), 2::double precision), public.atan(public.log2((1::double precision / value1)), 2::double precision) FROM public.s3mysql
(4 rows)

-- select atan as nest with log2 (pushdown, result)
--Testcase 442:
SELECT atan(log2(value1), 2),atan(log2(1/value1), 2) FROM s3;
        atan         |         atan         
---------------------+----------------------
 -1.0288635006528577 |   1.0288635006528577
  -0.859748003088039 |    0.859748003088039
  -0.715126880832206 |    0.715126880832206
 0.06864375823738518 | -0.06864375823738515
  0.5171258967180242 |  -0.5171258967180242
  0.7109793602585378 |  -0.7109793602585378
(6 rows)

-- select atan with non pushdown func and atanlicit constant (explain)
--Testcase 443:
EXPLAIN VERBOSE
SELECT atan(value3, 2), pi(), 4.1 FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=48)
   Output: (atan(value3, '2'::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.atan(value3, 2::double precision), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select atan with non pushdown func and atanlicit constant (result)
--Testcase 444:
SELECT atan(value3, 2), pi(), 4.1 FROM s3;
         atan         |        pi         | ?column? 
----------------------+-------------------+----------
 -0.04995839646514282 | 3.141592653589793 |      4.1
 -0.09966865396652452 | 3.141592653589793 |      4.1
 -0.14888995343880235 | 3.141592653589793 |      4.1
  -0.5028432200802054 | 3.141592653589793 |      4.1
  -0.8329812774626025 | 3.141592653589793 |      4.1
  -1.0259324049385556 | 3.141592653589793 |      4.1
(6 rows)

-- select atan with order by (explain)
--Testcase 445:
EXPLAIN VERBOSE
SELECT value1, atan(1-value3, 2) FROM s3 ORDER BY atan(1-value3, 2);
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=16)
   Output: value1, (atan(('1'::double precision - value3), '2'::double precision))
   Sort Key: (atan(('1'::double precision - s3.value3), '2'::double precision))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=16)
         Output: value1, (atan(('1'::double precision - value3), '2'::double precision))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.atan((1::double precision - value3), 2::double precision) FROM public.s3mysql
(7 rows)

-- select atan with order by (result)
--Testcase 446:
SELECT value1, atan(1-value3, 2) FROM s3 ORDER BY atan(1-value3, 2);
 value1 |        atan        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan with order by index (result)
--Testcase 447:
SELECT value1, atan(1-value3, 2) FROM s3 ORDER BY 2,1;
 value1 |        atan        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan with order by index (result)
--Testcase 448:
SELECT value1, atan(1-value3, 2) FROM s3 ORDER BY 1,2;
 value1 |        atan        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan with group by (explain)
--Testcase 449:
EXPLAIN VERBOSE
SELECT count(value1), atan(1-value3, 2) FROM s3 GROUP BY atan(1-value3, 2);
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (atan(('1'::double precision - value3), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.atan((1::double precision - value3), 2::double precision) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select atan with group by (result)
--Testcase 450:
SELECT count(value1), atan(1-value3, 2) FROM s3 GROUP BY atan(1-value3, 2);
 count |        atan        
-------+--------------------
     1 | 0.5028432114998824
     1 | 0.5404195013662578
     1 | 0.5763752247813169
     1 | 0.8097835782400498
     1 | 1.0121970181484852
     1 |  1.135443047402157
(6 rows)

-- select atan with group by index (result)
--Testcase 451:
SELECT value1, atan(1-value3, 2) FROM s3 GROUP BY 2,1;
 value1 |        atan        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan with group by index (result)
--Testcase 452:
SELECT value1, atan(1-value3, 2) FROM s3 GROUP BY 1,2;
 value1 |        atan        
--------+--------------------
    0.1 | 0.5028432114998824
    0.2 | 0.5404195013662578
    0.3 | 0.5763752247813169
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(6 rows)

-- select atan with group by having (explain)
--Testcase 453:
EXPLAIN VERBOSE
SELECT count(value1), atan(1-value3, 2) FROM s3 GROUP BY atan(1-value3, 2) HAVING avg(value1) > 0;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (atan(('1'::double precision - value3), '2'::double precision))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.atan((1::double precision - value3), 2::double precision), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select atan with group by having (result)
--Testcase 454:
SELECT count(value1), atan(1-value3, 2) FROM s3 GROUP BY atan(1-value3, 2) HAVING avg(value1) > 0;
 count |        atan        
-------+--------------------
     1 | 0.5028432114998824
     1 | 0.5404195013662578
     1 | 0.5763752247813169
     1 | 0.8097835782400498
     1 | 1.0121970181484852
     1 |  1.135443047402157
(6 rows)

-- select atan with group by index having (result)
--Testcase 455:
SELECT value3, atan(1-value3, 2) FROM s3 GROUP BY 2,1 HAVING atan(1-value3, 2) > 0;
 value3 |        atan        
--------+--------------------
   -0.1 | 0.5028432114998824
   -0.2 | 0.5404195013662578
   -0.3 | 0.5763752247813169
   -1.1 | 0.8097835782400498
   -2.2 | 1.0121970181484852
   -3.3 |  1.135443047402157
(6 rows)

-- select atan with group by index having (result)
--Testcase 456:
SELECT value1, atan(1-value3, 2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |        atan        
--------+--------------------
    1.1 | 0.8097835782400498
    2.2 | 1.0121970181484852
    3.3 |  1.135443047402157
(3 rows)

-- select atan and as
--Testcase 457:
SELECT atan(value3, 2) as atan1 FROM s3;
        atan1         
----------------------
 -0.04995839646514282
 -0.09966865396652452
 -0.14888995343880235
  -0.5028432200802054
  -0.8329812774626025
  -1.0259324049385556
(6 rows)

-- select ceil (builtin function, explain)
--Testcase 458:
EXPLAIN VERBOSE
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=64)
   Output: (ceil(value1)), (ceil((value2)::double precision)), (ceil(value3)), (ceil((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), 1::numeric FROM public.s3mysql
(4 rows)

-- select ceil (builtin function, result)
--Testcase 459:
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3;
 ceil | ceil | ceil | ceil | ceil 
------+------+------+------+------
    1 |  100 |   -0 | -100 |    1
    1 |  100 |   -0 | -100 |    1
    1 |  100 |   -0 | -100 |    1
    2 |  200 |   -1 | -200 |    1
    3 |  200 |   -2 | -200 |    1
    4 |  200 |   -3 | -200 |    1
(6 rows)

-- select ceil (builtin function, not pushdown constraints, explain)
--Testcase 460:
EXPLAIN VERBOSE
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=64)
   Output: (ceil(value1)), (ceil((value2)::double precision)), (ceil(value3)), (ceil((value4)::double precision)), '1'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), 1::numeric, value2 FROM public.s3mysql
(5 rows)

-- select ceil (builtin function, not pushdown constraints, result)
--Testcase 461:
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3 WHERE to_hex(value2) = '64';
 ceil | ceil | ceil | ceil | ceil 
------+------+------+------+------
    1 |  100 |   -0 | -100 |    1
    1 |  100 |   -0 | -100 |    1
    1 |  100 |   -0 | -100 |    1
(3 rows)

-- select ceil (builtin function, pushdown constraints, explain)
--Testcase 462:
EXPLAIN VERBOSE
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3 WHERE value2 != 200;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=64)
   Output: (ceil(value1)), (ceil((value2)::double precision)), (ceil(value3)), (ceil((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), 1::numeric FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select ceil (builtin function, pushdown constraints, result)
--Testcase 463:
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3 WHERE value2 != 200;
 ceil | ceil | ceil | ceil | ceil 
------+------+------+------+------
    1 |  100 |   -0 | -100 |    1
    1 |  100 |   -0 | -100 |    1
    1 |  100 |   -0 | -100 |    1
(3 rows)

-- select ceil (builtin function, ceil in constraints, explain)
--Testcase 464:
EXPLAIN VERBOSE
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3 WHERE ceil(value1) != 1;
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=64)
   Output: (ceil(value1)), (ceil((value2)::double precision)), (ceil(value3)), (ceil((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), 1::numeric FROM public.s3mysql WHERE ((ceil(value1) <> 1::double precision))
(4 rows)

-- select ceil (builtin function, ceil in constraints, result)
--Testcase 465:
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3 WHERE ceil(value1) != 1;
 ceil | ceil | ceil | ceil | ceil 
------+------+------+------+------
    2 |  200 |   -1 | -200 |    1
    3 |  200 |   -2 | -200 |    1
    4 |  200 |   -3 | -200 |    1
(3 rows)

-- select ceil (builtin function, ceil in constraints, explain)
--Testcase 466:
EXPLAIN VERBOSE
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3 WHERE ceil(0.5) > value1;
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=64)
   Output: (ceil(value1)), (ceil((value2)::double precision)), (ceil(value3)), (ceil((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), 1::numeric FROM public.s3mysql WHERE ((1::double precision > value1))
(4 rows)

-- select ceil (builtin function, ceil in constraints, result)
--Testcase 467:
SELECT ceil(value1), ceil(value2), ceil(value3), ceil(value4), ceil(0.5) FROM s3 WHERE ceil(0.5) > value1;
 ceil | ceil | ceil | ceil | ceil 
------+------+------+------+------
    1 |  100 |   -0 | -100 |    1
    1 |  100 |   -0 | -100 |    1
    1 |  100 |   -0 | -100 |    1
(3 rows)

-- select ceil as nest function with agg (pushdown, explain)
--Testcase 468:
EXPLAIN VERBOSE
SELECT sum(value3),ceil(sum(value3)) FROM s3;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (ceil(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), ceil(sum(value3)) FROM public.s3mysql
(6 rows)

-- select ceil as nest function with agg (pushdown, result)
--Testcase 469:
SELECT sum(value3),ceil(sum(value3)) FROM s3;
        sum         | ceil 
--------------------+------
 -7.200000040233135 |   -7
(1 row)

-- select ceil as nest with log2 (pushdown, explain)
--Testcase 470:
EXPLAIN VERBOSE
SELECT ceil(log2(value1)),ceil(log2(1/value1)) FROM s3;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (ceil(log2(value1))), (ceil(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceil(public.log2(value1)), ceil(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select ceil as nest with log2 (pushdown, result)
--Testcase 471:
SELECT ceil(log2(value1)),ceil(log2(1/value1)) FROM s3;
 ceil | ceil 
------+------
   -3 |    4
   -2 |    3
   -1 |    2
    1 |   -0
    2 |   -1
    2 |   -1
(6 rows)

-- select ceil with non pushdown func and explicit constant (explain)
--Testcase 472:
EXPLAIN VERBOSE
SELECT ceil(value3), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (ceil(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceil(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select ceil with non pushdown func and explicit constant (result)
--Testcase 473:
SELECT ceil(value3), pi(), 4.1 FROM s3;
 ceil |        pi         | ?column? 
------+-------------------+----------
   -0 | 3.141592653589793 |      4.1
   -0 | 3.141592653589793 |      4.1
   -0 | 3.141592653589793 |      4.1
   -1 | 3.141592653589793 |      4.1
   -2 | 3.141592653589793 |      4.1
   -3 | 3.141592653589793 |      4.1
(6 rows)

-- select ceil with order by (explain)
--Testcase 474:
EXPLAIN VERBOSE
SELECT value1, ceil(1-value3) FROM s3 ORDER BY ceil(1-value3);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (ceil(('1'::double precision - value3)))
   Sort Key: (ceil(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (ceil(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, ceil((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select ceil with order by (result)
--Testcase 475:
SELECT value1, ceil(1-value3) FROM s3 ORDER BY ceil(1-value3);
 value1 | ceil 
--------+------
    0.1 |    2
    0.2 |    2
    0.3 |    2
    1.1 |    3
    2.2 |    4
    3.3 |    5
(6 rows)

-- select ceil with order by index (result)
--Testcase 476:
SELECT value1, ceil(1-value3) FROM s3 ORDER BY 2,1;
 value1 | ceil 
--------+------
    0.1 |    2
    0.2 |    2
    0.3 |    2
    1.1 |    3
    2.2 |    4
    3.3 |    5
(6 rows)

-- select ceil with order by index (result)
--Testcase 477:
SELECT value1, ceil(1-value3) FROM s3 ORDER BY 1,2;
 value1 | ceil 
--------+------
    0.1 |    2
    0.2 |    2
    0.3 |    2
    1.1 |    3
    2.2 |    4
    3.3 |    5
(6 rows)

-- select ceil with group by (explain)
--Testcase 478:
EXPLAIN VERBOSE
SELECT value1, ceil(1-value3) FROM s3 GROUP BY value1, ceil(1-value3);
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (ceil(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, ceil((1::double precision - value3)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select ceil with group by (result)
--Testcase 479:
SELECT value1, ceil(1-value3) FROM s3 GROUP BY value1, ceil(1-value3);
 value1 | ceil 
--------+------
    0.1 |    2
    0.2 |    2
    0.3 |    2
    1.1 |    3
    2.2 |    4
    3.3 |    5
(6 rows)

-- select ceil with group by index (result)
--Testcase 480:
SELECT value1, ceil(1-value3) FROM s3 GROUP BY 2,1;
 value1 | ceil 
--------+------
    0.1 |    2
    0.2 |    2
    0.3 |    2
    1.1 |    3
    2.2 |    4
    3.3 |    5
(6 rows)

-- select ceil with group by index (result)
--Testcase 481:
SELECT value1, ceil(1-value3) FROM s3 GROUP BY 1,2;
 value1 | ceil 
--------+------
    0.1 |    2
    0.2 |    2
    0.3 |    2
    1.1 |    3
    2.2 |    4
    3.3 |    5
(6 rows)

-- select ceil with group by having (explain)
--Testcase 482:
EXPLAIN VERBOSE
SELECT value1, ceil(1-value3) FROM s3 GROUP BY value1, ceil(1-value3) HAVING ceil(avg(value1)) > 0;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (ceil(('1'::double precision - value3)))
   Filter: (ceil((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, ceil((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select ceil with group by having (result)
--Testcase 483:
SELECT value1, ceil(1-value3) FROM s3 GROUP BY value1, ceil(1-value3) HAVING ceil(avg(value1)) > 0;
 value1 | ceil 
--------+------
    0.1 |    2
    0.2 |    2
    0.3 |    2
    1.1 |    3
    2.2 |    4
    3.3 |    5
(6 rows)

-- select ceil with group by index having (result)
--Testcase 484:
SELECT value1, ceil(1-value3) FROM s3 GROUP BY 2,1 HAVING ceil(1-value3) > 0;
 value1 | ceil 
--------+------
    0.1 |    2
    0.2 |    2
    0.3 |    2
    1.1 |    3
    2.2 |    4
    3.3 |    5
(6 rows)

-- select ceil with group by index having (result)
--Testcase 485:
SELECT value1, ceil(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | ceil 
--------+------
    1.1 |    3
    2.2 |    4
    3.3 |    5
(3 rows)

-- select ceil and as
--Testcase 486:
SELECT ceil(value3) as ceil1 FROM s3;
 ceil1 
-------
    -0
    -0
    -0
    -1
    -2
    -3
(6 rows)

-- select ceiling (builtin function, explain)
--Testcase 487:
EXPLAIN VERBOSE
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=64)
   Output: (ceiling(value1)), (ceiling((value2)::double precision)), (ceiling(value3)), (ceiling((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), 1::numeric FROM public.s3mysql
(4 rows)

-- select ceiling (builtin function, result)
--Testcase 488:
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3;
 ceiling | ceiling | ceiling | ceiling | ceiling 
---------+---------+---------+---------+---------
       1 |     100 |      -0 |    -100 |       1
       1 |     100 |      -0 |    -100 |       1
       1 |     100 |      -0 |    -100 |       1
       2 |     200 |      -1 |    -200 |       1
       3 |     200 |      -2 |    -200 |       1
       4 |     200 |      -3 |    -200 |       1
(6 rows)

-- select ceiling (builtin function, not pushdown constraints, explain)
--Testcase 489:
EXPLAIN VERBOSE
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=64)
   Output: (ceiling(value1)), (ceiling((value2)::double precision)), (ceiling(value3)), (ceiling((value4)::double precision)), '1'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), 1::numeric, value2 FROM public.s3mysql
(5 rows)

-- select ceiling (builtin function, not pushdown constraints, result)
--Testcase 490:
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3 WHERE to_hex(value2) = '64';
 ceiling | ceiling | ceiling | ceiling | ceiling 
---------+---------+---------+---------+---------
       1 |     100 |      -0 |    -100 |       1
       1 |     100 |      -0 |    -100 |       1
       1 |     100 |      -0 |    -100 |       1
(3 rows)

-- select ceiling (builtin function, pushdown constraints, explain)
--Testcase 491:
EXPLAIN VERBOSE
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3 WHERE value2 != 200;
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=64)
   Output: (ceiling(value1)), (ceiling((value2)::double precision)), (ceiling(value3)), (ceiling((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), 1::numeric FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select ceiling (builtin function, pushdown constraints, result)
--Testcase 492:
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3 WHERE value2 != 200;
 ceiling | ceiling | ceiling | ceiling | ceiling 
---------+---------+---------+---------+---------
       1 |     100 |      -0 |    -100 |       1
       1 |     100 |      -0 |    -100 |       1
       1 |     100 |      -0 |    -100 |       1
(3 rows)

-- select ceiling (builtin function, ceiling in constraints, explain)
--Testcase 493:
EXPLAIN VERBOSE
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3 WHERE ceiling(value1) != 1;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=64)
   Output: (ceiling(value1)), (ceiling((value2)::double precision)), (ceiling(value3)), (ceiling((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), 1::numeric FROM public.s3mysql WHERE ((ceiling(value1) <> 1::double precision))
(4 rows)

-- select ceiling (builtin function, ceiling in constraints, result)
--Testcase 494:
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3 WHERE ceiling(value1) != 1;
 ceiling | ceiling | ceiling | ceiling | ceiling 
---------+---------+---------+---------+---------
       2 |     200 |      -1 |    -200 |       1
       3 |     200 |      -2 |    -200 |       1
       4 |     200 |      -3 |    -200 |       1
(3 rows)

-- select ceiling (builtin function, ceiling in constraints, explain)
--Testcase 495:
EXPLAIN VERBOSE
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3 WHERE ceiling(0.5) > value1;
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=64)
   Output: (ceiling(value1)), (ceiling((value2)::double precision)), (ceiling(value3)), (ceiling((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), 1::numeric FROM public.s3mysql WHERE ((1::double precision > value1))
(4 rows)

-- select ceiling (builtin function, ceiling in constraints, result)
--Testcase 496:
SELECT ceiling(value1), ceiling(value2), ceiling(value3), ceiling(value4), ceiling(0.5) FROM s3 WHERE ceiling(0.5) > value1;
 ceiling | ceiling | ceiling | ceiling | ceiling 
---------+---------+---------+---------+---------
       1 |     100 |      -0 |    -100 |       1
       1 |     100 |      -0 |    -100 |       1
       1 |     100 |      -0 |    -100 |       1
(3 rows)

-- select ceiling as nest function with agg (pushdown, explain)
--Testcase 497:
EXPLAIN VERBOSE
SELECT sum(value3),ceiling(sum(value3)) FROM s3;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (ceiling(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), ceiling(sum(value3)) FROM public.s3mysql
(6 rows)

-- select ceiling as nest function with agg (pushdown, result)
--Testcase 498:
SELECT sum(value3),ceiling(sum(value3)) FROM s3;
        sum         | ceiling 
--------------------+---------
 -7.200000040233135 |      -7
(1 row)

-- select ceiling as nest with log2 (pushdown, explain)
--Testcase 499:
EXPLAIN VERBOSE
SELECT ceiling(log2(value1)),ceiling(log2(1/value1)) FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (ceiling(log2(value1))), (ceiling(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceiling(public.log2(value1)), ceiling(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select ceiling as nest with log2 (pushdown, result)
--Testcase 500:
SELECT ceiling(log2(value1)),ceiling(log2(1/value1)) FROM s3;
 ceiling | ceiling 
---------+---------
      -3 |       4
      -2 |       3
      -1 |       2
       1 |      -0
       2 |      -1
       2 |      -1
(6 rows)

-- select ceiling with non pushdown func and explicit constant (explain)
--Testcase 501:
EXPLAIN VERBOSE
SELECT ceiling(value3), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (ceiling(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ceiling(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select ceiling with non pushdown func and explicit constant (result)
--Testcase 502:
SELECT ceiling(value3), pi(), 4.1 FROM s3;
 ceiling |        pi         | ?column? 
---------+-------------------+----------
      -0 | 3.141592653589793 |      4.1
      -0 | 3.141592653589793 |      4.1
      -0 | 3.141592653589793 |      4.1
      -1 | 3.141592653589793 |      4.1
      -2 | 3.141592653589793 |      4.1
      -3 | 3.141592653589793 |      4.1
(6 rows)

-- select ceiling with order by (explain)
--Testcase 503:
EXPLAIN VERBOSE
SELECT value1, ceiling(1-value3) FROM s3 ORDER BY ceiling(1-value3);
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (ceiling(('1'::double precision - value3)))
   Sort Key: (ceiling(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (ceiling(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, ceiling((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select ceiling with order by (result)
--Testcase 504:
SELECT value1, ceiling(1-value3) FROM s3 ORDER BY ceiling(1-value3);
 value1 | ceiling 
--------+---------
    0.1 |       2
    0.2 |       2
    0.3 |       2
    1.1 |       3
    2.2 |       4
    3.3 |       5
(6 rows)

-- select ceiling with order by index (result)
--Testcase 505:
SELECT value1, ceiling(1-value3) FROM s3 ORDER BY 2,1;
 value1 | ceiling 
--------+---------
    0.1 |       2
    0.2 |       2
    0.3 |       2
    1.1 |       3
    2.2 |       4
    3.3 |       5
(6 rows)

-- select ceiling with order by index (result)
--Testcase 506:
SELECT value1, ceiling(1-value3) FROM s3 ORDER BY 1,2;
 value1 | ceiling 
--------+---------
    0.1 |       2
    0.2 |       2
    0.3 |       2
    1.1 |       3
    2.2 |       4
    3.3 |       5
(6 rows)

-- select ceiling with group by (explain)
--Testcase 507:
EXPLAIN VERBOSE
SELECT count(value1), ceiling(1-value3) FROM s3 GROUP BY ceiling(1-value3);
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (ceiling(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), ceiling((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select ceiling with group by (result)
--Testcase 508:
SELECT count(value1), ceiling(1-value3) FROM s3 GROUP BY ceiling(1-value3);
 count | ceiling 
-------+---------
     3 |       2
     1 |       3
     1 |       4
     1 |       5
(4 rows)

-- select ceiling with group by index (result)
--Testcase 509:
SELECT value1, ceiling(1-value3) FROM s3 GROUP BY 2,1;
 value1 | ceiling 
--------+---------
    0.1 |       2
    0.2 |       2
    0.3 |       2
    1.1 |       3
    2.2 |       4
    3.3 |       5
(6 rows)

-- select ceiling with group by index (result)
--Testcase 510:
SELECT value1, ceiling(1-value3) FROM s3 GROUP BY 1,2;
 value1 | ceiling 
--------+---------
    0.1 |       2
    0.2 |       2
    0.3 |       2
    1.1 |       3
    2.2 |       4
    3.3 |       5
(6 rows)

-- select ceiling with group by having (explain)
--Testcase 511:
EXPLAIN VERBOSE
SELECT count(value1), ceiling(1-value3) FROM s3 GROUP BY ceiling(1-value3) HAVING ceiling(avg(value1)) > 0;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (ceiling(('1'::double precision - value3)))
   Filter: (ceiling((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), ceiling((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select ceiling with group by having (result)
--Testcase 512:
SELECT count(value1), ceiling(1-value3) FROM s3 GROUP BY ceiling(1-value3) HAVING ceiling(avg(value1)) > 0;
 count | ceiling 
-------+---------
     3 |       2
     1 |       3
     1 |       4
     1 |       5
(4 rows)

-- select ceiling with group by index having (result)
--Testcase 513:
SELECT value1, ceiling(1-value3) FROM s3 GROUP BY 2,1 HAVING ceiling(1-value3) > 0;
 value1 | ceiling 
--------+---------
    0.1 |       2
    0.2 |       2
    0.3 |       2
    1.1 |       3
    2.2 |       4
    3.3 |       5
(6 rows)

-- select ceiling with group by index having (result)
--Testcase 514:
SELECT value1, ceiling(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | ceiling 
--------+---------
    1.1 |       3
    2.2 |       4
    3.3 |       5
(3 rows)

-- select ceiling and as
--Testcase 515:
SELECT ceiling(value3) as ceiling1 FROM s3;
 ceiling1 
----------
       -0
       -0
       -0
       -1
       -2
       -3
(6 rows)

-- select cos (builtin function, explain)
--Testcase 516:
EXPLAIN VERBOSE
SELECT value1, cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..255.05 rows=3413 width=40)
   Output: value1, (cos((value2)::double precision)), (cos(value3)), (cos((value4)::double precision)), '0.8775825618903728'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, cos(value2), cos(value3), cos(value4), 0.8775825618903728::double precision FROM public.s3mysql
(4 rows)

-- select cos (builtin function, result)
--Testcase 517:
SELECT value1, cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3;
 value1 |         cos         |         cos         |         cos         |        cos         
--------+---------------------+---------------------+---------------------+--------------------
    0.1 |  0.8623188722876839 |  0.9950041651292624 |  0.8623188722876839 | 0.8775825618903728
    0.2 |  0.8623188722876839 |  0.9800665772491609 |  0.8623188722876839 | 0.8775825618903728
    0.3 |  0.8623188722876839 |  0.9553364856027305 |  0.8623188722876839 | 0.8775825618903728
    1.1 | 0.48718767500700594 |   0.453596100177538 | 0.48718767500700594 | 0.8775825618903728
    2.2 | 0.48718767500700594 | -0.5885011558074578 | 0.48718767500700594 | 0.8775825618903728
    3.3 | 0.48718767500700594 | -0.9874797774307646 | 0.48718767500700594 | 0.8775825618903728
(6 rows)

-- select cos (builtin function, not pushdown constraints, explain)
--Testcase 518:
EXPLAIN VERBOSE
SELECT cos(value1), cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (cos(value1)), (cos((value2)::double precision)), (cos(value3)), (cos((value4)::double precision)), '0.8775825618903728'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT cos(value1), cos(value2), cos(value3), cos(value4), 0.8775825618903728::double precision, value2 FROM public.s3mysql
(5 rows)

-- select cos (builtin function, not pushdown constraints, result)
--Testcase 519:
SELECT cos(value1), cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3 WHERE to_hex(value2) = '64';
        cos         |        cos         |        cos         |        cos         |        cos         
--------------------+--------------------+--------------------+--------------------+--------------------
 0.9950041651292624 | 0.8623188722876839 | 0.9950041651292624 | 0.8623188722876839 | 0.8775825618903728
 0.9800665772491609 | 0.8623188722876839 | 0.9800665772491609 | 0.8623188722876839 | 0.8775825618903728
 0.9553364856027305 | 0.8623188722876839 | 0.9553364856027305 | 0.8623188722876839 | 0.8775825618903728
(3 rows)

-- select cos (builtin function, pushdown constraints, explain)
--Testcase 520:
EXPLAIN VERBOSE
SELECT cos(value1), cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3 WHERE value2 != 200;
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (cos(value1)), (cos((value2)::double precision)), (cos(value3)), (cos((value4)::double precision)), '0.8775825618903728'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT cos(value1), cos(value2), cos(value3), cos(value4), 0.8775825618903728::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select cos (builtin function, pushdown constraints, result)
--Testcase 521:
SELECT cos(value1), cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3 WHERE value2 != 200;
        cos         |        cos         |        cos         |        cos         |        cos         
--------------------+--------------------+--------------------+--------------------+--------------------
 0.9950041651292624 | 0.8623188722876839 | 0.9950041651292624 | 0.8623188722876839 | 0.8775825618903728
 0.9800665772491609 | 0.8623188722876839 | 0.9800665772491609 | 0.8623188722876839 | 0.8775825618903728
 0.9553364856027305 | 0.8623188722876839 | 0.9553364856027305 | 0.8623188722876839 | 0.8775825618903728
(3 rows)

-- select cos (builtin function, cos in constraints, explain)
--Testcase 522:
EXPLAIN VERBOSE
SELECT value1, cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3 WHERE cos(value1) != 1;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.56 rows=3396 width=40)
   Output: value1, (cos((value2)::double precision)), (cos(value3)), (cos((value4)::double precision)), '0.8775825618903728'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, cos(value2), cos(value3), cos(value4), 0.8775825618903728::double precision FROM public.s3mysql WHERE ((cos(value1) <> 1::double precision))
(4 rows)

-- select cos (builtin function, cos in constraints, result)
--Testcase 523:
SELECT value1, cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3 WHERE cos(value1) != 1;
 value1 |         cos         |         cos         |         cos         |        cos         
--------+---------------------+---------------------+---------------------+--------------------
    0.1 |  0.8623188722876839 |  0.9950041651292624 |  0.8623188722876839 | 0.8775825618903728
    0.2 |  0.8623188722876839 |  0.9800665772491609 |  0.8623188722876839 | 0.8775825618903728
    0.3 |  0.8623188722876839 |  0.9553364856027305 |  0.8623188722876839 | 0.8775825618903728
    1.1 | 0.48718767500700594 |   0.453596100177538 | 0.48718767500700594 | 0.8775825618903728
    2.2 | 0.48718767500700594 | -0.5885011558074578 | 0.48718767500700594 | 0.8775825618903728
    3.3 | 0.48718767500700594 | -0.9874797774307646 | 0.48718767500700594 | 0.8775825618903728
(6 rows)

-- select cos (builtin function, cos in constraints, explain)
--Testcase 524:
EXPLAIN VERBOSE
SELECT cos(value1), cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3 WHERE cos(0.5) > value1;
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=40)
   Output: (cos(value1)), (cos((value2)::double precision)), (cos(value3)), (cos((value4)::double precision)), '0.8775825618903728'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT cos(value1), cos(value2), cos(value3), cos(value4), 0.8775825618903728::double precision FROM public.s3mysql WHERE ((0.8775825618903728::double precision > value1))
(4 rows)

-- select cos (builtin function, cos in constraints, result)
--Testcase 525:
SELECT cos(value1), cos(value2), cos(value3), cos(value4), cos(0.5) FROM s3 WHERE cos(0.5) > value1;
        cos         |        cos         |        cos         |        cos         |        cos         
--------------------+--------------------+--------------------+--------------------+--------------------
 0.9950041651292624 | 0.8623188722876839 | 0.9950041651292624 | 0.8623188722876839 | 0.8775825618903728
 0.9800665772491609 | 0.8623188722876839 | 0.9800665772491609 | 0.8623188722876839 | 0.8775825618903728
 0.9553364856027305 | 0.8623188722876839 | 0.9553364856027305 | 0.8623188722876839 | 0.8775825618903728
(3 rows)

-- select cos as nest function with agg (pushdown, explain)
--Testcase 526:
EXPLAIN VERBOSE
SELECT sum(value3),cos(sum(value3)) FROM s3;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (cos(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), cos(sum(value3)) FROM public.s3mysql
(6 rows)

-- select cos as nest function with agg (pushdown, result)
--Testcase 527:
SELECT sum(value3),cos(sum(value3)) FROM s3;
        sum         |        cos         
--------------------+--------------------
 -7.200000040233135 | 0.6083512826005076
(1 row)

-- select cos as nest with log2 (pushdown, explain)
--Testcase 528:
EXPLAIN VERBOSE
SELECT value1, cos(log2(value1)),cos(log2(1/value1)) FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (cos(log2(value1))), (cos(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, cos(public.log2(value1)), cos(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select cos as nest with log2 (pushdown, result)
--Testcase 529:
SELECT value1, cos(log2(value1)),cos(log2(1/value1)) FROM s3;
 value1 |         cos          |         cos          
--------+----------------------+----------------------
    0.1 |  -0.9837835873812056 |  -0.9837835873812056
    0.2 |  -0.6824664096936612 |  -0.6824664096936612
    0.3 |   -0.165405548705388 | -0.16540554870538823
    1.1 |   0.9905612719298578 |   0.9905612719298578
    2.2 |   0.4198615538592954 |   0.4198615538592954
    3.3 | -0.15108885156202348 | -0.15108885156202326
(6 rows)

-- select cos with non pushdown func and explicit constant (explain)
--Testcase 530:
EXPLAIN VERBOSE
SELECT cos(value3), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (cos(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT cos(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select cos with non pushdown func and explicit constant (result)
--Testcase 531:
SELECT cos(value3), pi(), 4.1 FROM s3;
         cos         |        pi         | ?column? 
---------------------+-------------------+----------
  0.9950041651292624 | 3.141592653589793 |      4.1
  0.9800665772491609 | 3.141592653589793 |      4.1
  0.9553364856027305 | 3.141592653589793 |      4.1
   0.453596100177538 | 3.141592653589793 |      4.1
 -0.5885011558074578 | 3.141592653589793 |      4.1
 -0.9874797774307646 | 3.141592653589793 |      4.1
(6 rows)

-- select cos with order by (explain)
--Testcase 532:
EXPLAIN VERBOSE
SELECT value1, cos(1-value3) FROM s3 ORDER BY cos(1-value3);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (cos(('1'::double precision - value3)))
   Sort Key: (cos(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (cos(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, cos((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select cos with order by (result)
--Testcase 533:
SELECT value1, cos(1-value3) FROM s3 ORDER BY cos(1-value3);
 value1 |         cos         
--------+---------------------
    2.2 | -0.9982947730112559
    1.1 | -0.5048461251803724
    3.3 |  -0.400799215766171
    0.3 |  0.2674988171380787
    0.2 | 0.36235775169898066
    0.1 | 0.45359612009757494
(6 rows)

-- select cos with order by index (result)
--Testcase 534:
SELECT value1, cos(1-value3) FROM s3 ORDER BY 2,1;
 value1 |         cos         
--------+---------------------
    2.2 | -0.9982947730112559
    1.1 | -0.5048461251803724
    3.3 |  -0.400799215766171
    0.3 |  0.2674988171380787
    0.2 | 0.36235775169898066
    0.1 | 0.45359612009757494
(6 rows)

-- select cos with order by index (result)
--Testcase 535:
SELECT value1, cos(1-value3) FROM s3 ORDER BY 1,2;
 value1 |         cos         
--------+---------------------
    0.1 | 0.45359612009757494
    0.2 | 0.36235775169898066
    0.3 |  0.2674988171380787
    1.1 | -0.5048461251803724
    2.2 | -0.9982947730112559
    3.3 |  -0.400799215766171
(6 rows)

-- select cos with group by (explain)
--Testcase 536:
EXPLAIN VERBOSE
SELECT value1, cos(1-value3) FROM s3 GROUP BY value1, cos(1-value3);
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (cos(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, cos((1::double precision - value3)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select cos with group by (result)
--Testcase 537:
SELECT value1, cos(1-value3) FROM s3 GROUP BY value1, cos(1-value3);
 value1 |         cos         
--------+---------------------
    0.1 | 0.45359612009757494
    0.2 | 0.36235775169898066
    0.3 |  0.2674988171380787
    1.1 | -0.5048461251803724
    2.2 | -0.9982947730112559
    3.3 |  -0.400799215766171
(6 rows)

-- select cos with group by index (result)
--Testcase 538:
SELECT value1, cos(1-value3) FROM s3 GROUP BY 2,1;
 value1 |         cos         
--------+---------------------
    0.1 | 0.45359612009757494
    0.2 | 0.36235775169898066
    0.3 |  0.2674988171380787
    1.1 | -0.5048461251803724
    2.2 | -0.9982947730112559
    3.3 |  -0.400799215766171
(6 rows)

-- select cos with group by index (result)
--Testcase 539:
SELECT value1, cos(1-value3) FROM s3 GROUP BY 1,2;
 value1 |         cos         
--------+---------------------
    0.1 | 0.45359612009757494
    0.2 | 0.36235775169898066
    0.3 |  0.2674988171380787
    1.1 | -0.5048461251803724
    2.2 | -0.9982947730112559
    3.3 |  -0.400799215766171
(6 rows)

-- select cos with group by having (explain)
--Testcase 540:
EXPLAIN VERBOSE
SELECT value1, cos(1-value3) FROM s3 GROUP BY value1, cos(1-value3) HAVING cos(avg(value1)) > 0;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (cos(('1'::double precision - value3)))
   Filter: (cos((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, cos((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select cos with group by having (result)
--Testcase 541:
SELECT value1, cos(1-value3) FROM s3 GROUP BY value1, cos(1-value3) HAVING cos(avg(value1)) > 0;
 value1 |         cos         
--------+---------------------
    0.1 | 0.45359612009757494
    0.2 | 0.36235775169898066
    0.3 |  0.2674988171380787
    1.1 | -0.5048461251803724
(4 rows)

-- select cos with group by index having (result)
--Testcase 542:
SELECT value1, cos(1-value3) FROM s3 GROUP BY 2,1 HAVING cos(1-value3) > 0;
 value1 |         cos         
--------+---------------------
    0.1 | 0.45359612009757494
    0.2 | 0.36235775169898066
    0.3 |  0.2674988171380787
(3 rows)

-- select cos with group by index having (result)
--Testcase 543:
SELECT value1, cos(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |         cos         
--------+---------------------
    1.1 | -0.5048461251803724
    2.2 | -0.9982947730112559
    3.3 |  -0.400799215766171
(3 rows)

-- select cos and as
--Testcase 544:
SELECT cos(value3) as cos1 FROM s3;
        cos1         
---------------------
  0.9950041651292624
  0.9800665772491609
  0.9553364856027305
   0.453596100177538
 -0.5885011558074578
 -0.9874797774307646
(6 rows)

-- select cot (builtin function, explain)
--Testcase 545:
EXPLAIN VERBOSE
SELECT value1, cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..255.05 rows=3413 width=40)
   Output: value1, (cot((value2)::double precision)), (cot(value3)), (cot((value4)::double precision)), '1.830487721712452'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, cot(value2), cot(value3), cot(value4), 1.830487721712452::double precision FROM public.s3mysql
(4 rows)

-- select cot (builtin function, result)
--Testcase 546:
SELECT value1, cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3;
 value1 |         cot         |         cot         |        cot         |        cot        
--------+---------------------+---------------------+--------------------+-------------------
    0.1 |  -1.702956919426469 |  -9.966644273749928 |  1.702956919426469 | 1.830487721712452
    0.2 |  -1.702956919426469 |   -4.93315480007968 |  1.702956919426469 | 1.830487721712452
    0.3 |  -1.702956919426469 | -3.2327280072648636 |  1.702956919426469 | 1.830487721712452
    1.1 | -0.5578715021347701 | -0.5089680752210085 | 0.5578715021347701 | 1.830487721712452
    2.2 | -0.5578715021347701 |  0.7278958489528831 | 0.5578715021347701 | 1.830487721712452
    3.3 | -0.5578715021347701 |  -6.259949455700704 | 0.5578715021347701 | 1.830487721712452
(6 rows)

-- select cot (builtin function, not pushdown constraints, explain)
--Testcase 547:
EXPLAIN VERBOSE
SELECT cot(value1), cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (cot(value1)), (cot((value2)::double precision)), (cot(value3)), (cot((value4)::double precision)), '1.830487721712452'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT cot(value1), cot(value2), cot(value3), cot(value4), 1.830487721712452::double precision, value2 FROM public.s3mysql
(5 rows)

-- select cot (builtin function, not pushdown constraints, result)
--Testcase 548:
SELECT cot(value1), cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3 WHERE to_hex(value2) = '64';
        cot         |        cot         |         cot         |        cot        |        cot        
--------------------+--------------------+---------------------+-------------------+-------------------
  9.966644273749928 | -1.702956919426469 |  -9.966644273749928 | 1.702956919426469 | 1.830487721712452
   4.93315480007968 | -1.702956919426469 |   -4.93315480007968 | 1.702956919426469 | 1.830487721712452
 3.2327280072648636 | -1.702956919426469 | -3.2327280072648636 | 1.702956919426469 | 1.830487721712452
(3 rows)

-- select cot (builtin function, pushdown constraints, explain)
--Testcase 549:
EXPLAIN VERBOSE
SELECT cot(value1), cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3 WHERE value2 != 200;
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (cot(value1)), (cot((value2)::double precision)), (cot(value3)), (cot((value4)::double precision)), '1.830487721712452'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT cot(value1), cot(value2), cot(value3), cot(value4), 1.830487721712452::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select cot (builtin function, pushdown constraints, result)
--Testcase 550:
SELECT cot(value1), cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3 WHERE value2 != 200;
        cot         |        cot         |         cot         |        cot        |        cot        
--------------------+--------------------+---------------------+-------------------+-------------------
  9.966644273749928 | -1.702956919426469 |  -9.966644273749928 | 1.702956919426469 | 1.830487721712452
   4.93315480007968 | -1.702956919426469 |   -4.93315480007968 | 1.702956919426469 | 1.830487721712452
 3.2327280072648636 | -1.702956919426469 | -3.2327280072648636 | 1.702956919426469 | 1.830487721712452
(3 rows)

-- select cot (builtin function, cot in constraints, explain)
--Testcase 551:
EXPLAIN VERBOSE
SELECT value1, cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3 WHERE cot(value1) != 1;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.56 rows=3396 width=40)
   Output: value1, (cot((value2)::double precision)), (cot(value3)), (cot((value4)::double precision)), '1.830487721712452'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, cot(value2), cot(value3), cot(value4), 1.830487721712452::double precision FROM public.s3mysql WHERE ((cot(value1) <> 1::double precision))
(4 rows)

-- select cot (builtin function, cot in constraints, result)
--Testcase 552:
SELECT value1, cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3 WHERE cot(value1) != 1;
 value1 |         cot         |         cot         |        cot         |        cot        
--------+---------------------+---------------------+--------------------+-------------------
    0.1 |  -1.702956919426469 |  -9.966644273749928 |  1.702956919426469 | 1.830487721712452
    0.2 |  -1.702956919426469 |   -4.93315480007968 |  1.702956919426469 | 1.830487721712452
    0.3 |  -1.702956919426469 | -3.2327280072648636 |  1.702956919426469 | 1.830487721712452
    1.1 | -0.5578715021347701 | -0.5089680752210085 | 0.5578715021347701 | 1.830487721712452
    2.2 | -0.5578715021347701 |  0.7278958489528831 | 0.5578715021347701 | 1.830487721712452
    3.3 | -0.5578715021347701 |  -6.259949455700704 | 0.5578715021347701 | 1.830487721712452
(6 rows)

-- select cot (builtin function, cot in constraints, explain)
--Testcase 553:
EXPLAIN VERBOSE
SELECT value1, cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3 WHERE cot(0.5) > value1;
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..189.65 rows=1138 width=40)
   Output: value1, (cot((value2)::double precision)), (cot(value3)), (cot((value4)::double precision)), '1.830487721712452'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, cot(value2), cot(value3), cot(value4), 1.830487721712452::double precision FROM public.s3mysql WHERE ((1.830487721712452::double precision > value1))
(4 rows)

-- select cot (builtin function, cot in constraints, result)
--Testcase 554:
SELECT value1, cot(value2), cot(value3), cot(value4), cot(0.5) FROM s3 WHERE cot(0.5) > value1;
 value1 |         cot         |         cot         |        cot         |        cot        
--------+---------------------+---------------------+--------------------+-------------------
    0.1 |  -1.702956919426469 |  -9.966644273749928 |  1.702956919426469 | 1.830487721712452
    0.2 |  -1.702956919426469 |   -4.93315480007968 |  1.702956919426469 | 1.830487721712452
    0.3 |  -1.702956919426469 | -3.2327280072648636 |  1.702956919426469 | 1.830487721712452
    1.1 | -0.5578715021347701 | -0.5089680752210085 | 0.5578715021347701 | 1.830487721712452
(4 rows)

-- select cot as nest function with agg (pushdown, explain)
--Testcase 555:
EXPLAIN VERBOSE
SELECT sum(value3),cot(sum(value3)) FROM s3;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (cot(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), cot(sum(value3)) FROM public.s3mysql
(6 rows)

-- select cot as nest function with agg (pushdown, result)
--Testcase 556:
SELECT sum(value3),cot(sum(value3)) FROM s3;
        sum         |         cot         
--------------------+---------------------
 -7.200000040233135 | -0.7665061060796853
(1 row)

-- select cot as nest with log2 (pushdown, explain)
--Testcase 557:
EXPLAIN VERBOSE
SELECT value1, cot(log2(value1)),cot(log2(1/value1)) FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (cot(log2(value1))), (cot(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, cot(public.log2(value1)), cot(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select cot as nest with log2 (pushdown, result)
--Testcase 558:
SELECT value1, cot(log2(value1)),cot(log2(1/value1)) FROM s3;
 value1 |         cot         |         cot          
--------+---------------------+----------------------
    0.1 |  -5.484979810524356 |    5.484979810524356
    0.2 |  0.9337126497470218 |  -0.9337126497470218
    0.3 | 0.16771572622183212 | -0.16771572622183237
    1.1 |   7.226646847351797 |   -7.226646847351802
    2.2 |  0.4626124165927711 |  -0.4626124165927711
    3.3 | -0.1528434660613515 |  0.15284346606135124
(6 rows)

-- select cot with non pushdown func and explicit constant (explain)
--Testcase 559:
EXPLAIN VERBOSE
SELECT value1, cot(value3), pi(), 4.1 FROM s3;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=56)
   Output: value1, (cot(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, cot(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select cot with non pushdown func and explicit constant (result)
--Testcase 560:
SELECT value1, cot(value3), pi(), 4.1 FROM s3;
 value1 |         cot         |        pi         | ?column? 
--------+---------------------+-------------------+----------
    0.1 |  -9.966644273749928 | 3.141592653589793 |      4.1
    0.2 |   -4.93315480007968 | 3.141592653589793 |      4.1
    0.3 | -3.2327280072648636 | 3.141592653589793 |      4.1
    1.1 | -0.5089680752210085 | 3.141592653589793 |      4.1
    2.2 |  0.7278958489528831 | 3.141592653589793 |      4.1
    3.3 |  -6.259949455700704 | 3.141592653589793 |      4.1
(6 rows)

-- select cot with order by (explain)
--Testcase 561:
EXPLAIN VERBOSE
SELECT value1, cot(1-value3) FROM s3 ORDER BY cot(1-value3);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (cot(('1'::double precision - value3)))
   Sort Key: (cot(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (cot(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, cot((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select cot with order by (result)
--Testcase 562:
SELECT value1, cot(1-value3) FROM s3 ORDER BY cot(1-value3);
 value1 |         cot         
--------+---------------------
    1.1 | -0.5848478384563578
    0.3 | 0.27761563370144493
    0.2 |  0.3887795659375119
    3.3 |  0.4374744880267397
    0.1 |  0.5089681033629359
    2.2 |   17.10164638510324
(6 rows)

-- select cot with order by index (result)
--Testcase 563:
SELECT value1, cot(1-value3) FROM s3 ORDER BY 2,1;
 value1 |         cot         
--------+---------------------
    1.1 | -0.5848478384563578
    0.3 | 0.27761563370144493
    0.2 |  0.3887795659375119
    3.3 |  0.4374744880267397
    0.1 |  0.5089681033629359
    2.2 |   17.10164638510324
(6 rows)

-- select cot with order by index (result)
--Testcase 564:
SELECT value1, cot(1-value3) FROM s3 ORDER BY 1,2;
 value1 |         cot         
--------+---------------------
    0.1 |  0.5089681033629359
    0.2 |  0.3887795659375119
    0.3 | 0.27761563370144493
    1.1 | -0.5848478384563578
    2.2 |   17.10164638510324
    3.3 |  0.4374744880267397
(6 rows)

-- select cot with group by (explain)
--Testcase 565:
EXPLAIN VERBOSE
SELECT value1, cot(1-value3) FROM s3 GROUP BY value1, cot(1-value3);
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (cot(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, cot((1::double precision - value3)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select cot with group by (result)
--Testcase 566:
SELECT value1, cot(1-value3) FROM s3 GROUP BY value1, cot(1-value3);
 value1 |         cot         
--------+---------------------
    0.1 |  0.5089681033629359
    0.2 |  0.3887795659375119
    0.3 | 0.27761563370144493
    1.1 | -0.5848478384563578
    2.2 |   17.10164638510324
    3.3 |  0.4374744880267397
(6 rows)

-- select cot with group by index (result)
--Testcase 567:
SELECT value1, cot(1-value3) FROM s3 GROUP BY 2,1;
 value1 |         cot         
--------+---------------------
    0.1 |  0.5089681033629359
    0.2 |  0.3887795659375119
    0.3 | 0.27761563370144493
    1.1 | -0.5848478384563578
    2.2 |   17.10164638510324
    3.3 |  0.4374744880267397
(6 rows)

-- select cot with group by index (result)
--Testcase 568:
SELECT value1, cot(1-value3) FROM s3 GROUP BY 1,2;
 value1 |         cot         
--------+---------------------
    0.1 |  0.5089681033629359
    0.2 |  0.3887795659375119
    0.3 | 0.27761563370144493
    1.1 | -0.5848478384563578
    2.2 |   17.10164638510324
    3.3 |  0.4374744880267397
(6 rows)

-- select cot with group by having (explain)
--Testcase 569:
EXPLAIN VERBOSE
SELECT value1, cot(1-value3) FROM s3 GROUP BY value1, cot(1-value3) HAVING cot(avg(value1)) > 0;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (cot(('1'::double precision - value3)))
   Filter: (cot((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, cot((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select cot with group by having (result)
--Testcase 570:
SELECT value1, cot(1-value3) FROM s3 GROUP BY value1, cot(1-value3) HAVING cot(avg(value1)) > 0;
 value1 |         cot         
--------+---------------------
    0.1 |  0.5089681033629359
    0.2 |  0.3887795659375119
    0.3 | 0.27761563370144493
    1.1 | -0.5848478384563578
    3.3 |  0.4374744880267397
(5 rows)

-- select cot with group by index having (result)
--Testcase 571:
SELECT value1, cot(1-value3) FROM s3 GROUP BY 2,1 HAVING cot(1-value3) > 0;
 value1 |         cot         
--------+---------------------
    0.1 |  0.5089681033629359
    0.2 |  0.3887795659375119
    0.3 | 0.27761563370144493
    2.2 |   17.10164638510324
    3.3 |  0.4374744880267397
(5 rows)

-- select cot with group by index having (result)
--Testcase 572:
SELECT value1, cot(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |         cot         
--------+---------------------
    1.1 | -0.5848478384563578
    2.2 |   17.10164638510324
    3.3 |  0.4374744880267397
(3 rows)

-- select cot and as
--Testcase 573:
SELECT value1, cot(value3) as cot1 FROM s3;
 value1 |        cot1         
--------+---------------------
    0.1 |  -9.966644273749928
    0.2 |   -4.93315480007968
    0.3 | -3.2327280072648636
    1.1 | -0.5089680752210085
    2.2 |  0.7278958489528831
    3.3 |  -6.259949455700704
(6 rows)

-- select degrees (builtin function, explain)
--Testcase 574:
EXPLAIN VERBOSE
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=40)
   Output: (degrees(value1)), (degrees((value2)::double precision)), (degrees(value3)), (degrees((value4)::double precision)), '28.64788975654116'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), 28.64788975654116::double precision FROM public.s3mysql
(4 rows)

-- select degrees (builtin function, result)
--Testcase 575:
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3;
      degrees       |      degrees       |       degrees       |       degrees       |      degrees      
--------------------+--------------------+---------------------+---------------------+-------------------
  5.729578036685597 | 5729.5779513082325 |  -5.729578036685597 | -5729.5779513082325 | 28.64788975654116
 11.459156073371194 | 5729.5779513082325 | -11.459156073371194 | -5729.5779513082325 | 28.64788975654116
 17.188734536943613 | 5729.5779513082325 | -17.188734536943613 | -5729.5779513082325 | 28.64788975654116
  63.02535883042839 | 11459.155902616465 |  -63.02535883042839 | -11459.155902616465 | 28.64788975654116
 126.05071766085678 | 11459.155902616465 | -126.05071766085678 | -11459.155902616465 | 28.64788975654116
   189.076069661096 | 11459.155902616465 |   -189.076069661096 | -11459.155902616465 | 28.64788975654116
(6 rows)

-- select degrees (builtin function, not pushdown constraints, explain)
--Testcase 576:
EXPLAIN VERBOSE
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (degrees(value1)), (degrees((value2)::double precision)), (degrees(value3)), (degrees((value4)::double precision)), '28.64788975654116'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), 28.64788975654116::double precision, value2 FROM public.s3mysql
(5 rows)

-- select degrees (builtin function, not pushdown constraints, result)
--Testcase 577:
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3 WHERE to_hex(value2) = '64';
      degrees       |      degrees       |       degrees       |       degrees       |      degrees      
--------------------+--------------------+---------------------+---------------------+-------------------
  5.729578036685597 | 5729.5779513082325 |  -5.729578036685597 | -5729.5779513082325 | 28.64788975654116
 11.459156073371194 | 5729.5779513082325 | -11.459156073371194 | -5729.5779513082325 | 28.64788975654116
 17.188734536943613 | 5729.5779513082325 | -17.188734536943613 | -5729.5779513082325 | 28.64788975654116
(3 rows)

-- select degrees (builtin function, pushdown constraints, explain)
--Testcase 578:
EXPLAIN VERBOSE
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3 WHERE value2 != 200;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (degrees(value1)), (degrees((value2)::double precision)), (degrees(value3)), (degrees((value4)::double precision)), '28.64788975654116'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), 28.64788975654116::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select degrees (builtin function, pushdown constraints, result)
--Testcase 579:
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3 WHERE value2 != 200;
      degrees       |      degrees       |       degrees       |       degrees       |      degrees      
--------------------+--------------------+---------------------+---------------------+-------------------
  5.729578036685597 | 5729.5779513082325 |  -5.729578036685597 | -5729.5779513082325 | 28.64788975654116
 11.459156073371194 | 5729.5779513082325 | -11.459156073371194 | -5729.5779513082325 | 28.64788975654116
 17.188734536943613 | 5729.5779513082325 | -17.188734536943613 | -5729.5779513082325 | 28.64788975654116
(3 rows)

-- select degrees (builtin function, degrees in constraints, explain)
--Testcase 580:
EXPLAIN VERBOSE
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3 WHERE degrees(value1) != 1;
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=40)
   Output: (degrees(value1)), (degrees((value2)::double precision)), (degrees(value3)), (degrees((value4)::double precision)), '28.64788975654116'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), 28.64788975654116::double precision FROM public.s3mysql WHERE ((degrees(value1) <> 1::double precision))
(4 rows)

-- select degrees (builtin function, degrees in constraints, result)
--Testcase 581:
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3 WHERE degrees(value1) != 1;
      degrees       |      degrees       |       degrees       |       degrees       |      degrees      
--------------------+--------------------+---------------------+---------------------+-------------------
  5.729578036685597 | 5729.5779513082325 |  -5.729578036685597 | -5729.5779513082325 | 28.64788975654116
 11.459156073371194 | 5729.5779513082325 | -11.459156073371194 | -5729.5779513082325 | 28.64788975654116
 17.188734536943613 | 5729.5779513082325 | -17.188734536943613 | -5729.5779513082325 | 28.64788975654116
  63.02535883042839 | 11459.155902616465 |  -63.02535883042839 | -11459.155902616465 | 28.64788975654116
 126.05071766085678 | 11459.155902616465 | -126.05071766085678 | -11459.155902616465 | 28.64788975654116
   189.076069661096 | 11459.155902616465 |   -189.076069661096 | -11459.155902616465 | 28.64788975654116
(6 rows)

-- select degrees (builtin function, degrees in constraints, explain)
--Testcase 582:
EXPLAIN VERBOSE
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3 WHERE degrees(0.5) > value1;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=40)
   Output: (degrees(value1)), (degrees((value2)::double precision)), (degrees(value3)), (degrees((value4)::double precision)), '28.64788975654116'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), 28.64788975654116::double precision FROM public.s3mysql WHERE ((28.64788975654116::double precision > value1))
(4 rows)

-- select degrees (builtin function, degrees in constraints, result)
--Testcase 583:
SELECT degrees(value1), degrees(value2), degrees(value3), degrees(value4), degrees(0.5) FROM s3 WHERE degrees(0.5) > value1;
      degrees       |      degrees       |       degrees       |       degrees       |      degrees      
--------------------+--------------------+---------------------+---------------------+-------------------
  5.729578036685597 | 5729.5779513082325 |  -5.729578036685597 | -5729.5779513082325 | 28.64788975654116
 11.459156073371194 | 5729.5779513082325 | -11.459156073371194 | -5729.5779513082325 | 28.64788975654116
 17.188734536943613 | 5729.5779513082325 | -17.188734536943613 | -5729.5779513082325 | 28.64788975654116
  63.02535883042839 | 11459.155902616465 |  -63.02535883042839 | -11459.155902616465 | 28.64788975654116
 126.05071766085678 | 11459.155902616465 | -126.05071766085678 | -11459.155902616465 | 28.64788975654116
   189.076069661096 | 11459.155902616465 |   -189.076069661096 | -11459.155902616465 | 28.64788975654116
(6 rows)

-- select degrees as nest function with agg (pushdown, explain)
--Testcase 584:
EXPLAIN VERBOSE
SELECT sum(value3),degrees(sum(value3)) FROM s3;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (degrees(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), degrees(sum(value3)) FROM public.s3mysql
(6 rows)

-- select degrees as nest function with agg (pushdown, result)
--Testcase 585:
SELECT sum(value3),degrees(sum(value3)) FROM s3;
        sum         |      degrees       
--------------------+--------------------
 -7.200000040233135 | -412.5296147993816
(1 row)

-- select degrees as nest with log2 (pushdown, explain)
--Testcase 586:
EXPLAIN VERBOSE
SELECT value1, degrees(log2(value1)),degrees(log2(1/value1)) FROM s3;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (degrees(log2(value1))), (degrees(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, degrees(public.log2(value1)), degrees(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select degrees as nest with log2 (pushdown, result)
--Testcase 587:
SELECT value1, degrees(log2(value1)),degrees(log2(1/value1)) FROM s3;
 value1 |       degrees       |      degrees       
--------+---------------------+--------------------
    0.1 | -190.33245845124492 | 190.33245845124492
    0.2 |  -133.0366789381626 |  133.0366789381626
    0.3 |  -99.52079442053036 |  99.52079442053038
    1.1 |   7.878373370662683 |  -7.87837337066268
    2.2 |   65.17415288374501 | -65.17415288374501
    3.3 |   98.69003236246138 | -98.69003236246137
(6 rows)

-- select degrees with non pushdown func and explicit constant (explain)
--Testcase 588:
EXPLAIN VERBOSE
SELECT degrees(value3), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (degrees(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT degrees(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select degrees with non pushdown func and explicit constant (result)
--Testcase 589:
SELECT degrees(value3), pi(), 4.1 FROM s3;
       degrees       |        pi         | ?column? 
---------------------+-------------------+----------
  -5.729578036685597 | 3.141592653589793 |      4.1
 -11.459156073371194 | 3.141592653589793 |      4.1
 -17.188734536943613 | 3.141592653589793 |      4.1
  -63.02535883042839 | 3.141592653589793 |      4.1
 -126.05071766085678 | 3.141592653589793 |      4.1
   -189.076069661096 | 3.141592653589793 |      4.1
(6 rows)

-- select degrees with order by (explain)
--Testcase 590:
EXPLAIN VERBOSE
SELECT value1, degrees(1-value3) FROM s3 ORDER BY degrees(1-value3);
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (degrees(('1'::double precision - value3)))
   Sort Key: (degrees(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (degrees(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, degrees((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select degrees with order by (result)
--Testcase 591:
SELECT value1, degrees(1-value3) FROM s3 ORDER BY degrees(1-value3);
 value1 |      degrees       
--------+--------------------
    0.1 |  63.02535754976792
    0.2 |  68.75493558645351
    0.3 |  74.48451405002594
    1.1 | 120.32113834351071
    2.2 |  183.3464971739391
    3.3 | 246.37184917417832
(6 rows)

-- select degrees with order by index (result)
--Testcase 592:
SELECT value1, degrees(1-value3) FROM s3 ORDER BY 2,1;
 value1 |      degrees       
--------+--------------------
    0.1 |  63.02535754976792
    0.2 |  68.75493558645351
    0.3 |  74.48451405002594
    1.1 | 120.32113834351071
    2.2 |  183.3464971739391
    3.3 | 246.37184917417832
(6 rows)

-- select degrees with order by index (result)
--Testcase 593:
SELECT value1, degrees(1-value3) FROM s3 ORDER BY 1,2;
 value1 |      degrees       
--------+--------------------
    0.1 |  63.02535754976792
    0.2 |  68.75493558645351
    0.3 |  74.48451405002594
    1.1 | 120.32113834351071
    2.2 |  183.3464971739391
    3.3 | 246.37184917417832
(6 rows)

-- select degrees with group by (explain)
--Testcase 594:
EXPLAIN VERBOSE
SELECT count(value1), degrees(1-value3) FROM s3 GROUP BY degrees(1-value3);
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (degrees(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), degrees((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select degrees with group by (result)
--Testcase 595:
SELECT count(value1), degrees(1-value3) FROM s3 GROUP BY degrees(1-value3);
 count |      degrees       
-------+--------------------
     1 |  63.02535754976792
     1 |  68.75493558645351
     1 |  74.48451405002594
     1 | 120.32113834351071
     1 |  183.3464971739391
     1 | 246.37184917417832
(6 rows)

-- select degrees with group by index (result)
--Testcase 596:
SELECT value1, degrees(1-value3) FROM s3 GROUP BY 2,1;
 value1 |      degrees       
--------+--------------------
    0.1 |  63.02535754976792
    0.2 |  68.75493558645351
    0.3 |  74.48451405002594
    1.1 | 120.32113834351071
    2.2 |  183.3464971739391
    3.3 | 246.37184917417832
(6 rows)

-- select degrees with group by index (result)
--Testcase 597:
SELECT value1, degrees(1-value3) FROM s3 GROUP BY 1,2;
 value1 |      degrees       
--------+--------------------
    0.1 |  63.02535754976792
    0.2 |  68.75493558645351
    0.3 |  74.48451405002594
    1.1 | 120.32113834351071
    2.2 |  183.3464971739391
    3.3 | 246.37184917417832
(6 rows)

-- select degrees with group by having (explain)
--Testcase 598:
EXPLAIN VERBOSE
SELECT count(value1), degrees(1-value3) FROM s3 GROUP BY degrees(1-value3) HAVING degrees(avg(value1)) > 0;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (degrees(('1'::double precision - value3)))
   Filter: (degrees((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), degrees((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select degrees with group by having (result)
--Testcase 599:
SELECT count(value1), degrees(1-value3) FROM s3 GROUP BY degrees(1-value3) HAVING degrees(avg(value1)) > 0;
 count |      degrees       
-------+--------------------
     1 |  63.02535754976792
     1 |  68.75493558645351
     1 |  74.48451405002594
     1 | 120.32113834351071
     1 |  183.3464971739391
     1 | 246.37184917417832
(6 rows)

-- select degrees with group by index having (result)
--Testcase 600:
SELECT value1, degrees(1-value3) FROM s3 GROUP BY 2,1 HAVING degrees(1-value3) > 0;
 value1 |      degrees       
--------+--------------------
    0.1 |  63.02535754976792
    0.2 |  68.75493558645351
    0.3 |  74.48451405002594
    1.1 | 120.32113834351071
    2.2 |  183.3464971739391
    3.3 | 246.37184917417832
(6 rows)

-- select degrees with group by index having (result)
--Testcase 601:
SELECT value1, degrees(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |      degrees       
--------+--------------------
    1.1 | 120.32113834351071
    2.2 |  183.3464971739391
    3.3 | 246.37184917417832
(3 rows)

-- select degrees and as
--Testcase 602:
SELECT degrees(value3) as degrees1 FROM s3;
      degrees1       
---------------------
  -5.729578036685597
 -11.459156073371194
 -17.188734536943613
  -63.02535883042839
 -126.05071766085678
   -189.076069661096
(6 rows)

-- select div (builtin function, explain)
--Testcase 603:
EXPLAIN VERBOSE
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3;
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.65 rows=3413 width=160)
   Output: (div((value1)::numeric, '2'::numeric)), (div((value2)::numeric, '2'::numeric)), (div((value3)::numeric, '2'::numeric)), (div((value4)::numeric, '2'::numeric)), '2'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT div(value1::numeric, 2::numeric), div(value2::numeric, 2::numeric), div(value3::numeric, 2::numeric), div(value4::numeric, 2::numeric), 2::numeric FROM public.s3mysql
(4 rows)

-- select div (builtin function, result)
--Testcase 604:
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3;
 div | div | div | div  | div 
-----+-----+-----+------+-----
   0 |  50 |   0 |  -50 |   2
   0 |  50 |   0 |  -50 |   2
   0 |  50 |   0 |  -50 |   2
   0 | 100 |   0 | -100 |   2
   1 | 100 |  -1 | -100 |   2
   1 | 100 |  -1 | -100 |   2
(6 rows)

-- select div (builtin function, not pushdown constraints, explain)
--Testcase 605:
EXPLAIN VERBOSE
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3 WHERE to_hex(value2) = '64';
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.53 rows=17 width=160)
   Output: (div((value1)::numeric, '2'::numeric)), (div((value2)::numeric, '2'::numeric)), (div((value3)::numeric, '2'::numeric)), (div((value4)::numeric, '2'::numeric)), '2'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT div(value1::numeric, 2::numeric), div(value2::numeric, 2::numeric), div(value3::numeric, 2::numeric), div(value4::numeric, 2::numeric), 2::numeric, value2 FROM public.s3mysql
(5 rows)

-- select div (builtin function, not pushdown constraints, result)
--Testcase 606:
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3 WHERE to_hex(value2) = '64';
 div | div | div | div | div 
-----+-----+-----+-----+-----
   0 |  50 |   0 | -50 |   2
   0 |  50 |   0 | -50 |   2
   0 |  50 |   0 | -50 |   2
(3 rows)

-- select div (builtin function, pushdown constraints, explain)
--Testcase 607:
EXPLAIN VERBOSE
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3 WHERE value2 != 200;
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..288.50 rows=3396 width=160)
   Output: (div((value1)::numeric, '2'::numeric)), (div((value2)::numeric, '2'::numeric)), (div((value3)::numeric, '2'::numeric)), (div((value4)::numeric, '2'::numeric)), '2'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT div(value1::numeric, 2::numeric), div(value2::numeric, 2::numeric), div(value3::numeric, 2::numeric), div(value4::numeric, 2::numeric), 2::numeric FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select div (builtin function, pushdown constraints, result)
--Testcase 608:
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3 WHERE value2 != 200;
 div | div | div | div | div 
-----+-----+-----+-----+-----
   0 |  50 |   0 | -50 |   2
   0 |  50 |   0 | -50 |   2
   0 |  50 |   0 | -50 |   2
(3 rows)

-- select div (builtin function, div in constraints, explain)
--Testcase 609:
EXPLAIN VERBOSE
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3 WHERE div(value1::numeric, 2) != 1;
                                                                                                                       QUERY PLAN                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..305.57 rows=3396 width=160)
   Output: (div((value1)::numeric, '2'::numeric)), (div((value2)::numeric, '2'::numeric)), (div((value3)::numeric, '2'::numeric)), (div((value4)::numeric, '2'::numeric)), '2'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT div(value1::numeric, 2::numeric), div(value2::numeric, 2::numeric), div(value3::numeric, 2::numeric), div(value4::numeric, 2::numeric), 2::numeric FROM public.s3mysql WHERE ((div(value1::numeric, 2::numeric) <> 1::numeric))
(4 rows)

-- select div (builtin function, div in constraints, result)
--Testcase 610:
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3 WHERE div(value1::numeric, 2) != 1;
 div | div | div | div  | div 
-----+-----+-----+------+-----
   0 |  50 |   0 |  -50 |   2
   0 |  50 |   0 |  -50 |   2
   0 |  50 |   0 |  -50 |   2
   0 | 100 |   0 | -100 |   2
(4 rows)

-- select div (builtin function, div in constraints, explain)
--Testcase 611:
EXPLAIN VERBOSE
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3 WHERE div(5, 2) > value1;
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..198.18 rows=1138 width=160)
   Output: (div((value1)::numeric, '2'::numeric)), (div((value2)::numeric, '2'::numeric)), (div((value3)::numeric, '2'::numeric)), (div((value4)::numeric, '2'::numeric)), '2'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT div(value1::numeric, 2::numeric), div(value2::numeric, 2::numeric), div(value3::numeric, 2::numeric), div(value4::numeric, 2::numeric), 2::numeric FROM public.s3mysql WHERE ((2::double precision > value1))
(4 rows)

-- select div (builtin function, div in constraints, result)
--Testcase 612:
SELECT div(value1::numeric, 2), div(value2::numeric, 2), div(value3::numeric, 2), div(value4::numeric, 2), div(5, 2) FROM s3 WHERE div(5, 2) > value1;
 div | div | div | div  | div 
-----+-----+-----+------+-----
   0 |  50 |   0 |  -50 |   2
   0 |  50 |   0 |  -50 |   2
   0 |  50 |   0 |  -50 |   2
   0 | 100 |   0 | -100 |   2
(4 rows)

-- select div as nest function with agg (pushdown, explain)
--Testcase 613:
EXPLAIN VERBOSE
SELECT sum(value3),div(sum(value3)::numeric, 2) FROM s3;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(value3)), (div((sum(value3))::numeric, '2'::numeric))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), div(sum(value3)::numeric, 2::numeric) FROM public.s3mysql
(6 rows)

-- select div as nest function with agg (pushdown, result)
--Testcase 614:
SELECT sum(value3),div(sum(value3)::numeric, 2) FROM s3;
        sum         | div 
--------------------+-----
 -7.200000040233135 |  -3
(1 row)

-- select div as nest with log2 (pushdown, explain)
--Testcase 615:
EXPLAIN VERBOSE
SELECT div(log2(value1)::numeric, 2),div(log2(1/value1)::numeric, 2) FROM s3;
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1961.55 rows=3413 width=64)
   Output: (div((log2(value1))::numeric, '2'::numeric)), (div((log2(('1'::double precision / value1)))::numeric, '2'::numeric))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT div(public.log2(value1)::numeric, 2::numeric), div(public.log2((1::double precision / value1))::numeric, 2::numeric) FROM public.s3mysql
(4 rows)

-- select div as nest with log2 (pushdown, result)
--Testcase 616:
SELECT div(log2(value1)::numeric, 2),div(log2(1/value1)::numeric, 2) FROM s3;
 div | div 
-----+-----
  -1 |   1
  -1 |   1
   0 |   0
   0 |   0
   0 |   0
   0 |   0
(6 rows)

-- select div with non pushdown func and explicit constant (explain)
--Testcase 617:
EXPLAIN VERBOSE
SELECT div(value3::numeric, 2), pi(), 4.1 FROM s3;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=72)
   Output: (div((value3)::numeric, '2'::numeric)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT div(value3::numeric, 2::numeric), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select div with non pushdown func and explicit constant (result)
--Testcase 618:
SELECT div(value3::numeric, 2), pi(), 4.1 FROM s3;
 div |        pi         | ?column? 
-----+-------------------+----------
   0 | 3.141592653589793 |      4.1
   0 | 3.141592653589793 |      4.1
   0 | 3.141592653589793 |      4.1
   0 | 3.141592653589793 |      4.1
  -1 | 3.141592653589793 |      4.1
  -1 | 3.141592653589793 |      4.1
(6 rows)

-- select div with order by (explain)
--Testcase 619:
EXPLAIN VERBOSE
SELECT value1, div((10-value1)::numeric, 2) FROM s3 ORDER BY value1, div((10-value1)::numeric, 2);
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Sort  (cost=438.28..446.81 rows=3413 width=40)
   Output: value1, (div((('10'::double precision - value1))::numeric, '2'::numeric))
   Sort Key: s3.value1, (div((('10'::double precision - s3.value1))::numeric, '2'::numeric))
   ->  Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=40)
         Output: value1, (div((('10'::double precision - value1))::numeric, '2'::numeric))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, div((10::double precision - value1)::numeric, 2::numeric) FROM public.s3mysql
(7 rows)

-- select div with order by (result)
--Testcase 620:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 ORDER BY value1, div((10-value1)::numeric, 2);
 value1 | div 
--------+-----
    0.1 |   4
    0.2 |   4
    0.3 |   4
    1.1 |   4
    2.2 |   3
    3.3 |   3
(6 rows)

-- select div with order by index (result)
--Testcase 621:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 ORDER BY 2,1;
 value1 | div 
--------+-----
    2.2 |   3
    3.3 |   3
    0.1 |   4
    0.2 |   4
    0.3 |   4
    1.1 |   4
(6 rows)

-- select div with order by index (result)
--Testcase 622:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 ORDER BY 1,2;
 value1 | div 
--------+-----
    0.1 |   4
    0.2 |   4
    0.3 |   4
    1.1 |   4
    2.2 |   3
    3.3 |   3
(6 rows)

-- select div with group by (explain)
--Testcase 623:
EXPLAIN VERBOSE
SELECT value1, div((10-value1)::numeric, 2) FROM s3 GROUP BY value1, div((10-value1)::numeric, 2);
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=40)
   Output: value1, (div((('10'::double precision - value1))::numeric, '2'::numeric))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, div((10::double precision - value1)::numeric, 2::numeric) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select div with group by (result)
--Testcase 624:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 GROUP BY value1, div((10-value1)::numeric, 2);
 value1 | div 
--------+-----
    0.1 |   4
    0.2 |   4
    0.3 |   4
    1.1 |   4
    2.2 |   3
    3.3 |   3
(6 rows)

-- select div with group by index (result)
--Testcase 625:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 GROUP BY 2,1;
 value1 | div 
--------+-----
    0.1 |   4
    0.2 |   4
    0.3 |   4
    1.1 |   4
    2.2 |   3
    3.3 |   3
(6 rows)

-- select div with group by index (result)
--Testcase 626:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 GROUP BY 1,2;
 value1 | div 
--------+-----
    0.1 |   4
    0.2 |   4
    0.3 |   4
    1.1 |   4
    2.2 |   3
    3.3 |   3
(6 rows)

-- select div with group by having (explain)
--Testcase 627:
EXPLAIN VERBOSE
SELECT value1, div((10-value1)::numeric, 2) FROM s3 GROUP BY value1, div((10-value1)::numeric, 2) HAVING avg(value1) > 0;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: value1, (div((('10'::double precision - value1))::numeric, '2'::numeric))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, div((10::double precision - value1)::numeric, 2::numeric), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select div with group by having (result)
--Testcase 628:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 GROUP BY value1, div((10-value1)::numeric, 2) HAVING avg(value1) > 0;
 value1 | div 
--------+-----
    0.1 |   4
    0.2 |   4
    0.3 |   4
    1.1 |   4
    2.2 |   3
    3.3 |   3
(6 rows)

-- select div with group by index having (result)
--Testcase 629:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 GROUP BY 2,1 HAVING div((10-value1)::numeric, 2) > 0;
 value1 | div 
--------+-----
    0.1 |   4
    0.2 |   4
    0.3 |   4
    1.1 |   4
    2.2 |   3
    3.3 |   3
(6 rows)

-- select div with group by index having (result)
--Testcase 630:
SELECT value1, div((10-value1)::numeric, 2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | div 
--------+-----
    1.1 |   4
    2.2 |   3
    3.3 |   3
(3 rows)

-- select div and as
--Testcase 631:
SELECT div(value3::numeric, 2) as div1 FROM s3;
 div1 
------
    0
    0
    0
    0
   -1
   -1
(6 rows)

-- select exp (builtin function, explain)
--Testcase 632:
EXPLAIN VERBOSE
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=64)
   Output: (exp(value1)), (exp((value2)::double precision)), (exp(value3)), (exp((value4)::double precision)), 1.6487212707001281
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT exp(value1), exp(value2), exp(value3), exp(value4), 1.6487212707001281 FROM public.s3mysql
(4 rows)

-- select exp (builtin function, result)
--Testcase 633:
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3;
        exp         |          exp           |         exp         |          exp           |        exp         
--------------------+------------------------+---------------------+------------------------+--------------------
 1.1051709197224806 | 2.6881171418161356e+43 |  0.9048374166876467 |  3.720075976020836e-44 | 1.6487212707001281
 1.2214027618002337 | 2.6881171418161356e+43 |  0.8187307506379741 |  3.720075976020836e-44 | 1.6487212707001281
 1.3498588236675741 | 2.6881171418161356e+43 |  0.7408182118504766 |  3.720075976020836e-44 | 1.6487212707001281
 3.0041660955713336 |  7.225973768125749e+86 | 0.33287107576181457 | 1.3838965267367376e-87 | 1.6487212707001281
  9.025013929780311 |  7.225973768125749e+86 |  0.1108031530788277 | 1.3838965267367376e-87 | 1.6487212707001281
 27.112637627826548 |  7.225973768125749e+86 | 0.03688316915996652 | 1.3838965267367376e-87 | 1.6487212707001281
(6 rows)

-- select exp (builtin function, not pushdown constraints, explain)
--Testcase 634:
EXPLAIN VERBOSE
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=64)
   Output: (exp(value1)), (exp((value2)::double precision)), (exp(value3)), (exp((value4)::double precision)), 1.6487212707001281
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT exp(value1), exp(value2), exp(value3), exp(value4), 1.6487212707001281, value2 FROM public.s3mysql
(5 rows)

-- select exp (builtin function, not pushdown constraints, result)
--Testcase 635:
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3 WHERE to_hex(value2) = '64';
        exp         |          exp           |        exp         |          exp          |        exp         
--------------------+------------------------+--------------------+-----------------------+--------------------
 1.1051709197224806 | 2.6881171418161356e+43 | 0.9048374166876467 | 3.720075976020836e-44 | 1.6487212707001281
 1.2214027618002337 | 2.6881171418161356e+43 | 0.8187307506379741 | 3.720075976020836e-44 | 1.6487212707001281
 1.3498588236675741 | 2.6881171418161356e+43 | 0.7408182118504766 | 3.720075976020836e-44 | 1.6487212707001281
(3 rows)

-- select exp (builtin function, pushdown constraints, explain)
--Testcase 636:
EXPLAIN VERBOSE
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3 WHERE value2 != 200;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=64)
   Output: (exp(value1)), (exp((value2)::double precision)), (exp(value3)), (exp((value4)::double precision)), 1.6487212707001281
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT exp(value1), exp(value2), exp(value3), exp(value4), 1.6487212707001281 FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select exp (builtin function, pushdown constraints, result)
--Testcase 637:
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3 WHERE value2 != 200;
        exp         |          exp           |        exp         |          exp          |        exp         
--------------------+------------------------+--------------------+-----------------------+--------------------
 1.1051709197224806 | 2.6881171418161356e+43 | 0.9048374166876467 | 3.720075976020836e-44 | 1.6487212707001281
 1.2214027618002337 | 2.6881171418161356e+43 | 0.8187307506379741 | 3.720075976020836e-44 | 1.6487212707001281
 1.3498588236675741 | 2.6881171418161356e+43 | 0.7408182118504766 | 3.720075976020836e-44 | 1.6487212707001281
(3 rows)

-- select exp (builtin function, exp in constraints, explain)
--Testcase 638:
EXPLAIN VERBOSE
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3 WHERE exp(value1) != 1;
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=64)
   Output: (exp(value1)), (exp((value2)::double precision)), (exp(value3)), (exp((value4)::double precision)), 1.6487212707001281
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT exp(value1), exp(value2), exp(value3), exp(value4), 1.6487212707001281 FROM public.s3mysql WHERE ((exp(value1) <> 1::double precision))
(4 rows)

-- select exp (builtin function, exp in constraints, result)
--Testcase 639:
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3 WHERE exp(value1) != 1;
        exp         |          exp           |         exp         |          exp           |        exp         
--------------------+------------------------+---------------------+------------------------+--------------------
 1.1051709197224806 | 2.6881171418161356e+43 |  0.9048374166876467 |  3.720075976020836e-44 | 1.6487212707001281
 1.2214027618002337 | 2.6881171418161356e+43 |  0.8187307506379741 |  3.720075976020836e-44 | 1.6487212707001281
 1.3498588236675741 | 2.6881171418161356e+43 |  0.7408182118504766 |  3.720075976020836e-44 | 1.6487212707001281
 3.0041660955713336 |  7.225973768125749e+86 | 0.33287107576181457 | 1.3838965267367376e-87 | 1.6487212707001281
  9.025013929780311 |  7.225973768125749e+86 |  0.1108031530788277 | 1.3838965267367376e-87 | 1.6487212707001281
 27.112637627826548 |  7.225973768125749e+86 | 0.03688316915996652 | 1.3838965267367376e-87 | 1.6487212707001281
(6 rows)

-- select exp (builtin function, exp in constraints, explain)
--Testcase 640:
EXPLAIN VERBOSE
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3 WHERE exp(0.5) > value1;
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=64)
   Output: (exp(value1)), (exp((value2)::double precision)), (exp(value3)), (exp((value4)::double precision)), 1.6487212707001281
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT exp(value1), exp(value2), exp(value3), exp(value4), 1.6487212707001281 FROM public.s3mysql WHERE ((1.6487212707001282::double precision > value1))
(4 rows)

-- select exp (builtin function, exp in constraints, result)
--Testcase 641:
SELECT exp(value1), exp(value2), exp(value3), exp(value4), exp(0.5) FROM s3 WHERE exp(0.5) > value1;
        exp         |          exp           |         exp         |          exp           |        exp         
--------------------+------------------------+---------------------+------------------------+--------------------
 1.1051709197224806 | 2.6881171418161356e+43 |  0.9048374166876467 |  3.720075976020836e-44 | 1.6487212707001281
 1.2214027618002337 | 2.6881171418161356e+43 |  0.8187307506379741 |  3.720075976020836e-44 | 1.6487212707001281
 1.3498588236675741 | 2.6881171418161356e+43 |  0.7408182118504766 |  3.720075976020836e-44 | 1.6487212707001281
 3.0041660955713336 |  7.225973768125749e+86 | 0.33287107576181457 | 1.3838965267367376e-87 | 1.6487212707001281
(4 rows)

-- select exp as nest function with agg (pushdown, explain)
--Testcase 642:
EXPLAIN VERBOSE
SELECT sum(value3),exp(sum(value3)) FROM s3;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (exp(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), exp(sum(value3)) FROM public.s3mysql
(6 rows)

-- select exp as nest function with agg (pushdown, result)
--Testcase 643:
SELECT sum(value3),exp(sum(value3)) FROM s3;
        sum         |          exp          
--------------------+-----------------------
 -7.200000040233135 | 0.0007465857783391922
(1 row)

-- select exp as nest with log2 (pushdown, explain)
--Testcase 644:
EXPLAIN VERBOSE
SELECT exp(log2(value1)),exp(log2(1/value1)) FROM s3;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (exp(log2(value1))), (exp(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT exp(public.log2(value1)), exp(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select exp as nest with log2 (pushdown, result)
--Testcase 645:
SELECT exp(log2(value1)),exp(log2(1/value1)) FROM s3;
         exp         |         exp         
---------------------+---------------------
 0.03608319359649761 |  27.713733190652626
 0.09808428946612922 |   10.19531267895174
    0.17605381971773 |    5.68008124790088
  1.1474057850147703 |  0.8715312516810496
   3.118972295274436 | 0.32061842983187216
   5.598316925921947 | 0.17862511416059523
(6 rows)

-- select exp with non pushdown func and explicit constant (explain)
--Testcase 646:
EXPLAIN VERBOSE
SELECT exp(value3), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (exp(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT exp(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select exp with non pushdown func and explicit constant (result)
--Testcase 647:
SELECT exp(value3), pi(), 4.1 FROM s3;
         exp         |        pi         | ?column? 
---------------------+-------------------+----------
  0.9048374166876467 | 3.141592653589793 |      4.1
  0.8187307506379741 | 3.141592653589793 |      4.1
  0.7408182118504766 | 3.141592653589793 |      4.1
 0.33287107576181457 | 3.141592653589793 |      4.1
  0.1108031530788277 | 3.141592653589793 |      4.1
 0.03688316915996652 | 3.141592653589793 |      4.1
(6 rows)

-- select exp with order by (explain)
--Testcase 648:
EXPLAIN VERBOSE
SELECT value1, exp(1-value3) FROM s3 ORDER BY exp(1-value3);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (exp(('1'::double precision - value3)))
   Sort Key: (exp(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (exp(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, exp((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select exp with order by (result)
--Testcase 649:
SELECT value1, exp(1-value3) FROM s3 ORDER BY exp(1-value3);
 value1 |        exp         
--------+--------------------
    0.1 | 3.0041660284229894
    0.2 |  3.320116932631267
    0.3 |  3.669296711360669
    1.1 |  8.166170107264316
    2.2 | 24.532531366911574
    3.3 |  73.69979018531586
(6 rows)

-- select exp with order by index (result)
--Testcase 650:
SELECT value1, exp(1-value3) FROM s3 ORDER BY 2,1;
 value1 |        exp         
--------+--------------------
    0.1 | 3.0041660284229894
    0.2 |  3.320116932631267
    0.3 |  3.669296711360669
    1.1 |  8.166170107264316
    2.2 | 24.532531366911574
    3.3 |  73.69979018531586
(6 rows)

-- select exp with order by index (result)
--Testcase 651:
SELECT value1, exp(1-value3) FROM s3 ORDER BY 1,2;
 value1 |        exp         
--------+--------------------
    0.1 | 3.0041660284229894
    0.2 |  3.320116932631267
    0.3 |  3.669296711360669
    1.1 |  8.166170107264316
    2.2 | 24.532531366911574
    3.3 |  73.69979018531586
(6 rows)

-- select exp with group by (explain)
--Testcase 652:
EXPLAIN VERBOSE
SELECT count(value1), exp(1-value3) FROM s3 GROUP BY exp(1-value3);
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (exp(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), exp((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select exp with group by (result)
--Testcase 653:
SELECT count(value1), exp(1-value3) FROM s3 GROUP BY exp(1-value3);
 count |        exp         
-------+--------------------
     1 | 3.0041660284229894
     1 |  3.320116932631267
     1 |  3.669296711360669
     1 |  8.166170107264316
     1 | 24.532531366911574
     1 |  73.69979018531586
(6 rows)

-- select exp with group by index (result)
--Testcase 654:
SELECT value1, exp(1-value3) FROM s3 GROUP BY 2,1;
 value1 |        exp         
--------+--------------------
    0.1 | 3.0041660284229894
    0.2 |  3.320116932631267
    0.3 |  3.669296711360669
    1.1 |  8.166170107264316
    2.2 | 24.532531366911574
    3.3 |  73.69979018531586
(6 rows)

-- select exp with group by index (result)
--Testcase 655:
SELECT value1, exp(1-value3) FROM s3 GROUP BY 1,2;
 value1 |        exp         
--------+--------------------
    0.1 | 3.0041660284229894
    0.2 |  3.320116932631267
    0.3 |  3.669296711360669
    1.1 |  8.166170107264316
    2.2 | 24.532531366911574
    3.3 |  73.69979018531586
(6 rows)

-- select exp with group by having (explain)
--Testcase 656:
EXPLAIN VERBOSE
SELECT count(value1), exp(1-value3) FROM s3 GROUP BY exp(1-value3) HAVING exp(avg(value1)) > 0;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (exp(('1'::double precision - value3)))
   Filter: (exp((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), exp((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select exp with group by having (result)
--Testcase 657:
SELECT count(value1), exp(1-value3) FROM s3 GROUP BY exp(1-value3) HAVING exp(avg(value1)) > 0;
 count |        exp         
-------+--------------------
     1 | 3.0041660284229894
     1 |  3.320116932631267
     1 |  3.669296711360669
     1 |  8.166170107264316
     1 | 24.532531366911574
     1 |  73.69979018531586
(6 rows)

-- select exp with group by index having (result)
--Testcase 658:
SELECT value1, exp(1-value3) FROM s3 GROUP BY 2,1 HAVING exp(1-value3) > 0;
 value1 |        exp         
--------+--------------------
    0.1 | 3.0041660284229894
    0.2 |  3.320116932631267
    0.3 |  3.669296711360669
    1.1 |  8.166170107264316
    2.2 | 24.532531366911574
    3.3 |  73.69979018531586
(6 rows)

-- select exp with group by index having (result)
--Testcase 659:
SELECT value1, exp(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |        exp         
--------+--------------------
    1.1 |  8.166170107264316
    2.2 | 24.532531366911574
    3.3 |  73.69979018531586
(3 rows)

-- select exp and as
--Testcase 660:
SELECT exp(value3) as exp1 FROM s3;
        exp1         
---------------------
  0.9048374166876467
  0.8187307506379741
  0.7408182118504766
 0.33287107576181457
  0.1108031530788277
 0.03688316915996652
(6 rows)

-- select floor (builtin function, explain)
--Testcase 661:
EXPLAIN VERBOSE
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3;
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=64)
   Output: (floor(value1)), (floor((value2)::double precision)), (floor(value3)), (floor((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT floor(value1), floor(value2), floor(value3), floor(value4), 1::numeric FROM public.s3mysql
(4 rows)

-- select floor (builtin function, result)
--Testcase 662:
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3;
 floor | floor | floor | floor | floor 
-------+-------+-------+-------+-------
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
     1 |   200 |    -2 |  -200 |     1
     2 |   200 |    -3 |  -200 |     1
     3 |   200 |    -4 |  -200 |     1
(6 rows)

-- select floor (builtin function, not pushdown constraints, explain)
--Testcase 663:
EXPLAIN VERBOSE
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3 WHERE to_hex(value2) = '64';
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=64)
   Output: (floor(value1)), (floor((value2)::double precision)), (floor(value3)), (floor((value4)::double precision)), '1'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT floor(value1), floor(value2), floor(value3), floor(value4), 1::numeric, value2 FROM public.s3mysql
(5 rows)

-- select floor (builtin function, not pushdown constraints, result)
--Testcase 664:
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3 WHERE to_hex(value2) = '64';
 floor | floor | floor | floor | floor 
-------+-------+-------+-------+-------
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
(3 rows)

-- select floor (builtin function, pushdown constraints, explain)
--Testcase 665:
EXPLAIN VERBOSE
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3 WHERE value2 != 200;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=64)
   Output: (floor(value1)), (floor((value2)::double precision)), (floor(value3)), (floor((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT floor(value1), floor(value2), floor(value3), floor(value4), 1::numeric FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select floor (builtin function, pushdown constraints, result)
--Testcase 666:
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3 WHERE value2 != 200;
 floor | floor | floor | floor | floor 
-------+-------+-------+-------+-------
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
(3 rows)

-- select floor (builtin function, floor in constraints, explain)
--Testcase 667:
EXPLAIN VERBOSE
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3 WHERE floor(value1) != 1;
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=64)
   Output: (floor(value1)), (floor((value2)::double precision)), (floor(value3)), (floor((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT floor(value1), floor(value2), floor(value3), floor(value4), 1::numeric FROM public.s3mysql WHERE ((floor(value1) <> 1::double precision))
(4 rows)

-- select floor (builtin function, floor in constraints, result)
--Testcase 668:
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3 WHERE floor(value1) != 1;
 floor | floor | floor | floor | floor 
-------+-------+-------+-------+-------
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
     2 |   200 |    -3 |  -200 |     1
     3 |   200 |    -4 |  -200 |     1
(5 rows)

-- select floor (builtin function, floor in constraints, explain)
--Testcase 669:
EXPLAIN VERBOSE
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3 WHERE floor(1.5) > value1;
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=64)
   Output: (floor(value1)), (floor((value2)::double precision)), (floor(value3)), (floor((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT floor(value1), floor(value2), floor(value3), floor(value4), 1::numeric FROM public.s3mysql WHERE ((1::double precision > value1))
(4 rows)

-- select floor (builtin function, floor in constraints, result)
--Testcase 670:
SELECT floor(value1), floor(value2), floor(value3), floor(value4), floor(1.5) FROM s3 WHERE floor(1.5) > value1;
 floor | floor | floor | floor | floor 
-------+-------+-------+-------+-------
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
     0 |   100 |    -1 |  -100 |     1
(3 rows)

-- select floor as nest function with agg (pushdown, explain)
--Testcase 671:
EXPLAIN VERBOSE
SELECT sum(value3),floor(sum(value3)) FROM s3;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (floor(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), floor(sum(value3)) FROM public.s3mysql
(6 rows)

-- select floor as nest function with agg (pushdown, result)
--Testcase 672:
SELECT sum(value3),floor(sum(value3)) FROM s3;
        sum         | floor 
--------------------+-------
 -7.200000040233135 |    -8
(1 row)

-- select floor as nest with log2 (pushdown, explain)
--Testcase 673:
EXPLAIN VERBOSE
SELECT floor(log2(value1)),floor(log2(1/value1)) FROM s3;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (floor(log2(value1))), (floor(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT floor(public.log2(value1)), floor(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select floor as nest with log2 (pushdown, result)
--Testcase 674:
SELECT floor(log2(value1)),floor(log2(1/value1)) FROM s3;
 floor | floor 
-------+-------
    -4 |     3
    -3 |     2
    -2 |     1
     0 |    -1
     1 |    -2
     1 |    -2
(6 rows)

-- select floor with non pushdown func and explicit constant (explain)
--Testcase 675:
EXPLAIN VERBOSE
SELECT floor(value3), pi(), 4.1 FROM s3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (floor(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT floor(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select floor with non pushdown func and explicit constant (result)
--Testcase 676:
SELECT floor(value3), pi(), 4.1 FROM s3;
 floor |        pi         | ?column? 
-------+-------------------+----------
    -1 | 3.141592653589793 |      4.1
    -1 | 3.141592653589793 |      4.1
    -1 | 3.141592653589793 |      4.1
    -2 | 3.141592653589793 |      4.1
    -3 | 3.141592653589793 |      4.1
    -4 | 3.141592653589793 |      4.1
(6 rows)

-- select floor with order by (explain)
--Testcase 677:
EXPLAIN VERBOSE
SELECT value1, floor(10 - value1) FROM s3 ORDER BY floor(10 - value1);
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (floor(('10'::double precision - value1)))
   Sort Key: (floor(('10'::double precision - s3.value1)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (floor(('10'::double precision - value1)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, floor((10::double precision - value1)) FROM public.s3mysql
(7 rows)

-- select floor with order by (result)
--Testcase 678:
SELECT value1, floor(10 - value1) FROM s3 ORDER BY floor(10 - value1);
 value1 | floor 
--------+-------
    3.3 |     6
    2.2 |     7
    1.1 |     8
    0.1 |     9
    0.2 |     9
    0.3 |     9
(6 rows)

-- select floor with order by index (result)
--Testcase 679:
SELECT value1, floor(10 - value1) FROM s3 ORDER BY 2,1;
 value1 | floor 
--------+-------
    3.3 |     6
    2.2 |     7
    1.1 |     8
    0.1 |     9
    0.2 |     9
    0.3 |     9
(6 rows)

-- select floor with order by index (result)
--Testcase 680:
SELECT value1, floor(10 - value1) FROM s3 ORDER BY 1,2;
 value1 | floor 
--------+-------
    0.1 |     9
    0.2 |     9
    0.3 |     9
    1.1 |     8
    2.2 |     7
    3.3 |     6
(6 rows)

-- select floor with group by (explain)
--Testcase 681:
EXPLAIN VERBOSE
SELECT value1, floor(10 - value1) FROM s3 GROUP BY value1, floor(10 - value1);
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (floor(('10'::double precision - value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, floor((10::double precision - value1)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select floor with group by (result)
--Testcase 682:
SELECT value1, floor(10 - value1) FROM s3 GROUP BY value1, floor(10 - value1);
 value1 | floor 
--------+-------
    0.1 |     9
    0.2 |     9
    0.3 |     9
    1.1 |     8
    2.2 |     7
    3.3 |     6
(6 rows)

-- select floor with group by index (result)
--Testcase 683:
SELECT value1, floor(10 - value1) FROM s3 GROUP BY 2,1;
 value1 | floor 
--------+-------
    0.1 |     9
    0.2 |     9
    0.3 |     9
    1.1 |     8
    2.2 |     7
    3.3 |     6
(6 rows)

-- select floor with group by index (result)
--Testcase 684:
SELECT value1, floor(10 - value1) FROM s3 GROUP BY 1,2;
 value1 | floor 
--------+-------
    0.1 |     9
    0.2 |     9
    0.3 |     9
    1.1 |     8
    2.2 |     7
    3.3 |     6
(6 rows)

-- select floor with group by having (explain)
--Testcase 685:
EXPLAIN VERBOSE
SELECT value1, floor(10 - value1) FROM s3 GROUP BY value1, floor(10 - value1) HAVING floor(avg(value1)) > 0;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (floor(('10'::double precision - value1)))
   Filter: (floor((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, floor((10::double precision - value1)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select floor with group by having (result)
--Testcase 686:
SELECT value1, floor(10 - value1) FROM s3 GROUP BY value1, floor(10 - value1) HAVING floor(avg(value1)) > 0;
 value1 | floor 
--------+-------
    1.1 |     8
    2.2 |     7
    3.3 |     6
(3 rows)

-- select floor with group by index having (result)
--Testcase 687:
SELECT value1, floor(10 - value1) FROM s3 GROUP BY 2,1 HAVING floor(10 - value1) > 0;
 value1 | floor 
--------+-------
    0.1 |     9
    0.2 |     9
    0.3 |     9
    1.1 |     8
    2.2 |     7
    3.3 |     6
(6 rows)

-- select floor with group by index having (result)
--Testcase 688:
SELECT value1, floor(10 - value1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | floor 
--------+-------
    1.1 |     8
    2.2 |     7
    3.3 |     6
(3 rows)

-- select floor and as
--Testcase 689:
SELECT floor(value3) as floor1 FROM s3;
 floor1 
--------
     -1
     -1
     -1
     -2
     -3
     -4
(6 rows)

-- select ln as nest function with agg (pushdown, explain)
--Testcase 690:
EXPLAIN VERBOSE
SELECT sum(value3),ln(sum(value1)) FROM s3;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (ln(sum(value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), ln(sum(value1)) FROM public.s3mysql
(6 rows)

-- select ln as nest function with agg (pushdown, result)
--Testcase 691:
SELECT sum(value3),ln(sum(value1)) FROM s3;
        sum         |        ln         
--------------------+-------------------
 -7.200000040233135 | 1.974081031609945
(1 row)

-- select ln as nest with log2 (pushdown, explain)
--Testcase 692:
EXPLAIN VERBOSE
SELECT value1, ln(log2(value1)),ln(log2(1/value1)) FROM s3;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (ln(log2(value1))), (ln(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, ln(public.log2(value1)), ln(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select ln as nest with log2 (pushdown, result)
--Testcase 693:
SELECT value1, ln(log2(value1)),ln(log2(1/value1)) FROM s3;
 value1 |         ln          |         ln         
--------+---------------------+--------------------
    0.1 |                     | 1.2005453593581281
    0.2 |                     | 0.8423979066501629
    0.3 |                     | 0.5521396464396054
    1.1 | -1.9841055075224108 |                   
    2.2 | 0.12883599712995936 |                   
    3.3 |  0.5437569870634226 |                   
(6 rows)

-- select ln with non pushdown func and explicit constant (explain)
--Testcase 694:
EXPLAIN VERBOSE
SELECT ln(value2), pi(), 4.1 FROM s3;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=48)
   Output: (ln((value2)::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ln(value2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select ln with non pushdown func and explicit constant (result)
--Testcase 695:
SELECT ln(value2), pi(), 4.1 FROM s3;
        ln         |        pi         | ?column? 
-------------------+-------------------+----------
 4.605170185988092 | 3.141592653589793 |      4.1
 4.605170185988092 | 3.141592653589793 |      4.1
 4.605170185988092 | 3.141592653589793 |      4.1
 5.298317366548036 | 3.141592653589793 |      4.1
 5.298317366548036 | 3.141592653589793 |      4.1
 5.298317366548036 | 3.141592653589793 |      4.1
(6 rows)

-- select ln with order by (explain)
--Testcase 696:
EXPLAIN VERBOSE
SELECT value1, ln(1-value3) FROM s3 ORDER BY ln(1-value3);
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (ln(('1'::double precision - value3)))
   Sort Key: (ln(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (ln(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, ln((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select ln with order by (result)
--Testcase 697:
SELECT value1, ln(1-value3) FROM s3 ORDER BY ln(1-value3);
 value1 |         ln          
--------+---------------------
    0.1 | 0.09531018115897588
    0.2 | 0.18232155927748148
    0.3 | 0.26236427363743636
    1.1 |  0.7419373560826429
    2.2 |  1.1631508247068418
    3.3 |  1.4586150116102805
(6 rows)

-- select ln with order by index (result)
--Testcase 698:
SELECT value1, ln(1-value3) FROM s3 ORDER BY 2,1;
 value1 |         ln          
--------+---------------------
    0.1 | 0.09531018115897588
    0.2 | 0.18232155927748148
    0.3 | 0.26236427363743636
    1.1 |  0.7419373560826429
    2.2 |  1.1631508247068418
    3.3 |  1.4586150116102805
(6 rows)

-- select ln with order by index (result)
--Testcase 699:
SELECT value1, ln(1-value3) FROM s3 ORDER BY 1,2;
 value1 |         ln          
--------+---------------------
    0.1 | 0.09531018115897588
    0.2 | 0.18232155927748148
    0.3 | 0.26236427363743636
    1.1 |  0.7419373560826429
    2.2 |  1.1631508247068418
    3.3 |  1.4586150116102805
(6 rows)

-- select ln with group by (explain)
--Testcase 700:
EXPLAIN VERBOSE
SELECT count(value1), ln(1-value3) FROM s3 GROUP BY ln(1-value3);
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (ln(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), ln((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select ln with group by (result)
--Testcase 701:
SELECT count(value1), ln(1-value3) FROM s3 GROUP BY ln(1-value3);
 count |         ln          
-------+---------------------
     1 | 0.09531018115897588
     1 | 0.18232155927748148
     1 | 0.26236427363743636
     1 |  0.7419373560826429
     1 |  1.1631508247068418
     1 |  1.4586150116102805
(6 rows)

-- select ln with group by index (result)
--Testcase 702:
SELECT value1, ln(1-value3) FROM s3 GROUP BY 2,1;
 value1 |         ln          
--------+---------------------
    0.1 | 0.09531018115897588
    0.2 | 0.18232155927748148
    0.3 | 0.26236427363743636
    1.1 |  0.7419373560826429
    2.2 |  1.1631508247068418
    3.3 |  1.4586150116102805
(6 rows)

-- select ln with group by index (result)
--Testcase 703:
SELECT value1, ln(1-value3) FROM s3 GROUP BY 1,2;
 value1 |         ln          
--------+---------------------
    0.1 | 0.09531018115897588
    0.2 | 0.18232155927748148
    0.3 | 0.26236427363743636
    1.1 |  0.7419373560826429
    2.2 |  1.1631508247068418
    3.3 |  1.4586150116102805
(6 rows)

-- select ln with group by having (explain)
--Testcase 704:
EXPLAIN VERBOSE
SELECT count(value1), ln(1-value3) FROM s3 GROUP BY ln(1-value3) HAVING ln(avg(value1)) > 0;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (ln(('1'::double precision - value3)))
   Filter: (ln((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), ln((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select ln with group by having (result)
--Testcase 705:
SELECT count(value1), ln(1-value3) FROM s3 GROUP BY ln(1-value3) HAVING ln(avg(value1)) > 0;
 count |         ln         
-------+--------------------
     1 | 0.7419373560826429
     1 | 1.1631508247068418
     1 | 1.4586150116102805
(3 rows)

-- select ln with group by index having (result)
--Testcase 706:
SELECT value1, ln(1-value3) FROM s3 GROUP BY 2,1 HAVING ln(1-value3) < 0;
 value1 | ln 
--------+----
(0 rows)

-- select ln with group by index having (result)
--Testcase 707:
SELECT value1, ln(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |         ln         
--------+--------------------
    1.1 | 0.7419373560826429
    2.2 | 1.1631508247068418
    3.3 | 1.4586150116102805
(3 rows)

-- select ln and as
--Testcase 708:
SELECT ln(value1) as ln1 FROM s3;
         ln1         
---------------------
 -2.3025850780928847
 -1.6094378975329393
 -1.2039727645895069
  0.0953102014787409
  0.7884573820386862
  1.1939224540228235
(6 rows)

-- select ln (builtin function, explain)
--Testcase 709:
EXPLAIN VERBOSE
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..255.05 rows=3413 width=56)
   Output: (ln(value1)), (ln((value2)::double precision)), (ln((value3 + '10'::double precision))), '-0.6931471805599453'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ln(value1), ln(value2), ln((value3 + 10::double precision)), (-0.6931471805599453) FROM public.s3mysql
(4 rows)

-- select ln (builtin function, result)
--Testcase 710:
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3;
         ln          |        ln         |         ln         |         ln          
---------------------+-------------------+--------------------+---------------------
 -2.3025850780928847 | 4.605170185988092 | 2.2925347569900274 | -0.6931471805599453
 -1.6094378975329393 | 4.605170185988092 | 2.2823823853724208 | -0.6931471805599453
 -1.2039727645895069 | 4.605170185988092 | 2.2721258842803755 | -0.6931471805599453
  0.0953102014787409 | 5.298317366548036 | 2.1860512740592335 | -0.6931471805599453
  0.7884573820386862 | 5.298317366548036 | 2.0541237275822493 | -0.6931471805599453
  1.1939224540228235 | 5.298317366548036 | 1.9021075335138928 | -0.6931471805599453
(6 rows)

-- select ln (builtin function, not pushdown constraints, explain)
--Testcase 711:
EXPLAIN VERBOSE
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.41 rows=17 width=56)
   Output: (ln(value1)), (ln((value2)::double precision)), (ln((value3 + '10'::double precision))), '-0.6931471805599453'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ln(value1), ln(value2), ln((value3 + 10::double precision)), (-0.6931471805599453), value2 FROM public.s3mysql
(5 rows)

-- select ln (builtin function, not pushdown constraints, result)
--Testcase 712:
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3 WHERE to_hex(value2) = '64';
         ln          |        ln         |         ln         |         ln          
---------------------+-------------------+--------------------+---------------------
 -2.3025850780928847 | 4.605170185988092 | 2.2925347569900274 | -0.6931471805599453
 -1.6094378975329393 | 4.605170185988092 | 2.2823823853724208 | -0.6931471805599453
 -1.2039727645895069 | 4.605170185988092 | 2.2721258842803755 | -0.6931471805599453
(3 rows)

-- select ln (builtin function, pushdown constraints, explain)
--Testcase 713:
EXPLAIN VERBOSE
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3 WHERE value2 != 200;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.03 rows=3396 width=56)
   Output: (ln(value1)), (ln((value2)::double precision)), (ln((value3 + '10'::double precision))), '-0.6931471805599453'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ln(value1), ln(value2), ln((value3 + 10::double precision)), (-0.6931471805599453) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select ln (builtin function, pushdown constraints, result)
--Testcase 714:
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3 WHERE value2 != 200;
         ln          |        ln         |         ln         |         ln          
---------------------+-------------------+--------------------+---------------------
 -2.3025850780928847 | 4.605170185988092 | 2.2925347569900274 | -0.6931471805599453
 -1.6094378975329393 | 4.605170185988092 | 2.2823823853724208 | -0.6931471805599453
 -1.2039727645895069 | 4.605170185988092 | 2.2721258842803755 | -0.6931471805599453
(3 rows)

-- select ln (builtin function, ln in constraints, explain)
--Testcase 715:
EXPLAIN VERBOSE
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3 WHERE ln(value1) != 1;
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.56 rows=3396 width=56)
   Output: (ln(value1)), (ln((value2)::double precision)), (ln((value3 + '10'::double precision))), '-0.6931471805599453'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ln(value1), ln(value2), ln((value3 + 10::double precision)), (-0.6931471805599453) FROM public.s3mysql WHERE ((ln(value1) <> 1::double precision))
(4 rows)

-- select ln (builtin function, ln in constraints, result)
--Testcase 716:
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3 WHERE ln(value1) != 1;
         ln          |        ln         |         ln         |         ln          
---------------------+-------------------+--------------------+---------------------
 -2.3025850780928847 | 4.605170185988092 | 2.2925347569900274 | -0.6931471805599453
 -1.6094378975329393 | 4.605170185988092 | 2.2823823853724208 | -0.6931471805599453
 -1.2039727645895069 | 4.605170185988092 | 2.2721258842803755 | -0.6931471805599453
  0.0953102014787409 | 5.298317366548036 | 2.1860512740592335 | -0.6931471805599453
  0.7884573820386862 | 5.298317366548036 | 2.0541237275822493 | -0.6931471805599453
  1.1939224540228235 | 5.298317366548036 | 1.9021075335138928 | -0.6931471805599453
(6 rows)

-- select ln (builtin function, ln in constraints, explain)
--Testcase 717:
EXPLAIN VERBOSE
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3 WHERE ln(0.5) < value1;
                                                                                        QUERY PLAN                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..189.65 rows=1138 width=56)
   Output: (ln(value1)), (ln((value2)::double precision)), (ln((value3 + '10'::double precision))), '-0.6931471805599453'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ln(value1), ln(value2), ln((value3 + 10::double precision)), (-0.6931471805599453) FROM public.s3mysql WHERE (((-0.6931471805599453)::double precision < value1))
(4 rows)

-- select ln (builtin function, ln in constraints, result)
--Testcase 718:
SELECT ln(value1), ln(value2), ln(value3 + 10), ln(0.5) FROM s3 WHERE ln(0.5) < value1;
         ln          |        ln         |         ln         |         ln          
---------------------+-------------------+--------------------+---------------------
 -2.3025850780928847 | 4.605170185988092 | 2.2925347569900274 | -0.6931471805599453
 -1.6094378975329393 | 4.605170185988092 | 2.2823823853724208 | -0.6931471805599453
 -1.2039727645895069 | 4.605170185988092 | 2.2721258842803755 | -0.6931471805599453
  0.0953102014787409 | 5.298317366548036 | 2.1860512740592335 | -0.6931471805599453
  0.7884573820386862 | 5.298317366548036 | 2.0541237275822493 | -0.6931471805599453
  1.1939224540228235 | 5.298317366548036 | 1.9021075335138928 | -0.6931471805599453
(6 rows)

-- select mod (builtin function, explain)
--Testcase 719:
EXPLAIN VERBOSE
SELECT value1, mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.65 rows=3413 width=140)
   Output: value1, (mod((value1)::numeric, '2'::numeric)), (mod((value2)::numeric, '2'::numeric)), (mod((value3)::numeric, '2'::numeric)), (mod((value4)::numeric, '2'::numeric)), 1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, mod(value1::numeric, 2::numeric), mod(value2::numeric, 2::numeric), mod(value3::numeric, 2::numeric), mod(value4::numeric, 2::numeric), 1 FROM public.s3mysql
(4 rows)

-- select mod (builtin function, result)
--Testcase 720:
SELECT value1, mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3;
 value1 |         mod         | mod |         mod          | mod | mod 
--------+---------------------+-----+----------------------+-----+-----
    0.1 | 0.10000000149011612 |   0 | -0.10000000149011612 |   0 |   1
    0.2 | 0.20000000298023224 |   0 | -0.20000000298023224 |   0 |   1
    0.3 | 0.30000001192092896 |   0 | -0.30000001192092896 |   0 |   1
    1.1 |   1.100000023841858 |   0 |   -1.100000023841858 |   0 |   1
    2.2 | 0.20000004768371582 |   0 | -0.20000004768371582 |   0 |   1
    3.3 |  1.2999999523162842 |   0 |  -1.2999999523162842 |   0 |   1
(6 rows)

-- select mod (builtin function, not pushdown constraints, explain)
--Testcase 721:
EXPLAIN VERBOSE
SELECT mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3 WHERE to_hex(value2) = '64';
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.53 rows=17 width=132)
   Output: (mod((value1)::numeric, '2'::numeric)), (mod((value2)::numeric, '2'::numeric)), (mod((value3)::numeric, '2'::numeric)), (mod((value4)::numeric, '2'::numeric)), 1
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT mod(value1::numeric, 2::numeric), mod(value2::numeric, 2::numeric), mod(value3::numeric, 2::numeric), mod(value4::numeric, 2::numeric), 1, value2 FROM public.s3mysql
(5 rows)

-- select mod (builtin function, not pushdown constraints, result)
--Testcase 722:
SELECT mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3 WHERE to_hex(value2) = '64';
         mod         | mod |         mod          | mod | mod 
---------------------+-----+----------------------+-----+-----
 0.10000000149011612 |   0 | -0.10000000149011612 |   0 |   1
 0.20000000298023224 |   0 | -0.20000000298023224 |   0 |   1
 0.30000001192092896 |   0 | -0.30000001192092896 |   0 |   1
(3 rows)

-- select mod (builtin function, pushdown constraints, explain)
--Testcase 723:
EXPLAIN VERBOSE
SELECT mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3 WHERE value2 != 200;
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..288.50 rows=3396 width=132)
   Output: (mod((value1)::numeric, '2'::numeric)), (mod((value2)::numeric, '2'::numeric)), (mod((value3)::numeric, '2'::numeric)), (mod((value4)::numeric, '2'::numeric)), 1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT mod(value1::numeric, 2::numeric), mod(value2::numeric, 2::numeric), mod(value3::numeric, 2::numeric), mod(value4::numeric, 2::numeric), 1 FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select mod (builtin function, pushdown constraints, result)
--Testcase 724:
SELECT mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3 WHERE value2 != 200;
         mod         | mod |         mod          | mod | mod 
---------------------+-----+----------------------+-----+-----
 0.10000000149011612 |   0 | -0.10000000149011612 |   0 |   1
 0.20000000298023224 |   0 | -0.20000000298023224 |   0 |   1
 0.30000001192092896 |   0 | -0.30000001192092896 |   0 |   1
(3 rows)

-- select mod (builtin function, mod in constraints, explain)
--Testcase 725:
EXPLAIN VERBOSE
SELECT value1, mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3 WHERE mod(value1::numeric, 2) != 1;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..305.57 rows=3396 width=140)
   Output: value1, (mod((value1)::numeric, '2'::numeric)), (mod((value2)::numeric, '2'::numeric)), (mod((value3)::numeric, '2'::numeric)), (mod((value4)::numeric, '2'::numeric)), 1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, mod(value1::numeric, 2::numeric), mod(value2::numeric, 2::numeric), mod(value3::numeric, 2::numeric), mod(value4::numeric, 2::numeric), 1 FROM public.s3mysql WHERE ((mod(value1::numeric, 2::numeric) <> 1::numeric))
(4 rows)

-- select mod (builtin function, mod in constraints, result)
--Testcase 726:
SELECT value1, mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3 WHERE mod(value1::numeric, 2) != 1;
 value1 |         mod         | mod |         mod          | mod | mod 
--------+---------------------+-----+----------------------+-----+-----
    0.1 | 0.10000000149011612 |   0 | -0.10000000149011612 |   0 |   1
    0.2 | 0.20000000298023224 |   0 | -0.20000000298023224 |   0 |   1
    0.3 | 0.30000001192092896 |   0 | -0.30000001192092896 |   0 |   1
    1.1 |   1.100000023841858 |   0 |   -1.100000023841858 |   0 |   1
    2.2 | 0.20000004768371582 |   0 | -0.20000004768371582 |   0 |   1
    3.3 |  1.2999999523162842 |   0 |  -1.2999999523162842 |   0 |   1
(6 rows)

-- select mod (builtin function, mod in constraints, explain)
--Testcase 727:
EXPLAIN VERBOSE
SELECT mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3 WHERE mod(5, 2) > value1;
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..198.18 rows=1138 width=132)
   Output: (mod((value1)::numeric, '2'::numeric)), (mod((value2)::numeric, '2'::numeric)), (mod((value3)::numeric, '2'::numeric)), (mod((value4)::numeric, '2'::numeric)), 1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT mod(value1::numeric, 2::numeric), mod(value2::numeric, 2::numeric), mod(value3::numeric, 2::numeric), mod(value4::numeric, 2::numeric), 1 FROM public.s3mysql WHERE ((1::double precision > value1))
(4 rows)

-- select mod (builtin function, mod in constraints, result)
--Testcase 728:
SELECT mod(value1::numeric, 2), mod(value2::numeric, 2), mod(value3::numeric, 2), mod(value4::numeric, 2), mod(5, 2) FROM s3 WHERE mod(5, 2) > value1;
         mod         | mod |         mod          | mod | mod 
---------------------+-----+----------------------+-----+-----
 0.10000000149011612 |   0 | -0.10000000149011612 |   0 |   1
 0.20000000298023224 |   0 | -0.20000000298023224 |   0 |   1
 0.30000001192092896 |   0 | -0.30000001192092896 |   0 |   1
(3 rows)

-- select mod as nest function with agg (pushdown, explain)
--Testcase 729:
EXPLAIN VERBOSE
SELECT sum(value3),mod(sum(value3)::numeric, 2) FROM s3;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(value3)), (mod((sum(value3))::numeric, '2'::numeric))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), mod(sum(value3)::numeric, 2::numeric) FROM public.s3mysql
(6 rows)

-- select mod as nest function with agg (pushdown, result)
--Testcase 730:
SELECT sum(value3),mod(sum(value3)::numeric, 2) FROM s3;
        sum         |         mod         
--------------------+---------------------
 -7.200000040233135 | -1.2000000402331352
(1 row)

-- select mod as nest with log2 (pushdown, explain)
--Testcase 731:
EXPLAIN VERBOSE
SELECT value1, mod(log2(value1)::numeric, 2),mod(log2(1/value1)::numeric, 2) FROM s3;
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1961.55 rows=3413 width=72)
   Output: value1, (mod((log2(value1))::numeric, '2'::numeric)), (mod((log2(('1'::double precision / value1)))::numeric, '2'::numeric))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, mod(public.log2(value1)::numeric, 2::numeric), mod(public.log2((1::double precision / value1))::numeric, 2::numeric) FROM public.s3mysql
(4 rows)

-- select mod as nest with log2 (pushdown, result)
--Testcase 732:
SELECT value1, mod(log2(value1)::numeric, 2),mod(log2(1/value1)::numeric, 2) FROM s3;
 value1 |         mod         |         mod         
--------+---------------------+---------------------
    0.1 |  -1.321928073389531 |   1.321928073389531
    0.2 | -0.3219280733895311 |  0.3219280733895311
    0.3 |  -1.736965536838657 |  1.7369655368386572
    1.1 | 0.13750355501950745 | -0.1375035550195074
    2.2 |  1.1375035550195074 | -1.1375035550195074
    3.3 |   1.722466003624709 | -1.7224660036247088
(6 rows)

-- select mod with non pushdown func and explicit constant (explain)
--Testcase 733:
EXPLAIN VERBOSE
SELECT value1, mod(value3::numeric, 2), pi(), 4.1 FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=80)
   Output: value1, (mod((value3)::numeric, '2'::numeric)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, mod(value3::numeric, 2::numeric), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select mod with non pushdown func and explicit constant (result)
--Testcase 734:
SELECT value1, mod(value3::numeric, 2), pi(), 4.1 FROM s3;
 value1 |         mod          |        pi         | ?column? 
--------+----------------------+-------------------+----------
    0.1 | -0.10000000149011612 | 3.141592653589793 |      4.1
    0.2 | -0.20000000298023224 | 3.141592653589793 |      4.1
    0.3 | -0.30000001192092896 | 3.141592653589793 |      4.1
    1.1 |   -1.100000023841858 | 3.141592653589793 |      4.1
    2.2 | -0.20000004768371582 | 3.141592653589793 |      4.1
    3.3 |  -1.2999999523162842 | 3.141592653589793 |      4.1
(6 rows)

-- select mod with order by (explain)
--Testcase 735:
EXPLAIN VERBOSE
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 ORDER BY mod((1-value3)::numeric, 2);
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Sort  (cost=438.28..446.81 rows=3413 width=40)
   Output: value1, (mod((('1'::double precision - value3))::numeric, '2'::numeric))
   Sort Key: (mod((('1'::double precision - s3.value3))::numeric, '2'::numeric))
   ->  Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=40)
         Output: value1, (mod((('1'::double precision - value3))::numeric, '2'::numeric))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, mod((1::double precision - value3)::numeric, 2::numeric) FROM public.s3mysql
(7 rows)

-- select mod with order by (result)
--Testcase 736:
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 ORDER BY mod((1-value3)::numeric, 2);
 value1 |         mod         
--------+---------------------
    1.1 | 0.10000002384185791
    3.3 |  0.2999999523162842
    0.1 |  1.1000000014901161
    0.2 |  1.2000000029802322
    2.2 |  1.2000000476837158
    0.3 |   1.300000011920929
(6 rows)

-- select mod with order by index (result)
--Testcase 737:
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 ORDER BY 2,1;
 value1 |         mod         
--------+---------------------
    1.1 | 0.10000002384185791
    3.3 |  0.2999999523162842
    0.1 |  1.1000000014901161
    0.2 |  1.2000000029802322
    2.2 |  1.2000000476837158
    0.3 |   1.300000011920929
(6 rows)

-- select mod with order by index (result)
--Testcase 738:
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 ORDER BY 1,2;
 value1 |         mod         
--------+---------------------
    0.1 |  1.1000000014901161
    0.2 |  1.2000000029802322
    0.3 |   1.300000011920929
    1.1 | 0.10000002384185791
    2.2 |  1.2000000476837158
    3.3 |  0.2999999523162842
(6 rows)

-- select mod with group by (explain)
--Testcase 739:
EXPLAIN VERBOSE
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 GROUP BY value1, mod((1-value3)::numeric, 2);
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=40)
   Output: value1, (mod((('1'::double precision - value3))::numeric, '2'::numeric))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, mod((1::double precision - value3)::numeric, 2::numeric) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select mod with group by (result)
--Testcase 740:
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 GROUP BY value1, mod((1-value3)::numeric, 2);
 value1 |         mod         
--------+---------------------
    0.1 |  1.1000000014901161
    0.2 |  1.2000000029802322
    0.3 |   1.300000011920929
    1.1 | 0.10000002384185791
    2.2 |  1.2000000476837158
    3.3 |  0.2999999523162842
(6 rows)

-- select mod with group by index (result)
--Testcase 741:
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 GROUP BY 2,1;
 value1 |         mod         
--------+---------------------
    0.1 |  1.1000000014901161
    0.2 |  1.2000000029802322
    0.3 |   1.300000011920929
    1.1 | 0.10000002384185791
    2.2 |  1.2000000476837158
    3.3 |  0.2999999523162842
(6 rows)

-- select mod with group by index (result)
--Testcase 742:
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 GROUP BY 1,2;
 value1 |         mod         
--------+---------------------
    0.1 |  1.1000000014901161
    0.2 |  1.2000000029802322
    0.3 |   1.300000011920929
    1.1 | 0.10000002384185791
    2.2 |  1.2000000476837158
    3.3 |  0.2999999523162842
(6 rows)

-- select mod with group by having (explain)
--Testcase 743:
EXPLAIN VERBOSE
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 GROUP BY value1, mod((1-value3)::numeric, 2) HAVING avg(value1) > 0;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: value1, (mod((('1'::double precision - value3))::numeric, '2'::numeric))
   Filter: ((avg(s3.value1)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, mod((1::double precision - value3)::numeric, 2::numeric), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select mod with group by having (result)
--Testcase 744:
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 GROUP BY value1, mod((1-value3)::numeric, 2) HAVING avg(value1) > 0;
 value1 |         mod         
--------+---------------------
    0.1 |  1.1000000014901161
    0.2 |  1.2000000029802322
    0.3 |   1.300000011920929
    1.1 | 0.10000002384185791
    2.2 |  1.2000000476837158
    3.3 |  0.2999999523162842
(6 rows)

-- select mod with group by index having (result)
--Testcase 745:
SELECT value1, mod((1-value3)::numeric, 2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |         mod         
--------+---------------------
    1.1 | 0.10000002384185791
    2.2 |  1.2000000476837158
    3.3 |  0.2999999523162842
(3 rows)

-- select mod and as
--Testcase 746:
SELECT value1, mod(value3::numeric, 2) as mod1 FROM s3;
 value1 |         mod1         
--------+----------------------
    0.1 | -0.10000000149011612
    0.2 | -0.20000000298023224
    0.3 | -0.30000001192092896
    1.1 |   -1.100000023841858
    2.2 | -0.20000004768371582
    3.3 |  -1.2999999523162842
(6 rows)

-- select power (builtin function, explain)
--Testcase 747:
EXPLAIN VERBOSE
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3;
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=40)
   Output: (power(value1, '2'::double precision)), (power((value2)::double precision, '2'::double precision)), (power(value3, '2'::double precision)), (power((value4)::double precision, '2'::double precision)), '25'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT power(value1, 2::double precision), power(value2, 2::double precision), power(value3, 2::double precision), power(value4, 2::double precision), 25::double precision FROM public.s3mysql
(4 rows)

-- select power (builtin function, result)
--Testcase 748:
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3;
        power         | power |        power         | power | power 
----------------------+-------+----------------------+-------+-------
 0.010000000298023226 | 10000 | 0.010000000298023226 | 10000 |    25
 0.040000001192092904 | 10000 | 0.040000001192092904 | 10000 |    25
  0.09000000715255752 | 10000 |  0.09000000715255752 | 10000 |    25
    1.210000052452088 | 40000 |    1.210000052452088 | 40000 |    25
    4.840000209808352 | 40000 |    4.840000209808352 | 40000 |    25
   10.889999685287478 | 40000 |   10.889999685287478 | 40000 |    25
(6 rows)

-- select power (builtin function, not pushdown constraints, explain)
--Testcase 749:
EXPLAIN VERBOSE
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3 WHERE to_hex(value2) = '64';
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (power(value1, '2'::double precision)), (power((value2)::double precision, '2'::double precision)), (power(value3, '2'::double precision)), (power((value4)::double precision, '2'::double precision)), '25'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT power(value1, 2::double precision), power(value2, 2::double precision), power(value3, 2::double precision), power(value4, 2::double precision), 25::double precision, value2 FROM public.s3mysql
(5 rows)

-- select power (builtin function, not pushdown constraints, result)
--Testcase 750:
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3 WHERE to_hex(value2) = '64';
        power         | power |        power         | power | power 
----------------------+-------+----------------------+-------+-------
 0.010000000298023226 | 10000 | 0.010000000298023226 | 10000 |    25
 0.040000001192092904 | 10000 | 0.040000001192092904 | 10000 |    25
  0.09000000715255752 | 10000 |  0.09000000715255752 | 10000 |    25
(3 rows)

-- select power (builtin function, pushdown constraints, explain)
--Testcase 751:
EXPLAIN VERBOSE
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3 WHERE value2 != 200;
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (power(value1, '2'::double precision)), (power((value2)::double precision, '2'::double precision)), (power(value3, '2'::double precision)), (power((value4)::double precision, '2'::double precision)), '25'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT power(value1, 2::double precision), power(value2, 2::double precision), power(value3, 2::double precision), power(value4, 2::double precision), 25::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select power (builtin function, pushdown constraints, result)
--Testcase 752:
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3 WHERE value2 != 200;
        power         | power |        power         | power | power 
----------------------+-------+----------------------+-------+-------
 0.010000000298023226 | 10000 | 0.010000000298023226 | 10000 |    25
 0.040000001192092904 | 10000 | 0.040000001192092904 | 10000 |    25
  0.09000000715255752 | 10000 |  0.09000000715255752 | 10000 |    25
(3 rows)

-- select power (builtin function, power in constraints, explain)
--Testcase 753:
EXPLAIN VERBOSE
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3 WHERE power(value1, 2) != 1;
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=40)
   Output: (power(value1, '2'::double precision)), (power((value2)::double precision, '2'::double precision)), (power(value3, '2'::double precision)), (power((value4)::double precision, '2'::double precision)), '25'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT power(value1, 2::double precision), power(value2, 2::double precision), power(value3, 2::double precision), power(value4, 2::double precision), 25::double precision FROM public.s3mysql WHERE ((power(value1, 2::double precision) <> 1::double precision))
(4 rows)

-- select power (builtin function, power in constraints, result)
--Testcase 754:
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3 WHERE power(value1, 2) != 1;
        power         | power |        power         | power | power 
----------------------+-------+----------------------+-------+-------
 0.010000000298023226 | 10000 | 0.010000000298023226 | 10000 |    25
 0.040000001192092904 | 10000 | 0.040000001192092904 | 10000 |    25
  0.09000000715255752 | 10000 |  0.09000000715255752 | 10000 |    25
    1.210000052452088 | 40000 |    1.210000052452088 | 40000 |    25
    4.840000209808352 | 40000 |    4.840000209808352 | 40000 |    25
   10.889999685287478 | 40000 |   10.889999685287478 | 40000 |    25
(6 rows)

-- select power (builtin function, power in constraints, explain)
--Testcase 755:
EXPLAIN VERBOSE
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3 WHERE power(5, 2) > value1;
                                                                                                                       QUERY PLAN                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=40)
   Output: (power(value1, '2'::double precision)), (power((value2)::double precision, '2'::double precision)), (power(value3, '2'::double precision)), (power((value4)::double precision, '2'::double precision)), '25'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT power(value1, 2::double precision), power(value2, 2::double precision), power(value3, 2::double precision), power(value4, 2::double precision), 25::double precision FROM public.s3mysql WHERE ((25::double precision > value1))
(4 rows)

-- select power (builtin function, power in constraints, result)
--Testcase 756:
SELECT power(value1, 2), power(value2, 2), power(value3, 2), power(value4, 2), power(5, 2) FROM s3 WHERE power(5, 2) > value1;
        power         | power |        power         | power | power 
----------------------+-------+----------------------+-------+-------
 0.010000000298023226 | 10000 | 0.010000000298023226 | 10000 |    25
 0.040000001192092904 | 10000 | 0.040000001192092904 | 10000 |    25
  0.09000000715255752 | 10000 |  0.09000000715255752 | 10000 |    25
    1.210000052452088 | 40000 |    1.210000052452088 | 40000 |    25
    4.840000209808352 | 40000 |    4.840000209808352 | 40000 |    25
   10.889999685287478 | 40000 |   10.889999685287478 | 40000 |    25
(6 rows)

-- select power as nest function with agg (pushdown, explain)
--Testcase 757:
EXPLAIN VERBOSE
SELECT sum(value3),power(sum(value3), 2) FROM s3;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (power(sum(value3), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), power(sum(value3), 2::double precision) FROM public.s3mysql
(6 rows)

-- select power as nest function with agg (pushdown, result)
--Testcase 758:
SELECT sum(value3),power(sum(value3), 2) FROM s3;
        sum         |       power       
--------------------+-------------------
 -7.200000040233135 | 51.84000057935715
(1 row)

-- select power as nest with log2 (pushdown, explain)
--Testcase 759:
EXPLAIN VERBOSE
SELECT value1, power(log2(value1), 2),power(log2(1/value1), 2) FROM s3;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (power(log2(value1), '2'::double precision)), (power(log2(('1'::double precision / value1)), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, power(public.log2(value1), 2::double precision), power(public.log2((1::double precision / value1)), 2::double precision) FROM public.s3mysql
(4 rows)

-- select power as nest with log2 (pushdown, result)
--Testcase 760:
SELECT value1, power(log2(value1), 2),power(log2(1/value1), 2) FROM s3;
 value1 |        power         |       power        
--------+----------------------+--------------------
    0.1 |   11.035206124773483 | 11.035206124773483
    0.2 |     5.39134997799442 |   5.39134997799442
    0.3 |   3.0170492761652037 | 3.0170492761652046
    1.1 | 0.018907227643002712 | 0.0189072276430027
    2.2 |   1.2939143376820175 | 1.2939143376820175
    3.3 |    2.966889133642876 | 2.9668891336428755
(6 rows)

-- select power with non pushdown func and explicit constant (explain)
--Testcase 761:
EXPLAIN VERBOSE
SELECT power(value3, 2), pi(), 4.1 FROM s3;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (power(value3, '2'::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT power(value3, 2::double precision), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select power with non pushdown func and explicit constant (result)
--Testcase 762:
SELECT power(value3, 2), pi(), 4.1 FROM s3;
        power         |        pi         | ?column? 
----------------------+-------------------+----------
 0.010000000298023226 | 3.141592653589793 |      4.1
 0.040000001192092904 | 3.141592653589793 |      4.1
  0.09000000715255752 | 3.141592653589793 |      4.1
    1.210000052452088 | 3.141592653589793 |      4.1
    4.840000209808352 | 3.141592653589793 |      4.1
   10.889999685287478 | 3.141592653589793 |      4.1
(6 rows)

-- select power with order by (explain)
--Testcase 763:
EXPLAIN VERBOSE
SELECT value1, power(1-value3, 2) FROM s3 ORDER BY power(1-value3, 2);
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (power(('1'::double precision - value3), '2'::double precision))
   Sort Key: (power(('1'::double precision - s3.value3), '2'::double precision))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (power(('1'::double precision - value3), '2'::double precision))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, power((1::double precision - value3), 2::double precision) FROM public.s3mysql
(7 rows)

-- select power with order by (result)
--Testcase 764:
SELECT value1, power(1-value3, 2) FROM s3 ORDER BY power(1-value3, 2);
 value1 |       power        
--------+--------------------
    0.1 | 1.2100000032782554
    0.2 | 1.4400000071525574
    0.3 | 1.6900000309944154
    1.1 |  4.410000100135804
    2.2 | 10.240000305175784
    3.3 | 18.489999589920046
(6 rows)

-- select power with order by index (result)
--Testcase 765:
SELECT value1, power(1-value3, 2) FROM s3 ORDER BY 2,1;
 value1 |       power        
--------+--------------------
    0.1 | 1.2100000032782554
    0.2 | 1.4400000071525574
    0.3 | 1.6900000309944154
    1.1 |  4.410000100135804
    2.2 | 10.240000305175784
    3.3 | 18.489999589920046
(6 rows)

-- select power with order by index (result)
--Testcase 766:
SELECT value1, power(1-value3, 2) FROM s3 ORDER BY 1,2;
 value1 |       power        
--------+--------------------
    0.1 | 1.2100000032782554
    0.2 | 1.4400000071525574
    0.3 | 1.6900000309944154
    1.1 |  4.410000100135804
    2.2 | 10.240000305175784
    3.3 | 18.489999589920046
(6 rows)

-- select power with group by (explain)
--Testcase 767:
EXPLAIN VERBOSE
SELECT count(value1), power(1-value3, 2) FROM s3 GROUP BY power(1-value3, 2);
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (power(('1'::double precision - value3), '2'::double precision))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), power((1::double precision - value3), 2::double precision) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select power with group by (result)
--Testcase 768:
SELECT count(value1), power(1-value3, 2) FROM s3 GROUP BY power(1-value3, 2);
 count |       power        
-------+--------------------
     1 | 1.2100000032782554
     1 | 1.4400000071525574
     1 | 1.6900000309944154
     1 |  4.410000100135804
     1 | 10.240000305175784
     1 | 18.489999589920046
(6 rows)

-- select power with group by index (result)
--Testcase 769:
SELECT value1, power(1-value3, 2) FROM s3 GROUP BY 2,1;
 value1 |       power        
--------+--------------------
    0.1 | 1.2100000032782554
    0.2 | 1.4400000071525574
    0.3 | 1.6900000309944154
    1.1 |  4.410000100135804
    2.2 | 10.240000305175784
    3.3 | 18.489999589920046
(6 rows)

-- select power with group by index (result)
--Testcase 770:
SELECT value1, power(1-value3, 2) FROM s3 GROUP BY 1,2;
 value1 |       power        
--------+--------------------
    0.1 | 1.2100000032782554
    0.2 | 1.4400000071525574
    0.3 | 1.6900000309944154
    1.1 |  4.410000100135804
    2.2 | 10.240000305175784
    3.3 | 18.489999589920046
(6 rows)

-- select power with group by having (explain)
--Testcase 771:
EXPLAIN VERBOSE
SELECT count(value1), power(1-value3, 2) FROM s3 GROUP BY power(1-value3, 2) HAVING power(avg(value1), 2) > 0;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (power(('1'::double precision - value3), '2'::double precision))
   Filter: (power((avg(s3.value1)), '2'::double precision) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), power((1::double precision - value3), 2::double precision), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select power with group by having (result)
--Testcase 772:
SELECT count(value1), power(1-value3, 2) FROM s3 GROUP BY power(1-value3, 2) HAVING power(avg(value1), 2) > 0;
 count |       power        
-------+--------------------
     1 | 1.2100000032782554
     1 | 1.4400000071525574
     1 | 1.6900000309944154
     1 |  4.410000100135804
     1 | 10.240000305175784
     1 | 18.489999589920046
(6 rows)

-- select power with group by index having (result)
--Testcase 773:
SELECT value1, power(1-value3, 2) FROM s3 GROUP BY 2,1 HAVING power(1-value3, 2) > 0;
 value1 |       power        
--------+--------------------
    0.1 | 1.2100000032782554
    0.2 | 1.4400000071525574
    0.3 | 1.6900000309944154
    1.1 |  4.410000100135804
    2.2 | 10.240000305175784
    3.3 | 18.489999589920046
(6 rows)

-- select power with group by index having (result)
--Testcase 774:
SELECT value1, power(1-value3, 2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |       power        
--------+--------------------
    1.1 |  4.410000100135804
    2.2 | 10.240000305175784
    3.3 | 18.489999589920046
(3 rows)

-- select power and as
--Testcase 775:
SELECT power(value3, 2) as power1 FROM s3;
        power1        
----------------------
 0.010000000298023226
 0.040000001192092904
  0.09000000715255752
    1.210000052452088
    4.840000209808352
   10.889999685287478
(6 rows)

-- select radians (builtin function, explain)
--Testcase 776:
EXPLAIN VERBOSE
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3;
                                                                               QUERY PLAN                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=40)
   Output: (radians(value1)), (radians((value2)::double precision)), (radians(value3)), (radians((value4)::double precision)), '0.008726646259971648'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT radians(value1), radians(value2), radians(value3), radians(value4), 0.008726646259971648::double precision FROM public.s3mysql
(4 rows)

-- select radians (builtin function, result)
--Testcase 777:
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3;
        radians        |      radians       |        radians         |       radians       |       radians        
-----------------------+--------------------+------------------------+---------------------+----------------------
 0.0017453292780017621 | 1.7453292519943295 | -0.0017453292780017621 | -1.7453292519943295 | 0.008726646259971648
 0.0034906585560035243 | 1.7453292519943295 | -0.0034906585560035243 | -1.7453292519943295 | 0.008726646259971648
  0.005235987964042448 | 1.7453292519943295 |  -0.005235987964042448 | -1.7453292519943295 | 0.008726646259971648
  0.019198622188056545 |  3.490658503988659 |  -0.019198622188056545 |  -3.490658503988659 | 0.008726646259971648
   0.03839724437611309 |  3.490658503988659 |   -0.03839724437611309 |  -3.490658503988659 | 0.008726646259971648
   0.05759586448357504 |  3.490658503988659 |   -0.05759586448357504 |  -3.490658503988659 | 0.008726646259971648
(6 rows)

-- select radians (builtin function, not pushdown constraints, explain)
--Testcase 778:
EXPLAIN VERBOSE
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                               QUERY PLAN                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (radians(value1)), (radians((value2)::double precision)), (radians(value3)), (radians((value4)::double precision)), '0.008726646259971648'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT radians(value1), radians(value2), radians(value3), radians(value4), 0.008726646259971648::double precision, value2 FROM public.s3mysql
(5 rows)

-- select radians (builtin function, not pushdown constraints, result)
--Testcase 779:
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3 WHERE to_hex(value2) = '64';
        radians        |      radians       |        radians         |       radians       |       radians        
-----------------------+--------------------+------------------------+---------------------+----------------------
 0.0017453292780017621 | 1.7453292519943295 | -0.0017453292780017621 | -1.7453292519943295 | 0.008726646259971648
 0.0034906585560035243 | 1.7453292519943295 | -0.0034906585560035243 | -1.7453292519943295 | 0.008726646259971648
  0.005235987964042448 | 1.7453292519943295 |  -0.005235987964042448 | -1.7453292519943295 | 0.008726646259971648
(3 rows)

-- select radians (builtin function, pushdown constraints, explain)
--Testcase 780:
EXPLAIN VERBOSE
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3 WHERE value2 != 200;
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (radians(value1)), (radians((value2)::double precision)), (radians(value3)), (radians((value4)::double precision)), '0.008726646259971648'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT radians(value1), radians(value2), radians(value3), radians(value4), 0.008726646259971648::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select radians (builtin function, pushdown constraints, result)
--Testcase 781:
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3 WHERE value2 != 200;
        radians        |      radians       |        radians         |       radians       |       radians        
-----------------------+--------------------+------------------------+---------------------+----------------------
 0.0017453292780017621 | 1.7453292519943295 | -0.0017453292780017621 | -1.7453292519943295 | 0.008726646259971648
 0.0034906585560035243 | 1.7453292519943295 | -0.0034906585560035243 | -1.7453292519943295 | 0.008726646259971648
  0.005235987964042448 | 1.7453292519943295 |  -0.005235987964042448 | -1.7453292519943295 | 0.008726646259971648
(3 rows)

-- select radians (builtin function, radians in constraints, explain)
--Testcase 782:
EXPLAIN VERBOSE
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3 WHERE radians(value1) != 1;
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=40)
   Output: (radians(value1)), (radians((value2)::double precision)), (radians(value3)), (radians((value4)::double precision)), '0.008726646259971648'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT radians(value1), radians(value2), radians(value3), radians(value4), 0.008726646259971648::double precision FROM public.s3mysql WHERE ((radians(value1) <> 1::double precision))
(4 rows)

-- select radians (builtin function, radians in constraints, result)
--Testcase 783:
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3 WHERE radians(value1) != 1;
        radians        |      radians       |        radians         |       radians       |       radians        
-----------------------+--------------------+------------------------+---------------------+----------------------
 0.0017453292780017621 | 1.7453292519943295 | -0.0017453292780017621 | -1.7453292519943295 | 0.008726646259971648
 0.0034906585560035243 | 1.7453292519943295 | -0.0034906585560035243 | -1.7453292519943295 | 0.008726646259971648
  0.005235987964042448 | 1.7453292519943295 |  -0.005235987964042448 | -1.7453292519943295 | 0.008726646259971648
  0.019198622188056545 |  3.490658503988659 |  -0.019198622188056545 |  -3.490658503988659 | 0.008726646259971648
   0.03839724437611309 |  3.490658503988659 |   -0.03839724437611309 |  -3.490658503988659 | 0.008726646259971648
   0.05759586448357504 |  3.490658503988659 |   -0.05759586448357504 |  -3.490658503988659 | 0.008726646259971648
(6 rows)

-- select radians (builtin function, radians in constraints, explain)
--Testcase 784:
EXPLAIN VERBOSE
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3 WHERE radians(0.5) < value1;
                                                                                                   QUERY PLAN                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=40)
   Output: (radians(value1)), (radians((value2)::double precision)), (radians(value3)), (radians((value4)::double precision)), '0.008726646259971648'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT radians(value1), radians(value2), radians(value3), radians(value4), 0.008726646259971648::double precision FROM public.s3mysql WHERE ((0.008726646259971648::double precision < value1))
(4 rows)

-- select radians (builtin function, radians in constraints, result)
--Testcase 785:
SELECT radians(value1), radians(value2), radians(value3), radians(value4), radians(0.5) FROM s3 WHERE radians(0.5) < value1;
        radians        |      radians       |        radians         |       radians       |       radians        
-----------------------+--------------------+------------------------+---------------------+----------------------
 0.0017453292780017621 | 1.7453292519943295 | -0.0017453292780017621 | -1.7453292519943295 | 0.008726646259971648
 0.0034906585560035243 | 1.7453292519943295 | -0.0034906585560035243 | -1.7453292519943295 | 0.008726646259971648
  0.005235987964042448 | 1.7453292519943295 |  -0.005235987964042448 | -1.7453292519943295 | 0.008726646259971648
  0.019198622188056545 |  3.490658503988659 |  -0.019198622188056545 |  -3.490658503988659 | 0.008726646259971648
   0.03839724437611309 |  3.490658503988659 |   -0.03839724437611309 |  -3.490658503988659 | 0.008726646259971648
   0.05759586448357504 |  3.490658503988659 |   -0.05759586448357504 |  -3.490658503988659 | 0.008726646259971648
(6 rows)

-- select radians as nest function with agg (pushdown, explain)
--Testcase 786:
EXPLAIN VERBOSE
SELECT sum(value3),radians(sum(value3)) FROM s3;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (radians(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), radians(sum(value3)) FROM public.s3mysql
(6 rows)

-- select radians as nest function with agg (pushdown, result)
--Testcase 787:
SELECT sum(value3),radians(sum(value3)) FROM s3;
        sum         |       radians       
--------------------+---------------------
 -7.200000040233135 | -0.1256637068457924
(1 row)

-- select radians as nest with log2 (pushdown, explain)
--Testcase 788:
EXPLAIN VERBOSE
SELECT radians(log2(value1)),radians(log2(1/value1)) FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (radians(log2(value1))), (radians(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT radians(public.log2(value1)), radians(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select radians as nest with log2 (pushdown, result)
--Testcase 789:
SELECT radians(log2(value1)),radians(log2(1/value1)) FROM s3;
        radians        |        radians        
-----------------------+-----------------------
 -0.057978582395079144 |  0.057978582395079144
  -0.04052528987513585 |   0.04052528987513585
 -0.030315767611505423 |  0.030315767611505427
  0.002399889768287581 |  -0.00239988976828758
  0.019853182288230874 | -0.019853182288230874
  0.030062703016919757 |  -0.03006270301691975
(6 rows)

-- select radians with non pushdown func and explicit constant (explain)
--Testcase 790:
EXPLAIN VERBOSE
SELECT radians(value3), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (radians(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT radians(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select radians with non pushdown func and explicit constant (result)
--Testcase 791:
SELECT radians(value3), pi(), 4.1 FROM s3;
        radians         |        pi         | ?column? 
------------------------+-------------------+----------
 -0.0017453292780017621 | 3.141592653589793 |      4.1
 -0.0034906585560035243 | 3.141592653589793 |      4.1
  -0.005235987964042448 | 3.141592653589793 |      4.1
  -0.019198622188056545 | 3.141592653589793 |      4.1
   -0.03839724437611309 | 3.141592653589793 |      4.1
   -0.05759586448357504 | 3.141592653589793 |      4.1
(6 rows)

-- select radians with order by (explain)
--Testcase 792:
EXPLAIN VERBOSE
SELECT value1, radians(1-value3) FROM s3 ORDER BY radians(1-value3);
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (radians(('1'::double precision - value3)))
   Sort Key: (radians(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (radians(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, radians((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select radians with order by (result)
--Testcase 793:
SELECT value1, radians(1-value3) FROM s3 ORDER BY radians(1-value3);
 value1 |       radians        
--------+----------------------
    0.1 | 0.019198621797945056
    0.2 |  0.02094395107594682
    0.3 | 0.022689280483985743
    1.1 |  0.03665191470799984
    2.2 |  0.05585053689605639
    3.3 |  0.07504915700351833
(6 rows)

-- select radians with order by index (result)
--Testcase 794:
SELECT value1, radians(1-value3) FROM s3 ORDER BY 2,1;
 value1 |       radians        
--------+----------------------
    0.1 | 0.019198621797945056
    0.2 |  0.02094395107594682
    0.3 | 0.022689280483985743
    1.1 |  0.03665191470799984
    2.2 |  0.05585053689605639
    3.3 |  0.07504915700351833
(6 rows)

-- select radians with order by index (result)
--Testcase 795:
SELECT value1, radians(1-value3) FROM s3 ORDER BY 1,2;
 value1 |       radians        
--------+----------------------
    0.1 | 0.019198621797945056
    0.2 |  0.02094395107594682
    0.3 | 0.022689280483985743
    1.1 |  0.03665191470799984
    2.2 |  0.05585053689605639
    3.3 |  0.07504915700351833
(6 rows)

-- select radians with group by (explain)
--Testcase 796:
EXPLAIN VERBOSE
SELECT count(value1), radians(1-value3) FROM s3 GROUP BY radians(1-value3);
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (radians(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), radians((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select radians with group by (result)
--Testcase 797:
SELECT count(value1), radians(1-value3) FROM s3 GROUP BY radians(1-value3);
 count |       radians        
-------+----------------------
     1 | 0.019198621797945056
     1 |  0.02094395107594682
     1 | 0.022689280483985743
     1 |  0.03665191470799984
     1 |  0.05585053689605639
     1 |  0.07504915700351833
(6 rows)

-- select radians with group by index (result)
--Testcase 798:
SELECT value1, radians(1-value3) FROM s3 GROUP BY 2,1;
 value1 |       radians        
--------+----------------------
    0.1 | 0.019198621797945056
    0.2 |  0.02094395107594682
    0.3 | 0.022689280483985743
    1.1 |  0.03665191470799984
    2.2 |  0.05585053689605639
    3.3 |  0.07504915700351833
(6 rows)

-- select radians with group by index (result)
--Testcase 799:
SELECT value1, radians(1-value3) FROM s3 GROUP BY 1,2;
 value1 |       radians        
--------+----------------------
    0.1 | 0.019198621797945056
    0.2 |  0.02094395107594682
    0.3 | 0.022689280483985743
    1.1 |  0.03665191470799984
    2.2 |  0.05585053689605639
    3.3 |  0.07504915700351833
(6 rows)

-- select radians with group by having (explain)
--Testcase 800:
EXPLAIN VERBOSE
SELECT count(value1), radians(1-value3) FROM s3 GROUP BY radians(1-value3) HAVING radians(avg(value1)) > 0;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (radians(('1'::double precision - value3)))
   Filter: (radians((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), radians((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select radians with group by having (result)
--Testcase 801:
SELECT count(value1), radians(1-value3) FROM s3 GROUP BY radians(1-value3) HAVING radians(avg(value1)) > 0;
 count |       radians        
-------+----------------------
     1 | 0.019198621797945056
     1 |  0.02094395107594682
     1 | 0.022689280483985743
     1 |  0.03665191470799984
     1 |  0.05585053689605639
     1 |  0.07504915700351833
(6 rows)

-- select radians with group by index having (result)
--Testcase 802:
SELECT value1, radians(1-value3) FROM s3 GROUP BY 2,1 HAVING radians(1-value3) > 0;
 value1 |       radians        
--------+----------------------
    0.1 | 0.019198621797945056
    0.2 |  0.02094395107594682
    0.3 | 0.022689280483985743
    1.1 |  0.03665191470799984
    2.2 |  0.05585053689605639
    3.3 |  0.07504915700351833
(6 rows)

-- select radians with group by index having (result)
--Testcase 803:
SELECT value1, radians(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |       radians       
--------+---------------------
    1.1 | 0.03665191470799984
    2.2 | 0.05585053689605639
    3.3 | 0.07504915700351833
(3 rows)

-- select radians and as
--Testcase 804:
SELECT radians(value3) as radians1 FROM s3;
        radians1        
------------------------
 -0.0017453292780017621
 -0.0034906585560035243
  -0.005235987964042448
  -0.019198622188056545
   -0.03839724437611309
   -0.05759586448357504
(6 rows)

-- select sign (builtin function, explain)
--Testcase 805:
EXPLAIN VERBOSE
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=64)
   Output: (sign(value1)), (sign((value2)::double precision)), (sign(value3)), (sign((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sign(value1), sign(value2), sign(value3), sign(value4), 1::numeric FROM public.s3mysql
(4 rows)

-- select sign (builtin function, result)
--Testcase 806:
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3;
 sign | sign | sign | sign | sign 
------+------+------+------+------
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
(6 rows)

-- select sign (builtin function, not pushdown constraints, explain)
--Testcase 807:
EXPLAIN VERBOSE
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=64)
   Output: (sign(value1)), (sign((value2)::double precision)), (sign(value3)), (sign((value4)::double precision)), '1'::numeric
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sign(value1), sign(value2), sign(value3), sign(value4), 1::numeric, value2 FROM public.s3mysql
(5 rows)

-- select sign (builtin function, not pushdown constraints, result)
--Testcase 808:
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3 WHERE to_hex(value2) = '64';
 sign | sign | sign | sign | sign 
------+------+------+------+------
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
(3 rows)

-- select sign (builtin function, pushdown constraints, explain)
--Testcase 809:
EXPLAIN VERBOSE
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3 WHERE value2 != 200;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=64)
   Output: (sign(value1)), (sign((value2)::double precision)), (sign(value3)), (sign((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sign(value1), sign(value2), sign(value3), sign(value4), 1::numeric FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select sign (builtin function, pushdown constraints, result)
--Testcase 810:
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3 WHERE value2 != 200;
 sign | sign | sign | sign | sign 
------+------+------+------+------
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
(3 rows)

-- select sign (builtin function, sign in constraints, explain)
--Testcase 811:
EXPLAIN VERBOSE
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3 WHERE sign(value1) != -1;
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..280.06 rows=3396 width=64)
   Output: (sign(value1)), (sign((value2)::double precision)), (sign(value3)), (sign((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sign(value1), sign(value2), sign(value3), sign(value4), 1::numeric FROM public.s3mysql WHERE ((sign(value1) <> (-1)::double precision))
(4 rows)

-- select sign (builtin function, sign in constraints, result)
--Testcase 812:
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3 WHERE sign(value1) != -1;
 sign | sign | sign | sign | sign 
------+------+------+------+------
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
(6 rows)

-- select sign (builtin function, sign in constraints, explain)
--Testcase 813:
EXPLAIN VERBOSE
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3 WHERE sign(0.5) > value1;
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=64)
   Output: (sign(value1)), (sign((value2)::double precision)), (sign(value3)), (sign((value4)::double precision)), '1'::numeric
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sign(value1), sign(value2), sign(value3), sign(value4), 1::numeric FROM public.s3mysql WHERE ((1::double precision > value1))
(4 rows)

-- select sign (builtin function, sign in constraints, result)
--Testcase 814:
SELECT sign(value1), sign(value2), sign(value3), sign(value4), sign(0.5) FROM s3 WHERE sign(0.5) > value1;
 sign | sign | sign | sign | sign 
------+------+------+------+------
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
    1 |    1 |   -1 |   -1 |    1
(3 rows)

-- select sign as nest function with agg (pushdown, explain)
--Testcase 815:
EXPLAIN VERBOSE
SELECT sum(value3),sign(sum(value3)) FROM s3;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (sign(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), sign(sum(value3)) FROM public.s3mysql
(6 rows)

-- select sign as nest function with agg (pushdown, result)
--Testcase 816:
SELECT sum(value3),sign(sum(value3)) FROM s3;
        sum         | sign 
--------------------+------
 -7.200000040233135 |   -1
(1 row)

-- select sign as nest with log2 (pushdown, explain)
--Testcase 817:
EXPLAIN VERBOSE
SELECT sign(log2(value1)),sign(log2(1/value1)) FROM s3;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=16)
   Output: (sign(log2(value1))), (sign(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sign(public.log2(value1)), sign(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select sign as nest with log2 (pushdown, result)
--Testcase 818:
SELECT sign(log2(value1)),sign(log2(1/value1)) FROM s3;
 sign | sign 
------+------
   -1 |    1
   -1 |    1
   -1 |    1
    1 |   -1
    1 |   -1
    1 |   -1
(6 rows)

-- select sign with non pushdown func and explicit constant (explain)
--Testcase 819:
EXPLAIN VERBOSE
SELECT sign(value3), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=48)
   Output: (sign(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sign(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select sign with non pushdown func and explicit constant (result)
--Testcase 820:
SELECT sign(value3), pi(), 4.1 FROM s3;
 sign |        pi         | ?column? 
------+-------------------+----------
   -1 | 3.141592653589793 |      4.1
   -1 | 3.141592653589793 |      4.1
   -1 | 3.141592653589793 |      4.1
   -1 | 3.141592653589793 |      4.1
   -1 | 3.141592653589793 |      4.1
   -1 | 3.141592653589793 |      4.1
(6 rows)

-- select sign with order by (explain)
--Testcase 821:
EXPLAIN VERBOSE
SELECT value1, sign(1-value3) FROM s3 ORDER BY sign(1-value3);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (sign(('1'::double precision - value3)))
   Sort Key: (sign(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (sign(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, sign((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select sign with order by (result)
--Testcase 822:
SELECT value1, sign(1-value3) FROM s3 ORDER BY sign(1-value3);
 value1 | sign 
--------+------
    0.1 |    1
    0.2 |    1
    0.3 |    1
    1.1 |    1
    2.2 |    1
    3.3 |    1
(6 rows)

-- select sign with order by index (result)
--Testcase 823:
SELECT value1, sign(1-value3) FROM s3 ORDER BY 2,1;
 value1 | sign 
--------+------
    0.1 |    1
    0.2 |    1
    0.3 |    1
    1.1 |    1
    2.2 |    1
    3.3 |    1
(6 rows)

-- select sign with order by index (result)
--Testcase 824:
SELECT value1, sign(1-value3) FROM s3 ORDER BY 1,2;
 value1 | sign 
--------+------
    0.1 |    1
    0.2 |    1
    0.3 |    1
    1.1 |    1
    2.2 |    1
    3.3 |    1
(6 rows)

-- select sign with group by (explain)
--Testcase 825:
EXPLAIN VERBOSE
SELECT count(value1), sign(1-value3) FROM s3 GROUP BY sign(1-value3);
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (sign(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), sign((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select sign with group by (result)
--Testcase 826:
SELECT count(value1), sign(1-value3) FROM s3 GROUP BY sign(1-value3);
 count | sign 
-------+------
     6 |    1
(1 row)

-- select sign with group by index (result)
--Testcase 827:
SELECT value1, sign(1-value3) FROM s3 GROUP BY 2,1;
 value1 | sign 
--------+------
    0.1 |    1
    0.2 |    1
    0.3 |    1
    1.1 |    1
    2.2 |    1
    3.3 |    1
(6 rows)

-- select sign with group by index (result)
--Testcase 828:
SELECT value1, sign(1-value3) FROM s3 GROUP BY 1,2;
 value1 | sign 
--------+------
    0.1 |    1
    0.2 |    1
    0.3 |    1
    1.1 |    1
    2.2 |    1
    3.3 |    1
(6 rows)

-- select sign with group by having (explain)
--Testcase 829:
EXPLAIN VERBOSE
SELECT count(value1), sign(1-value3) FROM s3 GROUP BY sign(1-value3) HAVING sign(avg(value1)) > 0;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (sign(('1'::double precision - value3)))
   Filter: (sign((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), sign((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select sign with group by having (result)
--Testcase 830:
SELECT count(value1), sign(1-value3) FROM s3 GROUP BY sign(1-value3) HAVING sign(avg(value1)) > 0;
 count | sign 
-------+------
     6 |    1
(1 row)

-- select sign with group by index having (result)
--Testcase 831:
SELECT value1, sign(1-value3) FROM s3 GROUP BY 2,1 HAVING sign(1-value3) > 0;
 value1 | sign 
--------+------
    0.1 |    1
    0.2 |    1
    0.3 |    1
    1.1 |    1
    2.2 |    1
    3.3 |    1
(6 rows)

-- select sign with group by index having (result)
--Testcase 832:
SELECT value1, sign(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | sign 
--------+------
    1.1 |    1
    2.2 |    1
    3.3 |    1
(3 rows)

-- select sign and as
--Testcase 833:
SELECT sign(value3) as sign1 FROM s3;
 sign1 
-------
    -1
    -1
    -1
    -1
    -1
    -1
(6 rows)

-- select sin (builtin function, explain)
--Testcase 834:
EXPLAIN VERBOSE
SELECT value1, sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..255.05 rows=3413 width=40)
   Output: value1, (sin((value2)::double precision)), (sin(value3)), (sin((value4)::double precision)), '0.479425538604203'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, sin(value2), sin(value3), sin(value4), 0.479425538604203::double precision FROM public.s3mysql
(4 rows)

-- select sin (builtin function, result)
--Testcase 835:
SELECT value1, sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3;
 value1 |         sin         |         sin          |        sin         |        sin        
--------+---------------------+----------------------+--------------------+-------------------
    0.1 | -0.5063656411097588 |  -0.0998334181294999 | 0.5063656411097588 | 0.479425538604203
    0.2 | -0.5063656411097588 | -0.19866933371588721 | 0.5063656411097588 | 0.479425538604203
    0.3 | -0.5063656411097588 | -0.29552021804983797 | 0.5063656411097588 | 0.479425538604203
    1.1 | -0.8732972972139946 |  -0.8912073708760093 | 0.8732972972139946 | 0.479425538604203
    2.2 | -0.8732972972139946 |  -0.8084963757576692 | 0.8732972972139946 | 0.479425538604203
    3.3 | -0.8732972972139946 |  0.15774564705654348 | 0.8732972972139946 | 0.479425538604203
(6 rows)

-- select sin (builtin function, not pushdown constraints, explain)
--Testcase 836:
EXPLAIN VERBOSE
SELECT sin(value1), sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (sin(value1)), (sin((value2)::double precision)), (sin(value3)), (sin((value4)::double precision)), '0.479425538604203'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sin(value1), sin(value2), sin(value3), sin(value4), 0.479425538604203::double precision, value2 FROM public.s3mysql
(5 rows)

-- select sin (builtin function, not pushdown constraints, result)
--Testcase 837:
SELECT sin(value1), sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3 WHERE to_hex(value2) = '64';
         sin         |         sin         |         sin          |        sin         |        sin        
---------------------+---------------------+----------------------+--------------------+-------------------
  0.0998334181294999 | -0.5063656411097588 |  -0.0998334181294999 | 0.5063656411097588 | 0.479425538604203
 0.19866933371588721 | -0.5063656411097588 | -0.19866933371588721 | 0.5063656411097588 | 0.479425538604203
 0.29552021804983797 | -0.5063656411097588 | -0.29552021804983797 | 0.5063656411097588 | 0.479425538604203
(3 rows)

-- select sin (builtin function, pushdown constraints, explain)
--Testcase 838:
EXPLAIN VERBOSE
SELECT sin(value1), sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3 WHERE value2 != 200;
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (sin(value1)), (sin((value2)::double precision)), (sin(value3)), (sin((value4)::double precision)), '0.479425538604203'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sin(value1), sin(value2), sin(value3), sin(value4), 0.479425538604203::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select sin (builtin function, pushdown constraints, result)
--Testcase 839:
SELECT sin(value1), sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3 WHERE value2 != 200;
         sin         |         sin         |         sin          |        sin         |        sin        
---------------------+---------------------+----------------------+--------------------+-------------------
  0.0998334181294999 | -0.5063656411097588 |  -0.0998334181294999 | 0.5063656411097588 | 0.479425538604203
 0.19866933371588721 | -0.5063656411097588 | -0.19866933371588721 | 0.5063656411097588 | 0.479425538604203
 0.29552021804983797 | -0.5063656411097588 | -0.29552021804983797 | 0.5063656411097588 | 0.479425538604203
(3 rows)

-- select sin (builtin function, sin in constraints, explain)
--Testcase 840:
EXPLAIN VERBOSE
SELECT value1, sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3 WHERE sin(value1) != 1;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.56 rows=3396 width=40)
   Output: value1, (sin((value2)::double precision)), (sin(value3)), (sin((value4)::double precision)), '0.479425538604203'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, sin(value2), sin(value3), sin(value4), 0.479425538604203::double precision FROM public.s3mysql WHERE ((sin(value1) <> 1::double precision))
(4 rows)

-- select sin (builtin function, sin in constraints, result)
--Testcase 841:
SELECT value1, sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3 WHERE sin(value1) != 1;
 value1 |         sin         |         sin          |        sin         |        sin        
--------+---------------------+----------------------+--------------------+-------------------
    0.1 | -0.5063656411097588 |  -0.0998334181294999 | 0.5063656411097588 | 0.479425538604203
    0.2 | -0.5063656411097588 | -0.19866933371588721 | 0.5063656411097588 | 0.479425538604203
    0.3 | -0.5063656411097588 | -0.29552021804983797 | 0.5063656411097588 | 0.479425538604203
    1.1 | -0.8732972972139946 |  -0.8912073708760093 | 0.8732972972139946 | 0.479425538604203
    2.2 | -0.8732972972139946 |  -0.8084963757576692 | 0.8732972972139946 | 0.479425538604203
    3.3 | -0.8732972972139946 |  0.15774564705654348 | 0.8732972972139946 | 0.479425538604203
(6 rows)

-- select sin (builtin function, sin in constraints, explain)
--Testcase 842:
EXPLAIN VERBOSE
SELECT sin(value1), sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3 WHERE sin(0.5) > value1;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=40)
   Output: (sin(value1)), (sin((value2)::double precision)), (sin(value3)), (sin((value4)::double precision)), '0.479425538604203'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sin(value1), sin(value2), sin(value3), sin(value4), 0.479425538604203::double precision FROM public.s3mysql WHERE ((0.479425538604203::double precision > value1))
(4 rows)

-- select sin (builtin function, sin in constraints, result)
--Testcase 843:
SELECT sin(value1), sin(value2), sin(value3), sin(value4), sin(0.5) FROM s3 WHERE sin(0.5) > value1;
         sin         |         sin         |         sin          |        sin         |        sin        
---------------------+---------------------+----------------------+--------------------+-------------------
  0.0998334181294999 | -0.5063656411097588 |  -0.0998334181294999 | 0.5063656411097588 | 0.479425538604203
 0.19866933371588721 | -0.5063656411097588 | -0.19866933371588721 | 0.5063656411097588 | 0.479425538604203
 0.29552021804983797 | -0.5063656411097588 | -0.29552021804983797 | 0.5063656411097588 | 0.479425538604203
(3 rows)

-- select sin as nest function with agg (pushdown, explain)
--Testcase 844:
EXPLAIN VERBOSE
SELECT sum(value3),sin(sum(value3)) FROM s3;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (sin(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), sin(sum(value3)) FROM public.s3mysql
(6 rows)

-- select sin as nest function with agg (pushdown, result)
--Testcase 845:
SELECT sum(value3),sin(sum(value3)) FROM s3;
        sum         |         sin         
--------------------+---------------------
 -7.200000040233135 | -0.7936678883250331
(1 row)

-- select sin as nest with log2 (pushdown, explain)
--Testcase 846:
EXPLAIN VERBOSE
SELECT value1, sin(log2(value1)),sin(log2(1/value1)) FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (sin(log2(value1))), (sin(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, sin(public.log2(value1)), sin(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select sin as nest with log2 (pushdown, result)
--Testcase 847:
SELECT value1, sin(log2(value1)),sin(log2(1/value1)) FROM s3;
 value1 |         sin         |         sin          
--------+---------------------+----------------------
    0.1 |  0.1793595640030546 |  -0.1793595640030546
    0.2 | -0.7309169581011538 |   0.7309169581011538
    0.3 | -0.9862256356724203 |   0.9862256356724203
    1.1 | 0.13707066262589662 | -0.13707066262589657
    2.2 |  0.9075881640870257 |  -0.9075881640870257
    3.3 |  0.9885201864067668 |  -0.9885201864067668
(6 rows)

-- select sin with non pushdown func and explicit constant (explain)
--Testcase 848:
EXPLAIN VERBOSE
SELECT value1, sin(value3), pi(), 4.1 FROM s3;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=56)
   Output: value1, (sin(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, sin(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select sin with non pushdown func and explicit constant (result)
--Testcase 849:
SELECT value1, sin(value3), pi(), 4.1 FROM s3;
 value1 |         sin          |        pi         | ?column? 
--------+----------------------+-------------------+----------
    0.1 |  -0.0998334181294999 | 3.141592653589793 |      4.1
    0.2 | -0.19866933371588721 | 3.141592653589793 |      4.1
    0.3 | -0.29552021804983797 | 3.141592653589793 |      4.1
    1.1 |  -0.8912073708760093 | 3.141592653589793 |      4.1
    2.2 |  -0.8084963757576692 | 3.141592653589793 |      4.1
    3.3 |  0.15774564705654348 | 3.141592653589793 |      4.1
(6 rows)

-- select sin with order by (explain)
--Testcase 850:
EXPLAIN VERBOSE
SELECT value1, sin(1-value3) FROM s3 ORDER BY sin(1-value3);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (sin(('1'::double precision - value3)))
   Sort Key: (sin(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (sin(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, sin((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select sin with order by (result)
--Testcase 851:
SELECT value1, sin(1-value3) FROM s3 ORDER BY sin(1-value3);
 value1 |          sin          
--------+-----------------------
    3.3 |   -0.9161659176378601
    2.2 | -0.058374191029984236
    1.1 |    0.8632093546124044
    0.1 |    0.8912073607373462
    0.2 |    0.9320390870471366
    0.3 |    0.9635581886060274
(6 rows)

-- select sin with order by index (result)
--Testcase 852:
SELECT value1, sin(1-value3) FROM s3 ORDER BY 2,1;
 value1 |          sin          
--------+-----------------------
    3.3 |   -0.9161659176378601
    2.2 | -0.058374191029984236
    1.1 |    0.8632093546124044
    0.1 |    0.8912073607373462
    0.2 |    0.9320390870471366
    0.3 |    0.9635581886060274
(6 rows)

-- select sin with order by index (result)
--Testcase 853:
SELECT value1, sin(1-value3) FROM s3 ORDER BY 1,2;
 value1 |          sin          
--------+-----------------------
    0.1 |    0.8912073607373462
    0.2 |    0.9320390870471366
    0.3 |    0.9635581886060274
    1.1 |    0.8632093546124044
    2.2 | -0.058374191029984236
    3.3 |   -0.9161659176378601
(6 rows)

-- select sin with group by (explain)
--Testcase 854:
EXPLAIN VERBOSE
SELECT value1, sin(1-value3) FROM s3 GROUP BY value1, sin(1-value3);
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (sin(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, sin((1::double precision - value3)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select sin with group by (result)
--Testcase 855:
SELECT value1, sin(1-value3) FROM s3 GROUP BY value1, sin(1-value3);
 value1 |          sin          
--------+-----------------------
    0.1 |    0.8912073607373462
    0.2 |    0.9320390870471366
    0.3 |    0.9635581886060274
    1.1 |    0.8632093546124044
    2.2 | -0.058374191029984236
    3.3 |   -0.9161659176378601
(6 rows)

-- select sin with group by index (result)
--Testcase 856:
SELECT value1, sin(1-value3) FROM s3 GROUP BY 2,1;
 value1 |          sin          
--------+-----------------------
    0.1 |    0.8912073607373462
    0.2 |    0.9320390870471366
    0.3 |    0.9635581886060274
    1.1 |    0.8632093546124044
    2.2 | -0.058374191029984236
    3.3 |   -0.9161659176378601
(6 rows)

-- select sin with group by index (result)
--Testcase 857:
SELECT value1, sin(1-value3) FROM s3 GROUP BY 1,2;
 value1 |          sin          
--------+-----------------------
    0.1 |    0.8912073607373462
    0.2 |    0.9320390870471366
    0.3 |    0.9635581886060274
    1.1 |    0.8632093546124044
    2.2 | -0.058374191029984236
    3.3 |   -0.9161659176378601
(6 rows)

-- select sin with group by having (explain)
--Testcase 858:
EXPLAIN VERBOSE
SELECT value1, sin(1-value3) FROM s3 GROUP BY value1, sin(1-value3) HAVING sin(avg(value1)) > 0;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (sin(('1'::double precision - value3)))
   Filter: (sin((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, sin((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select sin with group by having (result)
--Testcase 859:
SELECT value1, sin(1-value3) FROM s3 GROUP BY value1, sin(1-value3) HAVING sin(avg(value1)) > 0;
 value1 |          sin          
--------+-----------------------
    0.1 |    0.8912073607373462
    0.2 |    0.9320390870471366
    0.3 |    0.9635581886060274
    1.1 |    0.8632093546124044
    2.2 | -0.058374191029984236
(5 rows)

-- select sin with group by index having (result)
--Testcase 860:
SELECT value1, sin(1-value3) FROM s3 GROUP BY 2,1 HAVING sin(1-value3) > 0;
 value1 |        sin         
--------+--------------------
    0.1 | 0.8912073607373462
    0.2 | 0.9320390870471366
    0.3 | 0.9635581886060274
    1.1 | 0.8632093546124044
(4 rows)

-- select sin with group by index having (result)
--Testcase 861:
SELECT value1, sin(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |          sin          
--------+-----------------------
    1.1 |    0.8632093546124044
    2.2 | -0.058374191029984236
    3.3 |   -0.9161659176378601
(3 rows)

-- select sin and as
--Testcase 862:
SELECT value1, sin(value3) as sin1 FROM s3;
 value1 |         sin1         
--------+----------------------
    0.1 |  -0.0998334181294999
    0.2 | -0.19866933371588721
    0.3 | -0.29552021804983797
    1.1 |  -0.8912073708760093
    2.2 |  -0.8084963757576692
    3.3 |  0.15774564705654348
(6 rows)

-- select sqrt (builtin function, explain)
--Testcase 863:
EXPLAIN VERBOSE
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=48)
   Output: (sqrt(value1)), (sqrt((value2)::double precision)), 0.70710678118654752
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sqrt(value1), sqrt(value2), 0.70710678118654752 FROM public.s3mysql
(4 rows)

-- select sqrt (builtin function, result)
--Testcase 864:
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3;
        sqrt        |        sqrt        |        sqrt         
--------------------+--------------------+---------------------
 0.3162277683729184 |                 10 | 0.70710678118654752
 0.4472135988319589 |                 10 | 0.70710678118654752
 0.5477225683874355 |                 10 | 0.70710678118654752
 1.0488088595363112 | 14.142135623730951 | 0.70710678118654752
 1.4832397134933097 | 14.142135623730951 | 0.70710678118654752
 1.8165901993339841 | 14.142135623730951 | 0.70710678118654752
(6 rows)

-- select sqrt (builtin function, not pushdown constraints, explain)
--Testcase 865:
EXPLAIN VERBOSE
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.32 rows=17 width=48)
   Output: (sqrt(value1)), (sqrt((value2)::double precision)), 0.70710678118654752
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sqrt(value1), sqrt(value2), 0.70710678118654752, value2 FROM public.s3mysql
(5 rows)

-- select sqrt (builtin function, not pushdown constraints, result)
--Testcase 866:
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3 WHERE to_hex(value2) = '64';
        sqrt        | sqrt |        sqrt         
--------------------+------+---------------------
 0.3162277683729184 |   10 | 0.70710678118654752
 0.4472135988319589 |   10 | 0.70710678118654752
 0.5477225683874355 |   10 | 0.70710678118654752
(3 rows)

-- select sqrt (builtin function, pushdown constraints, explain)
--Testcase 867:
EXPLAIN VERBOSE
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3 WHERE value2 != 200;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.05 rows=3396 width=48)
   Output: (sqrt(value1)), (sqrt((value2)::double precision)), 0.70710678118654752
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sqrt(value1), sqrt(value2), 0.70710678118654752 FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select sqrt (builtin function, pushdown constraints, result)
--Testcase 868:
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3 WHERE value2 != 200;
        sqrt        | sqrt |        sqrt         
--------------------+------+---------------------
 0.3162277683729184 |   10 | 0.70710678118654752
 0.4472135988319589 |   10 | 0.70710678118654752
 0.5477225683874355 |   10 | 0.70710678118654752
(3 rows)

-- select sqrt (builtin function, sqrt in constraints, explain)
--Testcase 869:
EXPLAIN VERBOSE
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3 WHERE sqrt(value1) != 1;
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..254.59 rows=3396 width=48)
   Output: (sqrt(value1)), (sqrt((value2)::double precision)), 0.70710678118654752
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sqrt(value1), sqrt(value2), 0.70710678118654752 FROM public.s3mysql WHERE ((sqrt(value1) <> 1::double precision))
(4 rows)

-- select sqrt (builtin function, sqrt in constraints, result)
--Testcase 870:
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3 WHERE sqrt(value1) != 1;
        sqrt        |        sqrt        |        sqrt         
--------------------+--------------------+---------------------
 0.3162277683729184 |                 10 | 0.70710678118654752
 0.4472135988319589 |                 10 | 0.70710678118654752
 0.5477225683874355 |                 10 | 0.70710678118654752
 1.0488088595363112 | 14.142135623730951 | 0.70710678118654752
 1.4832397134933097 | 14.142135623730951 | 0.70710678118654752
 1.8165901993339841 | 14.142135623730951 | 0.70710678118654752
(6 rows)

-- select sqrt (builtin function, sqrt in constraints, explain)
--Testcase 871:
EXPLAIN VERBOSE
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3 WHERE sqrt(0.5) > value1;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..183.96 rows=1138 width=48)
   Output: (sqrt(value1)), (sqrt((value2)::double precision)), 0.70710678118654752
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sqrt(value1), sqrt(value2), 0.70710678118654752 FROM public.s3mysql WHERE ((0.7071067811865476::double precision > value1))
(4 rows)

-- select sqrt (builtin function, sqrt in constraints, result)
--Testcase 872:
SELECT sqrt(value1), sqrt(value2), sqrt(0.5) FROM s3 WHERE sqrt(0.5) > value1;
        sqrt        | sqrt |        sqrt         
--------------------+------+---------------------
 0.3162277683729184 |   10 | 0.70710678118654752
 0.4472135988319589 |   10 | 0.70710678118654752
 0.5477225683874355 |   10 | 0.70710678118654752
(3 rows)

-- select sqrt as nest function with agg (pushdown, explain)
--Testcase 873:
EXPLAIN VERBOSE
SELECT sum(value3),sqrt(sum(value1)) FROM s3;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (sqrt(sum(value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), sqrt(sum(value1)) FROM public.s3mysql
(6 rows)

-- select sqrt as nest function with agg (pushdown, result)
--Testcase 874:
SELECT sum(value3),sqrt(sum(value1)) FROM s3;
        sum         |       sqrt       
--------------------+------------------
 -7.200000040233135 | 2.68328158049675
(1 row)

-- select sqrt as nest with log2 (pushdown, explain)
--Testcase 875:
EXPLAIN VERBOSE
SELECT value1, sqrt(log2(value1)),sqrt(log2(1/value1)) FROM s3;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (sqrt(log2(value1))), (sqrt(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, sqrt(public.log2(value1)), sqrt(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select sqrt as nest with log2 (pushdown, result)
--Testcase 876:
SELECT value1, sqrt(log2(value1)),sqrt(log2(1/value1)) FROM s3;
 value1 |        sqrt        |        sqrt        
--------+--------------------+--------------------
    0.1 |                    |  1.822615722907473
    0.2 |                    | 1.5237874108252538
    0.3 |                    | 1.3179398836208946
    1.1 | 0.3708147179111253 |                   
    2.2 |  1.066538117002626 |                   
    3.3 |  1.312427523189265 |                   
(6 rows)

-- select sqrt with non pushdown func and explicit constant (explain)
--Testcase 877:
EXPLAIN VERBOSE
SELECT sqrt(value2), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=48)
   Output: (sqrt((value2)::double precision)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT sqrt(value2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select sqrt with non pushdown func and explicit constant (result)
--Testcase 878:
SELECT sqrt(value2), pi(), 4.1 FROM s3;
        sqrt        |        pi         | ?column? 
--------------------+-------------------+----------
                 10 | 3.141592653589793 |      4.1
                 10 | 3.141592653589793 |      4.1
                 10 | 3.141592653589793 |      4.1
 14.142135623730951 | 3.141592653589793 |      4.1
 14.142135623730951 | 3.141592653589793 |      4.1
 14.142135623730951 | 3.141592653589793 |      4.1
(6 rows)

-- select sqrt with order by (explain)
--Testcase 879:
EXPLAIN VERBOSE
SELECT value1, sqrt(1-value3) FROM s3 ORDER BY sqrt(1-value3);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (sqrt(('1'::double precision - value3)))
   Sort Key: (sqrt(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (sqrt(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, sqrt((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select sqrt with order by (result)
--Testcase 880:
SELECT value1, sqrt(1-value3) FROM s3 ORDER BY sqrt(1-value3);
 value1 |        sqrt        
--------+--------------------
    0.1 | 1.0488088488805365
    0.2 | 1.0954451163706158
    0.3 | 1.1401754303268112
    1.1 | 1.4491376828451663
    2.2 | 1.7888543953278355
    3.3 | 2.0736441238352072
(6 rows)

-- select sqrt with order by index (result)
--Testcase 881:
SELECT value1, sqrt(1-value3) FROM s3 ORDER BY 2,1;
 value1 |        sqrt        
--------+--------------------
    0.1 | 1.0488088488805365
    0.2 | 1.0954451163706158
    0.3 | 1.1401754303268112
    1.1 | 1.4491376828451663
    2.2 | 1.7888543953278355
    3.3 | 2.0736441238352072
(6 rows)

-- select sqrt with order by index (result)
--Testcase 882:
SELECT value1, sqrt(1-value3) FROM s3 ORDER BY 1,2;
 value1 |        sqrt        
--------+--------------------
    0.1 | 1.0488088488805365
    0.2 | 1.0954451163706158
    0.3 | 1.1401754303268112
    1.1 | 1.4491376828451663
    2.2 | 1.7888543953278355
    3.3 | 2.0736441238352072
(6 rows)

-- select sqrt with group by (explain)
--Testcase 883:
EXPLAIN VERBOSE
SELECT count(value1), sqrt(1-value3) FROM s3 GROUP BY sqrt(1-value3);
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (sqrt(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), sqrt((1::double precision - value3)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select sqrt with group by (result)
--Testcase 884:
SELECT count(value1), sqrt(1-value3) FROM s3 GROUP BY sqrt(1-value3);
 count |        sqrt        
-------+--------------------
     1 | 1.0488088488805365
     1 | 1.0954451163706158
     1 | 1.1401754303268112
     1 | 1.4491376828451663
     1 | 1.7888543953278355
     1 | 2.0736441238352072
(6 rows)

-- select sqrt with group by index (result)
--Testcase 885:
SELECT value1, sqrt(1-value3) FROM s3 GROUP BY 2,1;
 value1 |        sqrt        
--------+--------------------
    0.1 | 1.0488088488805365
    0.2 | 1.0954451163706158
    0.3 | 1.1401754303268112
    1.1 | 1.4491376828451663
    2.2 | 1.7888543953278355
    3.3 | 2.0736441238352072
(6 rows)

-- select sqrt with group by index (result)
--Testcase 886:
SELECT value1, sqrt(1-value3) FROM s3 GROUP BY 1,2;
 value1 |        sqrt        
--------+--------------------
    0.1 | 1.0488088488805365
    0.2 | 1.0954451163706158
    0.3 | 1.1401754303268112
    1.1 | 1.4491376828451663
    2.2 | 1.7888543953278355
    3.3 | 2.0736441238352072
(6 rows)

-- select sqrt with group by having (explain)
--Testcase 887:
EXPLAIN VERBOSE
SELECT count(value1), sqrt(1-value3) FROM s3 GROUP BY sqrt(1-value3) HAVING sqrt(avg(value1)) > 0;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (sqrt(('1'::double precision - value3)))
   Filter: (sqrt((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), sqrt((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 2
(7 rows)

-- select sqrt with group by having (result)
--Testcase 888:
SELECT count(value1), sqrt(1-value3) FROM s3 GROUP BY sqrt(1-value3) HAVING sqrt(avg(value1)) > 0;
 count |        sqrt        
-------+--------------------
     1 | 1.0488088488805365
     1 | 1.0954451163706158
     1 | 1.1401754303268112
     1 | 1.4491376828451663
     1 | 1.7888543953278355
     1 | 2.0736441238352072
(6 rows)

-- select sqrt with group by index having (result)
--Testcase 889:
SELECT value1, sqrt(1-value3) FROM s3 GROUP BY 2,1 HAVING sqrt(1-value3) > 0;
 value1 |        sqrt        
--------+--------------------
    0.1 | 1.0488088488805365
    0.2 | 1.0954451163706158
    0.3 | 1.1401754303268112
    1.1 | 1.4491376828451663
    2.2 | 1.7888543953278355
    3.3 | 2.0736441238352072
(6 rows)

-- select sqrt with group by index having (result)
--Testcase 890:
SELECT value1, sqrt(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |        sqrt        
--------+--------------------
    1.1 | 1.4491376828451663
    2.2 | 1.7888543953278355
    3.3 | 2.0736441238352072
(3 rows)

-- select sqrt and as (return null with negative number)
--Testcase 891:
SELECT value1, value3 + 1, sqrt(value1 + 1) as sqrt1 FROM s3;
 value1 |       ?column?       |       sqrt1        
--------+----------------------+--------------------
    0.1 |   0.8999999985098839 | 1.0488088488805365
    0.2 |   0.7999999970197678 | 1.0954451163706158
    0.3 |    0.699999988079071 | 1.1401754303268112
    1.1 | -0.10000002384185791 | 1.4491376828451663
    2.2 |  -1.2000000476837158 | 1.7888543953278355
    3.3 |   -2.299999952316284 | 2.0736441238352072
(6 rows)

-- select tan (builtin function, explain)
--Testcase 892:
EXPLAIN VERBOSE
SELECT value1, tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..255.05 rows=3413 width=40)
   Output: value1, (tan((value2)::double precision)), (tan(value3)), (tan((value4)::double precision)), '0.5463024898437905'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, tan(value2), tan(value3), tan(value4), 0.5463024898437905::double precision FROM public.s3mysql
(4 rows)

-- select tan (builtin function, result)
--Testcase 893:
SELECT value1, tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3;
 value1 |         tan         |         tan          |        tan         |        tan         
--------+---------------------+----------------------+--------------------+--------------------
    0.1 | -0.5872139151569291 | -0.10033467359056773 | 0.5872139151569291 | 0.5463024898437905
    0.2 | -0.5872139151569291 | -0.20271003861136652 | 0.5872139151569291 | 0.5463024898437905
    0.3 | -0.5872139151569291 | -0.30933626267125297 | 0.5872139151569291 | 0.5463024898437905
    1.1 | -1.7925274837903817 |  -1.9647597731267747 | 1.7925274837903817 | 0.5463024898437905
    2.2 | -1.7925274837903817 |     1.37382291908733 | 1.7925274837903817 | 0.5463024898437905
    3.3 | -1.7925274837903817 | -0.15974569875949032 | 1.7925274837903817 | 0.5463024898437905
(6 rows)

-- select tan (builtin function, not pushdown constraints, explain)
--Testcase 894:
EXPLAIN VERBOSE
SELECT tan(value1), tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3 WHERE to_hex(value2) = '64';
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=17 width=40)
   Output: (tan(value1)), (tan((value2)::double precision)), (tan(value3)), (tan((value4)::double precision)), '0.5463024898437905'::double precision
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT tan(value1), tan(value2), tan(value3), tan(value4), 0.5463024898437905::double precision, value2 FROM public.s3mysql
(5 rows)

-- select tan (builtin function, not pushdown constraints, result)
--Testcase 895:
SELECT tan(value1), tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3 WHERE to_hex(value2) = '64';
         tan         |         tan         |         tan          |        tan         |        tan         
---------------------+---------------------+----------------------+--------------------+--------------------
 0.10033467359056773 | -0.5872139151569291 | -0.10033467359056773 | 0.5872139151569291 | 0.5463024898437905
 0.20271003861136652 | -0.5872139151569291 | -0.20271003861136652 | 0.5872139151569291 | 0.5463024898437905
 0.30933626267125297 | -0.5872139151569291 | -0.30933626267125297 | 0.5872139151569291 | 0.5463024898437905
(3 rows)

-- select tan (builtin function, pushdown constraints, explain)
--Testcase 896:
EXPLAIN VERBOSE
SELECT tan(value1), tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3 WHERE value2 != 200;
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=40)
   Output: (tan(value1)), (tan((value2)::double precision)), (tan(value3)), (tan((value4)::double precision)), '0.5463024898437905'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT tan(value1), tan(value2), tan(value3), tan(value4), 0.5463024898437905::double precision FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select tan (builtin function, pushdown constraints, result)
--Testcase 897:
SELECT tan(value1), tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3 WHERE value2 != 200;
         tan         |         tan         |         tan          |        tan         |        tan         
---------------------+---------------------+----------------------+--------------------+--------------------
 0.10033467359056773 | -0.5872139151569291 | -0.10033467359056773 | 0.5872139151569291 | 0.5463024898437905
 0.20271003861136652 | -0.5872139151569291 | -0.20271003861136652 | 0.5872139151569291 | 0.5463024898437905
 0.30933626267125297 | -0.5872139151569291 | -0.30933626267125297 | 0.5872139151569291 | 0.5463024898437905
(3 rows)

-- select tan (builtin function, tan in constraints, explain)
--Testcase 898:
EXPLAIN VERBOSE
SELECT value1, tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3 WHERE tan(value1) != 1;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.56 rows=3396 width=40)
   Output: value1, (tan((value2)::double precision)), (tan(value3)), (tan((value4)::double precision)), '0.5463024898437905'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, tan(value2), tan(value3), tan(value4), 0.5463024898437905::double precision FROM public.s3mysql WHERE ((tan(value1) <> 1::double precision))
(4 rows)

-- select tan (builtin function, tan in constraints, result)
--Testcase 899:
SELECT value1, tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3 WHERE tan(value1) != 1;
 value1 |         tan         |         tan          |        tan         |        tan         
--------+---------------------+----------------------+--------------------+--------------------
    0.1 | -0.5872139151569291 | -0.10033467359056773 | 0.5872139151569291 | 0.5463024898437905
    0.2 | -0.5872139151569291 | -0.20271003861136652 | 0.5872139151569291 | 0.5463024898437905
    0.3 | -0.5872139151569291 | -0.30933626267125297 | 0.5872139151569291 | 0.5463024898437905
    1.1 | -1.7925274837903817 |  -1.9647597731267747 | 1.7925274837903817 | 0.5463024898437905
    2.2 | -1.7925274837903817 |     1.37382291908733 | 1.7925274837903817 | 0.5463024898437905
    3.3 | -1.7925274837903817 | -0.15974569875949032 | 1.7925274837903817 | 0.5463024898437905
(6 rows)

-- select tan (builtin function, tan in constraints, explain)
--Testcase 900:
EXPLAIN VERBOSE
SELECT tan(value1), tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3 WHERE tan(0.5) > value1;
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=40)
   Output: (tan(value1)), (tan((value2)::double precision)), (tan(value3)), (tan((value4)::double precision)), '0.5463024898437905'::double precision
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT tan(value1), tan(value2), tan(value3), tan(value4), 0.5463024898437905::double precision FROM public.s3mysql WHERE ((0.5463024898437905::double precision > value1))
(4 rows)

-- select tan (builtin function, tan in constraints, result)
--Testcase 901:
SELECT tan(value1), tan(value2), tan(value3), tan(value4), tan(0.5) FROM s3 WHERE tan(0.5) > value1;
         tan         |         tan         |         tan          |        tan         |        tan         
---------------------+---------------------+----------------------+--------------------+--------------------
 0.10033467359056773 | -0.5872139151569291 | -0.10033467359056773 | 0.5872139151569291 | 0.5463024898437905
 0.20271003861136652 | -0.5872139151569291 | -0.20271003861136652 | 0.5872139151569291 | 0.5463024898437905
 0.30933626267125297 | -0.5872139151569291 | -0.30933626267125297 | 0.5872139151569291 | 0.5463024898437905
(3 rows)

-- select tan as nest function with agg (pushdown, explain)
--Testcase 902:
EXPLAIN VERBOSE
SELECT sum(value3),tan(sum(value3)) FROM s3;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (sum(value3)), (tan(sum(value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), tan(sum(value3)) FROM public.s3mysql
(6 rows)

-- select tan as nest function with agg (pushdown, result)
--Testcase 903:
SELECT sum(value3),tan(sum(value3)) FROM s3;
        sum         |         tan         
--------------------+---------------------
 -7.200000040233135 | -1.3046210487670151
(1 row)

-- select tan as nest with log2 (pushdown, explain)
--Testcase 904:
EXPLAIN VERBOSE
SELECT value1, tan(log2(value1)),tan(log2(1/value1)) FROM s3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1944.49 rows=3413 width=24)
   Output: value1, (tan(log2(value1))), (tan(log2(('1'::double precision / value1))))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, tan(public.log2(value1)), tan(public.log2((1::double precision / value1))) FROM public.s3mysql
(4 rows)

-- select tan as nest with log2 (pushdown, result)
--Testcase 905:
SELECT value1, tan(log2(value1)),tan(log2(1/value1)) FROM s3;
 value1 |         tan         |         tan          
--------+---------------------+----------------------
    0.1 | -0.1823160767303538 |   0.1823160767303538
    0.2 |  1.0709933085633336 |  -1.0709933085633336
    0.3 |   5.962470082723981 |   -5.962470082723973
    1.1 | 0.13837676326558696 | -0.13837676326558687
    2.2 |   2.161636748458226 |   -2.161636748458226
    3.3 |  -6.542641473457552 |    6.542641473457562
(6 rows)

-- select tan with non pushdown func and explicit constant (explain)
--Testcase 906:
EXPLAIN VERBOSE
SELECT value1, tan(value3), pi(), 4.1 FROM s3;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=56)
   Output: value1, (tan(value3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, tan(value3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select tan with non pushdown func and explicit constant (result)
--Testcase 907:
SELECT value1, tan(value3), pi(), 4.1 FROM s3;
 value1 |         tan          |        pi         | ?column? 
--------+----------------------+-------------------+----------
    0.1 | -0.10033467359056773 | 3.141592653589793 |      4.1
    0.2 | -0.20271003861136652 | 3.141592653589793 |      4.1
    0.3 | -0.30933626267125297 | 3.141592653589793 |      4.1
    1.1 |  -1.9647597731267747 | 3.141592653589793 |      4.1
    2.2 |     1.37382291908733 | 3.141592653589793 |      4.1
    3.3 | -0.15974569875949032 | 3.141592653589793 |      4.1
(6 rows)

-- select tan with order by (explain)
--Testcase 908:
EXPLAIN VERBOSE
SELECT value1, tan(1-value3) FROM s3 ORDER BY tan(1-value3);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=16)
   Output: value1, (tan(('1'::double precision - value3)))
   Sort Key: (tan(('1'::double precision - s3.value3)))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
         Output: value1, (tan(('1'::double precision - value3)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, tan((1::double precision - value3)) FROM public.s3mysql
(7 rows)

-- select tan with order by (result)
--Testcase 909:
SELECT value1, tan(1-value3) FROM s3 ORDER BY tan(1-value3);
 value1 |         tan         
--------+---------------------
    1.1 | -1.7098464493591892
    2.2 | 0.05847390230633418
    0.1 |  1.9647596644910343
    3.3 |  2.2858475805310894
    0.2 |  2.5721516448236605
    0.3 |   3.602102614564661
(6 rows)

-- select tan with order by index (result)
--Testcase 910:
SELECT value1, tan(1-value3) FROM s3 ORDER BY 2,1;
 value1 |         tan         
--------+---------------------
    1.1 | -1.7098464493591892
    2.2 | 0.05847390230633418
    0.1 |  1.9647596644910343
    3.3 |  2.2858475805310894
    0.2 |  2.5721516448236605
    0.3 |   3.602102614564661
(6 rows)

-- select tan with order by index (result)
--Testcase 911:
SELECT value1, tan(1-value3) FROM s3 ORDER BY 1,2;
 value1 |         tan         
--------+---------------------
    0.1 |  1.9647596644910343
    0.2 |  2.5721516448236605
    0.3 |   3.602102614564661
    1.1 | -1.7098464493591892
    2.2 | 0.05847390230633418
    3.3 |  2.2858475805310894
(6 rows)

-- select tan with group by (explain)
--Testcase 912:
EXPLAIN VERBOSE
SELECT value1, tan(1-value3) FROM s3 GROUP BY value1, tan(1-value3);
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: value1, (tan(('1'::double precision - value3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, tan((1::double precision - value3)) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select tan with group by (result)
--Testcase 913:
SELECT value1, tan(1-value3) FROM s3 GROUP BY value1, tan(1-value3);
 value1 |         tan         
--------+---------------------
    0.1 |  1.9647596644910343
    0.2 |  2.5721516448236605
    0.3 |   3.602102614564661
    1.1 | -1.7098464493591892
    2.2 | 0.05847390230633418
    3.3 |  2.2858475805310894
(6 rows)

-- select tan with group by index (result)
--Testcase 914:
SELECT value1, tan(1-value3) FROM s3 GROUP BY 2,1;
 value1 |         tan         
--------+---------------------
    0.1 |  1.9647596644910343
    0.2 |  2.5721516448236605
    0.3 |   3.602102614564661
    1.1 | -1.7098464493591892
    2.2 | 0.05847390230633418
    3.3 |  2.2858475805310894
(6 rows)

-- select tan with group by index (result)
--Testcase 915:
SELECT value1, tan(1-value3) FROM s3 GROUP BY 1,2;
 value1 |         tan         
--------+---------------------
    0.1 |  1.9647596644910343
    0.2 |  2.5721516448236605
    0.3 |   3.602102614564661
    1.1 | -1.7098464493591892
    2.2 | 0.05847390230633418
    3.3 |  2.2858475805310894
(6 rows)

-- select tan with group by having (explain)
--Testcase 916:
EXPLAIN VERBOSE
SELECT value1, tan(1-value3) FROM s3 GROUP BY value1, tan(1-value3) HAVING tan(avg(value1)) > 0;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: value1, (tan(('1'::double precision - value3)))
   Filter: (tan((avg(s3.value1))) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, tan((1::double precision - value3)), avg(value1) FROM public.s3mysql GROUP BY 1, 2
(7 rows)

-- select tan with group by having (result)
--Testcase 917:
SELECT value1, tan(1-value3) FROM s3 GROUP BY value1, tan(1-value3) HAVING tan(avg(value1)) > 0;
 value1 |         tan         
--------+---------------------
    0.1 |  1.9647596644910343
    0.2 |  2.5721516448236605
    0.3 |   3.602102614564661
    1.1 | -1.7098464493591892
    3.3 |  2.2858475805310894
(5 rows)

-- select tan with group by index having (result)
--Testcase 918:
SELECT value1, tan(1-value3) FROM s3 GROUP BY 2,1 HAVING tan(1-value3) > 0;
 value1 |         tan         
--------+---------------------
    0.1 |  1.9647596644910343
    0.2 |  2.5721516448236605
    0.3 |   3.602102614564661
    2.2 | 0.05847390230633418
    3.3 |  2.2858475805310894
(5 rows)

-- select tan with group by index having (result)
--Testcase 919:
SELECT value1, tan(1-value3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |         tan         
--------+---------------------
    1.1 | -1.7098464493591892
    2.2 | 0.05847390230633418
    3.3 |  2.2858475805310894
(3 rows)

-- select tan and as
--Testcase 920:
SELECT value1, tan(value3) as tan1 FROM s3;
 value1 |         tan1         
--------+----------------------
    0.1 | -0.10033467359056773
    0.2 | -0.20271003861136652
    0.3 | -0.30933626267125297
    1.1 |  -1.9647597731267747
    2.2 |     1.37382291908733
    3.3 | -0.15974569875949032
(6 rows)

-- round()
--Testcase 921:
EXPLAIN VERBOSE
SELECT round(value1), round(value3) FROM s3;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=16)
   Output: (round(value1)), (round(value3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(value1), round(value3) FROM public.s3mysql
(4 rows)

--Testcase 922:
SELECT round(value1), round(value3) FROM s3;
 round | round 
-------+-------
     0 |    -0
     0 |    -0
     0 |    -0
     1 |    -1
     2 |    -2
     3 |    -3
(6 rows)

--Testcase 923:
EXPLAIN VERBOSE
SELECT round(value1), round(abs(value3)) FROM s3;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=16)
   Output: (round(value1)), (round(abs(value3)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(value1), round(abs(value3)) FROM public.s3mysql
(4 rows)

--Testcase 924:
SELECT round(value1), round(abs(value3)) FROM s3;
 round | round 
-------+-------
     0 |     0
     0 |     0
     0 |     0
     1 |     1
     2 |     2
     3 |     3
(6 rows)

--Testcase 925:
EXPLAIN VERBOSE
SELECT round(abs(value2), 2) FROM s3;
                             QUERY PLAN                              
---------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=32)
   Output: (round((abs(value2))::numeric, 2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT round(abs(value2), 2) FROM public.s3mysql
(4 rows)

--Testcase 926:
SELECT round(abs(value2), 2) FROM s3;
 round 
-------
   100
   100
   100
   200
   200
   200
(6 rows)

--Testcase 927:
EXPLAIN VERBOSE
SELECT * FROM s3 WHERE round(abs(value2), 2) = 100.00;
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..178.60 rows=17 width=156)
   Output: id, tag1, value1, value2, value3, value4, str1, str2, __spd_url
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, tag1, value1, value2, value3, value4, str1, str2, __spd_url FROM public.s3mysql WHERE ((round(abs(value2), 2) = 100.00))
(4 rows)

--Testcase 928:
SELECT * FROM s3 WHERE round(abs(value2), 2) = 100.00;
 id | tag1 | value1 | value2 | value3 | value4 |   str1    |   str2    |        __spd_url         
----+------+--------+--------+--------+--------+-----------+-----------+--------------------------
  0 | a    |    0.1 |    100 |   -0.1 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  1 | a    |    0.2 |    100 |   -0.2 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  2 | a    |    0.3 |    100 |   -0.3 |   -100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
(3 rows)

--Testcase 929:
EXPLAIN VERBOSE
SELECT * FROM s3 WHERE round(value1) = 1;
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..161.53 rows=17 width=156)
   Output: id, tag1, value1, value2, value3, value4, str1, str2, __spd_url
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, tag1, value1, value2, value3, value4, str1, str2, __spd_url FROM public.s3mysql WHERE ((round(value1) = 1::double precision))
(4 rows)

--Testcase 930:
SELECT * FROM s3 WHERE round(value1) = 1;
 id | tag1 | value1 | value2 | value3 | value4 |   str1    |   str2    |        __spd_url         
----+------+--------+--------+--------+--------+-----------+-----------+--------------------------
  3 | b    |    1.1 |    200 |   -1.1 |   -200 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
(1 row)

--Testcase 931:
EXPLAIN VERBOSE
SELECT * FROM s3 WHERE round(value3) = -1;
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..161.53 rows=17 width=156)
   Output: id, tag1, value1, value2, value3, value4, str1, str2, __spd_url
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, tag1, value1, value2, value3, value4, str1, str2, __spd_url FROM public.s3mysql WHERE ((round(value3) = (-1)::double precision))
(4 rows)

--Testcase 932:
SELECT * FROM s3 WHERE round(value3) = -1;
 id | tag1 | value1 | value2 | value3 | value4 |   str1    |   str2    |        __spd_url         
----+------+--------+--------+--------+--------+-----------+-----------+--------------------------
  3 | b    |    1.1 |    200 |   -1.1 |   -200 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
(1 row)

-- test for cast function:
-- convert()
-- select convert (stub function, explain)
--Testcase 933:
EXPLAIN VERBOSE
SELECT convert(value1, 'decimal(1)'), convert(value2, 'decimal(10, 2)'), convert(id, 'YEAR'), convert(value4, 'binary(1)')::bytea FROM s3;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3642.45 rows=3413 width=128)
   Output: (convert(value1, 'decimal(1)'::text)), (convert(value2, 'decimal(10, 2)'::text)), (convert(id, 'YEAR'::text)), ((convert(value4, 'binary(1)'::text))::bytea)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert(value1, 'decimal(1)'::text), public.convert(value2, 'decimal(10, 2)'::text), public.convert(id, 'YEAR'::text), public.convert(value4, 'binary(1)'::text)::bytea FROM public.s3mysql
(4 rows)

-- select convert (stub function, result)
--Testcase 934:
SELECT convert(value1, 'decimal(1)'), convert(value2, 'decimal(10, 2)'), convert(id, 'YEAR'), convert(value4, 'binary(1)')::bytea FROM s3;
 convert | convert | convert | convert 
---------+---------+---------+---------
 0       | 100.00  | 0       | \x2d
 0       | 100.00  | 2001    | \x2d
 0       | 100.00  | 2002    | \x2d
 1       | 200.00  | 2003    | \x2d
 2       | 200.00  | 2004    | \x2d
 3       | 200.00  | 2005    | \x2d
(6 rows)

-- select convert (stub function, not pushdown constraints, explain)
--Testcase 935:
EXPLAIN VERBOSE
SELECT convert(value1, 'decimal(1)'), convert(value2, 'decimal(10, 2)'), convert(id, 'YEAR'), convert(value4, 'binary(1)')::bytea FROM s3 WHERE to_hex(value2) != '64';
                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3642.43 rows=3396 width=128)
   Output: (convert(value1, 'decimal(1)'::text)), (convert(value2, 'decimal(10, 2)'::text)), (convert(id, 'YEAR'::text)), ((convert(value4, 'binary(1)'::text))::bytea)
   Filter: (to_hex(s3.value2) <> '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert(value1, 'decimal(1)'::text), public.convert(value2, 'decimal(10, 2)'::text), public.convert(id, 'YEAR'::text), public.convert(value4, 'binary(1)'::text)::bytea, value2 FROM public.s3mysql
(5 rows)

-- select convert (stub function, not pushdown constraints, result)
--Testcase 936:
SELECT convert(value1, 'decimal(1)'), convert(value2, 'decimal(10, 2)'), convert(id, 'YEAR'), convert(value4, 'binary(1)')::bytea FROM s3 WHERE to_hex(value2) != '64';
 convert | convert | convert | convert 
---------+---------+---------+---------
 1       | 200.00  | 2003    | \x2d
 2       | 200.00  | 2004    | \x2d
 3       | 200.00  | 2005    | \x2d
(3 rows)

-- select convert (stub function, pushdown constraints, explain)
--Testcase 937:
EXPLAIN VERBOSE
SELECT convert(value1, 'decimal(1)'), convert(value2, 'decimal(10, 2)'), convert(id, 'YEAR'), convert(value4, 'binary(1)')::bytea FROM s3 WHERE value2 != 200;
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3633.56 rows=3396 width=128)
   Output: (convert(value1, 'decimal(1)'::text)), (convert(value2, 'decimal(10, 2)'::text)), (convert(id, 'YEAR'::text)), ((convert(value4, 'binary(1)'::text))::bytea)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert(value1, 'decimal(1)'::text), public.convert(value2, 'decimal(10, 2)'::text), public.convert(id, 'YEAR'::text), public.convert(value4, 'binary(1)'::text)::bytea FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select convert (stub function, pushdown constraints, result)
--Testcase 938:
SELECT convert(value1, 'decimal(1)'), convert(value2, 'decimal(10, 2)'), convert(id, 'YEAR'), convert(value4, 'binary(1)')::bytea FROM s3 WHERE value2 != 200;
 convert | convert | convert | convert 
---------+---------+---------+---------
 0       | 100.00  | 0       | \x2d
 0       | 100.00  | 2001    | \x2d
 0       | 100.00  | 2002    | \x2d
(3 rows)

-- select convert as nest function with agg (pushdown, explain)
--Testcase 939:
EXPLAIN VERBOSE
SELECT sum(id), convert(sum(id), 'YEAR') FROM s3;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (convert(sum(id), 'YEAR'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(id), public.convert(sum(id), 'YEAR'::text) FROM public.s3mysql
(6 rows)

-- select convert as nest function with agg (pushdown, result)
--Testcase 940:
SELECT sum(id), convert(sum(id), 'YEAR') FROM s3;
 sum | convert 
-----+---------
  15 | 2015
(1 row)

-- select convert as nest with log2 (pushdown, explain)
--Testcase 941:
EXPLAIN VERBOSE
SELECT convert(log2(value1), 'decimal(12,4)')::numeric, convert(log2(1/value1), 'decimal(12,4)')::numeric FROM s3;
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3668.05 rows=3413 width=64)
   Output: ((convert(log2(value1), 'decimal(12,4)'::text))::numeric), ((convert(log2(('1'::double precision / value1)), 'decimal(12,4)'::text))::numeric)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert(public.log2(value1), 'decimal(12,4)'::text)::numeric, public.convert(public.log2((1::double precision / value1)), 'decimal(12,4)'::text)::numeric FROM public.s3mysql
(4 rows)

-- select convert as nest with log2 (pushdown, result)
--Testcase 942:
SELECT convert(log2(value1), 'decimal(12,4)')::numeric, convert(log2(1/value1), 'decimal(12,4)')::numeric FROM s3;
 convert | convert 
---------+---------
 -3.3219 |  3.3219
 -2.3219 |  2.3219
 -1.7370 |  1.7370
  0.1375 | -0.1375
  1.1375 | -1.1375
  1.7225 | -1.7225
(6 rows)

-- select cast json_extract with type modifier (explain)
--Testcase 943:
EXPLAIN VERBOSE
SELECT convert(json_extract('{"a": "2000-01-01 12:02:01.123456"}', '$.a'), 'datetime(3)')::timestamp, convert(json_extract('{"a": "2000-01-01 12:02:01.123456"}', '$.a'), 'datetime(3)')::timestamptz, convert(json_extract('{"a": "12:10:20.123456"}', '$.a'), 'time(3)')::time, convert(json_extract('{"a": "12:10:20.123456"}', '$.a'), 'time(3)')::timetz FROM s3;
                                                                                                                                                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                                                                                                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..7106.65 rows=3413 width=36)
   Output: ((convert(json_extract('{"a": "2000-01-01 12:02:01.123456"}'::json, VARIADIC '{$.a}'::text[]), 'datetime(3)'::text))::timestamp without time zone), ((convert(json_extract('{"a": "2000-01-01 12:02:01.123456"}'::json, VARIADIC '{$.a}'::text[]), 'datetime(3)'::text))::timestamp with time zone), ((convert(json_extract('{"a": "12:10:20.123456"}'::json, VARIADIC '{$.a}'::text[]), 'time(3)'::text))::time without time zone), ((convert(json_extract('{"a": "12:10:20.123456"}'::json, VARIADIC '{$.a}'::text[]), 'time(3)'::text))::time with time zone)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert(public.json_extract('{"a": "2000-01-01 12:02:01.123456"}'::json, VARIADIC '{$.a}'::text[]), 'datetime(3)'::text)::timestamp without time zone, public.convert(public.json_extract('{"a": "2000-01-01 12:02:01.123456"}'::json, VARIADIC '{$.a}'::text[]), 'datetime(3)'::text)::timestamp with time zone, public.convert(public.json_extract('{"a": "12:10:20.123456"}'::json, VARIADIC '{$.a}'::text[]), 'time(3)'::text)::time without time zone, public.convert(public.json_extract('{"a": "12:10:20.123456"}'::json, VARIADIC '{$.a}'::text[]), 'time(3)'::text)::time with time zone FROM public.s3mysql
(4 rows)

-- select cast json_extract with type modifier (result)
--Testcase 944:
SELECT convert(json_extract('{"a": "2000-01-01 12:02:01.123456"}', '$.a'), 'datetime(3)')::timestamp, convert(json_extract('{"a": "2000-01-01 12:02:01.123456"}', '$.a'), 'datetime(3)')::timestamptz, convert(json_extract('{"a": "12:10:20.123456"}', '$.a'), 'time(3)')::time, convert(json_extract('{"a": "12:10:20.123456"}', '$.a'), 'time(3)')::timetz FROM s3;
         convert         |          convert           |   convert    |     convert     
-------------------------+----------------------------+--------------+-----------------
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
(6 rows)

-- select cast json_extract with type modifier (explain)
--Testcase 945:
EXPLAIN VERBOSE
SELECT convert(json_extract('{"a": 100}', '$.a'), 'decimal(10,2)')::numeric, convert(json_extract('{"a": 10}', '$.a'), 'YEAR')::decimal, convert(json_unquote(json_extract('{"a": "1.123456"}', '$.a')), 'decimal(10, 3)')::numeric FROM s3;
                                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..6236.34 rows=3413 width=96)
   Output: ((convert(json_extract('{"a": 100}'::json, VARIADIC '{$.a}'::text[]), 'decimal(10,2)'::text))::numeric), ((convert(json_extract('{"a": 10}'::json, VARIADIC '{$.a}'::text[]), 'YEAR'::text))::numeric), ((convert(json_unquote(json_extract('{"a": "1.123456"}'::json, VARIADIC '{$.a}'::text[])), 'decimal(10, 3)'::text))::numeric)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert(public.json_extract('{"a": 100}'::json, VARIADIC '{$.a}'::text[]), 'decimal(10,2)'::text)::numeric, public.convert(public.json_extract('{"a": 10}'::json, VARIADIC '{$.a}'::text[]), 'YEAR'::text)::numeric, public.convert(public.json_unquote(public.json_extract('{"a": "1.123456"}'::json, VARIADIC '{$.a}'::text[])), 'decimal(10, 3)'::text)::numeric FROM public.s3mysql
(4 rows)

-- select cast json_extract with type modifier (result)
--Testcase 946:
SELECT convert(json_extract('{"a": 100}', '$.a'), 'decimal(10,2)')::numeric, convert(json_extract('{"a": 10}', '$.a'), 'YEAR')::decimal, convert(json_unquote(json_extract('{"a": "1.123456"}', '$.a')), 'decimal(10, 3)')::numeric FROM s3;
 convert | convert | convert 
---------+---------+---------
  100.00 |    2010 |   1.123
  100.00 |    2010 |   1.123
  100.00 |    2010 |   1.123
  100.00 |    2010 |   1.123
  100.00 |    2010 |   1.123
  100.00 |    2010 |   1.123
(6 rows)

-- select convert with non pushdown func and explicit constant (explain)
--Testcase 947:
EXPLAIN VERBOSE
SELECT convert(id, 'YEAR'), pi(), 4.1 FROM s3;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (convert(id, 'YEAR'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert(id, 'YEAR'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select convert with non pushdown func and explicit constant (result)
--Testcase 948:
SELECT convert(id, 'YEAR'), pi(), 4.1 FROM s3;
 convert |        pi         | ?column? 
---------+-------------------+----------
 0       | 3.141592653589793 |      4.1
 2001    | 3.141592653589793 |      4.1
 2002    | 3.141592653589793 |      4.1
 2003    | 3.141592653589793 |      4.1
 2004    | 3.141592653589793 |      4.1
 2005    | 3.141592653589793 |      4.1
(6 rows)

-- select convert with order by index (result)
--Testcase 949:
SELECT value1, convert(1.123456 - value1,'char(3)') FROM s3 order by 2,1;
 value1 | convert 
--------+---------
    1.1 | 0.0
    0.3 | 0.8
    0.2 | 0.9
    2.2 | -1.
    0.1 | 1.0
    3.3 | -2.
(6 rows)

-- select convert with order by index (result)
--Testcase 950:
SELECT value1, convert(1.123456 - value1,'char(3)') FROM s3 order by 1,2;
 value1 | convert 
--------+---------
    0.1 | 1.0
    0.2 | 0.9
    0.3 | 0.8
    1.1 | 0.0
    2.2 | -1.
    3.3 | -2.
(6 rows)

-- select convert and as
--Testcase 951:
SELECT convert(id, 'YEAR') as convert1 FROM s3;
 convert1 
----------
 0
 2001
 2002
 2003
 2004
 2005
(6 rows)

-- full text search table
-- text search (pushdown, explain)
--Testcase 952:
EXPLAIN VERBOSE
SELECT MATCH_AGAINST(content, 'success catches') AS score, content FROM ftextsearch WHERE MATCH_AGAINST(content, 'success catches','IN BOOLEAN MODE') != 0;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.ftextsearch  (cost=100.00..1922.83 rows=3396 width=40)
   Output: (match_against(VARIADIC ARRAY[content, 'success catches'::text])), content
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.match_against(VARIADIC ARRAY[content, 'success catches'::text]), content FROM public.ftextsearch WHERE ((public.match_against(VARIADIC ARRAY[content, 'success catches'::text, 'IN BOOLEAN MODE'::text]) <> 0::double precision))
(4 rows)

-- text search (pushdown, result)
--Testcase 953:
SELECT content FROM (
SELECT MATCH_AGAINST(content, 'success catches') AS score, content FROM ftextsearch WHERE MATCH_AGAINST(content, 'success catches','IN BOOLEAN MODE') != 0) AS t ORDER BY 1;
             content              
----------------------------------
 Failure teaches success.
 The early bird catches the worm.
(2 rows)

-- ===============================================================================
-- test string functions
-- ===============================================================================
--
-- test ascii()
--
-- select ascii (stub function, explain)
--Testcase 954:
EXPLAIN VERBOSE
SELECT ascii(tag1), ascii(str1), ascii(str2) FROM s3;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=12)
   Output: (ascii(tag1)), (ascii(str1)), (ascii(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ascii(tag1), ascii(str1), ascii(str2) FROM public.s3mysql
(4 rows)

-- select ascii (stub function, result)
--Testcase 955:
SELECT ascii(tag1), ascii(str1), ascii(str2) FROM s3;
 ascii | ascii | ascii 
-------+-------+-------
    97 |    45 |    32
    97 |    45 |    32
    97 |    45 |    32
    98 |    45 |    32
    98 |    45 |    32
    98 |    45 |    32
(6 rows)

-- select ascii (stub function, pushdown constraints, explain)
--Testcase 956:
EXPLAIN VERBOSE
SELECT ascii(tag1), ascii(str1), ascii(str2) FROM s3 WHERE value2 != 100;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..246.05 rows=3396 width=12)
   Output: (ascii(tag1)), (ascii(str1)), (ascii(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ascii(tag1), ascii(str1), ascii(str2) FROM public.s3mysql WHERE ((value2 <> 100))
(4 rows)

-- select ascii (stub function, pushdown constraints, result)
--Testcase 957:
SELECT ascii(tag1), ascii(str1), ascii(str2) FROM s3 WHERE value2 != 100;
 ascii | ascii | ascii 
-------+-------+-------
    98 |    45 |    32
    98 |    45 |    32
    98 |    45 |    32
(3 rows)

-- select ascii (stub function, ascii in constraints, explain)
--Testcase 958:
EXPLAIN VERBOSE
SELECT ascii(tag1), ascii(str1), ascii(str2) FROM s3 WHERE ascii(str1) <= 97;
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..192.49 rows=1138 width=12)
   Output: (ascii(tag1)), (ascii(str1)), (ascii(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ascii(tag1), ascii(str1), ascii(str2) FROM public.s3mysql WHERE ((ascii(str1) <= 97))
(4 rows)

-- select ascii (stub function, ascii in constraints, explain)
--Testcase 959:
SELECT ascii(tag1), ascii(str1), ascii(str2) FROM s3 WHERE ascii(str1) <= 97;
 ascii | ascii | ascii 
-------+-------+-------
    97 |    45 |    32
    97 |    45 |    32
    97 |    45 |    32
    98 |    45 |    32
    98 |    45 |    32
    98 |    45 |    32
(6 rows)

-- select ascii with non pushdown func and explicit constant (explain)
--Testcase 960:
EXPLAIN VERBOSE
SELECT ascii(str1), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=44)
   Output: (ascii(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ascii(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select ascii with non pushdown func and explicit constant (result)
--Testcase 961:
SELECT ascii(str1), pi(), 4.1 FROM s3;
 ascii |        pi         | ?column? 
-------+-------------------+----------
    45 | 3.141592653589793 |      4.1
    45 | 3.141592653589793 |      4.1
    45 | 3.141592653589793 |      4.1
    45 | 3.141592653589793 |      4.1
    45 | 3.141592653589793 |      4.1
    45 | 3.141592653589793 |      4.1
(6 rows)

-- select ascii with order by (explain)
--Testcase 962:
EXPLAIN VERBOSE
SELECT value1, ascii(str2) FROM s3 ORDER BY ascii(str2);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=12)
   Output: value1, (ascii(str2))
   Sort Key: (ascii(s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=12)
         Output: value1, (ascii(str2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, ascii(str2) FROM public.s3mysql
(7 rows)

-- select ascii with order by (result)
--Testcase 963:
SELECT value1, ascii(str2) FROM s3 ORDER BY ascii(str2);
 value1 | ascii 
--------+-------
    0.1 |    32
    0.2 |    32
    0.3 |    32
    1.1 |    32
    2.2 |    32
    3.3 |    32
(6 rows)

-- select ascii with order by index (result)
--Testcase 964:
SELECT value1, ascii(str2) FROM s3 ORDER BY 2,1;
 value1 | ascii 
--------+-------
    0.1 |    32
    0.2 |    32
    0.3 |    32
    1.1 |    32
    2.2 |    32
    3.3 |    32
(6 rows)

-- select ascii with group by (explain)
--Testcase 965:
EXPLAIN VERBOSE
SELECT count(value1), ascii(str1) FROM s3 GROUP BY ascii(str1);
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (ascii(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), ascii(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select ascii with group by (result)
--Testcase 966:
SELECT count(value1), ascii(str1) FROM s3 GROUP BY ascii(str1);
 count | ascii 
-------+-------
     6 |    45
(1 row)

-- select ascii with group by index (result)
--Testcase 967:
SELECT value1, ascii(str1) FROM s3 GROUP BY 2,1;
 value1 | ascii 
--------+-------
    0.1 |    45
    0.2 |    45
    0.3 |    45
    1.1 |    45
    2.2 |    45
    3.3 |    45
(6 rows)

-- select ascii with group by having (explain)
--Testcase 968:
EXPLAIN VERBOSE
SELECT count(value1), ascii(str1) FROM s3 GROUP BY ascii(str1) HAVING ascii(str1) IS NOT NULL;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (ascii(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), ascii(str1) FROM public.s3mysql WHERE ((ascii(str1) IS NOT NULL)) GROUP BY 2
(6 rows)

-- select ascii with group by having (explain)
--Testcase 969:
SELECT count(value1), ascii(str1) FROM s3 GROUP BY ascii(str1) HAVING ascii(str1) IS NOT NULL;
 count | ascii 
-------+-------
     6 |    45
(1 row)

-- select ascii with group by index having (result)
--Testcase 970:
SELECT value1, ascii(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | ascii 
--------+-------
    1.1 |    45
    2.2 |    45
    3.3 |    45
(3 rows)

--
-- test bin()
--
-- select bin (stub function, explain)
--Testcase 971:
EXPLAIN VERBOSE
SELECT id, bin(id), bin(value2), bin(value4) FROM s3;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2797.74 rows=3413 width=100)
   Output: id, (bin((id)::numeric)), (bin((value2)::numeric)), (bin((value4)::numeric))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.bin(id), public.bin(value2), public.bin(value4) FROM public.s3mysql
(4 rows)

-- select bin (stub function, result)
--Testcase 972:
SELECT id, bin(id), bin(value2), bin(value4) FROM s3;
 id | bin |   bin    |                               bin                                
----+-----+----------+------------------------------------------------------------------
  0 | 0   | 1100100  | 1111111111111111111111111111111111111111111111111111111110011100
  1 | 1   | 1100100  | 1111111111111111111111111111111111111111111111111111111110011100
  2 | 10  | 1100100  | 1111111111111111111111111111111111111111111111111111111110011100
  3 | 11  | 11001000 | 1111111111111111111111111111111111111111111111111111111100111000
  4 | 100 | 11001000 | 1111111111111111111111111111111111111111111111111111111100111000
  5 | 101 | 11001000 | 1111111111111111111111111111111111111111111111111111111100111000
(6 rows)

-- select bin (stub function, pushdown constraints, explain)
--Testcase 973:
EXPLAIN VERBOSE
SELECT bin(id), bin(value2) FROM s3 WHERE value2 != 200;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1935.56 rows=3396 width=64)
   Output: (bin((id)::numeric)), (bin((value2)::numeric))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.bin(id), public.bin(value2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select bin (stub function, pushdown constraints, result)
--Testcase 974:
SELECT bin(id), bin(value2) FROM s3 WHERE value2 != 200;
 bin |   bin   
-----+---------
 0   | 1100100
 1   | 1100100
 10  | 1100100
(3 rows)

-- select bin (stub function, bin in constraints, explain)
--Testcase 975:
EXPLAIN VERBOSE
SELECT bin(id), bin(value2) FROM s3 WHERE bin(value2) != '1100100';
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2797.35 rows=3396 width=64)
   Output: (bin((id)::numeric)), (bin((value2)::numeric))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.bin(id), public.bin(value2) FROM public.s3mysql WHERE ((public.bin(value2) <> '1100100'::text))
(4 rows)

-- select bin (stub function, bin in constraints, explain)
--Testcase 976:
SELECT bin(id), bin(value2) FROM s3 WHERE bin(value2) != '1100100';
 bin |   bin    
-----+----------
 11  | 11001000
 100 | 11001000
 101 | 11001000
(3 rows)

--select bin as nest function with agg (explain)
--Testcase 977:
EXPLAIN VERBOSE
SELECT sum(id), bin(sum(value2)) FROM s3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (bin((sum(value2))::numeric))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(id), public.bin(sum(value2)) FROM public.s3mysql
(6 rows)

--select bin as nest function with agg (result)
--Testcase 978:
SELECT sum(id), bin(sum(value2)) FROM s3;
 sum |    bin     
-----+------------
  15 | 1110000100
(1 row)

-- select bin with non pushdown func and explicit constant (explain)
--Testcase 979:
EXPLAIN VERBOSE
SELECT bin(value2), pi(), 4.1 FROM s3;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (bin((value2)::numeric)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.bin(value2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select bin with non pushdown func and explicit constant (explain)
--Testcase 980:
SELECT bin(value2), pi(), 4.1 FROM s3;
   bin    |        pi         | ?column? 
----------+-------------------+----------
 1100100  | 3.141592653589793 |      4.1
 1100100  | 3.141592653589793 |      4.1
 1100100  | 3.141592653589793 |      4.1
 11001000 | 3.141592653589793 |      4.1
 11001000 | 3.141592653589793 |      4.1
 11001000 | 3.141592653589793 |      4.1
(6 rows)

-- select bin with order by (explain)
--Testcase 981:
EXPLAIN VERBOSE
SELECT id, bin(value2) FROM s3 ORDER BY bin(value2);
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=36)
   Output: id, (bin((value2)::numeric))
   Sort Key: (bin((s3.value2)::numeric))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=36)
         Output: id, (bin((value2)::numeric))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.bin(value2) FROM public.s3mysql
(7 rows)

-- select bin with order by (result)
--Testcase 982:
SELECT id, bin(value2) FROM s3 ORDER BY bin(value2);
 id |   bin    
----+----------
  0 | 1100100
  1 | 1100100
  2 | 1100100
  3 | 11001000
  4 | 11001000
  5 | 11001000
(6 rows)

-- select bin with order by index (result)
--Testcase 983:
SELECT value1, bin(value2) FROM s3 ORDER BY 2,1;
 value1 |   bin    
--------+----------
    0.1 | 1100100
    0.2 | 1100100
    0.3 | 1100100
    1.1 | 11001000
    2.2 | 11001000
    3.3 | 11001000
(6 rows)

-- select bin with order by index (result)
--Testcase 984:
SELECT value1, bin(value2) FROM s3 ORDER BY 1,2;
 value1 |   bin    
--------+----------
    0.1 | 1100100
    0.2 | 1100100
    0.3 | 1100100
    1.1 | 11001000
    2.2 | 11001000
    3.3 | 11001000
(6 rows)

-- select bin with group by (explain)
--Testcase 985:
EXPLAIN VERBOSE
SELECT count(value1), bin(value2) FROM s3 GROUP BY bin(value2);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (bin((value2)::numeric))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.bin(value2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select bin with group by (result)
--Testcase 986:
SELECT count(value1), bin(value2) FROM s3 GROUP BY bin(value2);
 count |   bin    
-------+----------
     3 | 1100100
     3 | 11001000
(2 rows)

-- select bin with group by index (result)
--Testcase 987:
SELECT value1, bin(value2) FROM s3 GROUP BY 2,1;
 value1 |   bin    
--------+----------
    0.1 | 1100100
    0.2 | 1100100
    0.3 | 1100100
    1.1 | 11001000
    2.2 | 11001000
    3.3 | 11001000
(6 rows)

-- select bin with group by having (explain)
--Testcase 988:
EXPLAIN VERBOSE
SELECT value1, bin(value2 - 1) FROM s3 GROUP BY 1, bin(value2 - 1) HAVING value1 > 1;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: value1, (bin(((value2 - 1))::numeric))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, public.bin((value2 - 1)) FROM public.s3mysql WHERE ((value1 > 1::double precision)) GROUP BY 1, 2
(6 rows)

-- select bin with group by having (result)
--Testcase 989:
SELECT value1, bin(value2 - 1) FROM s3 GROUP BY 1, bin(value2 - 1) HAVING value1 > 1;
 value1 |   bin    
--------+----------
    1.1 | 11000111
    2.2 | 11000111
    3.3 | 11000111
(3 rows)

-- select bin with group by index having (result)
--Testcase 990:
SELECT value1, bin(value2 - 1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |   bin    
--------+----------
    1.1 | 11000111
    2.2 | 11000111
    3.3 | 11000111
(3 rows)

--
-- test bit_length()
--
-- select bit_length (stub function, explain)
--Testcase 991:
EXPLAIN VERBOSE
SELECT bit_length(tag1), bit_length(str1), bit_length(str2) FROM s3;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..263.58 rows=3413 width=12)
   Output: ((octet_length(tag1) * 8)), ((octet_length(str1) * 8)), ((octet_length(str2) * 8))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT (octet_length(tag1) * 8), (octet_length(str1) * 8), (octet_length(str2) * 8) FROM public.s3mysql
(4 rows)

-- select bit_length (stub function, result)
--Testcase 992:
SELECT bit_length(tag1), bit_length(str1), bit_length(str2) FROM s3;
 bit_length | bit_length | bit_length 
------------+------------+------------
          8 |         72 |         72
          8 |         72 |         72
          8 |         72 |         72
          8 |         72 |         72
          8 |         72 |         72
          8 |         72 |         72
(6 rows)

-- select bit_length (stub function, pushdown constraints, explain)
--Testcase 993:
EXPLAIN VERBOSE
SELECT bit_length(tag1), bit_length(str1), bit_length(str2) FROM s3 WHERE value2 != 100;
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=12)
   Output: ((octet_length(tag1) * 8)), ((octet_length(str1) * 8)), ((octet_length(str2) * 8))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT (octet_length(tag1) * 8), (octet_length(str1) * 8), (octet_length(str2) * 8) FROM public.s3mysql WHERE ((value2 <> 100))
(4 rows)

-- select bit_length (stub function, pushdown constraints, result)
--Testcase 994:
SELECT bit_length(tag1), bit_length(str1), bit_length(str2) FROM s3 WHERE value2 != 100;
 bit_length | bit_length | bit_length 
------------+------------+------------
          8 |         72 |         72
          8 |         72 |         72
          8 |         72 |         72
(3 rows)

-- select bit_length (stub function, bit_length in constraints, explain)
--Testcase 995:
EXPLAIN VERBOSE
SELECT bit_length(tag1), bit_length(str1), bit_length(str2) FROM s3 WHERE value2 != 200;
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..271.52 rows=3396 width=12)
   Output: ((octet_length(tag1) * 8)), ((octet_length(str1) * 8)), ((octet_length(str2) * 8))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT (octet_length(tag1) * 8), (octet_length(str1) * 8), (octet_length(str2) * 8) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select bit_length (stub function, bit_length in constraints, explain)
--Testcase 996:
SELECT bit_length(tag1), bit_length(str1), bit_length(str2) FROM s3 WHERE value2 != 200;
 bit_length | bit_length | bit_length 
------------+------------+------------
          8 |         72 |         72
          8 |         72 |         72
          8 |         72 |         72
(3 rows)

-- select bit_length with non pushdown func and explicit constant (explain)
--Testcase 997:
EXPLAIN VERBOSE
SELECT bit_length(str1), pi(), 4.1 FROM s3;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=44)
   Output: ((octet_length(str1) * 8)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT (octet_length(str1) * 8), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select bit_length with non pushdown func and explicit constant (result)
--Testcase 998:
SELECT bit_length(str1), pi(), 4.1 FROM s3;
 bit_length |        pi         | ?column? 
------------+-------------------+----------
         72 | 3.141592653589793 |      4.1
         72 | 3.141592653589793 |      4.1
         72 | 3.141592653589793 |      4.1
         72 | 3.141592653589793 |      4.1
         72 | 3.141592653589793 |      4.1
         72 | 3.141592653589793 |      4.1
(6 rows)

-- select bit_length with order by (explain)
--Testcase 999:
EXPLAIN VERBOSE
SELECT value1, bit_length(str2) FROM s3 ORDER BY bit_length(str2);
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=12)
   Output: value1, ((octet_length(str2) * 8))
   Sort Key: ((octet_length(s3.str2) * 8))
   ->  Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=12)
         Output: value1, ((octet_length(str2) * 8))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, (octet_length(str2) * 8) FROM public.s3mysql
(7 rows)

-- select bit_length with order by (result)
--Testcase 1000:
SELECT value1, bit_length(str2) FROM s3 ORDER BY bit_length(str2);
 value1 | bit_length 
--------+------------
    0.1 |         72
    0.2 |         72
    0.3 |         72
    1.1 |         72
    2.2 |         72
    3.3 |         72
(6 rows)

-- select bit_length with order by index (result)
--Testcase 1001:
SELECT value1, bit_length(str2) FROM s3 ORDER BY 2,1;
 value1 | bit_length 
--------+------------
    0.1 |         72
    0.2 |         72
    0.3 |         72
    1.1 |         72
    2.2 |         72
    3.3 |         72
(6 rows)

-- select bit_length with group by (explain)
--Testcase 1002:
EXPLAIN VERBOSE
SELECT count(value1), bit_length(str1) FROM s3 GROUP BY bit_length(str1);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), ((octet_length(str1) * 8))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), (octet_length(str1) * 8) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select bit_length with group by (result)
--Testcase 1003:
SELECT count(value1), bit_length(str1) FROM s3 GROUP BY bit_length(str1);
 count | bit_length 
-------+------------
     6 |         72
(1 row)

-- select bit_length with group by index (result)
--Testcase 1004:
SELECT value1, bit_length(str1) FROM s3 GROUP BY 2,1;
 value1 | bit_length 
--------+------------
    0.1 |         72
    0.2 |         72
    0.3 |         72
    1.1 |         72
    2.2 |         72
    3.3 |         72
(6 rows)

-- select bit_length with group by having (explain)
--Testcase 1005:
EXPLAIN VERBOSE
SELECT count(value1), bit_length(str1) FROM s3 GROUP BY bit_length(str1), str1 HAVING bit_length(str1) IS NOT NULL;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), ((octet_length(str1) * 8)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), (octet_length(str1) * 8), str1 FROM public.s3mysql WHERE (((octet_length(str1) * 8) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select bit_length with group by having (explain)
--Testcase 1006:
SELECT count(value1), bit_length(str1) FROM s3 GROUP BY bit_length(str1), str1 HAVING bit_length(str1) IS NOT NULL;
 count | bit_length 
-------+------------
     6 |         72
(1 row)

-- select bit_length with group by index having (result)
--Testcase 1007:
SELECT value1, bit_length(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | bit_length 
--------+------------
    1.1 |         72
    2.2 |         72
    3.3 |         72
(3 rows)

--
-- test char()
--
-- select char (stub function, explain)
--Testcase 1008:
EXPLAIN VERBOSE
SELECT mysql_char(value2), mysql_char(value4) FROM s3;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1935.95 rows=3413 width=64)
   Output: (mysql_char((value2)::bigint)), (mysql_char((value4)::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_char(value2), public.mysql_char(value4) FROM public.s3mysql
(4 rows)

-- select char (stub function, result)
--Testcase 1009:
SELECT mysql_char(value2), mysql_char(value4) FROM s3;
 mysql_char | mysql_char 
------------+------------
 d          | 
 d          | 
 d          | 
            | 8
            | 8
            | 8
(6 rows)

-- select char (stub function, not pushdown constraints, explain)
--Testcase 1010:
EXPLAIN VERBOSE
SELECT value1, mysql_char(value2) FROM s3 WHERE to_hex(value2) = '64';
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.49 rows=17 width=40)
   Output: value1, (mysql_char((value2)::bigint))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.mysql_char(value2), value2 FROM public.s3mysql
(5 rows)

-- select char (stub function, not pushdown constraints, result)
--Testcase 1011:
SELECT value1, mysql_char(value2) FROM s3 WHERE to_hex(value2) = '64';
 value1 | mysql_char 
--------+------------
    0.1 | d
    0.2 | d
    0.3 | d
(3 rows)

-- select char (stub function, pushdown constraints, explain)
--Testcase 1012:
EXPLAIN VERBOSE
SELECT value1, mysql_char(value2) FROM s3 WHERE value2 != 200;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1078.07 rows=3396 width=40)
   Output: value1, (mysql_char((value2)::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.mysql_char(value2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select char (stub function, pushdown constraints, result)
--Testcase 1013:
SELECT value1, mysql_char(value2) FROM s3 WHERE value2 != 200;
 value1 | mysql_char 
--------+------------
    0.1 | d
    0.2 | d
    0.3 | d
(3 rows)

-- select char with non pushdown func and explicit constant (explain)
--Testcase 1014:
EXPLAIN VERBOSE
SELECT mysql_char(value2), pi(), 4.1 FROM s3;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (mysql_char((value2)::bigint)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_char(value2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select char with non pushdown func and explicit constant (result)
--Testcase 1015:
SELECT mysql_char(value2), pi(), 4.1 FROM s3;
 mysql_char |        pi         | ?column? 
------------+-------------------+----------
 d          | 3.141592653589793 |      4.1
 d          | 3.141592653589793 |      4.1
 d          | 3.141592653589793 |      4.1
            | 3.141592653589793 |      4.1
            | 3.141592653589793 |      4.1
            | 3.141592653589793 |      4.1
(6 rows)

-- select char with order by (explain)
--Testcase 1016:
EXPLAIN VERBOSE
SELECT value1, mysql_char(value2) FROM s3 ORDER BY mysql_char(value2);
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=40)
   Output: value1, (mysql_char((value2)::bigint))
   Sort Key: (mysql_char((s3.value2)::bigint))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=40)
         Output: value1, (mysql_char((value2)::bigint))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.mysql_char(value2) FROM public.s3mysql
(7 rows)

-- select char with order by (result)
--Testcase 1017:
SELECT value1, mysql_char(value2) FROM s3 ORDER BY mysql_char(value2);
 value1 | mysql_char 
--------+------------
    1.1 | 
    2.2 | 
    3.3 | 
    0.1 | d
    0.2 | d
    0.3 | d
(6 rows)

-- select char with order by index (result)
--Testcase 1018:
SELECT value1, mysql_char(value2) FROM s3 ORDER BY 1,2;
 value1 | mysql_char 
--------+------------
    0.1 | d
    0.2 | d
    0.3 | d
    1.1 | 
    2.2 | 
    3.3 | 
(6 rows)

-- select char with group by (explain)
--Testcase 1019:
EXPLAIN VERBOSE
SELECT value1, mysql_char(value2) FROM s3 GROUP BY value1, mysql_char(value2);
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=40)
   Output: value1, (mysql_char((value2)::bigint))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, public.mysql_char(value2) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select char with group by (result)
--Testcase 1020:
SELECT value1, mysql_char(value2) FROM s3 GROUP BY value1, mysql_char(value2);
 value1 | mysql_char 
--------+------------
    0.1 | d
    0.2 | d
    0.3 | d
    1.1 | 
    2.2 | 
    3.3 | 
(6 rows)

-- select char with group by index (result)
--Testcase 1021:
SELECT value1, mysql_char(value2) FROM s3 GROUP BY 2,1;
 value1 | mysql_char 
--------+------------
    0.1 | d
    0.2 | d
    0.3 | d
    1.1 | 
    2.2 | 
    3.3 | 
(6 rows)

-- select char with group by having (explain)
--Testcase 1022:
EXPLAIN VERBOSE
SELECT value1, mysql_char(value2) FROM s3 GROUP BY mysql_char(value2), value2, value1 HAVING mysql_char(value2) IS NOT NULL;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: value1, (mysql_char((value2)::bigint)), value2
   Filter: ((mysql_char((s3.value2)::bigint)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, public.mysql_char(value2), value2 FROM public.s3mysql GROUP BY 2, 3, 1 HAVING ((public.mysql_char(value2) IS NOT NULL))
(7 rows)

-- select char with group by having (result)
--Testcase 1023:
SELECT value1, mysql_char(value2) FROM s3 GROUP BY mysql_char(value2), value2, value1 HAVING mysql_char(value2) IS NOT NULL;
 value1 | mysql_char 
--------+------------
    0.1 | d
    0.2 | d
    0.3 | d
    1.1 | 
    2.2 | 
    3.3 | 
(6 rows)

-- select char with group by index having (result)
--Testcase 1024:
SELECT value1, mysql_char(value2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | mysql_char 
--------+------------
    1.1 | 
    2.2 | 
    3.3 | 
(3 rows)

--
-- test char_length()
--
-- select char_length (stub function, explain)
--Testcase 1025:
EXPLAIN VERBOSE
SELECT char_length(tag1), char_length(str1), char_length(str2) FROM s3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=12)
   Output: (char_length(tag1)), (char_length(str1)), (char_length(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT char_length(tag1), char_length(str1), char_length(str2) FROM public.s3mysql
(4 rows)

-- select char_length (stub function, result)
--Testcase 1026:
SELECT char_length(tag1), char_length(str1), char_length(str2) FROM s3;
 char_length | char_length | char_length 
-------------+-------------+-------------
           1 |           9 |           9
           1 |           9 |           9
           1 |           9 |           9
           1 |           9 |           9
           1 |           9 |           9
           1 |           9 |           9
(6 rows)

-- select char_length (stub function, not pushdown constraints, explain)
--Testcase 1027:
EXPLAIN VERBOSE
SELECT id, char_length(str1) FROM s3 WHERE to_hex(value2) = '64';
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=8)
   Output: id, (char_length(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, char_length(str1), value2 FROM public.s3mysql
(5 rows)

-- select char_length (stub function, not pushdown constraints, explain)
--Testcase 1028:
SELECT id, char_length(str1) FROM s3 WHERE to_hex(value2) = '64';
 id | char_length 
----+-------------
  0 |           9
  1 |           9
  2 |           9
(3 rows)

-- select char_length (stub function, char_length in constraints, explain)
--Testcase 1029:
EXPLAIN VERBOSE
SELECT id, char_length(str1) FROM s3 WHERE char_length(str1) > 0;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..186.80 rows=1138 width=8)
   Output: id, (char_length(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, char_length(str1) FROM public.s3mysql WHERE ((char_length(str1) > 0))
(4 rows)

-- select char_length (stub function, char_length in constraints, result)
--Testcase 1030:
SELECT id, char_length(str1) FROM s3 WHERE char_length(str1) > 0;
 id | char_length 
----+-------------
  0 |           9
  1 |           9
  2 |           9
  3 |           9
  4 |           9
  5 |           9
(6 rows)

-- select char_length with non pushdown func and explicit constant (explain)
--Testcase 1031:
EXPLAIN VERBOSE
SELECT char_length(str1), pi(), 4.1 FROM s3;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=44)
   Output: (char_length(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT char_length(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select char_length with non pushdown func and explicit constant (result)
--Testcase 1032:
SELECT char_length(str1), pi(), 4.1 FROM s3;
 char_length |        pi         | ?column? 
-------------+-------------------+----------
           9 | 3.141592653589793 |      4.1
           9 | 3.141592653589793 |      4.1
           9 | 3.141592653589793 |      4.1
           9 | 3.141592653589793 |      4.1
           9 | 3.141592653589793 |      4.1
           9 | 3.141592653589793 |      4.1
(6 rows)

-- select char_length with order by (explain)
--Testcase 1033:
EXPLAIN VERBOSE
SELECT value1, char_length(str1) FROM s3 ORDER BY char_length(str1), 1 DESC;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=12)
   Output: value1, (char_length(str1))
   Sort Key: (char_length(s3.str1)), s3.value1 DESC
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=12)
         Output: value1, (char_length(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, char_length(str1) FROM public.s3mysql
(7 rows)

-- select char_length with order by (result)
--Testcase 1034:
SELECT value1, char_length(str1) FROM s3 ORDER BY char_length(str1), 1 DESC;
 value1 | char_length 
--------+-------------
    3.3 |           9
    2.2 |           9
    1.1 |           9
    0.3 |           9
    0.2 |           9
    0.1 |           9
(6 rows)

-- select char_length with group by (explain)
--Testcase 1035:
EXPLAIN VERBOSE
SELECT count(value1), char_length(str1) FROM s3 GROUP BY char_length(str1);
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (char_length(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), char_length(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select char_length with group by (result)
--Testcase 1036:
SELECT count(value1), char_length(str1) FROM s3 GROUP BY char_length(str1);
 count | char_length 
-------+-------------
     6 |           9
(1 row)

-- select char_length with group by index (result)
--Testcase 1037:
SELECT value1, char_length(str1) FROM s3 GROUP BY 2,1;
 value1 | char_length 
--------+-------------
    0.1 |           9
    0.2 |           9
    0.3 |           9
    1.1 |           9
    2.2 |           9
    3.3 |           9
(6 rows)

-- select char_length with group by having (explain)
--Testcase 1038:
EXPLAIN VERBOSE
SELECT count(value1), char_length(str1) FROM s3 GROUP BY char_length(str1), str1 HAVING char_length(str1) > 0;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (char_length(str1)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), char_length(str1), str1 FROM public.s3mysql WHERE ((char_length(str1) > 0)) GROUP BY 2, 3
(6 rows)

-- select char_length with group by having (result)
--Testcase 1039:
SELECT count(value1), char_length(str1) FROM s3 GROUP BY char_length(str1), str1 HAVING char_length(str1) > 0;
 count | char_length 
-------+-------------
     6 |           9
(1 row)

-- select char_length with group by index having (result)
--Testcase 1040:
SELECT value1, char_length(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | char_length 
--------+-------------
    1.1 |           9
    2.2 |           9
    3.3 |           9
(3 rows)

--
-- test character_length()
--
-- select character_length (stub function, explain)
--Testcase 1041:
EXPLAIN VERBOSE
SELECT character_length(tag1), character_length(str1), character_length(str2) FROM s3;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=12)
   Output: (character_length(tag1)), (character_length(str1)), (character_length(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT character_length(tag1), character_length(str1), character_length(str2) FROM public.s3mysql
(4 rows)

-- select character_length (stub function, result)
--Testcase 1042:
SELECT character_length(tag1), character_length(str1), character_length(str2) FROM s3;
 character_length | character_length | character_length 
------------------+------------------+------------------
                1 |                9 |                9
                1 |                9 |                9
                1 |                9 |                9
                1 |                9 |                9
                1 |                9 |                9
                1 |                9 |                9
(6 rows)

-- select character_length (stub function, not pushdown constraints, explain)
--Testcase 1043:
EXPLAIN VERBOSE
SELECT id, character_length(str1) FROM s3 WHERE to_hex(value2) = '64';
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=8)
   Output: id, (character_length(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, character_length(str1), value2 FROM public.s3mysql
(5 rows)

-- select character_length (stub function, not pushdown constraints, explain)
--Testcase 1044:
SELECT id, character_length(str1) FROM s3 WHERE to_hex(value2) = '64';
 id | character_length 
----+------------------
  0 |                9
  1 |                9
  2 |                9
(3 rows)

-- select character_length (stub function, character_length in constraints, explain)
--Testcase 1045:
EXPLAIN VERBOSE
SELECT id, character_length(str1) FROM s3 WHERE character_length(str1) > 0;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..186.80 rows=1138 width=8)
   Output: id, (character_length(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, character_length(str1) FROM public.s3mysql WHERE ((character_length(str1) > 0))
(4 rows)

-- select character_length (stub function, character_length in constraints, result)
--Testcase 1046:
SELECT id, character_length(str1) FROM s3 WHERE character_length(str1) > 0;
 id | character_length 
----+------------------
  0 |                9
  1 |                9
  2 |                9
  3 |                9
  4 |                9
  5 |                9
(6 rows)

-- select character_length with non pushdown func and explicit constant (explain)
--Testcase 1047:
EXPLAIN VERBOSE
SELECT character_length(str1), pi(), 4.1 FROM s3;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=44)
   Output: (character_length(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT character_length(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select character_length with non pushdown func and explicit constant (result)
--Testcase 1048:
SELECT character_length(str1), pi(), 4.1 FROM s3;
 character_length |        pi         | ?column? 
------------------+-------------------+----------
                9 | 3.141592653589793 |      4.1
                9 | 3.141592653589793 |      4.1
                9 | 3.141592653589793 |      4.1
                9 | 3.141592653589793 |      4.1
                9 | 3.141592653589793 |      4.1
                9 | 3.141592653589793 |      4.1
(6 rows)

-- select character_length with order by (explain)
--Testcase 1049:
EXPLAIN VERBOSE
SELECT value1, character_length(str1) FROM s3 ORDER BY character_length(str1), 1 DESC;
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=12)
   Output: value1, (character_length(str1))
   Sort Key: (character_length(s3.str1)), s3.value1 DESC
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=12)
         Output: value1, (character_length(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, character_length(str1) FROM public.s3mysql
(7 rows)

-- select character_length with order by (result)
--Testcase 1050:
SELECT value1, character_length(str1) FROM s3 ORDER BY character_length(str1), 1 DESC;
 value1 | character_length 
--------+------------------
    3.3 |                9
    2.2 |                9
    1.1 |                9
    0.3 |                9
    0.2 |                9
    0.1 |                9
(6 rows)

-- select character_length with group by (explain)
--Testcase 1051:
EXPLAIN VERBOSE
SELECT count(value1), character_length(str1) FROM s3 GROUP BY character_length(str1);
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (character_length(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), character_length(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select character_length with group by (result)
--Testcase 1052:
SELECT count(value1), character_length(str1) FROM s3 GROUP BY character_length(str1);
 count | character_length 
-------+------------------
     6 |                9
(1 row)

-- select character_length with group by index (result)
--Testcase 1053:
SELECT value1, character_length(str1) FROM s3 GROUP BY 2,1;
 value1 | character_length 
--------+------------------
    0.1 |                9
    0.2 |                9
    0.3 |                9
    1.1 |                9
    2.2 |                9
    3.3 |                9
(6 rows)

-- select character_length with group by having (explain)
--Testcase 1054:
EXPLAIN VERBOSE
SELECT count(value1), character_length(str1) FROM s3 GROUP BY character_length(str1), str1 HAVING character_length(str1) > 0;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (character_length(str1)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), character_length(str1), str1 FROM public.s3mysql WHERE ((character_length(str1) > 0)) GROUP BY 2, 3
(6 rows)

-- select character_length with group by having (result)
--Testcase 1055:
SELECT count(value1), character_length(str1) FROM s3 GROUP BY character_length(str1), str1 HAVING character_length(str1) > 0;
 count | character_length 
-------+------------------
     6 |                9
(1 row)

-- select character_length with group by index having (result)
--Testcase 1056:
SELECT value1, character_length(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | character_length 
--------+------------------
    1.1 |                9
    2.2 |                9
    3.3 |                9
(3 rows)

--
-- test concat()
--
-- select concat (stub function, explain)
--Testcase 1057:
EXPLAIN VERBOSE
SELECT concat(id), concat(tag1), concat(value1), concat(value2), concat(str1) FROM s3;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..255.05 rows=3413 width=160)
   Output: concat(id), concat(tag1), concat(value1), concat(value2), concat(str1)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, tag1, value1, value2, str1 FROM public.s3mysql
(4 rows)

-- select concat (stub function, result)
--Testcase 1058:
SELECT concat(id), concat(tag1), concat(value1), concat(value2), concat(str1) FROM s3;
 concat | concat | concat | concat |  concat   
--------+--------+--------+--------+-----------
 0      | a      | 0.1    | 100    | ---XYZ---
 1      | a      | 0.2    | 100    | ---XYZ---
 2      | a      | 0.3    | 100    | ---XYZ---
 3      | b      | 1.1    | 200    | ---XYZ---
 4      | b      | 2.2    | 200    | ---XYZ---
 5      | b      | 3.3    | 200    | ---XYZ---
(6 rows)

-- select concat (stub function, pushdown constraints, explain)
--Testcase 1059:
EXPLAIN VERBOSE
SELECT id, concat(str1, str2) FROM s3 WHERE value2 != 100;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=36)
   Output: id, concat(str1, str2)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, value2, str1, str2 FROM public.s3mysql WHERE ((value2 <> 100))
(4 rows)

-- select concat (stub function, pushdown constraints, result)
--Testcase 1060:
SELECT id, concat(str1, str2) FROM s3 WHERE value2 != 100;
 id |       concat       
----+--------------------
  3 | ---XYZ---   XYZ   
  4 | ---XYZ---   XYZ   
  5 | ---XYZ---   XYZ   
(3 rows)

-- select concat (stub function, concat in constraints, explain)
--Testcase 1061:
EXPLAIN VERBOSE
SELECT id, concat(str1, str2) FROM s3 WHERE concat(str1, str2) != 'XYZ';
                             QUERY PLAN                              
---------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.94 rows=3396 width=36)
   Output: id, concat(str1, str2)
   Filter: (concat(s3.str1, s3.str2) <> 'XYZ'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, str1, str2 FROM public.s3mysql
(5 rows)

-- select concat (stub function, concat in constraints, explain)
--Testcase 1062:
SELECT id, concat(str1, str2) FROM s3 WHERE concat(str1, str2) != 'XYZ';
 id |       concat       
----+--------------------
  0 | ---XYZ---   XYZ   
  1 | ---XYZ---   XYZ   
  2 | ---XYZ---   XYZ   
  3 | ---XYZ---   XYZ   
  4 | ---XYZ---   XYZ   
  5 | ---XYZ---   XYZ   
(6 rows)

-- select concat as nest function with agg (pushdown, explain)
--Testcase 1063:
EXPLAIN VERBOSE
SELECT id, concat(sum(value1), str1) FROM s3 GROUP BY id, str1;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=68)
   Output: id, concat((sum(value1)), str1), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT id, sum(value1), str1 FROM public.s3mysql GROUP BY 1, 3
(6 rows)

-- select concat as nest function with agg (pushdown, result)
--Testcase 1064:
SELECT id, concat(sum(value1), str1) FROM s3 GROUP BY id, str1;
 id |            concat            
----+------------------------------
  0 | 0.10000000149011612---XYZ---
  1 | 0.20000000298023224---XYZ---
  2 | 0.30000001192092896---XYZ---
  3 | 1.100000023841858---XYZ---
  4 | 2.200000047683716---XYZ---
  5 | 3.299999952316284---XYZ---
(6 rows)

-- select concat with non pushdown func and explicit constant (explain)
--Testcase 1065:
EXPLAIN VERBOSE
SELECT concat(str1, str2), pi(), 4.1 FROM s3;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: concat(str1, str2), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT str1, str2 FROM public.s3mysql
(4 rows)

-- select concat with non pushdown func and explicit constant (result)
--Testcase 1066:
SELECT concat(str1, str2), pi(), 4.1 FROM s3;
       concat       |        pi         | ?column? 
--------------------+-------------------+----------
 ---XYZ---   XYZ    | 3.141592653589793 |      4.1
 ---XYZ---   XYZ    | 3.141592653589793 |      4.1
 ---XYZ---   XYZ    | 3.141592653589793 |      4.1
 ---XYZ---   XYZ    | 3.141592653589793 |      4.1
 ---XYZ---   XYZ    | 3.141592653589793 |      4.1
 ---XYZ---   XYZ    | 3.141592653589793 |      4.1
(6 rows)

-- select concat with order by (explain)
--Testcase 1067:
EXPLAIN VERBOSE
SELECT value1, concat(value2, str2) FROM s3 ORDER BY concat(value2, str2);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (concat(value2, str2))
   Sort Key: (concat(s3.value2, s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, concat(value2, str2)
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, value2, str2 FROM public.s3mysql
(7 rows)

-- select concat with order by (result)
--Testcase 1068:
SELECT value1, concat(value2, str2) FROM s3 ORDER BY concat(value2, str2);
 value1 |    concat    
--------+--------------
    0.1 | 100   XYZ   
    0.2 | 100   XYZ   
    0.3 | 100   XYZ   
    1.1 | 200   XYZ   
    2.2 | 200   XYZ   
    3.3 | 200   XYZ   
(6 rows)

-- select concat with order by index (result)
--Testcase 1069:
SELECT value1, concat(value2, str2) FROM s3 ORDER BY 2,1;
 value1 |    concat    
--------+--------------
    0.1 | 100   XYZ   
    0.2 | 100   XYZ   
    0.3 | 100   XYZ   
    1.1 | 200   XYZ   
    2.2 | 200   XYZ   
    3.3 | 200   XYZ   
(6 rows)

-- select concat with group by (explain)
--Testcase 1070:
EXPLAIN VERBOSE
SELECT count(value1), concat(str1, str2) FROM s3 GROUP BY concat(str1, str2);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 HashAggregate  (cost=237.99..240.49 rows=200 width=40)
   Output: count(value1), (concat(str1, str2))
   Group Key: concat(s3.str1, s3.str2)
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: concat(str1, str2), value1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, str1, str2 FROM public.s3mysql
(7 rows)

-- select concat with group by (result)
--Testcase 1071:
SELECT count(value1), concat(str1, str2) FROM s3 GROUP BY concat(str1, str2);
 count |       concat       
-------+--------------------
     6 | ---XYZ---   XYZ   
(1 row)

-- select concat with group by index (result)
--Testcase 1072:
SELECT value1, concat(str1, str2) FROM s3 GROUP BY 2,1;
 value1 |       concat       
--------+--------------------
    0.1 | ---XYZ---   XYZ   
    0.3 | ---XYZ---   XYZ   
    1.1 | ---XYZ---   XYZ   
    0.2 | ---XYZ---   XYZ   
    2.2 | ---XYZ---   XYZ   
    3.3 | ---XYZ---   XYZ   
(6 rows)

-- select concat with group by having (explain)
--Testcase 1073:
EXPLAIN VERBOSE
SELECT count(value1), concat(str1, str2) FROM s3 GROUP BY concat(str1, str2) HAVING concat(str1, str2) IS NOT NULL;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 HashAggregate  (cost=246.39..248.89 rows=200 width=40)
   Output: count(value1), (concat(str1, str2))
   Group Key: concat(s3.str1, s3.str2)
   ->  Foreign Scan on public.s3  (cost=100.00..229.41 rows=3396 width=40)
         Output: concat(str1, str2), value1
         Filter: (concat(s3.str1, s3.str2) IS NOT NULL)
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, str1, str2 FROM public.s3mysql
(8 rows)

-- select concat with group by having (explain)
--Testcase 1074:
SELECT count(value1), concat(str1, str2) FROM s3 GROUP BY concat(str1, str2) HAVING concat(str1, str2) IS NOT NULL;
 count |       concat       
-------+--------------------
     6 | ---XYZ---   XYZ   
(1 row)

-- select concat with group by index having (result)
--Testcase 1075:
SELECT value1, concat(str1, str2, value1, value2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |          concat          
--------+--------------------------
    3.3 | ---XYZ---   XYZ   3.3200
    1.1 | ---XYZ---   XYZ   1.1200
    2.2 | ---XYZ---   XYZ   2.2200
(3 rows)

--
-- test concat_ws()
--
-- select concat_ws (stub function, explain)
--Testcase 1076:
EXPLAIN VERBOSE
SELECT concat_ws(',', str2, str1, tag1, value2) FROM s3;
                             QUERY PLAN                              
---------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=32)
   Output: concat_ws(','::text, str2, str1, tag1, value2)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT tag1, value2, str1, str2 FROM public.s3mysql
(4 rows)

-- select concat_ws (stub function, explain)
--Testcase 1077:
SELECT concat_ws(',', str2, str1, tag1, value2) FROM s3;
         concat_ws         
---------------------------
    XYZ   ,---XYZ---,a,100
    XYZ   ,---XYZ---,a,100
    XYZ   ,---XYZ---,a,100
    XYZ   ,---XYZ---,b,200
    XYZ   ,---XYZ---,b,200
    XYZ   ,---XYZ---,b,200
(6 rows)

-- select concat_ws (stub function, not pushdown constraints, explain)
--Testcase 1078:
EXPLAIN VERBOSE
SELECT value1, concat_ws('.', str2, str1) FROM s3 WHERE to_hex(value2) = '64';
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, concat_ws('.'::text, str2, str1)
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, value2, str1, str2 FROM public.s3mysql
(5 rows)

-- select concat_ws (stub function, not pushdown constraints, result)
--Testcase 1079:
SELECT value1, concat_ws('.', str2, str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 |      concat_ws      
--------+---------------------
    0.1 |    XYZ   .---XYZ---
    0.2 |    XYZ   .---XYZ---
    0.3 |    XYZ   .---XYZ---
(3 rows)

-- select concat_ws (stub function, pushdown constraints, explain)
--Testcase 1080:
EXPLAIN VERBOSE
SELECT value1, concat_ws('.', str2, str1) FROM s3 WHERE value2 != 200;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, concat_ws('.'::text, str2, str1)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, value2, str1, str2 FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select concat_ws (stub function, pushdown constraints, result)
--Testcase 1081:
SELECT value1, concat_ws('.', str2, str1) FROM s3 WHERE value2 != 200;
 value1 |      concat_ws      
--------+---------------------
    0.1 |    XYZ   .---XYZ---
    0.2 |    XYZ   .---XYZ---
    0.3 |    XYZ   .---XYZ---
(3 rows)

-- select concat_ws with non pushdown func and explicit constant (explain)
--Testcase 1082:
EXPLAIN VERBOSE
SELECT concat_ws('.', str2, str1), pi(), 4.1 FROM s3;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: concat_ws('.'::text, str2, str1), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT str1, str2 FROM public.s3mysql
(4 rows)

-- select concat_ws with non pushdown func and explicit constant (result)
--Testcase 1083:
SELECT concat_ws('.', str2, str1), pi(), 4.1 FROM s3;
      concat_ws      |        pi         | ?column? 
---------------------+-------------------+----------
    XYZ   .---XYZ--- | 3.141592653589793 |      4.1
    XYZ   .---XYZ--- | 3.141592653589793 |      4.1
    XYZ   .---XYZ--- | 3.141592653589793 |      4.1
    XYZ   .---XYZ--- | 3.141592653589793 |      4.1
    XYZ   .---XYZ--- | 3.141592653589793 |      4.1
    XYZ   .---XYZ--- | 3.141592653589793 |      4.1
(6 rows)

-- select concat_ws with order by (explain)
--Testcase 1084:
EXPLAIN VERBOSE
SELECT value1, concat_ws('.', str2, str1) FROM s3 ORDER BY concat_ws('.', str2, str1);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (concat_ws('.'::text, str2, str1))
   Sort Key: (concat_ws('.'::text, s3.str2, s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, concat_ws('.'::text, str2, str1)
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, str1, str2 FROM public.s3mysql
(7 rows)

-- select concat_ws with order by (result)
--Testcase 1085:
SELECT value1, concat_ws('.', str2, str1) FROM s3 ORDER BY concat_ws('.', str2, str1);
 value1 |      concat_ws      
--------+---------------------
    0.1 |    XYZ   .---XYZ---
    0.2 |    XYZ   .---XYZ---
    0.3 |    XYZ   .---XYZ---
    1.1 |    XYZ   .---XYZ---
    2.2 |    XYZ   .---XYZ---
    3.3 |    XYZ   .---XYZ---
(6 rows)

-- select concat_ws with order by index (result)
--Testcase 1086:
SELECT value1, concat_ws('.', str2, str1) FROM s3 ORDER BY 2,1;
 value1 |      concat_ws      
--------+---------------------
    0.1 |    XYZ   .---XYZ---
    0.2 |    XYZ   .---XYZ---
    0.3 |    XYZ   .---XYZ---
    1.1 |    XYZ   .---XYZ---
    2.2 |    XYZ   .---XYZ---
    3.3 |    XYZ   .---XYZ---
(6 rows)

-- select concat_ws with order by index (result)
--Testcase 1087:
SELECT value1, concat_ws('.', value1, value4) FROM s3 ORDER BY 1,2;
 value1 | concat_ws 
--------+-----------
    0.1 | 0.1.-100
    0.2 | 0.2.-100
    0.3 | 0.3.-100
    1.1 | 1.1.-200
    2.2 | 2.2.-200
    3.3 | 3.3.-200
(6 rows)

-- select concat_ws with group by (explain)
--Testcase 1088:
EXPLAIN VERBOSE
SELECT count(value1), concat_ws('.', str2, str1) FROM s3 GROUP BY concat_ws('.', str2, str1);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 HashAggregate  (cost=237.99..240.49 rows=200 width=40)
   Output: count(value1), (concat_ws('.'::text, str2, str1))
   Group Key: concat_ws('.'::text, s3.str2, s3.str1)
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: concat_ws('.'::text, str2, str1), value1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, str1, str2 FROM public.s3mysql
(7 rows)

-- select concat_ws with group by (result)
--Testcase 1089:
SELECT count(value1), concat_ws('.', str2, str1) FROM s3 GROUP BY concat_ws('.', str2, str1);
 count |      concat_ws      
-------+---------------------
     6 |    XYZ   .---XYZ---
(1 row)

-- select concat_ws with group by index (result)
--Testcase 1090:
SELECT value1, concat_ws('.', str2, str1) FROM s3 GROUP BY 2,1;
 value1 |      concat_ws      
--------+---------------------
    0.3 |    XYZ   .---XYZ---
    0.2 |    XYZ   .---XYZ---
    3.3 |    XYZ   .---XYZ---
    0.1 |    XYZ   .---XYZ---
    1.1 |    XYZ   .---XYZ---
    2.2 |    XYZ   .---XYZ---
(6 rows)

-- select concat_ws with group by having (explain)
--Testcase 1091:
EXPLAIN VERBOSE
SELECT count(value1), concat_ws('.', str2, str1) FROM s3 GROUP BY concat_ws('.', str2, str1) HAVING concat_ws('.', str2, str1) IS NOT NULL;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 HashAggregate  (cost=246.39..248.89 rows=200 width=40)
   Output: count(value1), (concat_ws('.'::text, str2, str1))
   Group Key: concat_ws('.'::text, s3.str2, s3.str1)
   ->  Foreign Scan on public.s3  (cost=100.00..229.41 rows=3396 width=40)
         Output: concat_ws('.'::text, str2, str1), value1
         Filter: (concat_ws('.'::text, s3.str2, s3.str1) IS NOT NULL)
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, str1, str2 FROM public.s3mysql
(8 rows)

-- select concat_ws with group by having (result)
--Testcase 1092:
SELECT count(value1), concat_ws('.', str2, str1) FROM s3 GROUP BY concat_ws('.', str2, str1) HAVING concat_ws('.', str2, str1) IS NOT NULL;
 count |      concat_ws      
-------+---------------------
     6 |    XYZ   .---XYZ---
(1 row)

-- select concat_ws with group by index having (result)
--Testcase 1093:
SELECT value1, concat_ws('.', str2, str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |      concat_ws      
--------+---------------------
    2.2 |    XYZ   .---XYZ---
    1.1 |    XYZ   .---XYZ---
    3.3 |    XYZ   .---XYZ---
(3 rows)

--
-- test elt()
--
-- select elt (stub function, explain)
--Testcase 1094:
EXPLAIN VERBOSE
SELECT elt(1, str2, str1, tag1) FROM s3;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (elt(1, VARIADIC ARRAY[str2, str1, tag1]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.elt(1, VARIADIC ARRAY[str2, str1, tag1]) FROM public.s3mysql
(4 rows)

-- select elt (stub function, result)
--Testcase 1095:
SELECT elt(1, str2, str1, tag1) FROM s3;
    elt    
-----------
    XYZ   
    XYZ   
    XYZ   
    XYZ   
    XYZ   
    XYZ   
(6 rows)

-- select elt (stub function, not pushdown constraints, explain)
--Testcase 1096:
EXPLAIN VERBOSE
SELECT value1, elt(1, str2, str1) FROM s3 WHERE to_hex(value2) = '64';
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (elt(1, VARIADIC ARRAY[str2, str1]))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.elt(1, VARIADIC ARRAY[str2, str1]), value2 FROM public.s3mysql
(5 rows)

-- select elt (stub function, not pushdown constraints, result)
--Testcase 1097:
SELECT value1, elt(1, str2, str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 |    elt    
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
(3 rows)

-- select elt (stub function, pushdown constraints, explain)
--Testcase 1098:
EXPLAIN VERBOSE
SELECT value1, elt(1, str2, str1) FROM s3 WHERE value2 != 200;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (elt(1, VARIADIC ARRAY[str2, str1]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.elt(1, VARIADIC ARRAY[str2, str1]) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select elt (stub function, pushdown constraints, result)
--Testcase 1099:
SELECT value1, elt(1, str2, str1) FROM s3 WHERE value2 != 200;
 value1 |    elt    
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
(3 rows)

-- select elt with non pushdown func and explicit constant (explain)
--Testcase 1100:
EXPLAIN VERBOSE
SELECT elt(1, str2, str1), pi(), 4.1 FROM s3;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (elt(1, VARIADIC ARRAY[str2, str1])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.elt(1, VARIADIC ARRAY[str2, str1]), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select elt with non pushdown func and explicit constant (result)
--Testcase 1101:
SELECT elt(1, str2, str1), pi(), 4.1 FROM s3;
    elt    |        pi         | ?column? 
-----------+-------------------+----------
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
(6 rows)

-- select elt with order by (explain)
--Testcase 1102:
EXPLAIN VERBOSE
SELECT value1, elt(1, str2, str1) FROM s3 ORDER BY elt(1, str2, str1);
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (elt(1, VARIADIC ARRAY[str2, str1]))
   Sort Key: (elt(1, VARIADIC ARRAY[s3.str2, s3.str1]))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (elt(1, VARIADIC ARRAY[str2, str1]))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.elt(1, VARIADIC ARRAY[str2, str1]) FROM public.s3mysql
(7 rows)

-- select elt with order by (result)
--Testcase 1103:
SELECT value1, elt(1, str2, str1) FROM s3 ORDER BY elt(1, str2, str1);
 value1 |    elt    
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(6 rows)

-- select elt with order by index (result)
--Testcase 1104:
SELECT value1, elt(1, str2, str1) FROM s3 ORDER BY 2,1;
 value1 |    elt    
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(6 rows)

-- select elt with order by index (result)
--Testcase 1105:
SELECT value1, elt(1, str2, str1) FROM s3 ORDER BY 1,2;
 value1 |    elt    
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(6 rows)

-- select elt with group by (explain)
--Testcase 1106:
EXPLAIN VERBOSE
SELECT count(value1), elt(1, str2, str1) FROM s3 GROUP BY elt(1, str2, str1);
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (elt(1, VARIADIC ARRAY[str2, str1]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.elt(1, VARIADIC ARRAY[str2, str1]) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select elt with group by (result)
--Testcase 1107:
SELECT count(value1), elt(1, str2, str1) FROM s3 GROUP BY elt(1, str2, str1);
 count |    elt    
-------+-----------
     6 |    XYZ   
(1 row)

-- select elt with group by index (result)
--Testcase 1108:
SELECT value1, elt(1, str2, str1) FROM s3 GROUP BY 2,1;
 value1 |    elt    
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(6 rows)

-- select elt with group by having (explain)
--Testcase 1109:
EXPLAIN VERBOSE
SELECT count(value1), elt(1, str2, str1) FROM s3 GROUP BY elt(1, str2, str1), str1, str2 HAVING elt(1, str2, str1) IS NOT NULL;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=104)
   Output: (count(value1)), (elt(1, VARIADIC ARRAY[str2, str1])), str1, str2
   Filter: ((elt(1, VARIADIC ARRAY[s3.str2, s3.str1])) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.elt(1, VARIADIC ARRAY[str2, str1]), str1, str2 FROM public.s3mysql GROUP BY 2, 3, 4
(7 rows)

-- select elt with group by having (result)
--Testcase 1110:
SELECT count(value1), elt(1, str2, str1) FROM s3 GROUP BY elt(1, str2, str1), str1, str2 HAVING elt(1, str2, str1) IS NOT NULL;
 count |    elt    
-------+-----------
     6 |    XYZ   
(1 row)

-- select elt with group by index having (result)
--Testcase 1111:
SELECT value1, elt(1, str2, str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |    elt    
--------+-----------
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(3 rows)

--
-- test export_set()
--
-- select export_set (stub function, explain)
--Testcase 1112:
EXPLAIN VERBOSE
SELECT export_set(5, str2, str1) FROM s3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (export_set(5, str2, str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.export_set(5, str2, str1) FROM public.s3mysql
(4 rows)

-- select export_set (stub function, result)
--Testcase 1113:
SELECT export_set(5, str2, str1) FROM s3;
                                                                                                                                                                                                                                                                                                                           export_set                                                                                                                                                                                                                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
(6 rows)

--Testcase 1114:
EXPLAIN VERBOSE
SELECT export_set(5, str2, str1, ',') FROM s3;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (export_set(5, str2, str1, ','::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.export_set(5, str2, str1, ','::text) FROM public.s3mysql
(4 rows)

-- select export_set (stub function, result)
--Testcase 1115:
SELECT export_set(5, str2, str1, ',') FROM s3;
                                                                                                                                                                                                                                                                                                                           export_set                                                                                                                                                                                                                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
    XYZ   ,---XYZ---,   XYZ   ,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---,---XYZ---
(6 rows)

-- select export_set (stub function, explain)
--Testcase 1116:
EXPLAIN VERBOSE
SELECT export_set(5, str2, str1, ',', 2) FROM s3;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (export_set(5, str2, str1, ','::text, 2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.export_set(5, str2, str1, ','::text, 2) FROM public.s3mysql
(4 rows)

-- select export_set (stub function, result)
--Testcase 1117:
SELECT export_set(5, str2, str1, ',', 2) FROM s3;
     export_set      
---------------------
    XYZ   ,---XYZ---
    XYZ   ,---XYZ---
    XYZ   ,---XYZ---
    XYZ   ,---XYZ---
    XYZ   ,---XYZ---
    XYZ   ,---XYZ---
(6 rows)

-- select export_set (stub function, not pushdown constraints, explain)
--Testcase 1118:
EXPLAIN VERBOSE
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 WHERE to_hex(value2) = '64';
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (export_set(5, str2, str1, ','::text, 2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.export_set(5, str2, str1, ','::text, 2), value2 FROM public.s3mysql
(5 rows)

-- select export_set (stub function, not pushdown constraints, result)
--Testcase 1119:
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 WHERE to_hex(value2) = '64';
 value1 |     export_set      
--------+---------------------
    0.1 |    XYZ   ,---XYZ---
    0.2 |    XYZ   ,---XYZ---
    0.3 |    XYZ   ,---XYZ---
(3 rows)

-- select export_set (stub function, pushdown constraints, explain)
--Testcase 1120:
EXPLAIN VERBOSE
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 WHERE value2 != 200;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (export_set(5, str2, str1, ','::text, 2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.export_set(5, str2, str1, ','::text, 2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select export_set (stub function, pushdown constraints, result)
--Testcase 1121:
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 WHERE value2 != 200;
 value1 |     export_set      
--------+---------------------
    0.1 |    XYZ   ,---XYZ---
    0.2 |    XYZ   ,---XYZ---
    0.3 |    XYZ   ,---XYZ---
(3 rows)

-- select export_set with non pushdown func and explicit constant (explain)
--Testcase 1122:
EXPLAIN VERBOSE
SELECT export_set(5, str2, str1, ',', 2), pi(), 4.1 FROM s3;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (export_set(5, str2, str1, ','::text, 2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.export_set(5, str2, str1, ','::text, 2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select export_set with non pushdown func and explicit constant (result)
--Testcase 1123:
SELECT export_set(5, str2, str1, ',', 2), pi(), 4.1 FROM s3;
     export_set      |        pi         | ?column? 
---------------------+-------------------+----------
    XYZ   ,---XYZ--- | 3.141592653589793 |      4.1
    XYZ   ,---XYZ--- | 3.141592653589793 |      4.1
    XYZ   ,---XYZ--- | 3.141592653589793 |      4.1
    XYZ   ,---XYZ--- | 3.141592653589793 |      4.1
    XYZ   ,---XYZ--- | 3.141592653589793 |      4.1
    XYZ   ,---XYZ--- | 3.141592653589793 |      4.1
(6 rows)

-- select export_set with order by (explain)
--Testcase 1124:
EXPLAIN VERBOSE
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 ORDER BY export_set(5, str2, str1, ',', 2);
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (export_set(5, str2, str1, ','::text, 2))
   Sort Key: (export_set(5, s3.str2, s3.str1, ','::text, 2))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (export_set(5, str2, str1, ','::text, 2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.export_set(5, str2, str1, ','::text, 2) FROM public.s3mysql
(7 rows)

-- select export_set with order by (result)
--Testcase 1125:
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 ORDER BY export_set(5, str2, str1, ',', 2);
 value1 |     export_set      
--------+---------------------
    0.1 |    XYZ   ,---XYZ---
    0.2 |    XYZ   ,---XYZ---
    0.3 |    XYZ   ,---XYZ---
    1.1 |    XYZ   ,---XYZ---
    2.2 |    XYZ   ,---XYZ---
    3.3 |    XYZ   ,---XYZ---
(6 rows)

-- select export_set with order by index (result)
--Testcase 1126:
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 ORDER BY 2,1;
 value1 |     export_set      
--------+---------------------
    0.1 |    XYZ   ,---XYZ---
    0.2 |    XYZ   ,---XYZ---
    0.3 |    XYZ   ,---XYZ---
    1.1 |    XYZ   ,---XYZ---
    2.2 |    XYZ   ,---XYZ---
    3.3 |    XYZ   ,---XYZ---
(6 rows)

-- select export_set with order by index (result)
--Testcase 1127:
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 ORDER BY 1,2;
 value1 |     export_set      
--------+---------------------
    0.1 |    XYZ   ,---XYZ---
    0.2 |    XYZ   ,---XYZ---
    0.3 |    XYZ   ,---XYZ---
    1.1 |    XYZ   ,---XYZ---
    2.2 |    XYZ   ,---XYZ---
    3.3 |    XYZ   ,---XYZ---
(6 rows)

-- select export_set with group by (explain)
--Testcase 1128:
EXPLAIN VERBOSE
SELECT count(value1), export_set(5, str2, str1, ',', 2) FROM s3 GROUP BY export_set(5, str2, str1, ',', 2);
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (export_set(5, str2, str1, ','::text, 2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.export_set(5, str2, str1, ','::text, 2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select export_set with group by (result)
--Testcase 1129:
SELECT count(value1), export_set(5, str2, str1, ',', 2) FROM s3 GROUP BY export_set(5, str2, str1, ',', 2);
 count |     export_set      
-------+---------------------
     6 |    XYZ   ,---XYZ---
(1 row)

-- select export_set with group by index (result)
--Testcase 1130:
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 GROUP BY 2,1;
 value1 |     export_set      
--------+---------------------
    0.1 |    XYZ   ,---XYZ---
    0.2 |    XYZ   ,---XYZ---
    0.3 |    XYZ   ,---XYZ---
    1.1 |    XYZ   ,---XYZ---
    2.2 |    XYZ   ,---XYZ---
    3.3 |    XYZ   ,---XYZ---
(6 rows)

-- select export_set with group by having (explain)
--Testcase 1131:
EXPLAIN VERBOSE
SELECT count(value1), export_set(5, str2, str1, ',', 2) FROM s3 GROUP BY export_set(5, str2, str1, ',', 2), str1, str2 HAVING export_set(5, str2, str1, ',', 2) IS NOT NULL;
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=104)
   Output: (count(value1)), (export_set(5, str2, str1, ','::text, 2)), str1, str2
   Filter: ((export_set(5, s3.str2, s3.str1, ','::text, 2)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.export_set(5, str2, str1, ','::text, 2), str1, str2 FROM public.s3mysql GROUP BY 2, 3, 4 HAVING ((public.export_set(5, str2, str1, ','::text, 2) IS NOT NULL))
(7 rows)

-- select export_set with group by having (result)
--Testcase 1132:
SELECT count(value1), export_set(5, str2, str1, ',', 2) FROM s3 GROUP BY export_set(5, str2, str1, ',', 2), str1, str2 HAVING export_set(5, str2, str1, ',', 2) IS NOT NULL;
 count |     export_set      
-------+---------------------
     6 |    XYZ   ,---XYZ---
(1 row)

-- select export_set with group by index having (result)
--Testcase 1133:
SELECT value1, export_set(5, str2, str1, ',', 2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |     export_set      
--------+---------------------
    1.1 |    XYZ   ,---XYZ---
    2.2 |    XYZ   ,---XYZ---
    3.3 |    XYZ   ,---XYZ---
(3 rows)

--
-- test field()
--
-- select field (stub function, explain)
--Testcase 1134:
EXPLAIN VERBOSE
SELECT field('---XYZ---', str2, str1) FROM s3;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]) FROM public.s3mysql
(4 rows)

-- select field (stub function, result)
--Testcase 1135:
SELECT field('---XYZ---', str2, str1) FROM s3;
 field 
-------
     2
     2
     2
     2
     2
     2
(6 rows)

-- select field (stub function, not pushdown constraints, explain)
--Testcase 1136:
EXPLAIN VERBOSE
SELECT value1, field('---XYZ---', str2, str1) FROM s3 WHERE to_hex(value2) = '64';
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=12)
   Output: value1, (field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]), value2 FROM public.s3mysql
(5 rows)

-- select field (stub function, not pushdown constraints, result)
--Testcase 1137:
SELECT value1, field('---XYZ---', str2, str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 | field 
--------+-------
    0.1 |     2
    0.2 |     2
    0.3 |     2
(3 rows)

-- select field (stub function, pushdown constraints, explain)
--Testcase 1138:
EXPLAIN VERBOSE
SELECT value1, field('---XYZ---', str2, str1) FROM s3 WHERE value2 != 200;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=12)
   Output: value1, (field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select field (stub function, pushdown constraints, result)
--Testcase 1139:
SELECT value1, field('---XYZ---', str2, str1) FROM s3 WHERE value2 != 200;
 value1 | field 
--------+-------
    0.1 |     2
    0.2 |     2
    0.3 |     2
(3 rows)

-- select field with non pushdown func and explicit constant (explain)
--Testcase 1140:
EXPLAIN VERBOSE
SELECT field('---XYZ---', str2, str1), pi(), 4.1 FROM s3;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (field('---XYZ---'::text, VARIADIC ARRAY[str2, str1])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select field with non pushdown func and explicit constant (result)
--Testcase 1141:
SELECT field('---XYZ---', str2, str1), pi(), 4.1 FROM s3;
 field |        pi         | ?column? 
-------+-------------------+----------
     2 | 3.141592653589793 |      4.1
     2 | 3.141592653589793 |      4.1
     2 | 3.141592653589793 |      4.1
     2 | 3.141592653589793 |      4.1
     2 | 3.141592653589793 |      4.1
     2 | 3.141592653589793 |      4.1
(6 rows)

-- select field with order by (explain)
--Testcase 1142:
EXPLAIN VERBOSE
SELECT value1, field('---XYZ---', str2, str1) FROM s3 ORDER BY field('---XYZ---', str2, str1);
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=12)
   Output: value1, (field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]))
   Sort Key: (field('---XYZ---'::text, VARIADIC ARRAY[s3.str2, s3.str1]))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=12)
         Output: value1, (field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]) FROM public.s3mysql
(7 rows)

-- select field with order by (result)
--Testcase 1143:
SELECT value1, field('---XYZ---', str2, str1) FROM s3 ORDER BY field('---XYZ---', str2, str1);
 value1 | field 
--------+-------
    0.1 |     2
    0.2 |     2
    0.3 |     2
    1.1 |     2
    2.2 |     2
    3.3 |     2
(6 rows)

-- select field with order by index (result)
--Testcase 1144:
SELECT value1, field('---XYZ---', str2, str1) FROM s3 ORDER BY 2,1;
 value1 | field 
--------+-------
    0.1 |     2
    0.2 |     2
    0.3 |     2
    1.1 |     2
    2.2 |     2
    3.3 |     2
(6 rows)

-- select field with order by index (result)
--Testcase 1145:
SELECT value1, field('---XYZ---', str2, str1) FROM s3 ORDER BY 1,2;
 value1 | field 
--------+-------
    0.1 |     2
    0.2 |     2
    0.3 |     2
    1.1 |     2
    2.2 |     2
    3.3 |     2
(6 rows)

-- select field with group by (explain)
--Testcase 1146:
EXPLAIN VERBOSE
SELECT count(value1), field('---XYZ---', str2, str1) FROM s3 GROUP BY field('---XYZ---', str2, str1);
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select field with group by (result)
--Testcase 1147:
SELECT count(value1), field('---XYZ---', str2, str1) FROM s3 GROUP BY field('---XYZ---', str2, str1);
 count | field 
-------+-------
     6 |     2
(1 row)

-- select field with group by index (result)
--Testcase 1148:
SELECT value1, field('---XYZ---', str2, str1) FROM s3 GROUP BY 2,1;
 value1 | field 
--------+-------
    0.1 |     2
    0.2 |     2
    0.3 |     2
    1.1 |     2
    2.2 |     2
    3.3 |     2
(6 rows)

-- select field with group by having (explain)
--Testcase 1149:
EXPLAIN VERBOSE
SELECT count(value1), field('---XYZ---', str2, str1) FROM s3 GROUP BY field('---XYZ---', str2, str1), str1, str2 HAVING field('---XYZ---', str2, str1) > 0;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=76)
   Output: (count(value1)), (field('---XYZ---'::text, VARIADIC ARRAY[str2, str1])), str1, str2
   Filter: ((field('---XYZ---'::text, VARIADIC ARRAY[s3.str2, s3.str1])) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.field('---XYZ---'::text, VARIADIC ARRAY[str2, str1]), str1, str2 FROM public.s3mysql GROUP BY 2, 3, 4
(7 rows)

-- select field with group by having (result)
--Testcase 1150:
SELECT count(value1), field('---XYZ---', str2, str1) FROM s3 GROUP BY field('---XYZ---', str2, str1), str1, str2 HAVING field('---XYZ---', str2, str1) > 0;
 count | field 
-------+-------
     6 |     2
(1 row)

-- select field with group by index having (result)
--Testcase 1151:
SELECT value1, field('---XYZ---', str2, str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | field 
--------+-------
    1.1 |     2
    2.2 |     2
    3.3 |     2
(3 rows)

--
-- test find_in_set()
--
-- select find_in_set (stub function, explain)
--Testcase 1152:
EXPLAIN VERBOSE
SELECT find_in_set('---XYZ---', str1) FROM s3;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (find_in_set('---XYZ---'::text, str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.find_in_set('---XYZ---'::text, str1) FROM public.s3mysql
(4 rows)

-- select find_in_set (stub function, result)
--Testcase 1153:
SELECT find_in_set('---XYZ---', str1) FROM s3;
 find_in_set 
-------------
           1
           1
           1
           1
           1
           1
(6 rows)

-- select find_in_set (stub function, not pushdown constraints, explain)
--Testcase 1154:
EXPLAIN VERBOSE
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 WHERE to_hex(value2) = '64';
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=12)
   Output: value1, (find_in_set('---XYZ---'::text, str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.find_in_set('---XYZ---'::text, str1), value2 FROM public.s3mysql
(5 rows)

-- select find_in_set (stub function, not pushdown constraints, result)
--Testcase 1155:
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 | find_in_set 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
(3 rows)

-- select find_in_set (stub function, pushdown constraints, explain)
--Testcase 1156:
EXPLAIN VERBOSE
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 WHERE value2 != 200;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=12)
   Output: value1, (find_in_set('---XYZ---'::text, str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.find_in_set('---XYZ---'::text, str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select find_in_set (stub function, pushdown constraints, result)
--Testcase 1157:
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 WHERE value2 != 200;
 value1 | find_in_set 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
(3 rows)

-- select find_in_set with non pushdown func and explicit constant (explain)
--Testcase 1158:
EXPLAIN VERBOSE
SELECT find_in_set('---XYZ---', str1), pi(), 4.1 FROM s3;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (find_in_set('---XYZ---'::text, str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.find_in_set('---XYZ---'::text, str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select find_in_set with non pushdown func and explicit constant (result)
--Testcase 1159:
SELECT find_in_set('---XYZ---', str1), pi(), 4.1 FROM s3;
 find_in_set |        pi         | ?column? 
-------------+-------------------+----------
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
(6 rows)

-- select find_in_set with order by (explain)
--Testcase 1160:
EXPLAIN VERBOSE
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 ORDER BY find_in_set('---XYZ---', str1);
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=12)
   Output: value1, (find_in_set('---XYZ---'::text, str1))
   Sort Key: (find_in_set('---XYZ---'::text, s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=12)
         Output: value1, (find_in_set('---XYZ---'::text, str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.find_in_set('---XYZ---'::text, str1) FROM public.s3mysql
(7 rows)

-- select find_in_set with order by (result)
--Testcase 1161:
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 ORDER BY find_in_set('---XYZ---', str1);
 value1 | find_in_set 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
    1.1 |           1
    2.2 |           1
    3.3 |           1
(6 rows)

-- select find_in_set with order by index (result)
--Testcase 1162:
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 ORDER BY 2,1;
 value1 | find_in_set 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
    1.1 |           1
    2.2 |           1
    3.3 |           1
(6 rows)

-- select find_in_set with order by index (result)
--Testcase 1163:
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 ORDER BY 1,2;
 value1 | find_in_set 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
    1.1 |           1
    2.2 |           1
    3.3 |           1
(6 rows)

-- select find_in_set with group by (explain)
--Testcase 1164:
EXPLAIN VERBOSE
SELECT count(value1), find_in_set('---XYZ---', str1) FROM s3 GROUP BY find_in_set('---XYZ---', str1);
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (find_in_set('---XYZ---'::text, str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.find_in_set('---XYZ---'::text, str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select find_in_set with group by (result)
--Testcase 1165:
SELECT count(value1), find_in_set('---XYZ---', str1) FROM s3 GROUP BY find_in_set('---XYZ---', str1);
 count | find_in_set 
-------+-------------
     6 |           1
(1 row)

-- select find_in_set with group by index (result)
--Testcase 1166:
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 GROUP BY 2,1;
 value1 | find_in_set 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
    1.1 |           1
    2.2 |           1
    3.3 |           1
(6 rows)

-- select find_in_set with group by having (explain)
--Testcase 1167:
EXPLAIN VERBOSE
SELECT count(value1), find_in_set('---XYZ---', str1) FROM s3 GROUP BY find_in_set('---XYZ---', str1), str1, str2 HAVING count(find_in_set('---XYZ---', str1)) IS NOT NULL;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=1961.55..2013.30 rows=199 width=76)
   Output: count(value1), (find_in_set('---XYZ---'::text, str1)), str1, str2
   Group Key: (find_in_set('---XYZ---'::text, s3.str1)), s3.str1, s3.str2
   Filter: (count((find_in_set('---XYZ---'::text, s3.str1))) IS NOT NULL)
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=76)
         Output: (find_in_set('---XYZ---'::text, str1)), str1, str2, value1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.find_in_set('---XYZ---'::text, str1), str1, str2, value1 FROM public.s3mysql
(8 rows)

-- select find_in_set with group by having (result)
--Testcase 1168:
SELECT count(value1), find_in_set('---XYZ---', str1) FROM s3 GROUP BY find_in_set('---XYZ---', str1), str1, str2 HAVING count(find_in_set('---XYZ---', str1)) IS NOT NULL;
 count | find_in_set 
-------+-------------
     6 |           1
(1 row)

-- select find_in_set with group by index having (result)
--Testcase 1169:
SELECT value1, find_in_set('---XYZ---', str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | find_in_set 
--------+-------------
    1.1 |           1
    2.2 |           1
    3.3 |           1
(3 rows)

--
-- test format()
--
-- select format (stub function, explain)
--Testcase 1170:
EXPLAIN VERBOSE
SELECT format(value1, 4), format(value2, 4), format(value4, 4) FROM s3;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2789.20 rows=3413 width=96)
   Output: (format(value1, 4)), (format((value2)::double precision, 4)), (format((value4)::double precision, 4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.format(value1, 4), public.format(value2, 4), public.format(value4, 4) FROM public.s3mysql
(4 rows)

-- select format (stub function, result)
--Testcase 1171:
SELECT format(value1, 4), format(value2, 4), format(value4, 4) FROM s3;
 format |  format  |  format   
--------+----------+-----------
 0.1000 | 100.0000 | -100.0000
 0.2000 | 100.0000 | -100.0000
 0.3000 | 100.0000 | -100.0000
 1.1000 | 200.0000 | -200.0000
 2.2000 | 200.0000 | -200.0000
 3.3000 | 200.0000 | -200.0000
(6 rows)

-- select format (stub function, explain)
--Testcase 1172:
EXPLAIN VERBOSE
SELECT format(value1, 4, 'de_DE'), format(value2, 4, 'de_DE'), format(value4, 4, 'de_DE') FROM s3;
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2789.20 rows=3413 width=96)
   Output: (format(value1, 4, 'de_DE'::text)), (format((value2)::double precision, 4, 'de_DE'::text)), (format((value4)::double precision, 4, 'de_DE'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.format(value1, 4, 'de_DE'::text), public.format(value2, 4, 'de_DE'::text), public.format(value4, 4, 'de_DE'::text) FROM public.s3mysql
(4 rows)

-- select format (stub function, result)
--Testcase 1173:
SELECT format(value1, 4, 'de_DE'), format(value2, 4, 'de_DE'), format(value4, 4, 'de_DE') FROM s3;
 format |  format  |  format   
--------+----------+-----------
 0,1000 | 100,0000 | -100,0000
 0,2000 | 100,0000 | -100,0000
 0,3000 | 100,0000 | -100,0000
 1,1000 | 200,0000 | -200,0000
 2,2000 | 200,0000 | -200,0000
 3,3000 | 200,0000 | -200,0000
(6 rows)

-- select format (stub function, not pushdown constraints, explain)
--Testcase 1174:
EXPLAIN VERBOSE
SELECT value1, format(value1, 4) FROM s3 WHERE to_hex(value2) = '64';
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (format(value1, 4))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.format(value1, 4), value2 FROM public.s3mysql
(5 rows)

-- select format (stub function, not pushdown constraints, result)
--Testcase 1175:
SELECT value1, format(value1, 4) FROM s3 WHERE to_hex(value2) = '64';
 value1 | format 
--------+--------
    0.1 | 0.1000
    0.2 | 0.2000
    0.3 | 0.3000
(3 rows)

-- select format (stub function, pushdown constraints, explain)
--Testcase 1176:
EXPLAIN VERBOSE
SELECT value1, format(value1, 4) FROM s3 WHERE value2 != 200;
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (format(value1, 4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.format(value1, 4) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select format (stub function, pushdown constraints, result)
--Testcase 1177:
SELECT value1, format(value1, 4) FROM s3 WHERE value2 != 200;
 value1 | format 
--------+--------
    0.1 | 0.1000
    0.2 | 0.2000
    0.3 | 0.3000
(3 rows)

-- select format with non pushdown func and explicit constant (explain)
--Testcase 1178:
EXPLAIN VERBOSE
SELECT format(value1, 4), pi(), 4.1 FROM s3;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (format(value1, 4)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.format(value1, 4), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select format with non pushdown func and explicit constant (result)
--Testcase 1179:
SELECT format(value1, 4), pi(), 4.1 FROM s3;
 format |        pi         | ?column? 
--------+-------------------+----------
 0.1000 | 3.141592653589793 |      4.1
 0.2000 | 3.141592653589793 |      4.1
 0.3000 | 3.141592653589793 |      4.1
 1.1000 | 3.141592653589793 |      4.1
 2.2000 | 3.141592653589793 |      4.1
 3.3000 | 3.141592653589793 |      4.1
(6 rows)

-- select format with order by (explain)
--Testcase 1180:
EXPLAIN VERBOSE
SELECT value1, format(value1, 4) FROM s3 ORDER BY format(value1, 4);
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (format(value1, 4))
   Sort Key: (format(s3.value1, 4))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (format(value1, 4))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.format(value1, 4) FROM public.s3mysql
(7 rows)

-- select format with order by (result)
--Testcase 1181:
SELECT value1, format(value1, 4) FROM s3 ORDER BY format(value1, 4);
 value1 | format 
--------+--------
    0.1 | 0.1000
    0.2 | 0.2000
    0.3 | 0.3000
    1.1 | 1.1000
    2.2 | 2.2000
    3.3 | 3.3000
(6 rows)

-- select format with order by index (result)
--Testcase 1182:
SELECT value1, format(value1, 4) FROM s3 ORDER BY 2,1;
 value1 | format 
--------+--------
    0.1 | 0.1000
    0.2 | 0.2000
    0.3 | 0.3000
    1.1 | 1.1000
    2.2 | 2.2000
    3.3 | 3.3000
(6 rows)

-- select format with order by index (result)
--Testcase 1183:
SELECT value1, format(value1, 4) FROM s3 ORDER BY 1,2;
 value1 | format 
--------+--------
    0.1 | 0.1000
    0.2 | 0.2000
    0.3 | 0.3000
    1.1 | 1.1000
    2.2 | 2.2000
    3.3 | 3.3000
(6 rows)

-- select format with group by (explain)
--Testcase 1184:
EXPLAIN VERBOSE
SELECT count(value1), format(value1, 4) FROM s3 GROUP BY format(value1, 4);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (format(value1, 4))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.format(value1, 4) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select format with group by (result)
--Testcase 1185:
SELECT count(value1), format(value1, 4) FROM s3 GROUP BY format(value1, 4);
 count | format 
-------+--------
     1 | 0.1000
     1 | 0.2000
     1 | 0.3000
     1 | 1.1000
     1 | 2.2000
     1 | 3.3000
(6 rows)

-- select format with group by index (result)
--Testcase 1186:
SELECT value1, format(value1, 4) FROM s3 GROUP BY 2,1;
 value1 | format 
--------+--------
    0.1 | 0.1000
    0.2 | 0.2000
    0.3 | 0.3000
    1.1 | 1.1000
    2.2 | 2.2000
    3.3 | 3.3000
(6 rows)

-- select format with group by having (explain)
--Testcase 1187:
EXPLAIN VERBOSE
SELECT count(value1), format(value1, 4) FROM s3 GROUP BY format(value1, 4), value1 HAVING format(value1, 4) IS NOT NULL;
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=48)
   Output: (count(value1)), (format(value1, 4)), value1
   Filter: ((format(s3.value1, 4)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.format(value1, 4), value1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.format(value1, 4) IS NOT NULL))
(7 rows)

-- select format with group by having (result)
--Testcase 1188:
SELECT count(value1), format(value1, 4) FROM s3 GROUP BY format(value1, 4), value1 HAVING format(value1, 4) IS NOT NULL;
 count | format 
-------+--------
     1 | 0.1000
     1 | 0.2000
     1 | 0.3000
     1 | 1.1000
     1 | 2.2000
     1 | 3.3000
(6 rows)

-- select format with group by index having (result)
--Testcase 1189:
SELECT value1, format(value1, 4) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | format 
--------+--------
    1.1 | 1.1000
    2.2 | 2.2000
    3.3 | 3.3000
(3 rows)

--
-- test from_base64()
--
-- select from_base64 (stub function, explain)
--Testcase 1190:
EXPLAIN VERBOSE
SELECT from_base64(tag1), from_base64(str1), from_base64(str2) FROM s3;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2772.14 rows=3413 width=96)
   Output: (from_base64(tag1)), (from_base64(str1)), (from_base64(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_base64(tag1), public.from_base64(str1), public.from_base64(str2) FROM public.s3mysql
(4 rows)

-- select from_base64 (stub function, result)
--Testcase 1191:
SELECT from_base64(tag1), from_base64(str1), from_base64(str2) FROM s3;
 from_base64 | from_base64 | from_base64 
-------------+-------------+-------------
             |             | 
             |             | 
             |             | 
             |             | 
             |             | 
             |             | 
(6 rows)

-- select from_base64 (stub function, explain)
--Testcase 1192:
EXPLAIN VERBOSE
SELECT from_base64(to_base64(tag1)), from_base64(to_base64(str1)), from_base64(to_base64(str2)) FROM s3;
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..5331.89 rows=3413 width=96)
   Output: (from_base64(to_base64(tag1))), (from_base64(to_base64(str1))), (from_base64(to_base64(str2)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_base64(public.to_base64(tag1)), public.from_base64(public.to_base64(str1)), public.from_base64(public.to_base64(str2)) FROM public.s3mysql
(4 rows)

-- select from_base64 (stub function, result)
--Testcase 1193:
SELECT from_base64(to_base64(tag1)), from_base64(to_base64(str1)), from_base64(to_base64(str2)) FROM s3;
 from_base64 | from_base64 | from_base64 
-------------+-------------+-------------
 a           | ---XYZ---   |    XYZ   
 a           | ---XYZ---   |    XYZ   
 a           | ---XYZ---   |    XYZ   
 b           | ---XYZ---   |    XYZ   
 b           | ---XYZ---   |    XYZ   
 b           | ---XYZ---   |    XYZ   
(6 rows)

-- select from_base64 (stub function, not pushdown constraints, explain)
--Testcase 1194:
EXPLAIN VERBOSE
SELECT value1, from_base64(to_base64(str1)) FROM s3 WHERE to_hex(value2) = '64';
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.69 rows=17 width=40)
   Output: value1, (from_base64(to_base64(str1)))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.from_base64(public.to_base64(str1)), value2 FROM public.s3mysql
(5 rows)

-- select from_base64 (stub function, not pushdown constraints, result)
--Testcase 1195:
SELECT value1, from_base64(to_base64(str1)) FROM s3 WHERE to_hex(value2) = '64';
 value1 | from_base64 
--------+-------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
(3 rows)

-- select from_base64 (stub function, pushdown constraints, explain)
--Testcase 1196:
EXPLAIN VERBOSE
SELECT value1, from_base64(to_base64(str1)) FROM s3 WHERE value2 != 200;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.58 rows=3396 width=40)
   Output: value1, (from_base64(to_base64(str1)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.from_base64(public.to_base64(str1)) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select from_base64 (stub function, pushdown constraints, result)
--Testcase 1197:
SELECT value1, from_base64(to_base64(str1)) FROM s3 WHERE value2 != 200;
 value1 | from_base64 
--------+-------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
(3 rows)

-- select from_base64 with non pushdown func and explicit constant (explain)
--Testcase 1198:
EXPLAIN VERBOSE
SELECT from_base64(to_base64(str1)), pi(), 4.1 FROM s3;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=72)
   Output: (from_base64(to_base64(str1))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_base64(public.to_base64(str1)), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select from_base64 with non pushdown func and explicit constant (result)
--Testcase 1199:
SELECT from_base64(to_base64(str1)), pi(), 4.1 FROM s3;
 from_base64 |        pi         | ?column? 
-------------+-------------------+----------
 ---XYZ---   | 3.141592653589793 |      4.1
 ---XYZ---   | 3.141592653589793 |      4.1
 ---XYZ---   | 3.141592653589793 |      4.1
 ---XYZ---   | 3.141592653589793 |      4.1
 ---XYZ---   | 3.141592653589793 |      4.1
 ---XYZ---   | 3.141592653589793 |      4.1
(6 rows)

-- select from_base64 with order by (explain)
--Testcase 1200:
EXPLAIN VERBOSE
SELECT value1, from_base64(to_base64(str1)) FROM s3 ORDER BY from_base64(to_base64(str1));
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=40)
   Output: value1, (from_base64(to_base64(str1)))
   Sort Key: (from_base64(to_base64(s3.str1)))
   ->  Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=40)
         Output: value1, (from_base64(to_base64(str1)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.from_base64(public.to_base64(str1)) FROM public.s3mysql
(7 rows)

-- select from_base64 with order by (result)
--Testcase 1201:
SELECT value1, from_base64(to_base64(str1)) FROM s3 ORDER BY from_base64(to_base64(str1));
 value1 | from_base64 
--------+-------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select from_base64 with order by index (result)
--Testcase 1202:
SELECT value1, from_base64(to_base64(str1)) FROM s3 ORDER BY 2,1;
 value1 | from_base64 
--------+-------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select from_base64 with order by index (result)
--Testcase 1203:
SELECT value1, from_base64(to_base64(str1)) FROM s3 ORDER BY 1,2;
 value1 | from_base64 
--------+-------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select from_base64 with group by (explain)
--Testcase 1204:
EXPLAIN VERBOSE
SELECT count(value1), from_base64(to_base64(str1)) FROM s3 GROUP BY from_base64(to_base64(str1));
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (from_base64(to_base64(str1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.from_base64(public.to_base64(str1)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select from_base64 with group by (result)
--Testcase 1205:
SELECT count(value1), from_base64(to_base64(str1)) FROM s3 GROUP BY from_base64(to_base64(str1));
 count | from_base64 
-------+-------------
     6 | ---XYZ---
(1 row)

-- select from_base64 with group by index (result)
--Testcase 1206:
SELECT value1, from_base64(to_base64(str1)) FROM s3 GROUP BY 2,1;
 value1 | from_base64 
--------+-------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select from_base64 with group by having (explain)
--Testcase 1207:
EXPLAIN VERBOSE
SELECT count(value1), from_base64(to_base64(str1)) FROM s3 GROUP BY from_base64(to_base64(str1)), str1 HAVING from_base64(to_base64(str1)) IS NOT NULL;
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (from_base64(to_base64(str1))), str1
   Filter: ((from_base64(to_base64(s3.str1))) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.from_base64(public.to_base64(str1)), str1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.from_base64(public.to_base64(str1)) IS NOT NULL))
(7 rows)

-- select from_base64 with group by having (result)
--Testcase 1208:
SELECT count(value1), from_base64(to_base64(str1)) FROM s3 GROUP BY from_base64(to_base64(str1)), str1 HAVING from_base64(to_base64(str1)) IS NOT NULL;
 count | from_base64 
-------+-------------
     6 | ---XYZ---
(1 row)

-- select from_base64 with group by index having (result)
--Testcase 1209:
SELECT value1, from_base64(to_base64(str1)) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | from_base64 
--------+-------------
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(3 rows)

--
-- test hex()
--
-- select hex (stub function, explain)
--Testcase 1210:
EXPLAIN VERBOSE
SELECT hex(tag1), hex(value2), hex(value4), hex(str1), hex(str2) FROM s3;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..4495.70 rows=3413 width=160)
   Output: (hex(tag1)), (hex((value2)::bigint)), (hex((value4)::bigint)), (hex(str1)), (hex(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.hex(tag1), public.hex(value2), public.hex(value4), public.hex(str1), public.hex(str2) FROM public.s3mysql
(4 rows)

-- select hex (stub function, result)
--Testcase 1211:
SELECT hex(tag1), hex(value2), hex(value4), hex(str1), hex(str2) FROM s3;
 hex | hex |       hex        |        hex         |        hex         
-----+-----+------------------+--------------------+--------------------
 61  | 64  | FFFFFFFFFFFFFF9C | 2D2D2D58595A2D2D2D | 20202058595A202020
 61  | 64  | FFFFFFFFFFFFFF9C | 2D2D2D58595A2D2D2D | 20202058595A202020
 61  | 64  | FFFFFFFFFFFFFF9C | 2D2D2D58595A2D2D2D | 20202058595A202020
 62  | C8  | FFFFFFFFFFFFFF38 | 2D2D2D58595A2D2D2D | 20202058595A202020
 62  | C8  | FFFFFFFFFFFFFF38 | 2D2D2D58595A2D2D2D | 20202058595A202020
 62  | C8  | FFFFFFFFFFFFFF38 | 2D2D2D58595A2D2D2D | 20202058595A202020
(6 rows)

-- select hex (stub function, not pushdown constraints, explain)
--Testcase 1212:
EXPLAIN VERBOSE
SELECT value1, hex(str1) FROM s3 WHERE to_hex(value2) = '64';
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (hex(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.hex(str1), value2 FROM public.s3mysql
(5 rows)

-- select hex (stub function, not pushdown constraints, result)
--Testcase 1213:
SELECT value1, hex(str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 |        hex         
--------+--------------------
    0.1 | 2D2D2D58595A2D2D2D
    0.2 | 2D2D2D58595A2D2D2D
    0.3 | 2D2D2D58595A2D2D2D
(3 rows)

-- select hex (stub function, pushdown constraints, explain)
--Testcase 1214:
EXPLAIN VERBOSE
SELECT value1, hex(str1) FROM s3 WHERE value2 != 200;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (hex(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.hex(str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select hex (stub function, pushdown constraints, result)
--Testcase 1215:
SELECT value1, hex(str1) FROM s3 WHERE value2 != 200;
 value1 |        hex         
--------+--------------------
    0.1 | 2D2D2D58595A2D2D2D
    0.2 | 2D2D2D58595A2D2D2D
    0.3 | 2D2D2D58595A2D2D2D
(3 rows)

-- select hex with non pushdown func and explicit constant (explain)
--Testcase 1216:
EXPLAIN VERBOSE
SELECT hex(str1), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (hex(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.hex(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select hex with non pushdown func and explicit constant (result)
--Testcase 1217:
SELECT hex(str1), pi(), 4.1 FROM s3;
        hex         |        pi         | ?column? 
--------------------+-------------------+----------
 2D2D2D58595A2D2D2D | 3.141592653589793 |      4.1
 2D2D2D58595A2D2D2D | 3.141592653589793 |      4.1
 2D2D2D58595A2D2D2D | 3.141592653589793 |      4.1
 2D2D2D58595A2D2D2D | 3.141592653589793 |      4.1
 2D2D2D58595A2D2D2D | 3.141592653589793 |      4.1
 2D2D2D58595A2D2D2D | 3.141592653589793 |      4.1
(6 rows)

-- select hex with order by (explain)
--Testcase 1218:
EXPLAIN VERBOSE
SELECT value1, hex(str1) FROM s3 ORDER BY hex(str1);
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (hex(str1))
   Sort Key: (hex(s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (hex(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.hex(str1) FROM public.s3mysql
(7 rows)

-- select hex with order by (result)
--Testcase 1219:
SELECT value1, hex(str1) FROM s3 ORDER BY hex(str1);
 value1 |        hex         
--------+--------------------
    0.1 | 2D2D2D58595A2D2D2D
    0.2 | 2D2D2D58595A2D2D2D
    0.3 | 2D2D2D58595A2D2D2D
    1.1 | 2D2D2D58595A2D2D2D
    2.2 | 2D2D2D58595A2D2D2D
    3.3 | 2D2D2D58595A2D2D2D
(6 rows)

-- select hex with order by index (result)
--Testcase 1220:
SELECT value1, hex(str1) FROM s3 ORDER BY 2,1;
 value1 |        hex         
--------+--------------------
    0.1 | 2D2D2D58595A2D2D2D
    0.2 | 2D2D2D58595A2D2D2D
    0.3 | 2D2D2D58595A2D2D2D
    1.1 | 2D2D2D58595A2D2D2D
    2.2 | 2D2D2D58595A2D2D2D
    3.3 | 2D2D2D58595A2D2D2D
(6 rows)

-- select hex with order by index (result)
--Testcase 1221:
SELECT value1, hex(str1) FROM s3 ORDER BY 1,2;
 value1 |        hex         
--------+--------------------
    0.1 | 2D2D2D58595A2D2D2D
    0.2 | 2D2D2D58595A2D2D2D
    0.3 | 2D2D2D58595A2D2D2D
    1.1 | 2D2D2D58595A2D2D2D
    2.2 | 2D2D2D58595A2D2D2D
    3.3 | 2D2D2D58595A2D2D2D
(6 rows)

-- select hex with group by (explain)
--Testcase 1222:
EXPLAIN VERBOSE
SELECT count(value1), hex(str1) FROM s3 GROUP BY hex(str1);
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (hex(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.hex(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select hex with group by (result)
--Testcase 1223:
SELECT count(value1), hex(str1) FROM s3 GROUP BY hex(str1);
 count |        hex         
-------+--------------------
     6 | 2D2D2D58595A2D2D2D
(1 row)

-- select hex with group by index (result)
--Testcase 1224:
SELECT value1, hex(str1) FROM s3 GROUP BY 2,1;
 value1 |        hex         
--------+--------------------
    0.1 | 2D2D2D58595A2D2D2D
    0.2 | 2D2D2D58595A2D2D2D
    0.3 | 2D2D2D58595A2D2D2D
    1.1 | 2D2D2D58595A2D2D2D
    2.2 | 2D2D2D58595A2D2D2D
    3.3 | 2D2D2D58595A2D2D2D
(6 rows)

-- select hex with group by having (explain)
--Testcase 1225:
EXPLAIN VERBOSE
SELECT count(value1), hex(str1) FROM s3 GROUP BY hex(str1), str1 HAVING hex(str1) IS NOT NULL;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (hex(str1)), str1
   Filter: ((hex(s3.str1)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.hex(str1), str1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.hex(str1) IS NOT NULL))
(7 rows)

-- select hex with group by having (result)
--Testcase 1226:
SELECT count(value1), hex(str1) FROM s3 GROUP BY hex(str1), str1 HAVING hex(str1) IS NOT NULL;
 count |        hex         
-------+--------------------
     6 | 2D2D2D58595A2D2D2D
(1 row)

-- select hex with group by index having (result)
--Testcase 1227:
SELECT value1, hex(value4) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |       hex        
--------+------------------
    1.1 | FFFFFFFFFFFFFF38
    2.2 | FFFFFFFFFFFFFF38
    3.3 | FFFFFFFFFFFFFF38
(3 rows)

--
-- test insert()
--
-- select insert (stub function, explain)
--Testcase 1228:
EXPLAIN VERBOSE
SELECT insert(str1, 3, 4, str2) FROM s3;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (insert(str1, 3, 4, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.insert(str1, 3, 4, str2) FROM public.s3mysql
(4 rows)

-- select hex (stub function, result)
--Testcase 1229:
SELECT insert(str1, 3, 4, str2) FROM s3;
     insert     
----------------
 --   XYZ   ---
 --   XYZ   ---
 --   XYZ   ---
 --   XYZ   ---
 --   XYZ   ---
 --   XYZ   ---
(6 rows)

-- select insert (stub function, not pushdown constraints, explain)
--Testcase 1230:
EXPLAIN VERBOSE
SELECT value1, insert(str1, 3, 4, str2) FROM s3 WHERE to_hex(value2) = '64';
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (insert(str1, 3, 4, str2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.insert(str1, 3, 4, str2), value2 FROM public.s3mysql
(5 rows)

-- select insert (stub function, not pushdown constraints, result)
--Testcase 1231:
SELECT value1, insert(str1, 3, 4, str2) FROM s3 WHERE to_hex(value2) = '64';
 value1 |     insert     
--------+----------------
    0.1 | --   XYZ   ---
    0.2 | --   XYZ   ---
    0.3 | --   XYZ   ---
(3 rows)

-- select insert (stub function, pushdown constraints, explain)
--Testcase 1232:
EXPLAIN VERBOSE
SELECT value1, insert(str1, 3, 4, str2) FROM s3 WHERE value2 != 200;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (insert(str1, 3, 4, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.insert(str1, 3, 4, str2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select insert (stub function, pushdown constraints, result)
--Testcase 1233:
SELECT value1, insert(str1, 3, 4, str2) FROM s3 WHERE value2 != 200;
 value1 |     insert     
--------+----------------
    0.1 | --   XYZ   ---
    0.2 | --   XYZ   ---
    0.3 | --   XYZ   ---
(3 rows)

-- select insert with non pushdown func and explicit constant (explain)
--Testcase 1234:
EXPLAIN VERBOSE
SELECT insert(str1, 3, 4, str2), pi(), 4.1 FROM s3;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (insert(str1, 3, 4, str2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.insert(str1, 3, 4, str2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select insert with non pushdown func and explicit constant (result)
--Testcase 1235:
SELECT insert(str1, 3, 4, str2), pi(), 4.1 FROM s3;
     insert     |        pi         | ?column? 
----------------+-------------------+----------
 --   XYZ   --- | 3.141592653589793 |      4.1
 --   XYZ   --- | 3.141592653589793 |      4.1
 --   XYZ   --- | 3.141592653589793 |      4.1
 --   XYZ   --- | 3.141592653589793 |      4.1
 --   XYZ   --- | 3.141592653589793 |      4.1
 --   XYZ   --- | 3.141592653589793 |      4.1
(6 rows)

-- select insert with order by (explain)
--Testcase 1236:
EXPLAIN VERBOSE
SELECT value1, insert(str1, 3, 4, str2) FROM s3 ORDER BY insert(str1, 3, 4, str2);
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (insert(str1, 3, 4, str2))
   Sort Key: (insert(s3.str1, 3, 4, s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (insert(str1, 3, 4, str2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.insert(str1, 3, 4, str2) FROM public.s3mysql
(7 rows)

-- select insert with order by (result)
--Testcase 1237:
SELECT value1, insert(str1, 3, 4, str2) FROM s3 ORDER BY insert(str1, 3, 4, str2);
 value1 |     insert     
--------+----------------
    0.1 | --   XYZ   ---
    0.2 | --   XYZ   ---
    0.3 | --   XYZ   ---
    1.1 | --   XYZ   ---
    2.2 | --   XYZ   ---
    3.3 | --   XYZ   ---
(6 rows)

-- select insert with order by index (result)
--Testcase 1238:
SELECT value1, insert(str1, 3, 4, str2) FROM s3 ORDER BY 2,1;
 value1 |     insert     
--------+----------------
    0.1 | --   XYZ   ---
    0.2 | --   XYZ   ---
    0.3 | --   XYZ   ---
    1.1 | --   XYZ   ---
    2.2 | --   XYZ   ---
    3.3 | --   XYZ   ---
(6 rows)

-- select insert with order by index (result)
--Testcase 1239:
SELECT value1, insert(str1, 3, 4, str2) FROM s3 ORDER BY 1,2;
 value1 |     insert     
--------+----------------
    0.1 | --   XYZ   ---
    0.2 | --   XYZ   ---
    0.3 | --   XYZ   ---
    1.1 | --   XYZ   ---
    2.2 | --   XYZ   ---
    3.3 | --   XYZ   ---
(6 rows)

-- select insert with group by (explain)
--Testcase 1240:
EXPLAIN VERBOSE
SELECT count(value1), insert(str1, 3, 4, str2) FROM s3 GROUP BY insert(str1, 3, 4, str2);
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (insert(str1, 3, 4, str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.insert(str1, 3, 4, str2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select insert with group by (result)
--Testcase 1241:
SELECT count(value1), insert(str1, 3, 4, str2) FROM s3 GROUP BY insert(str1, 3, 4, str2);
 count |     insert     
-------+----------------
     6 | --   XYZ   ---
(1 row)

-- select insert with group by index (result)
--Testcase 1242:
SELECT value1, insert(str1, 3, 4, str2) FROM s3 GROUP BY 2,1;
 value1 |     insert     
--------+----------------
    0.1 | --   XYZ   ---
    0.2 | --   XYZ   ---
    0.3 | --   XYZ   ---
    1.1 | --   XYZ   ---
    2.2 | --   XYZ   ---
    3.3 | --   XYZ   ---
(6 rows)

-- select insert with group by having (explain)
--Testcase 1243:
EXPLAIN VERBOSE
SELECT count(value1), insert(str1, 3, 4, str2) FROM s3 GROUP BY insert(str1, 3, 4, str2), str1, str2 HAVING insert(str1, 3, 4, str2) IS NOT NULL;
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=104)
   Output: (count(value1)), (insert(str1, 3, 4, str2)), str1, str2
   Filter: ((insert(s3.str1, 3, 4, s3.str2)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.insert(str1, 3, 4, str2), str1, str2 FROM public.s3mysql GROUP BY 2, 3, 4 HAVING ((public.insert(str1, 3, 4, str2) IS NOT NULL))
(7 rows)

-- select insert with group by having (result)
--Testcase 1244:
SELECT count(value1), insert(str1, 3, 4, str2) FROM s3 GROUP BY insert(str1, 3, 4, str2), str1, str2 HAVING insert(str1, 3, 4, str2) IS NOT NULL;
 count |     insert     
-------+----------------
     6 | --   XYZ   ---
(1 row)

-- select insert with group by index having (result)
--Testcase 1245:
SELECT value1, insert(str1, 3, 4, str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |     insert     
--------+----------------
    1.1 | --   XYZ   ---
    2.2 | --   XYZ   ---
    3.3 | --   XYZ   ---
(3 rows)

--
-- test instr()
--
-- select instr (stub function, explain)
--Testcase 1246:
EXPLAIN VERBOSE
SELECT instr(str1, str2) FROM s3;
                             QUERY PLAN                              
---------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (instr(str1, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.instr(str1, str2) FROM public.s3mysql
(4 rows)

-- select instr (stub function, result)
--Testcase 1247:
SELECT instr(str1, str2) FROM s3;
 instr 
-------
     0
     0
     0
     0
     0
     0
(6 rows)

-- select instr (stub function, not pushdown constraints, explain)
--Testcase 1248:
EXPLAIN VERBOSE
SELECT value1, instr(str1, str2) FROM s3 WHERE to_hex(value2) = '64';
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=16)
   Output: value1, (instr(str1, str2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.instr(str1, str2), value2 FROM public.s3mysql
(5 rows)

-- select instr (stub function, not pushdown constraints, result)
--Testcase 1249:
SELECT value1, instr(str1, str2) FROM s3 WHERE to_hex(value2) = '64';
 value1 | instr 
--------+-------
    0.1 |     0
    0.2 |     0
    0.3 |     0
(3 rows)

-- select instr (stub function, pushdown constraints, explain)
--Testcase 1250:
EXPLAIN VERBOSE
SELECT value1, instr(str1, str2) FROM s3 WHERE value2 != 200;
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=16)
   Output: value1, (instr(str1, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.instr(str1, str2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select instr (stub function, pushdown constraints, result)
--Testcase 1251:
SELECT value1, instr(str1, str2) FROM s3 WHERE value2 != 200;
 value1 | instr 
--------+-------
    0.1 |     0
    0.2 |     0
    0.3 |     0
(3 rows)

-- select instr with non pushdown func and explicit constant (explain)
--Testcase 1252:
EXPLAIN VERBOSE
SELECT instr(str1, str2), pi(), 4.1 FROM s3;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=48)
   Output: (instr(str1, str2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.instr(str1, str2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select instr with non pushdown func and explicit constant (result)
--Testcase 1253:
SELECT instr(str1, str2), pi(), 4.1 FROM s3;
 instr |        pi         | ?column? 
-------+-------------------+----------
     0 | 3.141592653589793 |      4.1
     0 | 3.141592653589793 |      4.1
     0 | 3.141592653589793 |      4.1
     0 | 3.141592653589793 |      4.1
     0 | 3.141592653589793 |      4.1
     0 | 3.141592653589793 |      4.1
(6 rows)

-- select instr with order by (explain)
--Testcase 1254:
EXPLAIN VERBOSE
SELECT value1, instr(str1, str2) FROM s3 ORDER BY instr(str1, str2);
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: value1, (instr(str1, str2))
   Sort Key: (instr(s3.str1, s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=16)
         Output: value1, (instr(str1, str2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.instr(str1, str2) FROM public.s3mysql
(7 rows)

-- select instr with order by (result)
--Testcase 1255:
SELECT value1, instr(str1, str2) FROM s3 ORDER BY instr(str1, str2);
 value1 | instr 
--------+-------
    0.1 |     0
    0.2 |     0
    0.3 |     0
    1.1 |     0
    2.2 |     0
    3.3 |     0
(6 rows)

-- select instr with order by index (result)
--Testcase 1256:
SELECT value1, instr(str1, str2) FROM s3 ORDER BY 2,1;
 value1 | instr 
--------+-------
    0.1 |     0
    0.2 |     0
    0.3 |     0
    1.1 |     0
    2.2 |     0
    3.3 |     0
(6 rows)

-- select instr with order by index (result)
--Testcase 1257:
SELECT value1, instr(str1, str2) FROM s3 ORDER BY 1,2;
 value1 | instr 
--------+-------
    0.1 |     0
    0.2 |     0
    0.3 |     0
    1.1 |     0
    2.2 |     0
    3.3 |     0
(6 rows)

-- select instr with group by (explain)
--Testcase 1258:
EXPLAIN VERBOSE
SELECT count(value1), instr(str1, str2) FROM s3 GROUP BY instr(str1, str2);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (instr(str1, str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.instr(str1, str2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select instr with group by (result)
--Testcase 1259:
SELECT count(value1), instr(str1, str2) FROM s3 GROUP BY instr(str1, str2);
 count | instr 
-------+-------
     6 |     0
(1 row)

-- select instr with group by index (result)
--Testcase 1260:
SELECT value1, instr(str1, str2) FROM s3 GROUP BY 2,1;
 value1 | instr 
--------+-------
    0.1 |     0
    0.2 |     0
    0.3 |     0
    1.1 |     0
    2.2 |     0
    3.3 |     0
(6 rows)

-- select instr with group by having (explain)
--Testcase 1261:
EXPLAIN VERBOSE
SELECT count(value1), instr(str1, str2) FROM s3 GROUP BY instr(str1, str2), str1, str2 HAVING instr(str1, str2) IS NOT NULL;
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=80)
   Output: (count(value1)), (instr(str1, str2)), str1, str2
   Filter: ((instr(s3.str1, s3.str2)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.instr(str1, str2), str1, str2 FROM public.s3mysql GROUP BY 2, 3, 4 HAVING ((public.instr(str1, str2) IS NOT NULL))
(7 rows)

-- select instr with group by having (result)
--Testcase 1262:
SELECT count(value1), instr(str1, str2) FROM s3 GROUP BY instr(str1, str2), str1, str2 HAVING instr(str1, str2) IS NOT NULL;
 count | instr 
-------+-------
     6 |     0
(1 row)

-- select instr with group by index having (result)
--Testcase 1263:
SELECT value1, instr(str1, str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | instr 
--------+-------
    1.1 |     0
    2.2 |     0
    3.3 |     0
(3 rows)

--
-- test lcase()
--
-- select lcase (stub function, explain)
--Testcase 1264:
EXPLAIN VERBOSE
SELECT lcase(tag1), lcase(str1), lcase(str2) FROM s3;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2772.14 rows=3413 width=96)
   Output: (lcase(tag1)), (lcase(str1)), (lcase(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.lcase(tag1), public.lcase(str1), public.lcase(str2) FROM public.s3mysql
(4 rows)

-- select lcase (stub function, result)
--Testcase 1265:
SELECT lcase(tag1), lcase(str1), lcase(str2) FROM s3;
 lcase |   lcase   |   lcase   
-------+-----------+-----------
 a     | ---xyz--- |    xyz   
 a     | ---xyz--- |    xyz   
 a     | ---xyz--- |    xyz   
 b     | ---xyz--- |    xyz   
 b     | ---xyz--- |    xyz   
 b     | ---xyz--- |    xyz   
(6 rows)

-- select lcase (stub function, not pushdown constraints, explain)
--Testcase 1266:
EXPLAIN VERBOSE
SELECT value1, lcase(str1) FROM s3 WHERE to_hex(value2) = '64';
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (lcase(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.lcase(str1), value2 FROM public.s3mysql
(5 rows)

-- select lcase (stub function, not pushdown constraints, result)
--Testcase 1267:
SELECT value1, lcase(str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 |   lcase   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
(3 rows)

-- select lcase (stub function, pushdown constraints, explain)
--Testcase 1268:
EXPLAIN VERBOSE
SELECT value1, lcase(str1) FROM s3 WHERE value2 != 200;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (lcase(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.lcase(str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select lcase (stub function, pushdown constraints, result)
--Testcase 1269:
SELECT value1, lcase(str1) FROM s3 WHERE value2 != 200;
 value1 |   lcase   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
(3 rows)

-- select lcase with non pushdown func and explicit constant (explain)
--Testcase 1270:
EXPLAIN VERBOSE
SELECT lcase(str1), pi(), 4.1 FROM s3;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (lcase(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.lcase(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select lcase with non pushdown func and explicit constant (result)
--Testcase 1271:
SELECT lcase(str1), pi(), 4.1 FROM s3;
   lcase   |        pi         | ?column? 
-----------+-------------------+----------
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
(6 rows)

-- select lcase with order by (explain)
--Testcase 1272:
EXPLAIN VERBOSE
SELECT value1, lcase(str1) FROM s3 ORDER BY lcase(str1);
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (lcase(str1))
   Sort Key: (lcase(s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (lcase(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.lcase(str1) FROM public.s3mysql
(7 rows)

-- select lcase with order by (result)
--Testcase 1273:
SELECT value1, lcase(str1) FROM s3 ORDER BY lcase(str1);
 value1 |   lcase   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(6 rows)

-- select lcase with order by index (result)
--Testcase 1274:
SELECT value1, lcase(str1) FROM s3 ORDER BY 2,1;
 value1 |   lcase   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(6 rows)

-- select lcase with order by index (result)
--Testcase 1275:
SELECT value1, lcase(str1) FROM s3 ORDER BY 1,2;
 value1 |   lcase   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(6 rows)

-- select lcase with group by (explain)
--Testcase 1276:
EXPLAIN VERBOSE
SELECT count(value1), lcase(str1) FROM s3 GROUP BY lcase(str1);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (lcase(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.lcase(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select lcase with group by (result)
--Testcase 1277:
SELECT count(value1), lcase(str1) FROM s3 GROUP BY lcase(str1);
 count |   lcase   
-------+-----------
     6 | ---xyz---
(1 row)

-- select lcase with group by index (result)
--Testcase 1278:
SELECT value1, lcase(str1) FROM s3 GROUP BY 2,1;
 value1 |   lcase   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(6 rows)

-- select lcase with group by having (explain)
--Testcase 1279:
EXPLAIN VERBOSE
SELECT count(value1), lcase(str1) FROM s3 GROUP BY lcase(str1), str1 HAVING lcase(str1) IS NOT NULL;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (lcase(str1)), str1
   Filter: ((lcase(s3.str1)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.lcase(str1), str1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.lcase(str1) IS NOT NULL))
(7 rows)

-- select lcase with group by having (result)
--Testcase 1280:
SELECT count(value1), lcase(str1) FROM s3 GROUP BY lcase(str1), str1 HAVING lcase(str1) IS NOT NULL;
 count |   lcase   
-------+-----------
     6 | ---xyz---
(1 row)

-- select lcase with group by index having (result)
--Testcase 1281:
SELECT value1, lcase(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |   lcase   
--------+-----------
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(3 rows)

--
-- test left()
--
-- select left (stub function, explain)
--Testcase 1282:
EXPLAIN VERBOSE
SELECT left(str1, 5), left(str2, 5) FROM s3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: ("left"(str1, 5)), ("left"(str2, 5))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "left"(str1, 5), "left"(str2, 5) FROM public.s3mysql
(4 rows)

-- select left (stub function, result)
--Testcase 1283:
SELECT left(str1, 5), left(str2, 5) FROM s3;
 left  | left  
-------+-------
 ---XY |    XY
 ---XY |    XY
 ---XY |    XY
 ---XY |    XY
 ---XY |    XY
 ---XY |    XY
(6 rows)

-- select left (stub function, not pushdown constraints, explain)
--Testcase 1284:
EXPLAIN VERBOSE
SELECT value1, left(str1, 5) FROM s3 WHERE to_hex(value2) = '64';
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, ("left"(str1, 5))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, "left"(str1, 5), value2 FROM public.s3mysql
(5 rows)

-- select left (stub function, not pushdown constraints, result)
--Testcase 1285:
SELECT value1, left(str1, 5) FROM s3 WHERE to_hex(value2) = '64';
 value1 | left  
--------+-------
    0.1 | ---XY
    0.2 | ---XY
    0.3 | ---XY
(3 rows)

-- select left (stub function, pushdown constraints, explain)
--Testcase 1286:
EXPLAIN VERBOSE
SELECT value1, left(str1, 5) FROM s3 WHERE value2 != 200;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, ("left"(str1, 5))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, "left"(str1, 5) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select left (stub function, pushdown constraints, result)
--Testcase 1287:
SELECT value1, left(str1, 5) FROM s3 WHERE value2 != 200;
 value1 | left  
--------+-------
    0.1 | ---XY
    0.2 | ---XY
    0.3 | ---XY
(3 rows)

-- select left with non pushdown func and explicit constant (explain)
--Testcase 1288:
EXPLAIN VERBOSE
SELECT left(str1, 5), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: ("left"(str1, 5)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "left"(str1, 5), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select left with non pushdown func and explicit constant (result)
--Testcase 1289:
SELECT left(str1, 5), pi(), 4.1 FROM s3;
 left  |        pi         | ?column? 
-------+-------------------+----------
 ---XY | 3.141592653589793 |      4.1
 ---XY | 3.141592653589793 |      4.1
 ---XY | 3.141592653589793 |      4.1
 ---XY | 3.141592653589793 |      4.1
 ---XY | 3.141592653589793 |      4.1
 ---XY | 3.141592653589793 |      4.1
(6 rows)

-- select left with order by (explain)
--Testcase 1290:
EXPLAIN VERBOSE
SELECT value1, left(str1, 5) FROM s3 ORDER BY left(str1, 5);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, ("left"(str1, 5))
   Sort Key: ("left"(s3.str1, 5))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, ("left"(str1, 5))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, "left"(str1, 5) FROM public.s3mysql
(7 rows)

-- select left with order by (result)
--Testcase 1291:
SELECT value1, left(str1, 5) FROM s3 ORDER BY left(str1, 5);
 value1 | left  
--------+-------
    0.1 | ---XY
    0.2 | ---XY
    0.3 | ---XY
    1.1 | ---XY
    2.2 | ---XY
    3.3 | ---XY
(6 rows)

-- select left with order by index (result)
--Testcase 1292:
SELECT value1, left(str1, 5) FROM s3 ORDER BY 2,1;
 value1 | left  
--------+-------
    0.1 | ---XY
    0.2 | ---XY
    0.3 | ---XY
    1.1 | ---XY
    2.2 | ---XY
    3.3 | ---XY
(6 rows)

-- select left with order by index (result)
--Testcase 1293:
SELECT value1, left(str1, 5) FROM s3 ORDER BY 1,2;
 value1 | left  
--------+-------
    0.1 | ---XY
    0.2 | ---XY
    0.3 | ---XY
    1.1 | ---XY
    2.2 | ---XY
    3.3 | ---XY
(6 rows)

-- select left with group by (explain)
--Testcase 1294:
EXPLAIN VERBOSE
SELECT count(value1), left(str1, 5) FROM s3 GROUP BY left(str1, 5);
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), ("left"(str1, 5))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), "left"(str1, 5) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select left with group by (result)
--Testcase 1295:
SELECT count(value1), left(str1, 5) FROM s3 GROUP BY left(str1, 5);
 count | left  
-------+-------
     6 | ---XY
(1 row)

-- select left with group by index (result)
--Testcase 1296:
SELECT value1, left(str1, 5) FROM s3 GROUP BY 2,1;
 value1 | left  
--------+-------
    0.1 | ---XY
    0.2 | ---XY
    0.3 | ---XY
    1.1 | ---XY
    2.2 | ---XY
    3.3 | ---XY
(6 rows)

-- select left with group by having (explain)
--Testcase 1297:
EXPLAIN VERBOSE
SELECT count(value1), left(str1, 5) FROM s3 GROUP BY left(str1, 5), str1 HAVING left(str1, 5) IS NOT NULL;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), ("left"(str1, 5)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), "left"(str1, 5), str1 FROM public.s3mysql WHERE (("left"(str1, 5) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select left with group by having (result)
--Testcase 1298:
SELECT count(value1), left(str1, 5) FROM s3 GROUP BY left(str1, 5), str1 HAVING left(str1, 5) IS NOT NULL;
 count | left  
-------+-------
     6 | ---XY
(1 row)

-- select left with group by index having (result)
--Testcase 1299:
SELECT value1, left(str1, 5) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | left  
--------+-------
    1.1 | ---XY
    2.2 | ---XY
    3.3 | ---XY
(3 rows)

--
-- test length()
--
-- select length (stub function, explain)
--Testcase 1300:
EXPLAIN VERBOSE
SELECT length(str1), length(str2) FROM s3;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=8)
   Output: (length(str1)), (length(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT length(str1), length(str2) FROM public.s3mysql
(4 rows)

-- select length (stub function, result)
--Testcase 1301:
SELECT length(str1), length(str2) FROM s3;
 length | length 
--------+--------
      9 |      9
      9 |      9
      9 |      9
      9 |      9
      9 |      9
      9 |      9
(6 rows)

-- select length (stub function, not pushdown constraints, explain)
--Testcase 1302:
EXPLAIN VERBOSE
SELECT value1, length(str1) FROM s3 WHERE to_hex(value2) = '64';
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=12)
   Output: value1, (length(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, length(str1), value2 FROM public.s3mysql
(5 rows)

-- select length (stub function, not pushdown constraints, result)
--Testcase 1303:
SELECT value1, length(str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 | length 
--------+--------
    0.1 |      9
    0.2 |      9
    0.3 |      9
(3 rows)

-- select length (stub function, pushdown constraints, explain)
--Testcase 1304:
EXPLAIN VERBOSE
SELECT value1, length(str1) FROM s3 WHERE value2 != 200;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=12)
   Output: value1, (length(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, length(str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select length (stub function, pushdown constraints, result)
--Testcase 1305:
SELECT value1, length(str1) FROM s3 WHERE value2 != 200;
 value1 | length 
--------+--------
    0.1 |      9
    0.2 |      9
    0.3 |      9
(3 rows)

-- select length with non pushdown func and explicit constant (explain)
--Testcase 1306:
EXPLAIN VERBOSE
SELECT length(str1), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=44)
   Output: (length(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT length(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select length with non pushdown func and explicit constant (result)
--Testcase 1307:
SELECT length(str1), pi(), 4.1 FROM s3;
 length |        pi         | ?column? 
--------+-------------------+----------
      9 | 3.141592653589793 |      4.1
      9 | 3.141592653589793 |      4.1
      9 | 3.141592653589793 |      4.1
      9 | 3.141592653589793 |      4.1
      9 | 3.141592653589793 |      4.1
      9 | 3.141592653589793 |      4.1
(6 rows)

-- select length with order by (explain)
--Testcase 1308:
EXPLAIN VERBOSE
SELECT value1, length(str1) FROM s3 ORDER BY length(str1);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=12)
   Output: value1, (length(str1))
   Sort Key: (length(s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=12)
         Output: value1, (length(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, length(str1) FROM public.s3mysql
(7 rows)

-- select length with order by (result)
--Testcase 1309:
SELECT value1, length(str1) FROM s3 ORDER BY length(str1);
 value1 | length 
--------+--------
    0.1 |      9
    0.2 |      9
    0.3 |      9
    1.1 |      9
    2.2 |      9
    3.3 |      9
(6 rows)

-- select length with order by index (result)
--Testcase 1310:
SELECT value1, length(str1) FROM s3 ORDER BY 2,1;
 value1 | length 
--------+--------
    0.1 |      9
    0.2 |      9
    0.3 |      9
    1.1 |      9
    2.2 |      9
    3.3 |      9
(6 rows)

-- select length with order by index (result)
--Testcase 1311:
SELECT value1, length(str1) FROM s3 ORDER BY 1,2;
 value1 | length 
--------+--------
    0.1 |      9
    0.2 |      9
    0.3 |      9
    1.1 |      9
    2.2 |      9
    3.3 |      9
(6 rows)

-- select length with group by (explain)
--Testcase 1312:
EXPLAIN VERBOSE
SELECT count(value1), length(str1) FROM s3 GROUP BY length(str1);
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (length(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), length(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select length with group by (result)
--Testcase 1313:
SELECT count(value1), length(str1) FROM s3 GROUP BY length(str1);
 count | length 
-------+--------
     6 |      9
(1 row)

-- select length with group by index (result)
--Testcase 1314:
SELECT value1, length(str1) FROM s3 GROUP BY 2,1;
 value1 | length 
--------+--------
    0.1 |      9
    0.2 |      9
    0.3 |      9
    1.1 |      9
    2.2 |      9
    3.3 |      9
(6 rows)

-- select length with group by having (explain)
--Testcase 1315:
EXPLAIN VERBOSE
SELECT count(value1), length(str1) FROM s3 GROUP BY length(str1), str1 HAVING length(str1) IS NOT NULL;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (length(str1)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), length(str1), str1 FROM public.s3mysql WHERE ((length(str1) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select length with group by having (result)
--Testcase 1316:
SELECT count(value1), length(str1) FROM s3 GROUP BY length(str1), str1 HAVING length(str1) IS NOT NULL;
 count | length 
-------+--------
     6 |      9
(1 row)

-- select length with group by index having (result)
--Testcase 1317:
SELECT value1, length(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | length 
--------+--------
    1.1 |      9
    2.2 |      9
    3.3 |      9
(3 rows)

--
-- test locate()
--
-- select locate (stub function, explain)
--Testcase 1318:
EXPLAIN VERBOSE
SELECT locate(str1, str2), locate(str2, str1, 3) FROM s3;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=16)
   Output: (locate(str1, str2)), (locate(str2, str1, '3'::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.locate(str1, str2), public.locate(str2, str1, 3::bigint) FROM public.s3mysql
(4 rows)

-- select locate (stub function, result)
--Testcase 1319:
SELECT locate(str1, str2), locate(str2, str1, 3) FROM s3;
 locate | locate 
--------+--------
      0 |      0
      0 |      0
      0 |      0
      0 |      0
      0 |      0
      0 |      0
(6 rows)

-- select locate (stub function, not pushdown constraints, explain)
--Testcase 1320:
EXPLAIN VERBOSE
SELECT value1, locate(str1, str2) FROM s3 WHERE to_hex(value2) = '64';
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=16)
   Output: value1, (locate(str1, str2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.locate(str1, str2), value2 FROM public.s3mysql
(5 rows)

-- select locate (stub function, not pushdown constraints, result)
--Testcase 1321:
SELECT value1, locate(str1, str2) FROM s3 WHERE to_hex(value2) = '64';
 value1 | locate 
--------+--------
    0.1 |      0
    0.2 |      0
    0.3 |      0
(3 rows)

-- select locate (stub function, pushdown constraints, explain)
--Testcase 1322:
EXPLAIN VERBOSE
SELECT value1, locate(str1, str2) FROM s3 WHERE value2 != 200;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=16)
   Output: value1, (locate(str1, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.locate(str1, str2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select locate (stub function, pushdown constraints, result)
--Testcase 1323:
SELECT value1, locate(str1, str2) FROM s3 WHERE value2 != 200;
 value1 | locate 
--------+--------
    0.1 |      0
    0.2 |      0
    0.3 |      0
(3 rows)

-- select locate with non pushdown func and explicit constant (explain)
--Testcase 1324:
EXPLAIN VERBOSE
SELECT locate(str1, str2), pi(), 4.1 FROM s3;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=48)
   Output: (locate(str1, str2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.locate(str1, str2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select locate with non pushdown func and explicit constant (result)
--Testcase 1325:
SELECT locate(str1, str2), pi(), 4.1 FROM s3;
 locate |        pi         | ?column? 
--------+-------------------+----------
      0 | 3.141592653589793 |      4.1
      0 | 3.141592653589793 |      4.1
      0 | 3.141592653589793 |      4.1
      0 | 3.141592653589793 |      4.1
      0 | 3.141592653589793 |      4.1
      0 | 3.141592653589793 |      4.1
(6 rows)

-- select locate with order by (explain)
--Testcase 1326:
EXPLAIN VERBOSE
SELECT value1, locate(str1, str2) FROM s3 ORDER BY locate(str1, str2);
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: value1, (locate(str1, str2))
   Sort Key: (locate(s3.str1, s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=16)
         Output: value1, (locate(str1, str2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.locate(str1, str2) FROM public.s3mysql
(7 rows)

-- select locate with order by (result)
--Testcase 1327:
SELECT value1, locate(str1, str2) FROM s3 ORDER BY locate(str1, str2);
 value1 | locate 
--------+--------
    0.1 |      0
    0.2 |      0
    0.3 |      0
    1.1 |      0
    2.2 |      0
    3.3 |      0
(6 rows)

-- select locate with order by index (result)
--Testcase 1328:
SELECT value1, locate(str1, str2) FROM s3 ORDER BY 2,1;
 value1 | locate 
--------+--------
    0.1 |      0
    0.2 |      0
    0.3 |      0
    1.1 |      0
    2.2 |      0
    3.3 |      0
(6 rows)

-- select locate with order by index (result)
--Testcase 1329:
SELECT value1, locate(str1, str2) FROM s3 ORDER BY 1,2;
 value1 | locate 
--------+--------
    0.1 |      0
    0.2 |      0
    0.3 |      0
    1.1 |      0
    2.2 |      0
    3.3 |      0
(6 rows)

-- select locate with group by (explain)
--Testcase 1330:
EXPLAIN VERBOSE
SELECT count(value1), locate(str1, str2) FROM s3 GROUP BY locate(str1, str2);
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(value1)), (locate(str1, str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.locate(str1, str2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select locate with group by (result)
--Testcase 1331:
SELECT count(value1), locate(str1, str2) FROM s3 GROUP BY locate(str1, str2);
 count | locate 
-------+--------
     6 |      0
(1 row)

-- select locate with group by index (result)
--Testcase 1332:
SELECT value1, locate(str1, str2) FROM s3 GROUP BY 2,1;
 value1 | locate 
--------+--------
    0.1 |      0
    0.2 |      0
    0.3 |      0
    1.1 |      0
    2.2 |      0
    3.3 |      0
(6 rows)

-- select locate with group by having (explain)
--Testcase 1333:
EXPLAIN VERBOSE
SELECT count(value1), locate(str1, str2) FROM s3 GROUP BY locate(str1, str2), str1, str2 HAVING locate(str1, str2) IS NOT NULL;
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=80)
   Output: (count(value1)), (locate(str1, str2)), str1, str2
   Filter: ((locate(s3.str1, s3.str2)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.locate(str1, str2), str1, str2 FROM public.s3mysql GROUP BY 2, 3, 4 HAVING ((public.locate(str1, str2) IS NOT NULL))
(7 rows)

-- select locate with group by having (result)
--Testcase 1334:
SELECT count(value1), locate(str1, str2) FROM s3 GROUP BY locate(str1, str2), str1, str2 HAVING locate(str1, str2) IS NOT NULL;
 count | locate 
-------+--------
     6 |      0
(1 row)

-- select locate with group by index having (result)
--Testcase 1335:
SELECT value1, locate(str1, str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | locate 
--------+--------
    1.1 |      0
    2.2 |      0
    3.3 |      0
(3 rows)

--
-- test lower()
--
-- select lower (stub function, explain)
--Testcase 1336:
EXPLAIN VERBOSE
SELECT lower(str1), lower(str2) FROM s3;
                             QUERY PLAN                              
---------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (lower(str1)), (lower(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT lower(str1), lower(str2) FROM public.s3mysql
(4 rows)

-- select lower (stub function, result)
--Testcase 1337:
SELECT lower(str1), lower(str2) FROM s3;
   lower   |   lower   
-----------+-----------
 ---xyz--- |    xyz   
 ---xyz--- |    xyz   
 ---xyz--- |    xyz   
 ---xyz--- |    xyz   
 ---xyz--- |    xyz   
 ---xyz--- |    xyz   
(6 rows)

-- select lower (stub function, not pushdown constraints, explain)
--Testcase 1338:
EXPLAIN VERBOSE
SELECT value1, lower(str1) FROM s3 WHERE to_hex(value2) = '64';
                               QUERY PLAN                               
------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (lower(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, lower(str1), value2 FROM public.s3mysql
(5 rows)

-- select lower (stub function, not pushdown constraints, result)
--Testcase 1339:
SELECT value1, lower(str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 |   lower   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
(3 rows)

-- select lower (stub function, pushdown constraints, explain)
--Testcase 1340:
EXPLAIN VERBOSE
SELECT value1, lower(str1) FROM s3 WHERE value2 != 200;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (lower(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, lower(str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select lower (stub function, pushdown constraints, result)
--Testcase 1341:
SELECT value1, lower(str1) FROM s3 WHERE value2 != 200;
 value1 |   lower   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
(3 rows)

-- select lower with non pushdown func and explicit constant (explain)
--Testcase 1342:
EXPLAIN VERBOSE
SELECT lower(str1), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (lower(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT lower(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select lower with non pushdown func and explicit constant (result)
--Testcase 1343:
SELECT lower(str1), pi(), 4.1 FROM s3;
   lower   |        pi         | ?column? 
-----------+-------------------+----------
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
 ---xyz--- | 3.141592653589793 |      4.1
(6 rows)

-- select lower with order by (explain)
--Testcase 1344:
EXPLAIN VERBOSE
SELECT value1, lower(str1) FROM s3 ORDER BY lower(str1);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (lower(str1))
   Sort Key: (lower(s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (lower(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, lower(str1) FROM public.s3mysql
(7 rows)

-- select lower with order by (result)
--Testcase 1345:
SELECT value1, lower(str1) FROM s3 ORDER BY lower(str1);
 value1 |   lower   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(6 rows)

-- select lower with order by index (result)
--Testcase 1346:
SELECT value1, lower(str1) FROM s3 ORDER BY 2,1;
 value1 |   lower   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(6 rows)

-- select lower with order by index (result)
--Testcase 1347:
SELECT value1, lower(str1) FROM s3 ORDER BY 1,2;
 value1 |   lower   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(6 rows)

-- select lower with group by (explain)
--Testcase 1348:
EXPLAIN VERBOSE
SELECT count(value1), lower(str1) FROM s3 GROUP BY lower(str1);
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (lower(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), lower(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select lower with group by (result)
--Testcase 1349:
SELECT count(value1), lower(str1) FROM s3 GROUP BY lower(str1);
 count |   lower   
-------+-----------
     6 | ---xyz---
(1 row)

-- select lower with group by index (result)
--Testcase 1350:
SELECT value1, lower(str1) FROM s3 GROUP BY 2,1;
 value1 |   lower   
--------+-----------
    0.1 | ---xyz---
    0.2 | ---xyz---
    0.3 | ---xyz---
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(6 rows)

-- select lower with group by having (explain)
--Testcase 1351:
EXPLAIN VERBOSE
SELECT count(value1), lower(str1) FROM s3 GROUP BY lower(str1), str1 HAVING lower(str1) IS NOT NULL;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (lower(str1)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), lower(str1), str1 FROM public.s3mysql WHERE ((lower(str1) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select lower with group by having (result)
--Testcase 1352:
SELECT count(value1), lower(str1) FROM s3 GROUP BY lower(str1), str1 HAVING lower(str1) IS NOT NULL;
 count |   lower   
-------+-----------
     6 | ---xyz---
(1 row)

-- select lower with group by index having (result)
--Testcase 1353:
SELECT value1, lower(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |   lower   
--------+-----------
    1.1 | ---xyz---
    2.2 | ---xyz---
    3.3 | ---xyz---
(3 rows)

--
-- test lpad()
--
-- select lpad (stub function, explain)
--Testcase 1354:
EXPLAIN VERBOSE
SELECT lpad(str1, 4, 'ABCD'), lpad(str2, 4, 'ABCD') FROM s3;
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (lpad(str1, 4, 'ABCD'::text)), (lpad(str2, 4, 'ABCD'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT lpad(str1, 4, 'ABCD'::text), lpad(str2, 4, 'ABCD'::text) FROM public.s3mysql
(4 rows)

-- select lpad (stub function, result)
--Testcase 1355:
SELECT lpad(str1, 4, 'ABCD'), lpad(str2, 4, 'ABCD') FROM s3;
 lpad | lpad 
------+------
 ---X |    X
 ---X |    X
 ---X |    X
 ---X |    X
 ---X |    X
 ---X |    X
(6 rows)

-- select lpad (stub function, not pushdown constraints, explain)
--Testcase 1356:
EXPLAIN VERBOSE
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 WHERE to_hex(value2) = '64';
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (lpad(str1, 4, 'ABCD'::text))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, lpad(str1, 4, 'ABCD'::text), value2 FROM public.s3mysql
(5 rows)

-- select lpad (stub function, not pushdown constraints, result)
--Testcase 1357:
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 WHERE to_hex(value2) = '64';
 value1 | lpad 
--------+------
    0.1 | ---X
    0.2 | ---X
    0.3 | ---X
(3 rows)

-- select lpad (stub function, pushdown constraints, explain)
--Testcase 1358:
EXPLAIN VERBOSE
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 WHERE value2 != 200;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (lpad(str1, 4, 'ABCD'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, lpad(str1, 4, 'ABCD'::text) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select lpad (stub function, pushdown constraints, result)
--Testcase 1359:
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 WHERE value2 != 200;
 value1 | lpad 
--------+------
    0.1 | ---X
    0.2 | ---X
    0.3 | ---X
(3 rows)

-- select lpad with non pushdown func and explicit constant (explain)
--Testcase 1360:
EXPLAIN VERBOSE
SELECT lpad(str1, 4, 'ABCD'), pi(), 4.1 FROM s3;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (lpad(str1, 4, 'ABCD'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT lpad(str1, 4, 'ABCD'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select lpad with non pushdown func and explicit constant (result)
--Testcase 1361:
SELECT lpad(str1, 4, 'ABCD'), pi(), 4.1 FROM s3;
 lpad |        pi         | ?column? 
------+-------------------+----------
 ---X | 3.141592653589793 |      4.1
 ---X | 3.141592653589793 |      4.1
 ---X | 3.141592653589793 |      4.1
 ---X | 3.141592653589793 |      4.1
 ---X | 3.141592653589793 |      4.1
 ---X | 3.141592653589793 |      4.1
(6 rows)

-- select lpad with order by (explain)
--Testcase 1362:
EXPLAIN VERBOSE
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 ORDER BY lpad(str1, 4, 'ABCD');
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (lpad(str1, 4, 'ABCD'::text))
   Sort Key: (lpad(s3.str1, 4, 'ABCD'::text))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (lpad(str1, 4, 'ABCD'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, lpad(str1, 4, 'ABCD'::text) FROM public.s3mysql
(7 rows)

-- select lpad with order by (result)
--Testcase 1363:
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 ORDER BY lpad(str1, 4, 'ABCD');
 value1 | lpad 
--------+------
    0.1 | ---X
    0.2 | ---X
    0.3 | ---X
    1.1 | ---X
    2.2 | ---X
    3.3 | ---X
(6 rows)

-- select lpad with order by index (result)
--Testcase 1364:
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 ORDER BY 2,1;
 value1 | lpad 
--------+------
    0.1 | ---X
    0.2 | ---X
    0.3 | ---X
    1.1 | ---X
    2.2 | ---X
    3.3 | ---X
(6 rows)

-- select lpad with order by index (result)
--Testcase 1365:
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 ORDER BY 1,2;
 value1 | lpad 
--------+------
    0.1 | ---X
    0.2 | ---X
    0.3 | ---X
    1.1 | ---X
    2.2 | ---X
    3.3 | ---X
(6 rows)

-- select lpad with group by (explain)
--Testcase 1366:
EXPLAIN VERBOSE
SELECT count(value1), lpad(str1, 4, 'ABCD') FROM s3 GROUP BY lpad(str1, 4, 'ABCD');
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (lpad(str1, 4, 'ABCD'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), lpad(str1, 4, 'ABCD'::text) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select lpad with group by (result)
--Testcase 1367:
SELECT count(value1), lpad(str1, 4, 'ABCD') FROM s3 GROUP BY lpad(str1, 4, 'ABCD');
 count | lpad 
-------+------
     6 | ---X
(1 row)

-- select lpad with group by index (result)
--Testcase 1368:
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 GROUP BY 2,1;
 value1 | lpad 
--------+------
    0.1 | ---X
    0.2 | ---X
    0.3 | ---X
    1.1 | ---X
    2.2 | ---X
    3.3 | ---X
(6 rows)

-- select lpad with group by having (explain)
--Testcase 1369:
EXPLAIN VERBOSE
SELECT count(value1), lpad(str1, 4, 'ABCD') FROM s3 GROUP BY lpad(str1, 4, 'ABCD'), str1 HAVING lpad(str1, 4, 'ABCD') IS NOT NULL;
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (lpad(str1, 4, 'ABCD'::text)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), lpad(str1, 4, 'ABCD'::text), str1 FROM public.s3mysql WHERE ((lpad(str1, 4, 'ABCD'::text) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select lpad with group by having (result)
--Testcase 1370:
SELECT count(value1), lpad(str1, 4, 'ABCD') FROM s3 GROUP BY lpad(str1, 4, 'ABCD'), str1 HAVING lpad(str1, 4, 'ABCD') IS NOT NULL;
 count | lpad 
-------+------
     6 | ---X
(1 row)

-- select lpad with group by index having (result)
--Testcase 1371:
SELECT value1, lpad(str1, 4, 'ABCD') FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | lpad 
--------+------
    1.1 | ---X
    2.2 | ---X
    3.3 | ---X
(3 rows)

--
-- test ltrim()
--
-- select ltrim (stub function, explain)
--Testcase 1372:
EXPLAIN VERBOSE
SELECT ltrim(str1), ltrim(str2, ' ') FROM s3;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (ltrim(str1)), (ltrim(str2, ' '::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ltrim(str1), ltrim(str2, ' '::text) FROM public.s3mysql
(4 rows)

-- select ltrim (stub function, result)
--Testcase 1373:
SELECT ltrim(str1), ltrim(str2, ' ') FROM s3;
   ltrim   | ltrim  
-----------+--------
 ---XYZ--- | XYZ   
 ---XYZ--- | XYZ   
 ---XYZ--- | XYZ   
 ---XYZ--- | XYZ   
 ---XYZ--- | XYZ   
 ---XYZ--- | XYZ   
(6 rows)

-- select ltrim (stub function, not pushdown constraints, explain)
--Testcase 1374:
EXPLAIN VERBOSE
SELECT value1, ltrim(str1, '-') FROM s3 WHERE to_hex(value2) = '64';
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (ltrim(str1, '-'::text))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, ltrim(str1, '-'::text), value2 FROM public.s3mysql
(5 rows)

-- select ltrim (stub function, not pushdown constraints, result)
--Testcase 1375:
SELECT value1, ltrim(str1, '-') FROM s3 WHERE to_hex(value2) = '64';
 value1 | ltrim  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
(3 rows)

-- select ltrim (stub function, pushdown constraints, explain)
--Testcase 1376:
EXPLAIN VERBOSE
SELECT value1, ltrim(str1, '-') FROM s3 WHERE value2 != 200;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (ltrim(str1, '-'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, ltrim(str1, '-'::text) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select ltrim (stub function, pushdown constraints, result)
--Testcase 1377:
SELECT value1, ltrim(str1, '-') FROM s3 WHERE value2 != 200;
 value1 | ltrim  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
(3 rows)

-- select ltrim with non pushdown func and explicit constant (explain)
--Testcase 1378:
EXPLAIN VERBOSE
SELECT ltrim(str1, '-'), pi(), 4.1 FROM s3;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (ltrim(str1, '-'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ltrim(str1, '-'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select ltrim with non pushdown func and explicit constant (result)
--Testcase 1379:
SELECT ltrim(str1, '-'), pi(), 4.1 FROM s3;
 ltrim  |        pi         | ?column? 
--------+-------------------+----------
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
(6 rows)

-- select ltrim with order by (explain)
--Testcase 1380:
EXPLAIN VERBOSE
SELECT value1, ltrim(str1, '-') FROM s3 ORDER BY ltrim(str1, '-');
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (ltrim(str1, '-'::text))
   Sort Key: (ltrim(s3.str1, '-'::text))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (ltrim(str1, '-'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, ltrim(str1, '-'::text) FROM public.s3mysql
(7 rows)

-- select ltrim with order by (result)
--Testcase 1381:
SELECT value1, ltrim(str1, '-') FROM s3 ORDER BY ltrim(str1, '-');
 value1 | ltrim  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(6 rows)

-- select ltrim with order by index (result)
--Testcase 1382:
SELECT value1, ltrim(str1, '-') FROM s3 ORDER BY 2,1;
 value1 | ltrim  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(6 rows)

-- select ltrim with order by index (result)
--Testcase 1383:
SELECT value1, ltrim(str1, '-') FROM s3 ORDER BY 1,2;
 value1 | ltrim  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(6 rows)

-- select ltrim with group by (explain)
--Testcase 1384:
EXPLAIN VERBOSE
SELECT count(value1), ltrim(str1, '-') FROM s3 GROUP BY ltrim(str1, '-');
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (ltrim(str1, '-'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), ltrim(str1, '-'::text) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select ltrim with group by (result)
--Testcase 1385:
SELECT count(value1), ltrim(str1, '-') FROM s3 GROUP BY ltrim(str1, '-');
 count | ltrim  
-------+--------
     6 | XYZ---
(1 row)

-- select ltrim with group by index (result)
--Testcase 1386:
SELECT value1, ltrim(str1, '-') FROM s3 GROUP BY 2,1;
 value1 | ltrim  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(6 rows)

-- select ltrim with group by having (explain)
--Testcase 1387:
EXPLAIN VERBOSE
SELECT count(value1), ltrim(str1, '-') FROM s3 GROUP BY ltrim(str1, '-'), str2 HAVING ltrim(str1, '-') IS NOT NULL;
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (ltrim(str1, '-'::text)), str2
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), ltrim(str1, '-'::text), str2 FROM public.s3mysql WHERE ((ltrim(str1, '-'::text) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select ltrim with group by having (result)
--Testcase 1388:
SELECT count(value1), ltrim(str1, '-') FROM s3 GROUP BY ltrim(str1, '-'), str2 HAVING ltrim(str1, '-') IS NOT NULL;
 count | ltrim  
-------+--------
     6 | XYZ---
(1 row)

-- select ltrim with group by index having (result)
--Testcase 1389:
SELECT value1, ltrim(str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | ltrim  
--------+--------
    1.1 | XYZ   
    2.2 | XYZ   
    3.3 | XYZ   
(3 rows)

--
-- test make_set()
--
-- select make_set (stub function, explain)
--Testcase 1390:
EXPLAIN VERBOSE
SELECT make_set(1, str1, str2), make_set(1 | 4, str1, str2) FROM s3;
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=64)
   Output: (make_set('1'::bigint, VARIADIC ARRAY[str1, str2])), (make_set('5'::bigint, VARIADIC ARRAY[str1, str2]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.make_set(1::bigint, VARIADIC ARRAY[str1, str2]), public.make_set(5::bigint, VARIADIC ARRAY[str1, str2]) FROM public.s3mysql
(4 rows)

-- select make_set (stub function, result)
--Testcase 1391:
SELECT make_set(1, str1, str2), make_set(1 | 4, str1, str2) FROM s3;
 make_set  | make_set  
-----------+-----------
 ---XYZ--- | ---XYZ---
 ---XYZ--- | ---XYZ---
 ---XYZ--- | ---XYZ---
 ---XYZ--- | ---XYZ---
 ---XYZ--- | ---XYZ---
 ---XYZ--- | ---XYZ---
(6 rows)

-- select make_set (stub function, not pushdown constraints, explain)
--Testcase 1392:
EXPLAIN VERBOSE
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 WHERE to_hex(value2) = '64';
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (make_set('5'::bigint, VARIADIC ARRAY[str1, str2]))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.make_set(5::bigint, VARIADIC ARRAY[str1, str2]), value2 FROM public.s3mysql
(5 rows)

-- select make_set (stub function, not pushdown constraints, result)
--Testcase 1393:
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 WHERE to_hex(value2) = '64';
 value1 | make_set  
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
(3 rows)

-- select make_set (stub function, pushdown constraints, explain)
--Testcase 1394:
EXPLAIN VERBOSE
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 WHERE value2 != 200;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (make_set('5'::bigint, VARIADIC ARRAY[str1, str2]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.make_set(5::bigint, VARIADIC ARRAY[str1, str2]) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select make_set (stub function, pushdown constraints, result)
--Testcase 1395:
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 WHERE value2 != 200;
 value1 | make_set  
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
(3 rows)

-- select make_set with non pushdown func and explicit constant (explain)
--Testcase 1396:
EXPLAIN VERBOSE
SELECT make_set(1 | 4, str1, str2), pi(), 4.1 FROM s3;
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (make_set('5'::bigint, VARIADIC ARRAY[str1, str2])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.make_set(5::bigint, VARIADIC ARRAY[str1, str2]), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select make_set with non pushdown func and explicit constant (result)
--Testcase 1397:
SELECT make_set(1 | 4, str1, str2), pi(), 4.1 FROM s3;
 make_set  |        pi         | ?column? 
-----------+-------------------+----------
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
(6 rows)

-- select make_set with order by (explain)
--Testcase 1398:
EXPLAIN VERBOSE
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 ORDER BY make_set(1 | 4, str1, str2);
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (make_set('5'::bigint, VARIADIC ARRAY[str1, str2]))
   Sort Key: (make_set('5'::bigint, VARIADIC ARRAY[s3.str1, s3.str2]))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (make_set('5'::bigint, VARIADIC ARRAY[str1, str2]))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.make_set(5::bigint, VARIADIC ARRAY[str1, str2]) FROM public.s3mysql
(7 rows)

-- select make_set with order by (result)
--Testcase 1399:
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 ORDER BY make_set(1 | 4, str1, str2);
 value1 | make_set  
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select make_set with order by index (result)
--Testcase 1400:
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 ORDER BY 2,1;
 value1 | make_set  
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select make_set with order by index (result)
--Testcase 1401:
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 ORDER BY 1,2;
 value1 | make_set  
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select make_set with group by (explain)
--Testcase 1402:
EXPLAIN VERBOSE
SELECT count(value1), make_set(1 | 4, str1, str2) FROM s3 GROUP BY make_set(1 | 4, str1, str2);
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (make_set('5'::bigint, VARIADIC ARRAY[str1, str2]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.make_set(5::bigint, VARIADIC ARRAY[str1, str2]) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select make_set with group by (result)
--Testcase 1403:
SELECT count(value1), make_set(1 | 4, str1, str2) FROM s3 GROUP BY make_set(1 | 4, str1, str2);
 count | make_set  
-------+-----------
     6 | ---XYZ---
(1 row)

-- select make_set with group by index (result)
--Testcase 1404:
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 GROUP BY 2,1;
 value1 | make_set  
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select make_set with group by having (explain)
--Testcase 1405:
EXPLAIN VERBOSE
SELECT count(value1), make_set(1 | 4, str1, str2) FROM s3 GROUP BY make_set(1 | 4, str1, str2), str1, str2 HAVING make_set(1 | 4, str1, str2) IS NOT NULL;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=104)
   Output: (count(value1)), (make_set('5'::bigint, VARIADIC ARRAY[str1, str2])), str1, str2
   Filter: ((make_set('5'::bigint, VARIADIC ARRAY[s3.str1, s3.str2])) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.make_set(5::bigint, VARIADIC ARRAY[str1, str2]), str1, str2 FROM public.s3mysql GROUP BY 2, 3, 4
(7 rows)

-- select make_set with group by having (result)
--Testcase 1406:
SELECT count(value1), make_set(1 | 4, str1, str2) FROM s3 GROUP BY make_set(1 | 4, str1, str2), str1, str2 HAVING make_set(1 | 4, str1, str2) IS NOT NULL;
 count | make_set  
-------+-----------
     6 | ---XYZ---
(1 row)

-- select make_set with group by index having (result)
--Testcase 1407:
SELECT value1, make_set(1 | 4, str1, str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | make_set  
--------+-----------
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(3 rows)

--
-- test mid()
--
-- select mid (stub function, explain)
--Testcase 1408:
EXPLAIN VERBOSE
SELECT mid(str1, 2, 4), mid(str2, 2, 4) FROM s3;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=64)
   Output: (mid(str1, '2'::bigint, '4'::bigint)), (mid(str2, '2'::bigint, '4'::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mid(str1, 2::bigint, 4::bigint), public.mid(str2, 2::bigint, 4::bigint) FROM public.s3mysql
(4 rows)

-- select mid (stub function, result)
--Testcase 1409:
SELECT mid(str1, 2, 4), mid(str2, 2, 4) FROM s3;
 mid  | mid  
------+------
 --XY |   XY
 --XY |   XY
 --XY |   XY
 --XY |   XY
 --XY |   XY
 --XY |   XY
(6 rows)

-- select mid (stub function, not pushdown constraints, explain)
--Testcase 1410:
EXPLAIN VERBOSE
SELECT value1, mid(str2, 2, 4) FROM s3 WHERE to_hex(value2) = '64';
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (mid(str2, '2'::bigint, '4'::bigint))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.mid(str2, 2::bigint, 4::bigint), value2 FROM public.s3mysql
(5 rows)

-- select mid (stub function, not pushdown constraints, result)
--Testcase 1411:
SELECT value1, mid(str2, 2, 4) FROM s3 WHERE to_hex(value2) = '64';
 value1 | mid  
--------+------
    0.1 |   XY
    0.2 |   XY
    0.3 |   XY
(3 rows)

-- select mid (stub function, pushdown constraints, explain)
--Testcase 1412:
EXPLAIN VERBOSE
SELECT value1, mid(str2, 2, 4) FROM s3 WHERE value2 != 200;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (mid(str2, '2'::bigint, '4'::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.mid(str2, 2::bigint, 4::bigint) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select mid (stub function, pushdown constraints, result)
--Testcase 1413:
SELECT value1, mid(str2, 2, 4) FROM s3 WHERE value2 != 200;
 value1 | mid  
--------+------
    0.1 |   XY
    0.2 |   XY
    0.3 |   XY
(3 rows)

-- select mid with non pushdown func and explicit constant (explain)
--Testcase 1414:
EXPLAIN VERBOSE
SELECT mid(str2, 2, 4), pi(), 4.1 FROM s3;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (mid(str2, '2'::bigint, '4'::bigint)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mid(str2, 2::bigint, 4::bigint), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select mid with non pushdown func and explicit constant (result)
--Testcase 1415:
SELECT mid(str2, 2, 4), pi(), 4.1 FROM s3;
 mid  |        pi         | ?column? 
------+-------------------+----------
   XY | 3.141592653589793 |      4.1
   XY | 3.141592653589793 |      4.1
   XY | 3.141592653589793 |      4.1
   XY | 3.141592653589793 |      4.1
   XY | 3.141592653589793 |      4.1
   XY | 3.141592653589793 |      4.1
(6 rows)

-- select mid with order by (explain)
--Testcase 1416:
EXPLAIN VERBOSE
SELECT value1, mid(str2, 2, 4) FROM s3 ORDER BY mid(str2, 2, 4);
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (mid(str2, '2'::bigint, '4'::bigint))
   Sort Key: (mid(s3.str2, '2'::bigint, '4'::bigint))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (mid(str2, '2'::bigint, '4'::bigint))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.mid(str2, 2::bigint, 4::bigint) FROM public.s3mysql
(7 rows)

-- select mid with order by (result)
--Testcase 1417:
SELECT value1, mid(str2, 2, 4) FROM s3 ORDER BY mid(str2, 2, 4);
 value1 | mid  
--------+------
    0.1 |   XY
    0.2 |   XY
    0.3 |   XY
    1.1 |   XY
    2.2 |   XY
    3.3 |   XY
(6 rows)

-- select mid with order by index (result)
--Testcase 1418:
SELECT value1, mid(str2, 2, 4) FROM s3 ORDER BY 2,1;
 value1 | mid  
--------+------
    0.1 |   XY
    0.2 |   XY
    0.3 |   XY
    1.1 |   XY
    2.2 |   XY
    3.3 |   XY
(6 rows)

-- select mid with order by index (result)
--Testcase 1419:
SELECT value1, mid(str2, 2, 4) FROM s3 ORDER BY 1,2;
 value1 | mid  
--------+------
    0.1 |   XY
    0.2 |   XY
    0.3 |   XY
    1.1 |   XY
    2.2 |   XY
    3.3 |   XY
(6 rows)

-- select mid with group by (explain)
--Testcase 1420:
EXPLAIN VERBOSE
SELECT count(value1), mid(str2, 2, 4) FROM s3 GROUP BY mid(str2, 2, 4);
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (mid(str2, '2'::bigint, '4'::bigint))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.mid(str2, 2::bigint, 4::bigint) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select mid with group by (result)
--Testcase 1421:
SELECT count(value1), mid(str2, 2, 4) FROM s3 GROUP BY mid(str2, 2, 4);
 count | mid  
-------+------
     6 |   XY
(1 row)

-- select mid with group by index (result)
--Testcase 1422:
SELECT value1, mid(str2, 2, 4) FROM s3 GROUP BY 2,1;
 value1 | mid  
--------+------
    0.1 |   XY
    0.2 |   XY
    0.3 |   XY
    1.1 |   XY
    2.2 |   XY
    3.3 |   XY
(6 rows)

-- select mid with group by having (explain)
--Testcase 1423:
EXPLAIN VERBOSE
SELECT count(value1), mid(str2, 2, 4) FROM s3 GROUP BY mid(str2, 2, 4), str2 HAVING mid(str2, 2, 4) IS NOT NULL;
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (mid(str2, '2'::bigint, '4'::bigint)), str2
   Filter: ((mid(s3.str2, '2'::bigint, '4'::bigint)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.mid(str2, 2::bigint, 4::bigint), str2 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.mid(str2, 2::bigint, 4::bigint) IS NOT NULL))
(7 rows)

-- select mid with group by having (result)
--Testcase 1424:
SELECT count(value1), mid(str2, 2, 4) FROM s3 GROUP BY mid(str2, 2, 4), str2 HAVING mid(str2, 2, 4) IS NOT NULL;
 count | mid  
-------+------
     6 |   XY
(1 row)

-- select mid with group by index having (result)
--Testcase 1425:
SELECT value1, mid(str2, 2, 4) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | mid  
--------+------
    1.1 |   XY
    2.2 |   XY
    3.3 |   XY
(3 rows)

--
-- test oct()
--
-- select oct (stub function, explain)
--Testcase 1426:
EXPLAIN VERBOSE
SELECT oct(value2), oct(value4) FROM s3;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1935.95 rows=3413 width=64)
   Output: (oct((value2)::bigint)), (oct((value4)::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.oct(value2), public.oct(value4) FROM public.s3mysql
(4 rows)

-- select oct (stub function, result)
--Testcase 1427:
SELECT oct(value2), oct(value4) FROM s3;
 oct |          oct           
-----+------------------------
 144 | 1777777777777777777634
 144 | 1777777777777777777634
 144 | 1777777777777777777634
 310 | 1777777777777777777470
 310 | 1777777777777777777470
 310 | 1777777777777777777470
(6 rows)

-- select oct (stub function, not pushdown constraints, explain)
--Testcase 1428:
EXPLAIN VERBOSE
SELECT value1, oct(value4) FROM s3 WHERE to_hex(value2) = '64';
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.49 rows=17 width=40)
   Output: value1, (oct((value4)::bigint))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.oct(value4), value2 FROM public.s3mysql
(5 rows)

-- select oct (stub function, not pushdown constraints, result)
--Testcase 1429:
SELECT value1, oct(value4) FROM s3 WHERE to_hex(value2) = '64';
 value1 |          oct           
--------+------------------------
    0.1 | 1777777777777777777634
    0.2 | 1777777777777777777634
    0.3 | 1777777777777777777634
(3 rows)

-- select oct (stub function, pushdown constraints, explain)
--Testcase 1430:
EXPLAIN VERBOSE
SELECT value1, oct(value4) FROM s3 WHERE value2 != 200;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1078.07 rows=3396 width=40)
   Output: value1, (oct((value4)::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.oct(value4) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select oct (stub function, pushdown constraints, result)
--Testcase 1431:
SELECT value1, oct(value4) FROM s3 WHERE value2 != 200;
 value1 |          oct           
--------+------------------------
    0.1 | 1777777777777777777634
    0.2 | 1777777777777777777634
    0.3 | 1777777777777777777634
(3 rows)

-- select oct with non pushdown func and explicit constant (explain)
--Testcase 1432:
EXPLAIN VERBOSE
SELECT oct(value4), pi(), 4.1 FROM s3;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (oct((value4)::bigint)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.oct(value4), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select oct with non pushdown func and explicit constant (result)
--Testcase 1433:
SELECT oct(value4), pi(), 4.1 FROM s3;
          oct           |        pi         | ?column? 
------------------------+-------------------+----------
 1777777777777777777634 | 3.141592653589793 |      4.1
 1777777777777777777634 | 3.141592653589793 |      4.1
 1777777777777777777634 | 3.141592653589793 |      4.1
 1777777777777777777470 | 3.141592653589793 |      4.1
 1777777777777777777470 | 3.141592653589793 |      4.1
 1777777777777777777470 | 3.141592653589793 |      4.1
(6 rows)

-- select oct with order by (explain)
--Testcase 1434:
EXPLAIN VERBOSE
SELECT value1, oct(value4) FROM s3 ORDER BY oct(value4);
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=40)
   Output: value1, (oct((value4)::bigint))
   Sort Key: (oct((s3.value4)::bigint))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=40)
         Output: value1, (oct((value4)::bigint))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.oct(value4) FROM public.s3mysql
(7 rows)

-- select oct with order by (result)
--Testcase 1435:
SELECT value1, oct(value4) FROM s3 ORDER BY oct(value4);
 value1 |          oct           
--------+------------------------
    1.1 | 1777777777777777777470
    2.2 | 1777777777777777777470
    3.3 | 1777777777777777777470
    0.1 | 1777777777777777777634
    0.2 | 1777777777777777777634
    0.3 | 1777777777777777777634
(6 rows)

-- select oct with order by index (result)
--Testcase 1436:
SELECT value1, oct(value4) FROM s3 ORDER BY 2,1;
 value1 |          oct           
--------+------------------------
    1.1 | 1777777777777777777470
    2.2 | 1777777777777777777470
    3.3 | 1777777777777777777470
    0.1 | 1777777777777777777634
    0.2 | 1777777777777777777634
    0.3 | 1777777777777777777634
(6 rows)

-- select oct with order by index (result)
--Testcase 1437:
SELECT value1, oct(value4) FROM s3 ORDER BY 1,2;
 value1 |          oct           
--------+------------------------
    0.1 | 1777777777777777777634
    0.2 | 1777777777777777777634
    0.3 | 1777777777777777777634
    1.1 | 1777777777777777777470
    2.2 | 1777777777777777777470
    3.3 | 1777777777777777777470
(6 rows)

-- select oct with group by (explain)
--Testcase 1438:
EXPLAIN VERBOSE
SELECT count(value1), oct(value4) FROM s3 GROUP BY oct(value4);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (oct((value4)::bigint))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.oct(value4) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select oct with group by (result)
--Testcase 1439:
SELECT count(value1), oct(value4) FROM s3 GROUP BY oct(value4);
 count |          oct           
-------+------------------------
     3 | 1777777777777777777634
     3 | 1777777777777777777470
(2 rows)

-- select oct with group by index (result)
--Testcase 1440:
SELECT value1, oct(value4) FROM s3 GROUP BY 2,1;
 value1 |          oct           
--------+------------------------
    0.1 | 1777777777777777777634
    0.2 | 1777777777777777777634
    0.3 | 1777777777777777777634
    1.1 | 1777777777777777777470
    2.2 | 1777777777777777777470
    3.3 | 1777777777777777777470
(6 rows)

-- select oct with group by having (explain)
--Testcase 1441:
EXPLAIN VERBOSE
SELECT count(value1), oct(value4) FROM s3 GROUP BY oct(value4), value4 HAVING oct(value4) IS NOT NULL;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (oct((value4)::bigint)), value4
   Filter: ((oct((s3.value4)::bigint)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.oct(value4), value4 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.oct(value4) IS NOT NULL))
(7 rows)

-- select oct with group by having (result)
--Testcase 1442:
SELECT count(value1), oct(value4) FROM s3 GROUP BY oct(value4), value4 HAVING oct(value4) IS NOT NULL;
 count |          oct           
-------+------------------------
     3 | 1777777777777777777634
     3 | 1777777777777777777470
(2 rows)

-- select oct with group by index having (result)
--Testcase 1443:
SELECT value1, oct(value4) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |          oct           
--------+------------------------
    1.1 | 1777777777777777777470
    2.2 | 1777777777777777777470
    3.3 | 1777777777777777777470
(3 rows)

--
-- test octet_length()
--
-- select octet_length (stub function, explain)
--Testcase 1444:
EXPLAIN VERBOSE
SELECT octet_length(str1), octet_length(str2) FROM s3;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=8)
   Output: (octet_length(str1)), (octet_length(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT octet_length(str1), octet_length(str2) FROM public.s3mysql
(4 rows)

-- select octet_length (stub function, result)
--Testcase 1445:
SELECT octet_length(str1), octet_length(str2) FROM s3;
 octet_length | octet_length 
--------------+--------------
            9 |            9
            9 |            9
            9 |            9
            9 |            9
            9 |            9
            9 |            9
(6 rows)

-- select octet_length (stub function, not pushdown constraints, explain)
--Testcase 1446:
EXPLAIN VERBOSE
SELECT value1, octet_length(str1) FROM s3 WHERE to_hex(value2) = '64';
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=12)
   Output: value1, (octet_length(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, octet_length(str1), value2 FROM public.s3mysql
(5 rows)

-- select octet_length (stub function, not pushdown constraints, result)
--Testcase 1447:
SELECT value1, octet_length(str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 | octet_length 
--------+--------------
    0.1 |            9
    0.2 |            9
    0.3 |            9
(3 rows)

-- select octet_length (stub function, pushdown constraints, explain)
--Testcase 1448:
EXPLAIN VERBOSE
SELECT value1, octet_length(str1) FROM s3 WHERE value2 != 200;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=12)
   Output: value1, (octet_length(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, octet_length(str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select octet_length (stub function, pushdown constraints, result)
--Testcase 1449:
SELECT value1, octet_length(str1) FROM s3 WHERE value2 != 200;
 value1 | octet_length 
--------+--------------
    0.1 |            9
    0.2 |            9
    0.3 |            9
(3 rows)

-- select octet_length with non pushdown func and explicit constant (explain)
--Testcase 1450:
EXPLAIN VERBOSE
SELECT octet_length(str1), pi(), 4.1 FROM s3;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=44)
   Output: (octet_length(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT octet_length(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select octet_length with non pushdown func and explicit constant (result)
--Testcase 1451:
SELECT octet_length(str1), pi(), 4.1 FROM s3;
 octet_length |        pi         | ?column? 
--------------+-------------------+----------
            9 | 3.141592653589793 |      4.1
            9 | 3.141592653589793 |      4.1
            9 | 3.141592653589793 |      4.1
            9 | 3.141592653589793 |      4.1
            9 | 3.141592653589793 |      4.1
            9 | 3.141592653589793 |      4.1
(6 rows)

-- select octet_length with order by (explain)
--Testcase 1452:
EXPLAIN VERBOSE
SELECT value1, octet_length(str1) FROM s3 ORDER BY octet_length(str1);
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=12)
   Output: value1, (octet_length(str1))
   Sort Key: (octet_length(s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=12)
         Output: value1, (octet_length(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, octet_length(str1) FROM public.s3mysql
(7 rows)

-- select octet_length with order by (result)
--Testcase 1453:
SELECT value1, octet_length(str1) FROM s3 ORDER BY octet_length(str1);
 value1 | octet_length 
--------+--------------
    0.1 |            9
    0.2 |            9
    0.3 |            9
    1.1 |            9
    2.2 |            9
    3.3 |            9
(6 rows)

-- select octet_length with order by index (result)
--Testcase 1454:
SELECT value1, octet_length(str1) FROM s3 ORDER BY 2,1;
 value1 | octet_length 
--------+--------------
    0.1 |            9
    0.2 |            9
    0.3 |            9
    1.1 |            9
    2.2 |            9
    3.3 |            9
(6 rows)

-- select octet_length with order by index (result)
--Testcase 1455:
SELECT value1, octet_length(str1) FROM s3 ORDER BY 1,2;
 value1 | octet_length 
--------+--------------
    0.1 |            9
    0.2 |            9
    0.3 |            9
    1.1 |            9
    2.2 |            9
    3.3 |            9
(6 rows)

-- select octet_length with group by (explain)
--Testcase 1456:
EXPLAIN VERBOSE
SELECT count(value1), octet_length(str1) FROM s3 GROUP BY octet_length(str1);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (octet_length(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), octet_length(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select octet_length with group by (result)
--Testcase 1457:
SELECT count(value1), octet_length(str1) FROM s3 GROUP BY octet_length(str1);
 count | octet_length 
-------+--------------
     6 |            9
(1 row)

-- select octet_length with group by index (result)
--Testcase 1458:
SELECT value1, octet_length(str1) FROM s3 GROUP BY 2,1;
 value1 | octet_length 
--------+--------------
    0.1 |            9
    0.2 |            9
    0.3 |            9
    1.1 |            9
    2.2 |            9
    3.3 |            9
(6 rows)

-- select octet_length with group by having (explain)
--Testcase 1459:
EXPLAIN VERBOSE
SELECT count(value1), octet_length(str1) FROM s3 GROUP BY octet_length(str1), str1 HAVING octet_length(str1) IS NOT NULL;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (octet_length(str1)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), octet_length(str1), str1 FROM public.s3mysql WHERE ((octet_length(str1) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select octet_length with group by having (result)
--Testcase 1460:
SELECT count(value1), octet_length(str1) FROM s3 GROUP BY octet_length(str1), str1 HAVING octet_length(str1) IS NOT NULL;
 count | octet_length 
-------+--------------
     6 |            9
(1 row)

-- select octet_length with group by index having (result)
--Testcase 1461:
SELECT value1, octet_length(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | octet_length 
--------+--------------
    1.1 |            9
    2.2 |            9
    3.3 |            9
(3 rows)

--
-- test ord()
--
-- select ord (stub function, explain)
--Testcase 1462:
EXPLAIN VERBOSE
SELECT ord(value1), ord(value2), ord(value3), ord(value4), ord(str1), ord(str2) FROM s3;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..5331.89 rows=3413 width=24)
   Output: (ord(value1)), (ord(value2)), (ord(value3)), (ord(value4)), (ord(str1)), (ord(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.ord(value1), public.ord(value2), public.ord(value3), public.ord(value4), public.ord(str1), public.ord(str2) FROM public.s3mysql
(4 rows)

-- select ord (stub function, result)
--Testcase 1463:
SELECT ord(value1), ord(value2), ord(value3), ord(value4), ord(str1), ord(str2) FROM s3;
 ord | ord | ord | ord | ord | ord 
-----+-----+-----+-----+-----+-----
  48 |  49 |  45 |  45 |  45 |  32
  48 |  49 |  45 |  45 |  45 |  32
  48 |  49 |  45 |  45 |  45 |  32
  49 |  50 |  45 |  45 |  45 |  32
  50 |  50 |  45 |  45 |  45 |  32
  51 |  50 |  45 |  45 |  45 |  32
(6 rows)

-- select ord (stub function, not pushdown constraints, explain)
--Testcase 1464:
EXPLAIN VERBOSE
SELECT value1, ord(str2) FROM s3 WHERE to_hex(value2) = '64';
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=12)
   Output: value1, (ord(str2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.ord(str2), value2 FROM public.s3mysql
(5 rows)

-- select ord (stub function, not pushdown constraints, result)
--Testcase 1465:
SELECT value1, ord(str2) FROM s3 WHERE to_hex(value2) = '64';
 value1 | ord 
--------+-----
    0.1 |  32
    0.2 |  32
    0.3 |  32
(3 rows)

-- select ord (stub function, pushdown constraints, explain)
--Testcase 1466:
EXPLAIN VERBOSE
SELECT value1, ord(str2) FROM s3 WHERE value2 != 200;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=12)
   Output: value1, (ord(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.ord(str2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select ord (stub function, pushdown constraints, result)
--Testcase 1467:
SELECT value1, ord(str2) FROM s3 WHERE value2 != 200;
 value1 | ord 
--------+-----
    0.1 |  32
    0.2 |  32
    0.3 |  32
(3 rows)

-- select ord with non pushdown func and explicit constant (explain)
--Testcase 1468:
EXPLAIN VERBOSE
SELECT ord(str2), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (ord(str2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.ord(str2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select ord with non pushdown func and explicit constant (result)
--Testcase 1469:
SELECT ord(str2), pi(), 4.1 FROM s3;
 ord |        pi         | ?column? 
-----+-------------------+----------
  32 | 3.141592653589793 |      4.1
  32 | 3.141592653589793 |      4.1
  32 | 3.141592653589793 |      4.1
  32 | 3.141592653589793 |      4.1
  32 | 3.141592653589793 |      4.1
  32 | 3.141592653589793 |      4.1
(6 rows)

-- select ord with order by (explain)
--Testcase 1470:
EXPLAIN VERBOSE
SELECT value1, ord(str2) FROM s3 ORDER BY ord(str2);
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=12)
   Output: value1, (ord(str2))
   Sort Key: (ord(s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=12)
         Output: value1, (ord(str2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.ord(str2) FROM public.s3mysql
(7 rows)

-- select ord with order by (result)
--Testcase 1471:
SELECT value1, ord(str2) FROM s3 ORDER BY ord(str2);
 value1 | ord 
--------+-----
    0.1 |  32
    0.2 |  32
    0.3 |  32
    1.1 |  32
    2.2 |  32
    3.3 |  32
(6 rows)

-- select ord with order by index (result)
--Testcase 1472:
SELECT value1, ord(str2) FROM s3 ORDER BY 2,1;
 value1 | ord 
--------+-----
    0.1 |  32
    0.2 |  32
    0.3 |  32
    1.1 |  32
    2.2 |  32
    3.3 |  32
(6 rows)

-- select ord with order by index (result)
--Testcase 1473:
SELECT value1, ord(str2) FROM s3 ORDER BY 1,2;
 value1 | ord 
--------+-----
    0.1 |  32
    0.2 |  32
    0.3 |  32
    1.1 |  32
    2.2 |  32
    3.3 |  32
(6 rows)

-- select ord with group by (explain)
--Testcase 1474:
EXPLAIN VERBOSE
SELECT count(value1), ord(str2) FROM s3 GROUP BY ord(str2);
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (ord(str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.ord(str2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select ord with group by (result)
--Testcase 1475:
SELECT count(value1), ord(str2) FROM s3 GROUP BY ord(str2);
 count | ord 
-------+-----
     6 |  32
(1 row)

-- select ord with group by index (result)
--Testcase 1476:
SELECT value1, ord(str2) FROM s3 GROUP BY 2,1;
 value1 | ord 
--------+-----
    0.1 |  32
    0.2 |  32
    0.3 |  32
    1.1 |  32
    2.2 |  32
    3.3 |  32
(6 rows)

-- select ord with group by having (explain)
--Testcase 1477:
EXPLAIN VERBOSE
SELECT count(value1), ord(str2) FROM s3 GROUP BY ord(str2), str2 HAVING ord(str2) IS NOT NULL;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (ord(str2)), str2
   Filter: ((ord(s3.str2)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.ord(str2), str2 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.ord(str2) IS NOT NULL))
(7 rows)

-- select ord with group by having (result)
--Testcase 1478:
SELECT count(value1), ord(str2) FROM s3 GROUP BY ord(str2), str2 HAVING ord(str2) IS NOT NULL;
 count | ord 
-------+-----
     6 |  32
(1 row)

-- select ord with group by index having (result)
--Testcase 1479:
SELECT value1, ord(str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | ord 
--------+-----
    1.1 |  32
    2.2 |  32
    3.3 |  32
(3 rows)

--
-- test position()
--
-- select position (stub function, explain)
--Testcase 1480:
EXPLAIN VERBOSE
SELECT position('XYZ' IN str1), position('XYZ' IN str2) FROM s3;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=8)
   Output: ("position"(str1, 'XYZ'::text)), ("position"(str2, 'XYZ'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "position"(str1, 'XYZ'::text), "position"(str2, 'XYZ'::text) FROM public.s3mysql
(4 rows)

-- select position (stub function, result)
--Testcase 1481:
SELECT position('XYZ' IN str1), position('XYZ' IN str2) FROM s3;
 position | position 
----------+----------
        4 |        4
        4 |        4
        4 |        4
        4 |        4
        4 |        4
        4 |        4
(6 rows)

-- select position (stub function, not pushdown constraints, explain)
--Testcase 1482:
EXPLAIN VERBOSE
SELECT value1, position('XYZ' IN str1) FROM s3 WHERE to_hex(value2) = '64';
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=12)
   Output: value1, ("position"(str1, 'XYZ'::text))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, "position"(str1, 'XYZ'::text), value2 FROM public.s3mysql
(5 rows)

-- select position (stub function, not pushdown constraints, result)
--Testcase 1483:
SELECT value1, position('XYZ' IN str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 | position 
--------+----------
    0.1 |        4
    0.2 |        4
    0.3 |        4
(3 rows)

-- select position (stub function, pushdown constraints, explain)
--Testcase 1484:
EXPLAIN VERBOSE
SELECT value1, position('XYZ' IN str1) FROM s3 WHERE value2 != 200;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=12)
   Output: value1, ("position"(str1, 'XYZ'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, "position"(str1, 'XYZ'::text) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select position (stub function, pushdown constraints, result)
--Testcase 1485:
SELECT value1, position('XYZ' IN str1) FROM s3 WHERE value2 != 200;
 value1 | position 
--------+----------
    0.1 |        4
    0.2 |        4
    0.3 |        4
(3 rows)

-- select position with non pushdown func and explicit constant (explain)
--Testcase 1486:
EXPLAIN VERBOSE
SELECT position('XYZ' IN str1), pi(), 4.1 FROM s3;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=44)
   Output: ("position"(str1, 'XYZ'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "position"(str1, 'XYZ'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select position with non pushdown func and explicit constant (result)
--Testcase 1487:
SELECT position('XYZ' IN str1), pi(), 4.1 FROM s3;
 position |        pi         | ?column? 
----------+-------------------+----------
        4 | 3.141592653589793 |      4.1
        4 | 3.141592653589793 |      4.1
        4 | 3.141592653589793 |      4.1
        4 | 3.141592653589793 |      4.1
        4 | 3.141592653589793 |      4.1
        4 | 3.141592653589793 |      4.1
(6 rows)

-- select position with order by (explain)
--Testcase 1488:
EXPLAIN VERBOSE
SELECT value1, position('XYZ' IN str1) FROM s3 ORDER BY position('XYZ' IN str1);
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=12)
   Output: value1, ("position"(str1, 'XYZ'::text))
   Sort Key: ("position"(s3.str1, 'XYZ'::text))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=12)
         Output: value1, ("position"(str1, 'XYZ'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, "position"(str1, 'XYZ'::text) FROM public.s3mysql
(7 rows)

-- select position with order by (result)
--Testcase 1489:
SELECT value1, position('XYZ' IN str1) FROM s3 ORDER BY position('XYZ' IN str1);
 value1 | position 
--------+----------
    0.1 |        4
    0.2 |        4
    0.3 |        4
    1.1 |        4
    2.2 |        4
    3.3 |        4
(6 rows)

-- select position with order by index (result)
--Testcase 1490:
SELECT value1, position('XYZ' IN str1) FROM s3 ORDER BY 2,1;
 value1 | position 
--------+----------
    0.1 |        4
    0.2 |        4
    0.3 |        4
    1.1 |        4
    2.2 |        4
    3.3 |        4
(6 rows)

-- select position with order by index (result)
--Testcase 1491:
SELECT value1, position('XYZ' IN str1) FROM s3 ORDER BY 1,2;
 value1 | position 
--------+----------
    0.1 |        4
    0.2 |        4
    0.3 |        4
    1.1 |        4
    2.2 |        4
    3.3 |        4
(6 rows)

-- select position with group by (explain)
--Testcase 1492:
EXPLAIN VERBOSE
SELECT count(value1), position('XYZ' IN str1) FROM s3 GROUP BY position('XYZ' IN str1);
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), ("position"(str1, 'XYZ'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), "position"(str1, 'XYZ'::text) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select position with group by (result)
--Testcase 1493:
SELECT count(value1), position('XYZ' IN str1) FROM s3 GROUP BY position('XYZ' IN str1);
 count | position 
-------+----------
     6 |        4
(1 row)

-- select position with group by index (result)
--Testcase 1494:
SELECT value1, position('XYZ' IN str1) FROM s3 GROUP BY 2,1;
 value1 | position 
--------+----------
    0.1 |        4
    0.2 |        4
    0.3 |        4
    1.1 |        4
    2.2 |        4
    3.3 |        4
(6 rows)

-- select position with group by having (explain)
--Testcase 1495:
EXPLAIN VERBOSE
SELECT count(value1), position('XYZ' IN str1) FROM s3 GROUP BY position('XYZ' IN str1), str1 HAVING position('XYZ' IN str1) IS NOT NULL;
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), ("position"(str1, 'XYZ'::text)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), "position"(str1, 'XYZ'::text), str1 FROM public.s3mysql WHERE (("position"(str1, 'XYZ'::text) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select position with group by having (result)
--Testcase 1496:
SELECT count(value1), position('XYZ' IN str1) FROM s3 GROUP BY position('XYZ' IN str1), str1 HAVING position('XYZ' IN str1) IS NOT NULL;
 count | position 
-------+----------
     6 |        4
(1 row)

-- select position with group by index having (result)
--Testcase 1497:
SELECT value1, position('XYZ' IN str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | position 
--------+----------
    1.1 |        4
    2.2 |        4
    3.3 |        4
(3 rows)

--
-- test quote()
--
-- select quote (stub function, explain)
--Testcase 1498:
EXPLAIN VERBOSE
SELECT quote(str1), quote(str2) FROM s3;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=64)
   Output: (quote(str1)), (quote(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.quote(str1), public.quote(str2) FROM public.s3mysql
(4 rows)

-- select quote (stub function, result)
--Testcase 1499:
SELECT quote(str1), quote(str2) FROM s3;
    quote    |    quote    
-------------+-------------
 '---XYZ---' | '   XYZ   '
 '---XYZ---' | '   XYZ   '
 '---XYZ---' | '   XYZ   '
 '---XYZ---' | '   XYZ   '
 '---XYZ---' | '   XYZ   '
 '---XYZ---' | '   XYZ   '
(6 rows)

-- select quote (stub function, not pushdown constraints, explain)
--Testcase 1500:
EXPLAIN VERBOSE
SELECT value1, quote(str2) FROM s3 WHERE to_hex(value2) = '64';
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (quote(str2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.quote(str2), value2 FROM public.s3mysql
(5 rows)

-- select quote (stub function, not pushdown constraints, result)
--Testcase 1501:
SELECT value1, quote(str2) FROM s3 WHERE to_hex(value2) = '64';
 value1 |    quote    
--------+-------------
    0.1 | '   XYZ   '
    0.2 | '   XYZ   '
    0.3 | '   XYZ   '
(3 rows)

-- select quote (stub function, pushdown constraints, explain)
--Testcase 1502:
EXPLAIN VERBOSE
SELECT value1, quote(str2) FROM s3 WHERE value2 != 200;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (quote(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.quote(str2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select quote (stub function, pushdown constraints, result)
--Testcase 1503:
SELECT value1, quote(str2) FROM s3 WHERE value2 != 200;
 value1 |    quote    
--------+-------------
    0.1 | '   XYZ   '
    0.2 | '   XYZ   '
    0.3 | '   XYZ   '
(3 rows)

-- select quote with non pushdown func and explicit constant (explain)
--Testcase 1504:
EXPLAIN VERBOSE
SELECT quote(str2), pi(), 4.1 FROM s3;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (quote(str2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.quote(str2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select quote with non pushdown func and explicit constant (result)
--Testcase 1505:
SELECT quote(str2), pi(), 4.1 FROM s3;
    quote    |        pi         | ?column? 
-------------+-------------------+----------
 '   XYZ   ' | 3.141592653589793 |      4.1
 '   XYZ   ' | 3.141592653589793 |      4.1
 '   XYZ   ' | 3.141592653589793 |      4.1
 '   XYZ   ' | 3.141592653589793 |      4.1
 '   XYZ   ' | 3.141592653589793 |      4.1
 '   XYZ   ' | 3.141592653589793 |      4.1
(6 rows)

-- select quote with order by (explain)
--Testcase 1506:
EXPLAIN VERBOSE
SELECT value1, quote(str2) FROM s3 ORDER BY quote(str2);
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (quote(str2))
   Sort Key: (quote(s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (quote(str2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.quote(str2) FROM public.s3mysql
(7 rows)

-- select quote with order by (result)
--Testcase 1507:
SELECT value1, quote(str2) FROM s3 ORDER BY quote(str2);
 value1 |    quote    
--------+-------------
    0.1 | '   XYZ   '
    0.2 | '   XYZ   '
    0.3 | '   XYZ   '
    1.1 | '   XYZ   '
    2.2 | '   XYZ   '
    3.3 | '   XYZ   '
(6 rows)

-- select quote with order by index (result)
--Testcase 1508:
SELECT value1, quote(str2) FROM s3 ORDER BY 2,1;
 value1 |    quote    
--------+-------------
    0.1 | '   XYZ   '
    0.2 | '   XYZ   '
    0.3 | '   XYZ   '
    1.1 | '   XYZ   '
    2.2 | '   XYZ   '
    3.3 | '   XYZ   '
(6 rows)

-- select quote with order by index (result)
--Testcase 1509:
SELECT value1, quote(str2) FROM s3 ORDER BY 1,2;
 value1 |    quote    
--------+-------------
    0.1 | '   XYZ   '
    0.2 | '   XYZ   '
    0.3 | '   XYZ   '
    1.1 | '   XYZ   '
    2.2 | '   XYZ   '
    3.3 | '   XYZ   '
(6 rows)

-- select quote with group by (explain)
--Testcase 1510:
EXPLAIN VERBOSE
SELECT count(value1), quote(str2) FROM s3 GROUP BY quote(str2);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (quote(str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.quote(str2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select quote with group by (result)
--Testcase 1511:
SELECT count(value1), quote(str2) FROM s3 GROUP BY quote(str2);
 count |    quote    
-------+-------------
     6 | '   XYZ   '
(1 row)

-- select quote with group by index (result)
--Testcase 1512:
SELECT value1, quote(str2) FROM s3 GROUP BY 2,1;
 value1 |    quote    
--------+-------------
    0.1 | '   XYZ   '
    0.2 | '   XYZ   '
    0.3 | '   XYZ   '
    1.1 | '   XYZ   '
    2.2 | '   XYZ   '
    3.3 | '   XYZ   '
(6 rows)

-- select quote with group by having (explain)
--Testcase 1513:
EXPLAIN VERBOSE
SELECT count(value1), quote(str2) FROM s3 GROUP BY quote(str2), str2 HAVING quote(str2) IS NOT NULL;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (quote(str2)), str2
   Filter: ((quote(s3.str2)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.quote(str2), str2 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.quote(str2) IS NOT NULL))
(7 rows)

-- select quote with group by having (result)
--Testcase 1514:
SELECT count(value1), quote(str2) FROM s3 GROUP BY quote(str2), str2 HAVING quote(str2) IS NOT NULL;
 count |    quote    
-------+-------------
     6 | '   XYZ   '
(1 row)

-- select quote with group by index having (result)
--Testcase 1515:
SELECT value1, quote(str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |    quote    
--------+-------------
    1.1 | '   XYZ   '
    2.2 | '   XYZ   '
    3.3 | '   XYZ   '
(3 rows)

--
-- test regexp_instr()
--
-- select regexp_instr (stub function, explain)
--Testcase 1516:
EXPLAIN VERBOSE
SELECT regexp_instr(str1, 'XY'), regexp_instr(str2, 'XYZ') FROM s3;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (regexp_instr(str1, 'XY'::text)), (regexp_instr(str2, 'XYZ'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_instr(str1, 'XY'::text), public.regexp_instr(str2, 'XYZ'::text) FROM public.s3mysql
(4 rows)

-- select regexp_instr (stub function, result)
--Testcase 1517:
SELECT regexp_instr(str1, 'XY'), regexp_instr(str2, 'XYZ') FROM s3;
 regexp_instr | regexp_instr 
--------------+--------------
            4 |            4
            4 |            4
            4 |            4
            4 |            4
            4 |            4
            4 |            4
(6 rows)

-- select regexp_instr (stub function, explain)
--Testcase 1518:
EXPLAIN VERBOSE
SELECT regexp_instr(str1, 'XY', 3), regexp_instr(str2, 'XYZ', 3) FROM s3;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (regexp_instr(str1, 'XY'::text, 3)), (regexp_instr(str2, 'XYZ'::text, 3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_instr(str1, 'XY'::text, 3), public.regexp_instr(str2, 'XYZ'::text, 3) FROM public.s3mysql
(4 rows)

-- select regexp_instr (stub function, result)
--Testcase 1519:
SELECT regexp_instr(str1, 'XY', 3), regexp_instr(str2, 'XYZ', 3) FROM s3;
 regexp_instr | regexp_instr 
--------------+--------------
            4 |            4
            4 |            4
            4 |            4
            4 |            4
            4 |            4
            4 |            4
(6 rows)

-- select regexp_instr (stub function, explain)
--Testcase 1520:
EXPLAIN VERBOSE
SELECT regexp_instr(str1, 'XY', 3, 0), regexp_instr(str2, 'XYZ', 3, 0) FROM s3;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (regexp_instr(str1, 'XY'::text, 3, 0)), (regexp_instr(str2, 'XYZ'::text, 3, 0))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_instr(str1, 'XY'::text, 3, 0), public.regexp_instr(str2, 'XYZ'::text, 3, 0) FROM public.s3mysql
(4 rows)

-- select regexp_instr (stub function, result)
--Testcase 1521:
SELECT regexp_instr(str1, 'XY', 3, 0), regexp_instr(str2, 'XYZ', 3, 0) FROM s3;
 regexp_instr | regexp_instr 
--------------+--------------
            4 |            4
            4 |            4
            4 |            4
            4 |            4
            4 |            4
            4 |            4
(6 rows)

-- select regexp_instr (stub function, explain)
--Testcase 1522:
EXPLAIN VERBOSE
SELECT regexp_instr(str1, 'XY', 3, 0, 1), regexp_instr(str2, 'XYZ', 3, 0, 1) FROM s3;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (regexp_instr(str1, 'XY'::text, 3, 0, 1)), (regexp_instr(str2, 'XYZ'::text, 3, 0, 1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_instr(str1, 'XY'::text, 3, 0, 1), public.regexp_instr(str2, 'XYZ'::text, 3, 0, 1) FROM public.s3mysql
(4 rows)

-- select regexp_instr (stub function, result)
--Testcase 1523:
SELECT regexp_instr(str1, 'XY', 3, 0, 1), regexp_instr(str2, 'XYZ', 3, 0, 1) FROM s3;
 regexp_instr | regexp_instr 
--------------+--------------
            6 |            7
            6 |            7
            6 |            7
            6 |            7
            6 |            7
            6 |            7
(6 rows)

-- select regexp_instr (stub function, explain)
--Testcase 1524:
EXPLAIN VERBOSE
SELECT regexp_instr(str1, 'xy', 3, 0, 1, 'i'), regexp_instr(str2, 'xyz', 3, 0, 1, 'i') FROM s3;
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (regexp_instr(str1, 'xy'::text, 3, 0, 1, 'i'::text)), (regexp_instr(str2, 'xyz'::text, 3, 0, 1, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_instr(str1, 'xy'::text, 3, 0, 1, 'i'::text), public.regexp_instr(str2, 'xyz'::text, 3, 0, 1, 'i'::text) FROM public.s3mysql
(4 rows)

-- select regexp_instr (stub function, result)
--Testcase 1525:
SELECT regexp_instr(str1, 'xy', 3, 0, 1, 'i'), regexp_instr(str2, 'xyz', 3, 0, 1, 'i') FROM s3;
 regexp_instr | regexp_instr 
--------------+--------------
            6 |            7
            6 |            7
            6 |            7
            6 |            7
            6 |            7
            6 |            7
(6 rows)

-- select regexp_instr (stub function, not pushdown constraints, explain)
--Testcase 1526:
EXPLAIN VERBOSE
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 WHERE to_hex(value2) = '64';
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=12)
   Output: value1, (regexp_instr(str2, 'XYZ'::text, 3, 0))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.regexp_instr(str2, 'XYZ'::text, 3, 0), value2 FROM public.s3mysql
(5 rows)

-- select regexp_instr (stub function, not pushdown constraints, result)
--Testcase 1527:
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 WHERE to_hex(value2) = '64';
 value1 | regexp_instr 
--------+--------------
    0.1 |            4
    0.2 |            4
    0.3 |            4
(3 rows)

-- select regexp_instr (stub function, pushdown constraints, explain)
--Testcase 1528:
EXPLAIN VERBOSE
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 WHERE value2 != 200;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=12)
   Output: value1, (regexp_instr(str2, 'XYZ'::text, 3, 0))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.regexp_instr(str2, 'XYZ'::text, 3, 0) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select regexp_instr (stub function, pushdown constraints, result)
--Testcase 1529:
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 WHERE value2 != 200;
 value1 | regexp_instr 
--------+--------------
    0.1 |            4
    0.2 |            4
    0.3 |            4
(3 rows)

-- select regexp_instr with non pushdown func and explicit constant (explain)
--Testcase 1530:
EXPLAIN VERBOSE
SELECT regexp_instr(str2, 'XYZ', 3, 0), pi(), 4.1 FROM s3;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (regexp_instr(str2, 'XYZ'::text, 3, 0)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_instr(str2, 'XYZ'::text, 3, 0), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select regexp_instr with non pushdown func and explicit constant (result)
--Testcase 1531:
SELECT regexp_instr(str2, 'XYZ', 3, 0), pi(), 4.1 FROM s3;
 regexp_instr |        pi         | ?column? 
--------------+-------------------+----------
            4 | 3.141592653589793 |      4.1
            4 | 3.141592653589793 |      4.1
            4 | 3.141592653589793 |      4.1
            4 | 3.141592653589793 |      4.1
            4 | 3.141592653589793 |      4.1
            4 | 3.141592653589793 |      4.1
(6 rows)

-- select regexp_instr with order by (explain)
--Testcase 1532:
EXPLAIN VERBOSE
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 ORDER BY regexp_instr(str2, 'XYZ', 3, 0);
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=12)
   Output: value1, (regexp_instr(str2, 'XYZ'::text, 3, 0))
   Sort Key: (regexp_instr(s3.str2, 'XYZ'::text, 3, 0))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=12)
         Output: value1, (regexp_instr(str2, 'XYZ'::text, 3, 0))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.regexp_instr(str2, 'XYZ'::text, 3, 0) FROM public.s3mysql
(7 rows)

-- select regexp_instr with order by (result)
--Testcase 1533:
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 ORDER BY regexp_instr(str2, 'XYZ', 3, 0);
 value1 | regexp_instr 
--------+--------------
    0.1 |            4
    0.2 |            4
    0.3 |            4
    1.1 |            4
    2.2 |            4
    3.3 |            4
(6 rows)

-- select regexp_instr with order by index (result)
--Testcase 1534:
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 ORDER BY 2,1;
 value1 | regexp_instr 
--------+--------------
    0.1 |            4
    0.2 |            4
    0.3 |            4
    1.1 |            4
    2.2 |            4
    3.3 |            4
(6 rows)

-- select regexp_instr with order by index (result)
--Testcase 1535:
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 ORDER BY 1,2;
 value1 | regexp_instr 
--------+--------------
    0.1 |            4
    0.2 |            4
    0.3 |            4
    1.1 |            4
    2.2 |            4
    3.3 |            4
(6 rows)

-- select regexp_instr with group by (explain)
--Testcase 1536:
EXPLAIN VERBOSE
SELECT count(value1), regexp_instr(str2, 'XYZ', 3, 0) FROM s3 GROUP BY regexp_instr(str2, 'XYZ', 3, 0);
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (regexp_instr(str2, 'XYZ'::text, 3, 0))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.regexp_instr(str2, 'XYZ'::text, 3, 0) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select regexp_instr with group by (result)
--Testcase 1537:
SELECT count(value1), regexp_instr(str2, 'XYZ', 3, 0) FROM s3 GROUP BY regexp_instr(str2, 'XYZ', 3, 0);
 count | regexp_instr 
-------+--------------
     6 |            4
(1 row)

-- select regexp_instr with group by index (result)
--Testcase 1538:
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 GROUP BY 2,1;
 value1 | regexp_instr 
--------+--------------
    0.1 |            4
    0.2 |            4
    0.3 |            4
    1.1 |            4
    2.2 |            4
    3.3 |            4
(6 rows)

-- select regexp_instr with group by having (explain)
--Testcase 1539:
EXPLAIN VERBOSE
SELECT count(value1), regexp_instr(str2, 'XYZ', 3, 0) FROM s3 GROUP BY regexp_instr(str2, 'XYZ', 3, 0), str2 HAVING regexp_instr(str2, 'XYZ', 3, 0) IS NOT NULL;
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (regexp_instr(str2, 'XYZ'::text, 3, 0)), str2
   Filter: ((regexp_instr(s3.str2, 'XYZ'::text, 3, 0)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.regexp_instr(str2, 'XYZ'::text, 3, 0), str2 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.regexp_instr(str2, 'XYZ'::text, 3, 0) IS NOT NULL))
(7 rows)

-- select regexp_instr with group by having (result)
--Testcase 1540:
SELECT count(value1), regexp_instr(str2, 'XYZ', 3, 0) FROM s3 GROUP BY regexp_instr(str2, 'XYZ', 3, 0), str2 HAVING regexp_instr(str2, 'XYZ', 3, 0) IS NOT NULL;
 count | regexp_instr 
-------+--------------
     6 |            4
(1 row)

-- select regexp_instr with group by index having (result)
--Testcase 1541:
SELECT value1, regexp_instr(str2, 'XYZ', 3, 0) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | regexp_instr 
--------+--------------
    1.1 |            4
    2.2 |            4
    3.3 |            4
(3 rows)

--
-- test regexp_like()
--
-- select regexp_like (stub function, explain)
--Testcase 1542:
EXPLAIN VERBOSE
SELECT regexp_instr(str1, 'XY'), regexp_instr(str2, 'XYZ') FROM s3;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (regexp_instr(str1, 'XY'::text)), (regexp_instr(str2, 'XYZ'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_instr(str1, 'XY'::text), public.regexp_instr(str2, 'XYZ'::text) FROM public.s3mysql
(4 rows)

-- select regexp_like (stub function, result)
--Testcase 1543:
SELECT regexp_instr(str1, 'XY'), regexp_instr(str2, 'XYZ') FROM s3;
 regexp_instr | regexp_instr 
--------------+--------------
            4 |            4
            4 |            4
            4 |            4
            4 |            4
            4 |            4
            4 |            4
(6 rows)

-- select regexp_like (stub function, explain)
--Testcase 1544:
EXPLAIN VERBOSE
SELECT regexp_like('   XyZ   ', str2, 'i') FROM s3;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (regexp_like('   XyZ   '::text, str2, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_like('   XyZ   '::text, str2, 'i'::text) FROM public.s3mysql
(4 rows)

-- select regexp_like (stub function, result)
--Testcase 1545:
SELECT regexp_like('   XyZ   ', str2, 'i') FROM s3;
 regexp_like 
-------------
           1
           1
           1
           1
           1
           1
(6 rows)

-- select regexp_like (stub function, not pushdown constraints, explain)
--Testcase 1546:
EXPLAIN VERBOSE
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 WHERE to_hex(value2) = '64';
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=12)
   Output: value1, (regexp_like('   XyZ   '::text, str2, 'i'::text))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.regexp_like('   XyZ   '::text, str2, 'i'::text), value2 FROM public.s3mysql
(5 rows)

-- select regexp_like (stub function, not pushdown constraints, result)
--Testcase 1547:
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 WHERE to_hex(value2) = '64';
 value1 | regexp_like 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
(3 rows)

-- select regexp_like (stub function, pushdown constraints, explain)
--Testcase 1548:
EXPLAIN VERBOSE
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 WHERE value2 != 200;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=12)
   Output: value1, (regexp_like('   XyZ   '::text, str2, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.regexp_like('   XyZ   '::text, str2, 'i'::text) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select regexp_like (stub function, pushdown constraints, result)
--Testcase 1549:
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 WHERE value2 != 200;
 value1 | regexp_like 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
(3 rows)

-- select regexp_like with non pushdown func and explicit constant (explain)
--Testcase 1550:
EXPLAIN VERBOSE
SELECT regexp_like('   XyZ   ', str2, 'i'), pi(), 4.1 FROM s3;
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (regexp_like('   XyZ   '::text, str2, 'i'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_like('   XyZ   '::text, str2, 'i'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select regexp_like with non pushdown func and explicit constant (result)
--Testcase 1551:
SELECT regexp_like('   XyZ   ', str2, 'i'), pi(), 4.1 FROM s3;
 regexp_like |        pi         | ?column? 
-------------+-------------------+----------
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
           1 | 3.141592653589793 |      4.1
(6 rows)

-- select regexp_like with order by (explain)
--Testcase 1552:
EXPLAIN VERBOSE
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 ORDER BY regexp_like('   XyZ   ', str2, 'i');
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=12)
   Output: value1, (regexp_like('   XyZ   '::text, str2, 'i'::text))
   Sort Key: (regexp_like('   XyZ   '::text, s3.str2, 'i'::text))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=12)
         Output: value1, (regexp_like('   XyZ   '::text, str2, 'i'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.regexp_like('   XyZ   '::text, str2, 'i'::text) FROM public.s3mysql
(7 rows)

-- select regexp_like with order by (result)
--Testcase 1553:
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 ORDER BY regexp_like('   XyZ   ', str2, 'i');
 value1 | regexp_like 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
    1.1 |           1
    2.2 |           1
    3.3 |           1
(6 rows)

-- select regexp_like with order by index (result)
--Testcase 1554:
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 ORDER BY 2,1;
 value1 | regexp_like 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
    1.1 |           1
    2.2 |           1
    3.3 |           1
(6 rows)

-- select regexp_like with order by index (result)
--Testcase 1555:
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 ORDER BY 1,2;
 value1 | regexp_like 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
    1.1 |           1
    2.2 |           1
    3.3 |           1
(6 rows)

-- select regexp_like with group by (explain)
--Testcase 1556:
EXPLAIN VERBOSE
SELECT count(value1), regexp_like('   XyZ   ', str2, 'i') FROM s3 GROUP BY regexp_like('   XyZ   ', str2, 'i');
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (regexp_like('   XyZ   '::text, str2, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.regexp_like('   XyZ   '::text, str2, 'i'::text) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select regexp_like with group by (result)
--Testcase 1557:
SELECT count(value1), regexp_like('   XyZ   ', str2, 'i') FROM s3 GROUP BY regexp_like('   XyZ   ', str2, 'i');
 count | regexp_like 
-------+-------------
     6 |           1
(1 row)

-- select regexp_like with group by index (result)
--Testcase 1558:
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 GROUP BY 2,1;
 value1 | regexp_like 
--------+-------------
    0.1 |           1
    0.2 |           1
    0.3 |           1
    1.1 |           1
    2.2 |           1
    3.3 |           1
(6 rows)

-- select regexp_like with group by having (explain)
--Testcase 1559:
EXPLAIN VERBOSE
SELECT count(value1), regexp_like('   XyZ   ', str2, 'i') FROM s3 GROUP BY regexp_like('   XyZ   ', str2, 'i'), str2 HAVING regexp_like('   XyZ   ', str2, 'i') > 0;
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (regexp_like('   XyZ   '::text, str2, 'i'::text)), str2
   Filter: ((regexp_like('   XyZ   '::text, s3.str2, 'i'::text)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.regexp_like('   XyZ   '::text, str2, 'i'::text), str2 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.regexp_like('   XyZ   '::text, str2, 'i'::text) > 0))
(7 rows)

-- select regexp_like with group by having (result)
--Testcase 1560:
SELECT count(value1), regexp_like('   XyZ   ', str2, 'i') FROM s3 GROUP BY regexp_like('   XyZ   ', str2, 'i'), str2 HAVING regexp_like('   XyZ   ', str2, 'i') > 0;
 count | regexp_like 
-------+-------------
     6 |           1
(1 row)

-- select regexp_like with group by index having (result)
--Testcase 1561:
SELECT value1, regexp_like('   XyZ   ', str2, 'i') FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | regexp_like 
--------+-------------
    1.1 |           1
    2.2 |           1
    3.3 |           1
(3 rows)

--
-- test regexp_replace()
--
-- select regexp_replace (stub function, explain)
--Testcase 1562:
EXPLAIN VERBOSE
SELECT regexp_replace(str1, 'X', 'x') FROM s3;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=32)
   Output: (regexp_replace(str1, 'X'::text, 'x'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT regexp_replace(str1, 'X'::text, 'x'::text) FROM public.s3mysql
(4 rows)

-- select regexp_replace (stub function, result)
--Testcase 1563:
SELECT regexp_replace(str1, 'X', 'x') FROM s3;
 regexp_replace 
----------------
 ---xYZ---
 ---xYZ---
 ---xYZ---
 ---xYZ---
 ---xYZ---
 ---xYZ---
(6 rows)

-- select regexp_replace (stub function, explain)
--Testcase 1564:
EXPLAIN VERBOSE
SELECT regexp_replace(str1, 'Y', 'y', 3) FROM s3;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_replace(str1, 'Y'::text, 'y'::text, 3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_replace(str1, 'Y'::text, 'y'::text, 3) FROM public.s3mysql
(4 rows)

-- select regexp_replace (stub function, result)
--Testcase 1565:
SELECT regexp_replace(str1, 'Y', 'y', 3) FROM s3;
 regexp_replace 
----------------
 ---XyZ---
 ---XyZ---
 ---XyZ---
 ---XyZ---
 ---XyZ---
 ---XyZ---
(6 rows)

-- select regexp_replace (stub function, explain)
--Testcase 1566:
EXPLAIN VERBOSE
SELECT regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3) FROM public.s3mysql
(4 rows)

-- select regexp_replace (stub function, result)
--Testcase 1567:
SELECT regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3;
 regexp_replace 
----------------
 ---XYZ---
 ---XYZ---
 ---XYZ---
 ---XYZ---
 ---XYZ---
 ---XYZ---
(6 rows)

-- select regexp_replace (stub function, explain)
--Testcase 1568:
EXPLAIN VERBOSE
SELECT regexp_replace(str1, 'y', 'K', 3, 0, 'i') FROM s3;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_replace(str1, 'y'::text, 'K'::text, 3, 0, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_replace(str1, 'y'::text, 'K'::text, 3, 0, 'i'::text) FROM public.s3mysql
(4 rows)

-- select regexp_replace (stub function, result)
--Testcase 1569:
SELECT regexp_replace(str1, 'y', 'K', 3, 0, 'i') FROM s3;
 regexp_replace 
----------------
 ---XKZ---
 ---XKZ---
 ---XKZ---
 ---XKZ---
 ---XKZ---
 ---XKZ---
(6 rows)

-- select regexp_replace (stub function, explain)
--Testcase 1570:
EXPLAIN VERBOSE
SELECT regexp_replace(str1, 'y', NULL, 3, 3, 'i') FROM s3;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_replace(str1, 'y'::text, NULL::text, 3, 3, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_replace(str1, 'y'::text, NULL::text, 3, 3, 'i'::text) FROM public.s3mysql
(4 rows)

-- select regexp_replace (stub function, result)
--Testcase 1571:
SELECT regexp_replace(str1, 'y', NULL, 3, 3, 'i') FROM s3;
 regexp_replace 
----------------
 
 
 
 
 
 
(6 rows)

-- select regexp_replace (stub function, not pushdown constraints, explain)
--Testcase 1572:
EXPLAIN VERBOSE
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 WHERE to_hex(value2) = '64';
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3), value2 FROM public.s3mysql
(5 rows)

-- select regexp_replace (stub function, not pushdown constraints, result)
--Testcase 1573:
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 WHERE to_hex(value2) = '64';
 value1 | regexp_replace 
--------+----------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
(3 rows)

-- select regexp_replace (stub function, pushdown constraints, explain)
--Testcase 1574:
EXPLAIN VERBOSE
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 WHERE value2 != 200;
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select regexp_replace (stub function, pushdown constraints, result)
--Testcase 1575:
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 WHERE value2 != 200;
 value1 | regexp_replace 
--------+----------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
(3 rows)

-- select regexp_replace with non pushdown func and explicit constant (explain)
--Testcase 1576:
EXPLAIN VERBOSE
SELECT regexp_replace(str1, 'Y', 'y', 3, 3), pi(), 4.1 FROM s3;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select regexp_replace with non pushdown func and explicit constant (result)
--Testcase 1577:
SELECT regexp_replace(str1, 'Y', 'y', 3, 3), pi(), 4.1 FROM s3;
 regexp_replace |        pi         | ?column? 
----------------+-------------------+----------
 ---XYZ---      | 3.141592653589793 |      4.1
 ---XYZ---      | 3.141592653589793 |      4.1
 ---XYZ---      | 3.141592653589793 |      4.1
 ---XYZ---      | 3.141592653589793 |      4.1
 ---XYZ---      | 3.141592653589793 |      4.1
 ---XYZ---      | 3.141592653589793 |      4.1
(6 rows)

-- select regexp_replace with order by (explain)
--Testcase 1578:
EXPLAIN VERBOSE
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 ORDER BY regexp_replace(str1, 'Y', 'y', 3, 3);
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3))
   Sort Key: (regexp_replace(s3.str1, 'Y'::text, 'y'::text, 3, 3))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3) FROM public.s3mysql
(7 rows)

-- select regexp_replace with order by (result)
--Testcase 1579:
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 ORDER BY regexp_replace(str1, 'Y', 'y', 3, 3);
 value1 | regexp_replace 
--------+----------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select regexp_replace with order by index (result)
--Testcase 1580:
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 ORDER BY 2,1;
 value1 | regexp_replace 
--------+----------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select regexp_replace with order by index (result)
--Testcase 1581:
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 ORDER BY 1,2;
 value1 | regexp_replace 
--------+----------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select regexp_replace with group by (explain)
--Testcase 1582:
EXPLAIN VERBOSE
SELECT count(value1), regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 GROUP BY regexp_replace(str1, 'Y', 'y', 3, 3);
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select regexp_replace with group by (result)
--Testcase 1583:
SELECT count(value1), regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 GROUP BY regexp_replace(str1, 'Y', 'y', 3, 3);
 count | regexp_replace 
-------+----------------
     6 | ---XYZ---
(1 row)

-- select regexp_replace with group by index (result)
--Testcase 1584:
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 GROUP BY 2,1;
 value1 | regexp_replace 
--------+----------------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select regexp_replace with group by having (explain)
--Testcase 1585:
EXPLAIN VERBOSE
SELECT count(value1), regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 GROUP BY regexp_replace(str1, 'Y', 'y', 3, 3), str1 HAVING regexp_replace(str1, 'Y', 'y', 3, 3) IS NOT NULL;
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3)), str1
   Filter: ((regexp_replace(s3.str1, 'Y'::text, 'y'::text, 3, 3)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3), str1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.regexp_replace(str1, 'Y'::text, 'y'::text, 3, 3) IS NOT NULL))
(7 rows)

-- select regexp_replace with group by having (result)
--Testcase 1586:
SELECT count(value1), regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 GROUP BY regexp_replace(str1, 'Y', 'y', 3, 3), str1 HAVING regexp_replace(str1, 'Y', 'y', 3, 3) IS NOT NULL;
 count | regexp_replace 
-------+----------------
     6 | ---XYZ---
(1 row)

-- select regexp_replace with group by index having (result)
--Testcase 1587:
SELECT value1, regexp_replace(str1, 'Y', 'y', 3, 3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | regexp_replace 
--------+----------------
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(3 rows)

--
-- test regexp_substr()
--
-- select regexp_substr (stub function, explain)
--Testcase 1588:
EXPLAIN VERBOSE
SELECT regexp_substr(str1, 'XYZ') FROM s3;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_substr(str1, 'XYZ'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_substr(str1, 'XYZ'::text) FROM public.s3mysql
(4 rows)

-- select regexp_substr (stub function, result)
--Testcase 1589:
SELECT regexp_substr(str1, 'XYZ') FROM s3;
 regexp_substr 
---------------
 XYZ
 XYZ
 XYZ
 XYZ
 XYZ
 XYZ
(6 rows)

-- select regexp_substr (stub function, explain)
--Testcase 1590:
EXPLAIN VERBOSE
SELECT regexp_substr(str1, 'XYZ', 3) FROM s3;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_substr(str1, 'XYZ'::text, 3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_substr(str1, 'XYZ'::text, 3) FROM public.s3mysql
(4 rows)

-- select regexp_substr (stub function, result)
--Testcase 1591:
SELECT regexp_substr(str1, 'XYZ', 3) FROM s3;
 regexp_substr 
---------------
 XYZ
 XYZ
 XYZ
 XYZ
 XYZ
 XYZ
(6 rows)

-- select regexp_substr (stub function, explain)
--Testcase 1592:
EXPLAIN VERBOSE
SELECT regexp_substr(str2, 'XYZ', 4, 0) FROM s3;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_substr(str2, 'XYZ'::text, 4, 0))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_substr(str2, 'XYZ'::text, 4, 0) FROM public.s3mysql
(4 rows)

-- select regexp_substr (stub function, result)
--Testcase 1593:
SELECT regexp_substr(str2, 'XYZ', 4, 0) FROM s3;
 regexp_substr 
---------------
 XYZ
 XYZ
 XYZ
 XYZ
 XYZ
 XYZ
(6 rows)

-- select regexp_substr (stub function, explain)
--Testcase 1594:
EXPLAIN VERBOSE
SELECT regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3;
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text) FROM public.s3mysql
(4 rows)

-- select regexp_substr (stub function, result)
--Testcase 1595:
SELECT regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3;
 regexp_substr 
---------------
 XYZ
 XYZ
 XYZ
 XYZ
 XYZ
 XYZ
(6 rows)

-- select regexp_substr (stub function, explain)
--Testcase 1596:
EXPLAIN VERBOSE
SELECT regexp_substr(str1, NULL, 4, 0, 'i') FROM s3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (regexp_substr(str1, NULL::text, 4, 0, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_substr(str1, NULL::text, 4, 0, 'i'::text) FROM public.s3mysql
(4 rows)

-- select regexp_substr (stub function, result)
--Testcase 1597:
SELECT regexp_substr(str1, NULL, 4, 0, 'i') FROM s3;
 regexp_substr 
---------------
 
 
 
 
 
 
(6 rows)

-- select regexp_substr (stub function, not pushdown constraints, explain)
--Testcase 1598:
EXPLAIN VERBOSE
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 WHERE to_hex(value2) = '64';
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text), value2 FROM public.s3mysql
(5 rows)

-- select regexp_substr (stub function, not pushdown constraints, result)
--Testcase 1599:
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 WHERE to_hex(value2) = '64';
 value1 | regexp_substr 
--------+---------------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
(3 rows)

-- select regexp_substr (stub function, pushdown constraints, explain)
--Testcase 1600:
EXPLAIN VERBOSE
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 WHERE value2 != 200;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select regexp_substr (stub function, pushdown constraints, result)
--Testcase 1601:
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 WHERE value2 != 200;
 value1 | regexp_substr 
--------+---------------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
(3 rows)

-- select regexp_substr with non pushdown func and explicit constant (explain)
--Testcase 1602:
EXPLAIN VERBOSE
SELECT regexp_substr(str1, 'xyz', 4, 0, 'i'), pi(), 4.1 FROM s3;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select regexp_substr with non pushdown func and explicit constant (result)
--Testcase 1603:
SELECT regexp_substr(str1, 'xyz', 4, 0, 'i'), pi(), 4.1 FROM s3;
 regexp_substr |        pi         | ?column? 
---------------+-------------------+----------
 XYZ           | 3.141592653589793 |      4.1
 XYZ           | 3.141592653589793 |      4.1
 XYZ           | 3.141592653589793 |      4.1
 XYZ           | 3.141592653589793 |      4.1
 XYZ           | 3.141592653589793 |      4.1
 XYZ           | 3.141592653589793 |      4.1
(6 rows)

-- select regexp_substr with order by (explain)
--Testcase 1604:
EXPLAIN VERBOSE
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 ORDER BY regexp_substr(str1, 'xyz', 4, 0, 'i');
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text))
   Sort Key: (regexp_substr(s3.str1, 'xyz'::text, 4, 0, 'i'::text))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text) FROM public.s3mysql
(7 rows)

-- select regexp_substr with order by (result)
--Testcase 1605:
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 ORDER BY regexp_substr(str1, 'xyz', 4, 0, 'i');
 value1 | regexp_substr 
--------+---------------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(6 rows)

-- select regexp_substr with order by index (result)
--Testcase 1606:
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 ORDER BY 2,1;
 value1 | regexp_substr 
--------+---------------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(6 rows)

-- select regexp_substr with order by index (result)
--Testcase 1607:
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 ORDER BY 1,2;
 value1 | regexp_substr 
--------+---------------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(6 rows)

-- select regexp_substr with group by (explain)
--Testcase 1608:
EXPLAIN VERBOSE
SELECT count(value1), regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 GROUP BY regexp_substr(str1, 'xyz', 4, 0, 'i');
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select regexp_substr with group by (result)
--Testcase 1609:
SELECT count(value1), regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 GROUP BY regexp_substr(str1, 'xyz', 4, 0, 'i');
 count | regexp_substr 
-------+---------------
     6 | XYZ
(1 row)

-- select regexp_substr with group by index (result)
--Testcase 1610:
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 GROUP BY 2,1;
 value1 | regexp_substr 
--------+---------------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(6 rows)

-- select regexp_substr with group by having (explain)
--Testcase 1611:
EXPLAIN VERBOSE
SELECT count(value1), regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 GROUP BY regexp_substr(str1, 'xyz', 4, 0, 'i'), str1 HAVING regexp_substr(str1, 'xyz', 4, 0, 'i') IS NOT NULL;
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text)), str1
   Filter: ((regexp_substr(s3.str1, 'xyz'::text, 4, 0, 'i'::text)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text), str1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.regexp_substr(str1, 'xyz'::text, 4, 0, 'i'::text) IS NOT NULL))
(7 rows)

-- select regexp_substr with group by having (result)
--Testcase 1612:
SELECT count(value1), regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 GROUP BY regexp_substr(str1, 'xyz', 4, 0, 'i'), str1 HAVING regexp_substr(str1, 'xyz', 4, 0, 'i') IS NOT NULL;
 count | regexp_substr 
-------+---------------
     6 | XYZ
(1 row)

-- select regexp_substr with group by index having (result)
--Testcase 1613:
SELECT value1, regexp_substr(str1, 'xyz', 4, 0, 'i') FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | regexp_substr 
--------+---------------
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(3 rows)

--
-- test repeat()
--
-- select repeat (stub function, explain)
--Testcase 1614:
EXPLAIN VERBOSE
SELECT repeat(str1, 3), repeat(str2, 3) FROM s3;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (repeat(str1, 3)), (repeat(str2, 3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT repeat(str1, 3), repeat(str2, 3) FROM public.s3mysql
(4 rows)

-- select repeat (stub function, result)
--Testcase 1615:
SELECT repeat(str1, 3), repeat(str2, 3) FROM s3;
           repeat            |           repeat            
-----------------------------+-----------------------------
 ---XYZ------XYZ------XYZ--- |    XYZ      XYZ      XYZ   
 ---XYZ------XYZ------XYZ--- |    XYZ      XYZ      XYZ   
 ---XYZ------XYZ------XYZ--- |    XYZ      XYZ      XYZ   
 ---XYZ------XYZ------XYZ--- |    XYZ      XYZ      XYZ   
 ---XYZ------XYZ------XYZ--- |    XYZ      XYZ      XYZ   
 ---XYZ------XYZ------XYZ--- |    XYZ      XYZ      XYZ   
(6 rows)

-- select repeat (stub function, not pushdown constraints, explain)
--Testcase 1616:
EXPLAIN VERBOSE
SELECT value1, repeat(str1, 3) FROM s3 WHERE to_hex(value2) = '64';
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (repeat(str1, 3))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, repeat(str1, 3), value2 FROM public.s3mysql
(5 rows)

-- select repeat (stub function, not pushdown constraints, result)
--Testcase 1617:
SELECT value1, repeat(str1, 3) FROM s3 WHERE to_hex(value2) = '64';
 value1 |           repeat            
--------+-----------------------------
    0.1 | ---XYZ------XYZ------XYZ---
    0.2 | ---XYZ------XYZ------XYZ---
    0.3 | ---XYZ------XYZ------XYZ---
(3 rows)

-- select repeat (stub function, pushdown constraints, explain)
--Testcase 1618:
EXPLAIN VERBOSE
SELECT value1, repeat(str1, 3) FROM s3 WHERE value2 != 200;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (repeat(str1, 3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, repeat(str1, 3) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select repeat (stub function, pushdown constraints, result)
--Testcase 1619:
SELECT value1, repeat(str1, 3) FROM s3 WHERE value2 != 200;
 value1 |           repeat            
--------+-----------------------------
    0.1 | ---XYZ------XYZ------XYZ---
    0.2 | ---XYZ------XYZ------XYZ---
    0.3 | ---XYZ------XYZ------XYZ---
(3 rows)

-- select repeat with non pushdown func and explicit constant (explain)
--Testcase 1620:
EXPLAIN VERBOSE
SELECT repeat(str1, 3), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (repeat(str1, 3)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT repeat(str1, 3), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select repeat with non pushdown func and explicit constant (result)
--Testcase 1621:
SELECT repeat(str1, 3), pi(), 4.1 FROM s3;
           repeat            |        pi         | ?column? 
-----------------------------+-------------------+----------
 ---XYZ------XYZ------XYZ--- | 3.141592653589793 |      4.1
 ---XYZ------XYZ------XYZ--- | 3.141592653589793 |      4.1
 ---XYZ------XYZ------XYZ--- | 3.141592653589793 |      4.1
 ---XYZ------XYZ------XYZ--- | 3.141592653589793 |      4.1
 ---XYZ------XYZ------XYZ--- | 3.141592653589793 |      4.1
 ---XYZ------XYZ------XYZ--- | 3.141592653589793 |      4.1
(6 rows)

-- select repeat with order by (explain)
--Testcase 1622:
EXPLAIN VERBOSE
SELECT value1, repeat(str1, 3) FROM s3 ORDER BY repeat(str1, 3);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (repeat(str1, 3))
   Sort Key: (repeat(s3.str1, 3))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (repeat(str1, 3))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, repeat(str1, 3) FROM public.s3mysql
(7 rows)

-- select repeat with order by (result)
--Testcase 1623:
SELECT value1, repeat(str1, 3) FROM s3 ORDER BY repeat(str1, 3);
 value1 |           repeat            
--------+-----------------------------
    0.1 | ---XYZ------XYZ------XYZ---
    0.2 | ---XYZ------XYZ------XYZ---
    0.3 | ---XYZ------XYZ------XYZ---
    1.1 | ---XYZ------XYZ------XYZ---
    2.2 | ---XYZ------XYZ------XYZ---
    3.3 | ---XYZ------XYZ------XYZ---
(6 rows)

-- select repeat with order by index (result)
--Testcase 1624:
SELECT value1, repeat(str1, 3) FROM s3 ORDER BY 2,1;
 value1 |           repeat            
--------+-----------------------------
    0.1 | ---XYZ------XYZ------XYZ---
    0.2 | ---XYZ------XYZ------XYZ---
    0.3 | ---XYZ------XYZ------XYZ---
    1.1 | ---XYZ------XYZ------XYZ---
    2.2 | ---XYZ------XYZ------XYZ---
    3.3 | ---XYZ------XYZ------XYZ---
(6 rows)

-- select repeat with order by index (result)
--Testcase 1625:
SELECT value1, repeat(str1, 3) FROM s3 ORDER BY 1,2;
 value1 |           repeat            
--------+-----------------------------
    0.1 | ---XYZ------XYZ------XYZ---
    0.2 | ---XYZ------XYZ------XYZ---
    0.3 | ---XYZ------XYZ------XYZ---
    1.1 | ---XYZ------XYZ------XYZ---
    2.2 | ---XYZ------XYZ------XYZ---
    3.3 | ---XYZ------XYZ------XYZ---
(6 rows)

-- select repeat with group by (explain)
--Testcase 1626:
EXPLAIN VERBOSE
SELECT count(value1), repeat(str1, 3) FROM s3 GROUP BY repeat(str1, 3);
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (repeat(str1, 3))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), repeat(str1, 3) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select repeat with group by (result)
--Testcase 1627:
SELECT count(value1), repeat(str1, 3) FROM s3 GROUP BY repeat(str1, 3);
 count |           repeat            
-------+-----------------------------
     6 | ---XYZ------XYZ------XYZ---
(1 row)

-- select repeat with group by index (result)
--Testcase 1628:
SELECT value1, repeat(str1, 3) FROM s3 GROUP BY 2,1;
 value1 |           repeat            
--------+-----------------------------
    0.1 | ---XYZ------XYZ------XYZ---
    0.2 | ---XYZ------XYZ------XYZ---
    0.3 | ---XYZ------XYZ------XYZ---
    1.1 | ---XYZ------XYZ------XYZ---
    2.2 | ---XYZ------XYZ------XYZ---
    3.3 | ---XYZ------XYZ------XYZ---
(6 rows)

-- select repeat with group by having (explain)
--Testcase 1629:
EXPLAIN VERBOSE
SELECT count(value1), repeat(str1, 3) FROM s3 GROUP BY repeat(str1, 3), str1 HAVING repeat(str1, 3) IS NOT NULL;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (repeat(str1, 3)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), repeat(str1, 3), str1 FROM public.s3mysql WHERE ((repeat(str1, 3) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select repeat with group by having (result)
--Testcase 1630:
SELECT count(value1), repeat(str1, 3) FROM s3 GROUP BY repeat(str1, 3), str1 HAVING repeat(str1, 3) IS NOT NULL;
 count |           repeat            
-------+-----------------------------
     6 | ---XYZ------XYZ------XYZ---
(1 row)

-- select repeat with group by index having (result)
--Testcase 1631:
SELECT value1, repeat(str1, 3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |           repeat            
--------+-----------------------------
    1.1 | ---XYZ------XYZ------XYZ---
    2.2 | ---XYZ------XYZ------XYZ---
    3.3 | ---XYZ------XYZ------XYZ---
(3 rows)

--
-- test replace()
--
-- select replace (stub function, explain)
--Testcase 1632:
EXPLAIN VERBOSE
SELECT replace(str1, 'XYZ', 'ABC'), replace(str2, 'XYZ', 'ABC') FROM s3;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (replace(str1, 'XYZ'::text, 'ABC'::text)), (replace(str2, 'XYZ'::text, 'ABC'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT replace(str1, 'XYZ'::text, 'ABC'::text), replace(str2, 'XYZ'::text, 'ABC'::text) FROM public.s3mysql
(4 rows)

-- select replace (stub function, result)
--Testcase 1633:
SELECT replace(str1, 'XYZ', 'ABC'), replace(str2, 'XYZ', 'ABC') FROM s3;
  replace  |  replace  
-----------+-----------
 ---ABC--- |    ABC   
 ---ABC--- |    ABC   
 ---ABC--- |    ABC   
 ---ABC--- |    ABC   
 ---ABC--- |    ABC   
 ---ABC--- |    ABC   
(6 rows)

-- select replace (stub function, not pushdown constraints, explain)
--Testcase 1634:
EXPLAIN VERBOSE
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 WHERE to_hex(value2) = '64';
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (replace(str1, 'XYZ'::text, 'ABC'::text))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, replace(str1, 'XYZ'::text, 'ABC'::text), value2 FROM public.s3mysql
(5 rows)

-- select replace (stub function, not pushdown constraints, result)
--Testcase 1635:
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 WHERE to_hex(value2) = '64';
 value1 |  replace  
--------+-----------
    0.1 | ---ABC---
    0.2 | ---ABC---
    0.3 | ---ABC---
(3 rows)

-- select replace (stub function, pushdown constraints, explain)
--Testcase 1636:
EXPLAIN VERBOSE
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 WHERE value2 != 200;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (replace(str1, 'XYZ'::text, 'ABC'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, replace(str1, 'XYZ'::text, 'ABC'::text) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select replace (stub function, pushdown constraints, result)
--Testcase 1637:
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 WHERE value2 != 200;
 value1 |  replace  
--------+-----------
    0.1 | ---ABC---
    0.2 | ---ABC---
    0.3 | ---ABC---
(3 rows)

-- select replace with non pushdown func and explicit constant (explain)
--Testcase 1638:
EXPLAIN VERBOSE
SELECT replace(str1, 'XYZ', 'ABC'), pi(), 4.1 FROM s3;
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (replace(str1, 'XYZ'::text, 'ABC'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT replace(str1, 'XYZ'::text, 'ABC'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select replace with non pushdown func and explicit constant (result)
--Testcase 1639:
SELECT replace(str1, 'XYZ', 'ABC'), pi(), 4.1 FROM s3;
  replace  |        pi         | ?column? 
-----------+-------------------+----------
 ---ABC--- | 3.141592653589793 |      4.1
 ---ABC--- | 3.141592653589793 |      4.1
 ---ABC--- | 3.141592653589793 |      4.1
 ---ABC--- | 3.141592653589793 |      4.1
 ---ABC--- | 3.141592653589793 |      4.1
 ---ABC--- | 3.141592653589793 |      4.1
(6 rows)

-- select replace with order by (explain)
--Testcase 1640:
EXPLAIN VERBOSE
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 ORDER BY replace(str1, 'XYZ', 'ABC');
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (replace(str1, 'XYZ'::text, 'ABC'::text))
   Sort Key: (replace(s3.str1, 'XYZ'::text, 'ABC'::text))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (replace(str1, 'XYZ'::text, 'ABC'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, replace(str1, 'XYZ'::text, 'ABC'::text) FROM public.s3mysql
(7 rows)

-- select replace with order by (result)
--Testcase 1641:
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 ORDER BY replace(str1, 'XYZ', 'ABC');
 value1 |  replace  
--------+-----------
    0.1 | ---ABC---
    0.2 | ---ABC---
    0.3 | ---ABC---
    1.1 | ---ABC---
    2.2 | ---ABC---
    3.3 | ---ABC---
(6 rows)

-- select replace with order by index (result)
--Testcase 1642:
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 ORDER BY 2,1;
 value1 |  replace  
--------+-----------
    0.1 | ---ABC---
    0.2 | ---ABC---
    0.3 | ---ABC---
    1.1 | ---ABC---
    2.2 | ---ABC---
    3.3 | ---ABC---
(6 rows)

-- select replace with order by index (result)
--Testcase 1643:
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 ORDER BY 1,2;
 value1 |  replace  
--------+-----------
    0.1 | ---ABC---
    0.2 | ---ABC---
    0.3 | ---ABC---
    1.1 | ---ABC---
    2.2 | ---ABC---
    3.3 | ---ABC---
(6 rows)

-- select replace with group by (explain)
--Testcase 1644:
EXPLAIN VERBOSE
SELECT count(value1), replace(str1, 'XYZ', 'ABC') FROM s3 GROUP BY replace(str1, 'XYZ', 'ABC');
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (replace(str1, 'XYZ'::text, 'ABC'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), replace(str1, 'XYZ'::text, 'ABC'::text) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select replace with group by (result)
--Testcase 1645:
SELECT count(value1), replace(str1, 'XYZ', 'ABC') FROM s3 GROUP BY replace(str1, 'XYZ', 'ABC');
 count |  replace  
-------+-----------
     6 | ---ABC---
(1 row)

-- select replace with group by index (result)
--Testcase 1646:
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 GROUP BY 2,1;
 value1 |  replace  
--------+-----------
    0.1 | ---ABC---
    0.2 | ---ABC---
    0.3 | ---ABC---
    1.1 | ---ABC---
    2.2 | ---ABC---
    3.3 | ---ABC---
(6 rows)

-- select replace with group by having (explain)
--Testcase 1647:
EXPLAIN VERBOSE
SELECT count(value1), replace(str1, 'XYZ', 'ABC') FROM s3 GROUP BY replace(str1, 'XYZ', 'ABC'), str1 HAVING replace(str1, 'XYZ', 'ABC') IS NOT NULL;
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (replace(str1, 'XYZ'::text, 'ABC'::text)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), replace(str1, 'XYZ'::text, 'ABC'::text), str1 FROM public.s3mysql WHERE ((replace(str1, 'XYZ'::text, 'ABC'::text) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select replace with group by having (result)
--Testcase 1648:
SELECT count(value1), replace(str1, 'XYZ', 'ABC') FROM s3 GROUP BY replace(str1, 'XYZ', 'ABC'), str1 HAVING replace(str1, 'XYZ', 'ABC') IS NOT NULL;
 count |  replace  
-------+-----------
     6 | ---ABC---
(1 row)

-- select replace with group by index having (result)
--Testcase 1649:
SELECT value1, replace(str1, 'XYZ', 'ABC') FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |  replace  
--------+-----------
    1.1 | ---ABC---
    2.2 | ---ABC---
    3.3 | ---ABC---
(3 rows)

--
-- test reverse()
--
-- select reverse (stub function, explain)
--Testcase 1650:
EXPLAIN VERBOSE
SELECT reverse(str1), reverse(str2) FROM s3;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (reverse(str1)), (reverse(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT reverse(str1), reverse(str2) FROM public.s3mysql
(4 rows)

-- select reverse (stub function, result)
--Testcase 1651:
SELECT reverse(str1), reverse(str2) FROM s3;
  reverse  |  reverse  
-----------+-----------
 ---ZYX--- |    ZYX   
 ---ZYX--- |    ZYX   
 ---ZYX--- |    ZYX   
 ---ZYX--- |    ZYX   
 ---ZYX--- |    ZYX   
 ---ZYX--- |    ZYX   
(6 rows)

-- select reverse (stub function, not pushdown constraints, explain)
--Testcase 1652:
EXPLAIN VERBOSE
SELECT value1, reverse(str1) FROM s3 WHERE to_hex(value2) = '64';
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (reverse(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, reverse(str1), value2 FROM public.s3mysql
(5 rows)

-- select reverse (stub function, not pushdown constraints, result)
--Testcase 1653:
SELECT value1, reverse(str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 |  reverse  
--------+-----------
    0.1 | ---ZYX---
    0.2 | ---ZYX---
    0.3 | ---ZYX---
(3 rows)

-- select reverse (stub function, pushdown constraints, explain)
--Testcase 1654:
EXPLAIN VERBOSE
SELECT value1, reverse(str1) FROM s3 WHERE value2 != 200;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (reverse(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, reverse(str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select reverse (stub function, pushdown constraints, result)
--Testcase 1655:
SELECT value1, reverse(str1) FROM s3 WHERE value2 != 200;
 value1 |  reverse  
--------+-----------
    0.1 | ---ZYX---
    0.2 | ---ZYX---
    0.3 | ---ZYX---
(3 rows)

-- select reverse with non pushdown func and explicit constant (explain)
--Testcase 1656:
EXPLAIN VERBOSE
SELECT reverse(str1), pi(), 4.1 FROM s3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (reverse(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT reverse(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select reverse with non pushdown func and explicit constant (result)
--Testcase 1657:
SELECT reverse(str1), pi(), 4.1 FROM s3;
  reverse  |        pi         | ?column? 
-----------+-------------------+----------
 ---ZYX--- | 3.141592653589793 |      4.1
 ---ZYX--- | 3.141592653589793 |      4.1
 ---ZYX--- | 3.141592653589793 |      4.1
 ---ZYX--- | 3.141592653589793 |      4.1
 ---ZYX--- | 3.141592653589793 |      4.1
 ---ZYX--- | 3.141592653589793 |      4.1
(6 rows)

-- select reverse with order by (explain)
--Testcase 1658:
EXPLAIN VERBOSE
SELECT value1, reverse(str1) FROM s3 ORDER BY reverse(str1);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (reverse(str1))
   Sort Key: (reverse(s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (reverse(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, reverse(str1) FROM public.s3mysql
(7 rows)

-- select reverse with order by (result)
--Testcase 1659:
SELECT value1, reverse(str1) FROM s3 ORDER BY reverse(str1);
 value1 |  reverse  
--------+-----------
    0.1 | ---ZYX---
    0.2 | ---ZYX---
    0.3 | ---ZYX---
    1.1 | ---ZYX---
    2.2 | ---ZYX---
    3.3 | ---ZYX---
(6 rows)

-- select reverse with order by index (result)
--Testcase 1660:
SELECT value1, reverse(str1) FROM s3 ORDER BY 2,1;
 value1 |  reverse  
--------+-----------
    0.1 | ---ZYX---
    0.2 | ---ZYX---
    0.3 | ---ZYX---
    1.1 | ---ZYX---
    2.2 | ---ZYX---
    3.3 | ---ZYX---
(6 rows)

-- select reverse with order by index (result)
--Testcase 1661:
SELECT value1, reverse(str1) FROM s3 ORDER BY 1,2;
 value1 |  reverse  
--------+-----------
    0.1 | ---ZYX---
    0.2 | ---ZYX---
    0.3 | ---ZYX---
    1.1 | ---ZYX---
    2.2 | ---ZYX---
    3.3 | ---ZYX---
(6 rows)

-- select reverse with group by (explain)
--Testcase 1662:
EXPLAIN VERBOSE
SELECT count(value1), reverse(str1) FROM s3 GROUP BY reverse(str1);
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (reverse(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), reverse(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select reverse with group by (result)
--Testcase 1663:
SELECT count(value1), reverse(str1) FROM s3 GROUP BY reverse(str1);
 count |  reverse  
-------+-----------
     6 | ---ZYX---
(1 row)

-- select reverse with group by index (result)
--Testcase 1664:
SELECT value1, reverse(str1) FROM s3 GROUP BY 2,1;
 value1 |  reverse  
--------+-----------
    0.1 | ---ZYX---
    0.2 | ---ZYX---
    0.3 | ---ZYX---
    1.1 | ---ZYX---
    2.2 | ---ZYX---
    3.3 | ---ZYX---
(6 rows)

-- select reverse with group by having (explain)
--Testcase 1665:
EXPLAIN VERBOSE
SELECT count(value1), reverse(str1) FROM s3 GROUP BY reverse(str1), str1 HAVING reverse(str1) IS NOT NULL;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (reverse(str1)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), reverse(str1), str1 FROM public.s3mysql WHERE ((reverse(str1) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select reverse with group by having (result)
--Testcase 1666:
SELECT count(value1), reverse(str1) FROM s3 GROUP BY reverse(str1), str1 HAVING reverse(str1) IS NOT NULL;
 count |  reverse  
-------+-----------
     6 | ---ZYX---
(1 row)

-- select reverse with group by index having (result)
--Testcase 1667:
SELECT value1, reverse(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |  reverse  
--------+-----------
    1.1 | ---ZYX---
    2.2 | ---ZYX---
    3.3 | ---ZYX---
(3 rows)

--
-- test right()
--
-- select right (stub function, explain)
--Testcase 1668:
EXPLAIN VERBOSE
SELECT right(str1, 4), right(str2, 4) FROM s3;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: ("right"(str1, 4)), ("right"(str2, 4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "right"(str1, 4), "right"(str2, 4) FROM public.s3mysql
(4 rows)

-- select right (stub function, result)
--Testcase 1669:
SELECT right(str1, 4), right(str2, 4) FROM s3;
 right | right 
-------+-------
 Z---  | Z   
 Z---  | Z   
 Z---  | Z   
 Z---  | Z   
 Z---  | Z   
 Z---  | Z   
(6 rows)

-- select right (stub function, not pushdown constraints, explain)
--Testcase 1670:
EXPLAIN VERBOSE
SELECT value1, right(str1, 6) FROM s3 WHERE to_hex(value2) = '64';
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, ("right"(str1, 6))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, "right"(str1, 6), value2 FROM public.s3mysql
(5 rows)

-- select right (stub function, not pushdown constraints, result)
--Testcase 1671:
SELECT value1, right(str1, 6) FROM s3 WHERE to_hex(value2) = '64';
 value1 | right  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
(3 rows)

-- select right (stub function, pushdown constraints, explain)
--Testcase 1672:
EXPLAIN VERBOSE
SELECT value1, right(str1, 6) FROM s3 WHERE value2 != 200;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, ("right"(str1, 6))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, "right"(str1, 6) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select right (stub function, pushdown constraints, result)
--Testcase 1673:
SELECT value1, right(str1, 6) FROM s3 WHERE value2 != 200;
 value1 | right  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
(3 rows)

-- select right with non pushdown func and explicit constant (explain)
--Testcase 1674:
EXPLAIN VERBOSE
SELECT right(str1, 6), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: ("right"(str1, 6)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "right"(str1, 6), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select right with non pushdown func and explicit constant (result)
--Testcase 1675:
SELECT right(str1, 6), pi(), 4.1 FROM s3;
 right  |        pi         | ?column? 
--------+-------------------+----------
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
 XYZ--- | 3.141592653589793 |      4.1
(6 rows)

-- select right with order by (explain)
--Testcase 1676:
EXPLAIN VERBOSE
SELECT value1, right(str1, 6) FROM s3 ORDER BY right(str1, 6);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, ("right"(str1, 6))
   Sort Key: ("right"(s3.str1, 6))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, ("right"(str1, 6))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, "right"(str1, 6) FROM public.s3mysql
(7 rows)

-- select right with order by (result)
--Testcase 1677:
SELECT value1, right(str1, 6) FROM s3 ORDER BY right(str1, 6);
 value1 | right  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(6 rows)

-- select right with order by index (result)
--Testcase 1678:
SELECT value1, right(str1, 6) FROM s3 ORDER BY 2,1;
 value1 | right  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(6 rows)

-- select right with order by index (result)
--Testcase 1679:
SELECT value1, right(str1, 6) FROM s3 ORDER BY 1,2;
 value1 | right  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(6 rows)

-- select right with group by (explain)
--Testcase 1680:
EXPLAIN VERBOSE
SELECT count(value1), right(str1, 6) FROM s3 GROUP BY right(str1, 6);
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), ("right"(str1, 6))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), "right"(str1, 6) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select right with group by (result)
--Testcase 1681:
SELECT count(value1), right(str1, 6) FROM s3 GROUP BY right(str1, 6);
 count | right  
-------+--------
     6 | XYZ---
(1 row)

-- select right with group by index (result)
--Testcase 1682:
SELECT value1, right(str1, 6) FROM s3 GROUP BY 2,1;
 value1 | right  
--------+--------
    0.1 | XYZ---
    0.2 | XYZ---
    0.3 | XYZ---
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(6 rows)

-- select right with group by having (explain)
--Testcase 1683:
EXPLAIN VERBOSE
SELECT count(value1), right(str1, 6) FROM s3 GROUP BY right(str1, 6), str1 HAVING right(str1, 6) IS NOT NULL;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), ("right"(str1, 6)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), "right"(str1, 6), str1 FROM public.s3mysql WHERE (("right"(str1, 6) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select right with group by having (result)
--Testcase 1684:
SELECT count(value1), right(str1, 6) FROM s3 GROUP BY right(str1, 6), str1 HAVING right(str1, 6) IS NOT NULL;
 count | right  
-------+--------
     6 | XYZ---
(1 row)

-- select right with group by index having (result)
--Testcase 1685:
SELECT value1, right(str1, 6) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | right  
--------+--------
    1.1 | XYZ---
    2.2 | XYZ---
    3.3 | XYZ---
(3 rows)

--
-- test rpad()
--
-- select rpad (stub function, explain)
--Testcase 1686:
EXPLAIN VERBOSE
SELECT rpad(str1, 16, str2), rpad(str1, 4, str2) FROM s3;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (rpad(str1, 16, str2)), (rpad(str1, 4, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT rpad(str1, 16, str2), rpad(str1, 4, str2) FROM public.s3mysql
(4 rows)

-- select rpad (stub function, result)
--Testcase 1687:
SELECT rpad(str1, 16, str2), rpad(str1, 4, str2) FROM s3;
       rpad       | rpad 
------------------+------
 ---XYZ---   XYZ  | ---X
 ---XYZ---   XYZ  | ---X
 ---XYZ---   XYZ  | ---X
 ---XYZ---   XYZ  | ---X
 ---XYZ---   XYZ  | ---X
 ---XYZ---   XYZ  | ---X
(6 rows)

-- select rpad (stub function, not pushdown constraints, explain)
--Testcase 1688:
EXPLAIN VERBOSE
SELECT value1, rpad(str1, 16, str2) FROM s3 WHERE to_hex(value2) = '64';
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (rpad(str1, 16, str2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, rpad(str1, 16, str2), value2 FROM public.s3mysql
(5 rows)

-- select rpad (stub function, not pushdown constraints, result)
--Testcase 1689:
SELECT value1, rpad(str1, 16, str2) FROM s3 WHERE to_hex(value2) = '64';
 value1 |       rpad       
--------+------------------
    0.1 | ---XYZ---   XYZ 
    0.2 | ---XYZ---   XYZ 
    0.3 | ---XYZ---   XYZ 
(3 rows)

-- select rpad (stub function, pushdown constraints, explain)
--Testcase 1690:
EXPLAIN VERBOSE
SELECT value1, rpad(str1, 16, str2) FROM s3 WHERE value2 != 200;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (rpad(str1, 16, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, rpad(str1, 16, str2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select rpad (stub function, pushdown constraints, result)
--Testcase 1691:
SELECT value1, rpad(str1, 16, str2) FROM s3 WHERE value2 != 200;
 value1 |       rpad       
--------+------------------
    0.1 | ---XYZ---   XYZ 
    0.2 | ---XYZ---   XYZ 
    0.3 | ---XYZ---   XYZ 
(3 rows)

-- select rpad with non pushdown func and explicit constant (explain)
--Testcase 1692:
EXPLAIN VERBOSE
SELECT rpad(str1, 16, str2), pi(), 4.1 FROM s3;
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (rpad(str1, 16, str2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT rpad(str1, 16, str2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select rpad with non pushdown func and explicit constant (result)
--Testcase 1693:
SELECT rpad(str1, 16, str2), pi(), 4.1 FROM s3;
       rpad       |        pi         | ?column? 
------------------+-------------------+----------
 ---XYZ---   XYZ  | 3.141592653589793 |      4.1
 ---XYZ---   XYZ  | 3.141592653589793 |      4.1
 ---XYZ---   XYZ  | 3.141592653589793 |      4.1
 ---XYZ---   XYZ  | 3.141592653589793 |      4.1
 ---XYZ---   XYZ  | 3.141592653589793 |      4.1
 ---XYZ---   XYZ  | 3.141592653589793 |      4.1
(6 rows)

-- select rpad with order by (explain)
--Testcase 1694:
EXPLAIN VERBOSE
SELECT value1, rpad(str1, 16, str2) FROM s3 ORDER BY rpad(str1, 16, str2);
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (rpad(str1, 16, str2))
   Sort Key: (rpad(s3.str1, 16, s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (rpad(str1, 16, str2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, rpad(str1, 16, str2) FROM public.s3mysql
(7 rows)

-- select rpad with order by (result)
--Testcase 1695:
SELECT value1, rpad(str1, 16, str2) FROM s3 ORDER BY rpad(str1, 16, str2);
 value1 |       rpad       
--------+------------------
    0.1 | ---XYZ---   XYZ 
    0.2 | ---XYZ---   XYZ 
    0.3 | ---XYZ---   XYZ 
    1.1 | ---XYZ---   XYZ 
    2.2 | ---XYZ---   XYZ 
    3.3 | ---XYZ---   XYZ 
(6 rows)

-- select rpad with order by index (result)
--Testcase 1696:
SELECT value1, rpad(str1, 16, str2) FROM s3 ORDER BY 2,1;
 value1 |       rpad       
--------+------------------
    0.1 | ---XYZ---   XYZ 
    0.2 | ---XYZ---   XYZ 
    0.3 | ---XYZ---   XYZ 
    1.1 | ---XYZ---   XYZ 
    2.2 | ---XYZ---   XYZ 
    3.3 | ---XYZ---   XYZ 
(6 rows)

-- select rpad with order by index (result)
--Testcase 1697:
SELECT value1, rpad(str1, 16, str2) FROM s3 ORDER BY 1,2;
 value1 |       rpad       
--------+------------------
    0.1 | ---XYZ---   XYZ 
    0.2 | ---XYZ---   XYZ 
    0.3 | ---XYZ---   XYZ 
    1.1 | ---XYZ---   XYZ 
    2.2 | ---XYZ---   XYZ 
    3.3 | ---XYZ---   XYZ 
(6 rows)

-- select rpad with group by (explain)
--Testcase 1698:
EXPLAIN VERBOSE
SELECT count(value1), rpad(str1, 16, str2) FROM s3 GROUP BY rpad(str1, 16, str2);
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (rpad(str1, 16, str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), rpad(str1, 16, str2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select rpad with group by (result)
--Testcase 1699:
SELECT count(value1), rpad(str1, 16, str2) FROM s3 GROUP BY rpad(str1, 16, str2);
 count |       rpad       
-------+------------------
     6 | ---XYZ---   XYZ 
(1 row)

-- select rpad with group by index (result)
--Testcase 1700:
SELECT value1, rpad(str1, 16, str2) FROM s3 GROUP BY 2,1;
 value1 |       rpad       
--------+------------------
    0.1 | ---XYZ---   XYZ 
    0.2 | ---XYZ---   XYZ 
    0.3 | ---XYZ---   XYZ 
    1.1 | ---XYZ---   XYZ 
    2.2 | ---XYZ---   XYZ 
    3.3 | ---XYZ---   XYZ 
(6 rows)

-- select rpad with group by having (explain)
--Testcase 1701:
EXPLAIN VERBOSE
SELECT count(value1), rpad(str1, 16, str2) FROM s3 GROUP BY rpad(str1, 16, str2) HAVING rpad(str1, 16, str2) IS NOT NULL;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (rpad(str1, 16, str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), rpad(str1, 16, str2) FROM public.s3mysql WHERE ((rpad(str1, 16, str2) IS NOT NULL)) GROUP BY 2
(6 rows)

-- select rpad with group by having (result)
--Testcase 1702:
SELECT count(value1), rpad(str1, 16, str2) FROM s3 GROUP BY rpad(str1, 16, str2) HAVING rpad(str1, 16, str2) IS NOT NULL;
 count |       rpad       
-------+------------------
     6 | ---XYZ---   XYZ 
(1 row)

-- select rpad with group by index having (result)
--Testcase 1703:
SELECT value1, rpad(str1, 16, str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |       rpad       
--------+------------------
    1.1 | ---XYZ---   XYZ 
    2.2 | ---XYZ---   XYZ 
    3.3 | ---XYZ---   XYZ 
(3 rows)

--
-- test rtrim()
--
-- select rtrim (stub function, explain)
--Testcase 1704:
EXPLAIN VERBOSE
SELECT rtrim(str1), rtrim(str2, ' ') FROM s3;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (rtrim(str1)), (rtrim(str2, ' '::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT rtrim(str1), rtrim(str2, ' '::text) FROM public.s3mysql
(4 rows)

-- select rtrim (stub function, result)
--Testcase 1705:
SELECT rtrim(str1), rtrim(str2, ' ') FROM s3;
   rtrim   | rtrim  
-----------+--------
 ---XYZ--- |    XYZ
 ---XYZ--- |    XYZ
 ---XYZ--- |    XYZ
 ---XYZ--- |    XYZ
 ---XYZ--- |    XYZ
 ---XYZ--- |    XYZ
(6 rows)

-- select rtrim (stub function, not pushdown constraints, explain)
--Testcase 1706:
EXPLAIN VERBOSE
SELECT value1, rtrim(str1, '-') FROM s3 WHERE to_hex(value2) = '64';
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (rtrim(str1, '-'::text))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, rtrim(str1, '-'::text), value2 FROM public.s3mysql
(5 rows)

-- select rtrim (stub function, not pushdown constraints, result)
--Testcase 1707:
SELECT value1, rtrim(str1, '-') FROM s3 WHERE to_hex(value2) = '64';
 value1 | rtrim  
--------+--------
    0.1 | ---XYZ
    0.2 | ---XYZ
    0.3 | ---XYZ
(3 rows)

-- select rtrim (stub function, pushdown constraints, explain)
--Testcase 1708:
EXPLAIN VERBOSE
SELECT value1, rtrim(str1, '-') FROM s3 WHERE value2 != 200;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (rtrim(str1, '-'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, rtrim(str1, '-'::text) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select rtrim (stub function, pushdown constraints, result)
--Testcase 1709:
SELECT value1, rtrim(str1, '-') FROM s3 WHERE value2 != 200;
 value1 | rtrim  
--------+--------
    0.1 | ---XYZ
    0.2 | ---XYZ
    0.3 | ---XYZ
(3 rows)

-- select rtrim with non pushdown func and explicit constant (explain)
--Testcase 1710:
EXPLAIN VERBOSE
SELECT rtrim(str1, '-'), pi(), 4.1 FROM s3;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (rtrim(str1, '-'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT rtrim(str1, '-'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select rtrim with non pushdown func and explicit constant (result)
--Testcase 1711:
SELECT rtrim(str1, '-'), pi(), 4.1 FROM s3;
 rtrim  |        pi         | ?column? 
--------+-------------------+----------
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
(6 rows)

-- select rtrim with order by (explain)
--Testcase 1712:
EXPLAIN VERBOSE
SELECT value1, rtrim(str1, '-') FROM s3 ORDER BY rtrim(str1, '-');
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (rtrim(str1, '-'::text))
   Sort Key: (rtrim(s3.str1, '-'::text))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (rtrim(str1, '-'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, rtrim(str1, '-'::text) FROM public.s3mysql
(7 rows)

-- select rtrim with order by (result)
--Testcase 1713:
SELECT value1, rtrim(str1, '-') FROM s3 ORDER BY rtrim(str1, '-');
 value1 | rtrim  
--------+--------
    0.1 | ---XYZ
    0.2 | ---XYZ
    0.3 | ---XYZ
    1.1 | ---XYZ
    2.2 | ---XYZ
    3.3 | ---XYZ
(6 rows)

-- select rtrim with order by index (result)
--Testcase 1714:
SELECT value1, rtrim(str1, '-') FROM s3 ORDER BY 2,1;
 value1 | rtrim  
--------+--------
    0.1 | ---XYZ
    0.2 | ---XYZ
    0.3 | ---XYZ
    1.1 | ---XYZ
    2.2 | ---XYZ
    3.3 | ---XYZ
(6 rows)

-- select rtrim with order by index (result)
--Testcase 1715:
SELECT value1, rtrim(str1, '-') FROM s3 ORDER BY 1,2;
 value1 | rtrim  
--------+--------
    0.1 | ---XYZ
    0.2 | ---XYZ
    0.3 | ---XYZ
    1.1 | ---XYZ
    2.2 | ---XYZ
    3.3 | ---XYZ
(6 rows)

-- select rtrim with group by (explain)
--Testcase 1716:
EXPLAIN VERBOSE
SELECT count(value1), rtrim(str1, '-') FROM s3 GROUP BY rtrim(str1, '-');
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (rtrim(str1, '-'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), rtrim(str1, '-'::text) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select rtrim with group by (result)
--Testcase 1717:
SELECT count(value1), rtrim(str1, '-') FROM s3 GROUP BY rtrim(str1, '-');
 count | rtrim  
-------+--------
     6 | ---XYZ
(1 row)

-- select rtrim with group by index (result)
--Testcase 1718:
SELECT value1, rtrim(str2) FROM s3 GROUP BY 2,1;
 value1 | rtrim  
--------+--------
    0.1 |    XYZ
    0.2 |    XYZ
    0.3 |    XYZ
    1.1 |    XYZ
    2.2 |    XYZ
    3.3 |    XYZ
(6 rows)

-- select rtrim with group by having (explain)
--Testcase 1719:
EXPLAIN VERBOSE
SELECT count(value1), rtrim(str1, '-') FROM s3 GROUP BY rtrim(str1, '-') HAVING rtrim(str1, '-') IS NOT NULL;
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (rtrim(str1, '-'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), rtrim(str1, '-'::text) FROM public.s3mysql WHERE ((rtrim(str1, '-'::text) IS NOT NULL)) GROUP BY 2
(6 rows)

-- select rtrim with group by having (result)
--Testcase 1720:
SELECT count(value1), rtrim(str1, '-') FROM s3 GROUP BY rtrim(str1, '-') HAVING rtrim(str1, '-') IS NOT NULL;
 count | rtrim  
-------+--------
     6 | ---XYZ
(1 row)

-- select rtrim with group by index having (result)
--Testcase 1721:
SELECT value1, rtrim(str1, '-') FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | rtrim  
--------+--------
    1.1 | ---XYZ
    2.2 | ---XYZ
    3.3 | ---XYZ
(3 rows)

--
-- test space()
--
-- select space (stub function, explain)
--Testcase 1722:
EXPLAIN VERBOSE
SELECT space(value2), space(value4) FROM s3;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1935.95 rows=3413 width=64)
   Output: (space((value2)::bigint)), (space((value4)::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.space(value2), public.space(value4) FROM public.s3mysql
(4 rows)

-- select space (stub function, result)
--Testcase 1723:
SELECT space(value2), space(value4) FROM s3;
                                                                                                  space                                                                                                   | space 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------
                                                                                                                                                                                                          | 
                                                                                                                                                                                                          | 
                                                                                                                                                                                                          | 
                                                                                                                                                                                                          | 
                                                                                                                                                                                                          | 
                                                                                                                                                                                                          | 
(6 rows)

-- select space (stub function, not pushdown constraints, explain)
--Testcase 1724:
EXPLAIN VERBOSE
SELECT value1, space(id) FROM s3 WHERE to_hex(value2) = '64';
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.49 rows=17 width=40)
   Output: value1, (space((id)::bigint))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.space(id), value2 FROM public.s3mysql
(5 rows)

-- select space (stub function, not pushdown constraints, result)
--Testcase 1725:
SELECT value1, space(id) FROM s3 WHERE to_hex(value2) = '64';
 value1 | space 
--------+-------
    0.1 | 
    0.2 |  
    0.3 |   
(3 rows)

-- select space (stub function, pushdown constraints, explain)
--Testcase 1726:
EXPLAIN VERBOSE
SELECT value1, space(id) FROM s3 WHERE value2 != 200;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1078.07 rows=3396 width=40)
   Output: value1, (space((id)::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.space(id) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select space (stub function, pushdown constraints, result)
--Testcase 1727:
SELECT value1, space(id) FROM s3 WHERE value2 != 200;
 value1 | space 
--------+-------
    0.1 | 
    0.2 |  
    0.3 |   
(3 rows)

-- select space as nest function with agg (pushdown, explain)
--Testcase 1728:
EXPLAIN VERBOSE
SELECT sum(value3), space(sum(id)) FROM s3;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(value3)), (space(sum(id)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT sum(value3), public.space(sum(id)) FROM public.s3mysql
(6 rows)

-- select space as nest function with agg (pushdown, result)
--Testcase 1729:
SELECT sum(value3), space(sum(id)) FROM s3;
        sum         |      space      
--------------------+-----------------
 -7.200000040233135 |                
(1 row)

-- select space with non pushdown func and explicit constant (explain)
--Testcase 1730:
EXPLAIN VERBOSE
SELECT space(id), pi(), 4.1 FROM s3;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (space((id)::bigint)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.space(id), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select space with non pushdown func and explicit constant (result)
--Testcase 1731:
SELECT space(id), pi(), 4.1 FROM s3;
 space |        pi         | ?column? 
-------+-------------------+----------
       | 3.141592653589793 |      4.1
       | 3.141592653589793 |      4.1
       | 3.141592653589793 |      4.1
       | 3.141592653589793 |      4.1
       | 3.141592653589793 |      4.1
       | 3.141592653589793 |      4.1
(6 rows)

-- select space with order by (explain)
--Testcase 1732:
EXPLAIN VERBOSE
SELECT value1, space(id) FROM s3 ORDER BY space(id);
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=40)
   Output: value1, (space((id)::bigint))
   Sort Key: (space((s3.id)::bigint))
   ->  Foreign Scan on public.s3  (cost=100.00..1074.17 rows=3413 width=40)
         Output: value1, (space((id)::bigint))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.space(id) FROM public.s3mysql
(7 rows)

-- select space with order by (result)
--Testcase 1733:
SELECT value1, space(id) FROM s3 ORDER BY space(id);
 value1 | space 
--------+-------
    0.1 | 
    0.2 |  
    0.3 |   
    1.1 |    
    2.2 |     
    3.3 |      
(6 rows)

-- select space with order by index (result)
--Testcase 1734:
SELECT value1, space(id) FROM s3 ORDER BY 2,1;
 value1 | space 
--------+-------
    0.1 | 
    0.2 |  
    0.3 |   
    1.1 |    
    2.2 |     
    3.3 |      
(6 rows)

-- select space with order by index (result)
--Testcase 1735:
SELECT value1, space(id) FROM s3 ORDER BY 1,2;
 value1 | space 
--------+-------
    0.1 | 
    0.2 |  
    0.3 |   
    1.1 |    
    2.2 |     
    3.3 |      
(6 rows)

-- select space with group by (explain)
--Testcase 1736:
EXPLAIN VERBOSE
SELECT value1, space(id) FROM s3 GROUP BY value1, space(id);
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=40)
   Output: value1, (space((id)::bigint))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT value1, public.space(id) FROM public.s3mysql GROUP BY 1, 2
(6 rows)

-- select space with group by (result)
--Testcase 1737:
SELECT value1, space(id) FROM s3 GROUP BY value1, space(id);
 value1 | space 
--------+-------
    0.1 | 
    0.2 |  
    0.3 |   
    1.1 |    
    2.2 |     
    3.3 |      
(6 rows)

-- select space with group by index (result)
--Testcase 1738:
SELECT value1, space(id) FROM s3 GROUP BY 2,1;
 value1 | space 
--------+-------
    0.1 | 
    0.2 |  
    0.3 |   
    1.1 |    
    2.2 |     
    3.3 |      
(6 rows)

-- select space with group by having (explain)
--Testcase 1739:
EXPLAIN VERBOSE
SELECT count(value1), space(id) FROM s3 GROUP BY space(id), id HAVING space(id) IS NOT NULL;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: (count(value1)), (space((id)::bigint)), id
   Filter: ((space((s3.id)::bigint)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.space(id), id FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.space(id) IS NOT NULL))
(7 rows)

-- select space with group by having (result)
--Testcase 1740:
SELECT count(value1), space(id) FROM s3 GROUP BY space(id), id HAVING space(id) IS NOT NULL;
 count | space 
-------+-------
     1 | 
     1 |  
     1 |   
     1 |    
     1 |     
     1 |      
(6 rows)

-- select space with group by index having (result)
--Testcase 1741:
SELECT value1, space(id) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | space 
--------+-------
    1.1 |    
    2.2 |     
    3.3 |      
(3 rows)

--
-- test strcmp()
--
-- select strcmp (stub function, explain)
--Testcase 1742:
EXPLAIN VERBOSE
SELECT strcmp(str1, str2) FROM s3;
                              QUERY PLAN                              
----------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (strcmp(str1, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.strcmp(str1, str2) FROM public.s3mysql
(4 rows)

-- select strcmp (stub function, result)
--Testcase 1743:
SELECT strcmp(str1, str2) FROM s3;
 strcmp 
--------
      1
      1
      1
      1
      1
      1
(6 rows)

-- select strcmp (stub function, not pushdown constraints, explain)
--Testcase 1744:
EXPLAIN VERBOSE
SELECT value1, strcmp(str1, str2) FROM s3 WHERE to_hex(value2) = '64';
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=12)
   Output: value1, (strcmp(str1, str2))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.strcmp(str1, str2), value2 FROM public.s3mysql
(5 rows)

-- select strcmp (stub function, not pushdown constraints, result)
--Testcase 1745:
SELECT value1, strcmp(str1, str2) FROM s3 WHERE to_hex(value2) = '64';
 value1 | strcmp 
--------+--------
    0.1 |      1
    0.2 |      1
    0.3 |      1
(3 rows)

-- select strcmp (stub function, pushdown constraints, explain)
--Testcase 1746:
EXPLAIN VERBOSE
SELECT value1, strcmp(str1, str2) FROM s3 WHERE value2 != 200;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=12)
   Output: value1, (strcmp(str1, str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.strcmp(str1, str2) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select strcmp (stub function, pushdown constraints, result)
--Testcase 1747:
SELECT value1, strcmp(str1, str2) FROM s3 WHERE value2 != 200;
 value1 | strcmp 
--------+--------
    0.1 |      1
    0.2 |      1
    0.3 |      1
(3 rows)

-- select strcmp with non pushdown func and explicit constant (explain)
--Testcase 1748:
EXPLAIN VERBOSE
SELECT strcmp(str1, str2), pi(), 4.1 FROM s3;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (strcmp(str1, str2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.strcmp(str1, str2), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select strcmp with non pushdown func and explicit constant (result)
--Testcase 1749:
SELECT strcmp(str1, str2), pi(), 4.1 FROM s3;
 strcmp |        pi         | ?column? 
--------+-------------------+----------
      1 | 3.141592653589793 |      4.1
      1 | 3.141592653589793 |      4.1
      1 | 3.141592653589793 |      4.1
      1 | 3.141592653589793 |      4.1
      1 | 3.141592653589793 |      4.1
      1 | 3.141592653589793 |      4.1
(6 rows)

-- select strcmp with order by (explain)
--Testcase 1750:
EXPLAIN VERBOSE
SELECT value1, strcmp(str1, str2) FROM s3 ORDER BY strcmp(str1, str2);
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=12)
   Output: value1, (strcmp(str1, str2))
   Sort Key: (strcmp(s3.str1, s3.str2))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=12)
         Output: value1, (strcmp(str1, str2))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.strcmp(str1, str2) FROM public.s3mysql
(7 rows)

-- select strcmp with order by (result)
--Testcase 1751:
SELECT value1, strcmp(str1, str2) FROM s3 ORDER BY strcmp(str1, str2);
 value1 | strcmp 
--------+--------
    0.1 |      1
    0.2 |      1
    0.3 |      1
    1.1 |      1
    2.2 |      1
    3.3 |      1
(6 rows)

-- select strcmp with order by index (result)
--Testcase 1752:
SELECT value1, strcmp(str1, str2) FROM s3 ORDER BY 2,1;
 value1 | strcmp 
--------+--------
    0.1 |      1
    0.2 |      1
    0.3 |      1
    1.1 |      1
    2.2 |      1
    3.3 |      1
(6 rows)

-- select strcmp with order by index (result)
--Testcase 1753:
SELECT value1, strcmp(str1, str2) FROM s3 ORDER BY 1,2;
 value1 | strcmp 
--------+--------
    0.1 |      1
    0.2 |      1
    0.3 |      1
    1.1 |      1
    2.2 |      1
    3.3 |      1
(6 rows)

-- select strcmp with group by (explain)
--Testcase 1754:
EXPLAIN VERBOSE
SELECT count(value1), strcmp(str1, str2) FROM s3 GROUP BY strcmp(str1, str2);
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(value1)), (strcmp(str1, str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.strcmp(str1, str2) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select strcmp with group by (result)
--Testcase 1755:
SELECT count(value1), strcmp(str1, str2) FROM s3 GROUP BY strcmp(str1, str2);
 count | strcmp 
-------+--------
     6 |      1
(1 row)

-- select strcmp with group by index (result)
--Testcase 1756:
SELECT value1, strcmp(str1, str2) FROM s3 GROUP BY 2,1;
 value1 | strcmp 
--------+--------
    0.1 |      1
    0.2 |      1
    0.3 |      1
    1.1 |      1
    2.2 |      1
    3.3 |      1
(6 rows)

-- select strcmp with group by having (explain)
--Testcase 1757:
EXPLAIN VERBOSE
SELECT count(value1), strcmp(str1, str2) FROM s3 GROUP BY strcmp(str1, str2), str1, str2 HAVING strcmp(str1, str2) IS NOT NULL;
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=76)
   Output: (count(value1)), (strcmp(str1, str2)), str1, str2
   Filter: ((strcmp(s3.str1, s3.str2)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.strcmp(str1, str2), str1, str2 FROM public.s3mysql GROUP BY 2, 3, 4 HAVING ((public.strcmp(str1, str2) IS NOT NULL))
(7 rows)

-- select strcmp with group by having (result)
--Testcase 1758:
SELECT count(value1), strcmp(str1, str2) FROM s3 GROUP BY strcmp(str1, str2), str1, str2 HAVING strcmp(str1, str2) IS NOT NULL;
 count | strcmp 
-------+--------
     6 |      1
(1 row)

-- select strcmp with group by index having (result)
--Testcase 1759:
SELECT value1, strcmp(str1, str2) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | strcmp 
--------+--------
    1.1 |      1
    2.2 |      1
    3.3 |      1
(3 rows)

--
-- test substr()
--
-- select substr (stub function, explain)
--Testcase 1760:
EXPLAIN VERBOSE
SELECT substr(str1, 3), substr(str2, 3, 4) FROM s3;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (substr(str1, 3)), (substr(str2, 3, 4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT substr(str1, 3), substr(str2, 3, 4) FROM public.s3mysql
(4 rows)

-- select substr (stub function, result)
--Testcase 1761:
SELECT substr(str1, 3), substr(str2, 3, 4) FROM s3;
 substr  | substr 
---------+--------
 -XYZ--- |  XYZ
 -XYZ--- |  XYZ
 -XYZ--- |  XYZ
 -XYZ--- |  XYZ
 -XYZ--- |  XYZ
 -XYZ--- |  XYZ
(6 rows)

-- select substr (stub function, not pushdown constraints, explain)
--Testcase 1762:
EXPLAIN VERBOSE
SELECT value1, substr(str2, 3, 4) FROM s3 WHERE to_hex(value2) = '64';
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (substr(str2, 3, 4))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, substr(str2, 3, 4), value2 FROM public.s3mysql
(5 rows)

-- select substr (stub function, not pushdown constraints, result)
--Testcase 1763:
SELECT value1, substr(str2, 3, 4) FROM s3 WHERE to_hex(value2) = '64';
 value1 | substr 
--------+--------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
(3 rows)

-- select substr (stub function, pushdown constraints, explain)
--Testcase 1764:
EXPLAIN VERBOSE
SELECT value1, substr(str2, 3, 4) FROM s3 WHERE value2 != 200;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (substr(str2, 3, 4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, substr(str2, 3, 4) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select substr (stub function, pushdown constraints, result)
--Testcase 1765:
SELECT value1, substr(str2, 3, 4) FROM s3 WHERE value2 != 200;
 value1 | substr 
--------+--------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
(3 rows)

-- select substr with non pushdown func and explicit constant (explain)
--Testcase 1766:
EXPLAIN VERBOSE
SELECT substr(str2, 3, 4), pi(), 4.1 FROM s3;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (substr(str2, 3, 4)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT substr(str2, 3, 4), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select substr with non pushdown func and explicit constant (result)
--Testcase 1767:
SELECT substr(str2, 3, 4), pi(), 4.1 FROM s3;
 substr |        pi         | ?column? 
--------+-------------------+----------
  XYZ   | 3.141592653589793 |      4.1
  XYZ   | 3.141592653589793 |      4.1
  XYZ   | 3.141592653589793 |      4.1
  XYZ   | 3.141592653589793 |      4.1
  XYZ   | 3.141592653589793 |      4.1
  XYZ   | 3.141592653589793 |      4.1
(6 rows)

-- select substr with order by (explain)
--Testcase 1768:
EXPLAIN VERBOSE
SELECT value1, substr(str2, 3, 4) FROM s3 ORDER BY substr(str2, 3, 4);
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (substr(str2, 3, 4))
   Sort Key: (substr(s3.str2, 3, 4))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (substr(str2, 3, 4))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, substr(str2, 3, 4) FROM public.s3mysql
(7 rows)

-- select substr with order by (result)
--Testcase 1769:
SELECT value1, substr(str2, 3, 4) FROM s3 ORDER BY substr(str2, 3, 4);
 value1 | substr 
--------+--------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(6 rows)

-- select substr with order by index (result)
--Testcase 1770:
SELECT value1, substr(str2, 3, 4) FROM s3 ORDER BY 2,1;
 value1 | substr 
--------+--------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(6 rows)

-- select substr with order by index (result)
--Testcase 1771:
SELECT value1, substr(str2, 3, 4) FROM s3 ORDER BY 1,2;
 value1 | substr 
--------+--------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(6 rows)

-- select substr with group by (explain)
--Testcase 1772:
EXPLAIN VERBOSE
SELECT count(value1), substr(str2, 3, 4) FROM s3 GROUP BY substr(str2, 3, 4);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (substr(str2, 3, 4))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), substr(str2, 3, 4) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select substr with group by (result)
--Testcase 1773:
SELECT count(value1), substr(str2, 3, 4) FROM s3 GROUP BY substr(str2, 3, 4);
 count | substr 
-------+--------
     6 |  XYZ
(1 row)

-- select substr with group by index (result)
--Testcase 1774:
SELECT value1, substr(str2, 3, 4) FROM s3 GROUP BY 2,1;
 value1 | substr 
--------+--------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(6 rows)

-- select substr with group by having (explain)
--Testcase 1775:
EXPLAIN VERBOSE
SELECT count(value1), substr(str2, 3, 4) FROM s3 GROUP BY substr(str2, 3, 4), str2 HAVING substr(str2, 3, 4) IS NOT NULL;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (substr(str2, 3, 4)), str2
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), substr(str2, 3, 4), str2 FROM public.s3mysql WHERE ((substr(str2, 3, 4) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select substr with group by having (result)
--Testcase 1776:
SELECT count(value1), substr(str2, 3, 4) FROM s3 GROUP BY substr(str2, 3, 4), str2 HAVING substr(str2, 3, 4) IS NOT NULL;
 count | substr 
-------+--------
     6 |  XYZ
(1 row)

-- select substr with group by index having (result)
--Testcase 1777:
SELECT value1, substr(str2, 3, 4) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | substr 
--------+--------
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(3 rows)

--
-- test substring()
--
-- select substring (stub function, explain)
--Testcase 1778:
EXPLAIN VERBOSE
SELECT substring(str1, 3), substring(str2, 3, 4) FROM s3;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: ("substring"(str1, 3)), ("substring"(str2, 3, 4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "substring"(str1, 3), "substring"(str2, 3, 4) FROM public.s3mysql
(4 rows)

-- select substring (stub function, result)
--Testcase 1779:
SELECT substring(str1, 3), substring(str2, 3, 4) FROM s3;
 substring | substring 
-----------+-----------
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
(6 rows)

-- select substring (stub function, explain)
--Testcase 1780:
EXPLAIN VERBOSE
SELECT substring(str1 FROM 3), substring(str2 FROM 3 FOR 4) FROM s3;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: ("substring"(str1, 3)), ("substring"(str2, 3, 4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "substring"(str1, 3), "substring"(str2, 3, 4) FROM public.s3mysql
(4 rows)

-- select substring (stub function, result)
--Testcase 1781:
SELECT substring(str1 FROM 3), substring(str2 FROM 3 FOR 4) FROM s3;
 substring | substring 
-----------+-----------
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
 -XYZ---   |  XYZ
(6 rows)

-- select substring (stub function, not pushdown constraints, explain)
--Testcase 1782:
EXPLAIN VERBOSE
SELECT value1, substring(str2, 3, 4) FROM s3 WHERE to_hex(value2) = '64';
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, ("substring"(str2, 3, 4))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, "substring"(str2, 3, 4), value2 FROM public.s3mysql
(5 rows)

-- select substring (stub function, not pushdown constraints, result)
--Testcase 1783:
SELECT value1, substring(str2, 3, 4) FROM s3 WHERE to_hex(value2) = '64';
 value1 | substring 
--------+-----------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
(3 rows)

-- select substring (stub function, pushdown constraints, explain)
--Testcase 1784:
EXPLAIN VERBOSE
SELECT value1, substring(str2 FROM 3 FOR 4) FROM s3 WHERE value2 != 200;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, ("substring"(str2, 3, 4))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, "substring"(str2, 3, 4) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select substring (stub function, pushdown constraints, result)
--Testcase 1785:
SELECT value1, substring(str2 FROM 3 FOR 4) FROM s3 WHERE value2 != 200;
 value1 | substring 
--------+-----------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
(3 rows)

-- select substring with non pushdown func and explicit constant (explain)
--Testcase 1786:
EXPLAIN VERBOSE
SELECT substring(str2 FROM 3 FOR 4), pi(), 4.1 FROM s3;
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: ("substring"(str2, 3, 4)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT "substring"(str2, 3, 4), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select substring with non pushdown func and explicit constant (result)
--Testcase 1787:
SELECT substring(str2 FROM 3 FOR 4), pi(), 4.1 FROM s3;
 substring |        pi         | ?column? 
-----------+-------------------+----------
  XYZ      | 3.141592653589793 |      4.1
  XYZ      | 3.141592653589793 |      4.1
  XYZ      | 3.141592653589793 |      4.1
  XYZ      | 3.141592653589793 |      4.1
  XYZ      | 3.141592653589793 |      4.1
  XYZ      | 3.141592653589793 |      4.1
(6 rows)

-- select substring with order by (explain)
--Testcase 1788:
EXPLAIN VERBOSE
SELECT value1, substring(str2 FROM 3 FOR 4) FROM s3 ORDER BY substring(str2 FROM 3 FOR 4);
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, ("substring"(str2, 3, 4))
   Sort Key: ("substring"(s3.str2, 3, 4))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, ("substring"(str2, 3, 4))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, "substring"(str2, 3, 4) FROM public.s3mysql
(7 rows)

-- select substring with order by (result)
--Testcase 1789:
SELECT value1, substring(str2 FROM 3 FOR 4) FROM s3 ORDER BY substring(str2 FROM 3 FOR 4);
 value1 | substring 
--------+-----------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(6 rows)

-- select substring with order by index (result)
--Testcase 1790:
SELECT value1, substring(str2 FROM 3 FOR 4) FROM s3 ORDER BY 2,1;
 value1 | substring 
--------+-----------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(6 rows)

-- select substring with order by index (result)
--Testcase 1791:
SELECT value1, substring(str2 FROM 3 FOR 4) FROM s3 ORDER BY 1,2;
 value1 | substring 
--------+-----------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(6 rows)

-- select substring with group by (explain)
--Testcase 1792:
EXPLAIN VERBOSE
SELECT count(value1), substring(str2, 3, 4) FROM s3 GROUP BY substring(str2, 3, 4);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), ("substring"(str2, 3, 4))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), "substring"(str2, 3, 4) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select substring with group by (result)
--Testcase 1793:
SELECT count(value1), substring(str2, 3, 4) FROM s3 GROUP BY substring(str2, 3, 4);
 count | substring 
-------+-----------
     6 |  XYZ
(1 row)

-- select substring with group by index (result)
--Testcase 1794:
SELECT value1, substring(str2, 3, 4) FROM s3 GROUP BY 2,1;
 value1 | substring 
--------+-----------
    0.1 |  XYZ
    0.2 |  XYZ
    0.3 |  XYZ
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(6 rows)

-- select substring with group by having (explain)
--Testcase 1795:
EXPLAIN VERBOSE
SELECT count(value1), substring(str2, 3, 4) FROM s3 GROUP BY substring(str2, 3, 4), str2 HAVING substring(str2, 3, 4) IS NOT NULL;
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), ("substring"(str2, 3, 4)), str2
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), "substring"(str2, 3, 4), str2 FROM public.s3mysql WHERE (("substring"(str2, 3, 4) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select substring with group by having (result)
--Testcase 1796:
SELECT count(value1), substring(str2, 3, 4) FROM s3 GROUP BY substring(str2, 3, 4), str2 HAVING substring(str2, 3, 4) IS NOT NULL;
 count | substring 
-------+-----------
     6 |  XYZ
(1 row)

-- select substring with group by index having (result)
--Testcase 1797:
SELECT value1, substring(str2, 3, 4) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | substring 
--------+-----------
    1.1 |  XYZ
    2.2 |  XYZ
    3.3 |  XYZ
(3 rows)

--
-- test substring_index()
--
-- select substring_index (stub function, explain)
--Testcase 1798:
EXPLAIN VERBOSE
SELECT substring_index(str1, '-', 5), substring_index(str1, '-', -5) FROM s3;
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=64)
   Output: (substring_index(str1, '-'::text, '5'::bigint)), (substring_index(str1, '-'::text, '-5'::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.substring_index(str1, '-'::text, 5::bigint), public.substring_index(str1, '-'::text, (-5)::bigint) FROM public.s3mysql
(4 rows)

-- select substring_index (stub function, result)
--Testcase 1799:
SELECT substring_index(str1, '-', 5), substring_index(str1, '-', -5) FROM s3;
 substring_index | substring_index 
-----------------+-----------------
 ---XYZ-         | -XYZ---
 ---XYZ-         | -XYZ---
 ---XYZ-         | -XYZ---
 ---XYZ-         | -XYZ---
 ---XYZ-         | -XYZ---
 ---XYZ-         | -XYZ---
(6 rows)

-- select substring_index (stub function, not pushdown constraints, explain)
--Testcase 1800:
EXPLAIN VERBOSE
SELECT value1, substring_index(str1, '-', 5) FROM s3 WHERE to_hex(value2) = '64';
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (substring_index(str1, '-'::text, '5'::bigint))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.substring_index(str1, '-'::text, 5::bigint), value2 FROM public.s3mysql
(5 rows)

-- select substring_index (stub function, not pushdown constraints, result)
--Testcase 1801:
SELECT value1, substring_index(str1, '-', 5) FROM s3 WHERE to_hex(value2) = '64';
 value1 | substring_index 
--------+-----------------
    0.1 | ---XYZ-
    0.2 | ---XYZ-
    0.3 | ---XYZ-
(3 rows)

-- select substring_index (stub function, pushdown constraints, explain)
--Testcase 1802:
EXPLAIN VERBOSE
SELECT value1, substring_index(str1, '-', 5) FROM s3 WHERE value2 != 200;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (substring_index(str1, '-'::text, '5'::bigint))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.substring_index(str1, '-'::text, 5::bigint) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select substring_index (stub function, pushdown constraints, result)
--Testcase 1803:
SELECT value1, substring_index(str1, '-', 5) FROM s3 WHERE value2 != 200;
 value1 | substring_index 
--------+-----------------
    0.1 | ---XYZ-
    0.2 | ---XYZ-
    0.3 | ---XYZ-
(3 rows)

-- select substring_index with non pushdown func and explicit constant (explain)
--Testcase 1804:
EXPLAIN VERBOSE
SELECT substring_index(str1, '-', 5), pi(), 4.1 FROM s3;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (substring_index(str1, '-'::text, '5'::bigint)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.substring_index(str1, '-'::text, 5::bigint), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select substring_index with non pushdown func and explicit constant (result)
--Testcase 1805:
SELECT substring_index(str1, '-', 5), pi(), 4.1 FROM s3;
 substring_index |        pi         | ?column? 
-----------------+-------------------+----------
 ---XYZ-         | 3.141592653589793 |      4.1
 ---XYZ-         | 3.141592653589793 |      4.1
 ---XYZ-         | 3.141592653589793 |      4.1
 ---XYZ-         | 3.141592653589793 |      4.1
 ---XYZ-         | 3.141592653589793 |      4.1
 ---XYZ-         | 3.141592653589793 |      4.1
(6 rows)

-- select substring_index with order by (explain)
--Testcase 1806:
EXPLAIN VERBOSE
SELECT value1, substring_index(str1, '-', 5) FROM s3 ORDER BY substring_index(str1, '-', 5);
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (substring_index(str1, '-'::text, '5'::bigint))
   Sort Key: (substring_index(s3.str1, '-'::text, '5'::bigint))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (substring_index(str1, '-'::text, '5'::bigint))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.substring_index(str1, '-'::text, 5::bigint) FROM public.s3mysql
(7 rows)

-- select substring_index with order by (result)
--Testcase 1807:
SELECT value1, substring_index(str1, '-', 5) FROM s3 ORDER BY substring_index(str1, '-', 5);
 value1 | substring_index 
--------+-----------------
    0.1 | ---XYZ-
    0.2 | ---XYZ-
    0.3 | ---XYZ-
    1.1 | ---XYZ-
    2.2 | ---XYZ-
    3.3 | ---XYZ-
(6 rows)

-- select substring_index with order by index (result)
--Testcase 1808:
SELECT value1, substring_index(str1, '-', 5) FROM s3 ORDER BY 2,1;
 value1 | substring_index 
--------+-----------------
    0.1 | ---XYZ-
    0.2 | ---XYZ-
    0.3 | ---XYZ-
    1.1 | ---XYZ-
    2.2 | ---XYZ-
    3.3 | ---XYZ-
(6 rows)

-- select substring_index with order by index (result)
--Testcase 1809:
SELECT value1, substring_index(str1, '-', 5) FROM s3 ORDER BY 1,2;
 value1 | substring_index 
--------+-----------------
    0.1 | ---XYZ-
    0.2 | ---XYZ-
    0.3 | ---XYZ-
    1.1 | ---XYZ-
    2.2 | ---XYZ-
    3.3 | ---XYZ-
(6 rows)

-- select substring_index with group by (explain)
--Testcase 1810:
EXPLAIN VERBOSE
SELECT count(value1), substring_index(str1, '-', 5) FROM s3 GROUP BY substring_index(str1, '-', 5);
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (substring_index(str1, '-'::text, '5'::bigint))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.substring_index(str1, '-'::text, 5::bigint) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select substring_index with group by (result)
--Testcase 1811:
SELECT count(value1), substring_index(str1, '-', 5) FROM s3 GROUP BY substring_index(str1, '-', 5);
 count | substring_index 
-------+-----------------
     6 | ---XYZ-
(1 row)

-- select substring_index with group by index (result)
--Testcase 1812:
SELECT value1, substring_index(str1, '-', 5) FROM s3 GROUP BY 2,1;
 value1 | substring_index 
--------+-----------------
    0.1 | ---XYZ-
    0.2 | ---XYZ-
    0.3 | ---XYZ-
    1.1 | ---XYZ-
    2.2 | ---XYZ-
    3.3 | ---XYZ-
(6 rows)

-- select substring_index with group by having (explain)
--Testcase 1813:
EXPLAIN VERBOSE
SELECT count(value1), substring_index(str1, '-', 5) FROM s3 GROUP BY substring_index(str1, '-', 5), str1 HAVING substring_index(str1, '-', 5) IS NOT NULL;
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (substring_index(str1, '-'::text, '5'::bigint)), str1
   Filter: ((substring_index(s3.str1, '-'::text, '5'::bigint)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.substring_index(str1, '-'::text, 5::bigint), str1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.substring_index(str1, '-'::text, 5::bigint) IS NOT NULL))
(7 rows)

-- select substring_index with group by having (result)
--Testcase 1814:
SELECT count(value1), substring_index(str1, '-', 5) FROM s3 GROUP BY substring_index(str1, '-', 5), str1 HAVING substring_index(str1, '-', 5) IS NOT NULL;
 count | substring_index 
-------+-----------------
     6 | ---XYZ-
(1 row)

-- select substring_index with group by index having (result)
--Testcase 1815:
SELECT value1, substring_index(str1, '-', 5) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | substring_index 
--------+-----------------
    1.1 | ---XYZ-
    2.2 | ---XYZ-
    3.3 | ---XYZ-
(3 rows)

--
-- test to_base64()
--
-- select to_base64 (stub function, explain)
--Testcase 1816:
EXPLAIN VERBOSE
SELECT id, to_base64(tag1), to_base64(str1), to_base64(str2) FROM s3;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2772.14 rows=3413 width=100)
   Output: id, (to_base64(tag1)), (to_base64(str1)), (to_base64(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.to_base64(tag1), public.to_base64(str1), public.to_base64(str2) FROM public.s3mysql
(4 rows)

-- select to_base64 (stub function, result)
--Testcase 1817:
SELECT id, to_base64(tag1), to_base64(str1), to_base64(str2) FROM s3;
 id | to_base64 |  to_base64   |  to_base64   
----+-----------+--------------+--------------
  0 | YQ==      | LS0tWFlaLS0t | ICAgWFlaICAg
  1 | YQ==      | LS0tWFlaLS0t | ICAgWFlaICAg
  2 | YQ==      | LS0tWFlaLS0t | ICAgWFlaICAg
  3 | Yg==      | LS0tWFlaLS0t | ICAgWFlaICAg
  4 | Yg==      | LS0tWFlaLS0t | ICAgWFlaICAg
  5 | Yg==      | LS0tWFlaLS0t | ICAgWFlaICAg
(6 rows)

-- select to_base64 (stub function, not pushdown constraints, explain)
--Testcase 1818:
EXPLAIN VERBOSE
SELECT value1, to_base64(str1) FROM s3 WHERE to_hex(value2) = '64';
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (to_base64(str1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.to_base64(str1), value2 FROM public.s3mysql
(5 rows)

-- select to_base64 (stub function, not pushdown constraints, result)
--Testcase 1819:
SELECT value1, to_base64(str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 |  to_base64   
--------+--------------
    0.1 | LS0tWFlaLS0t
    0.2 | LS0tWFlaLS0t
    0.3 | LS0tWFlaLS0t
(3 rows)

-- select to_base64 (stub function, pushdown constraints, explain)
--Testcase 1820:
EXPLAIN VERBOSE
SELECT value1, to_base64(str1) FROM s3 WHERE value2 != 200;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (to_base64(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.to_base64(str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select to_base64 (stub function, pushdown constraints, result)
--Testcase 1821:
SELECT value1, to_base64(str1) FROM s3 WHERE value2 != 200;
 value1 |  to_base64   
--------+--------------
    0.1 | LS0tWFlaLS0t
    0.2 | LS0tWFlaLS0t
    0.3 | LS0tWFlaLS0t
(3 rows)

-- select to_base64 with non pushdown func and explicit constant (explain)
--Testcase 1822:
EXPLAIN VERBOSE
SELECT to_base64(str1), pi(), 4.1 FROM s3;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (to_base64(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_base64(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select to_base64 with non pushdown func and explicit constant (result)
--Testcase 1823:
SELECT to_base64(str1), pi(), 4.1 FROM s3;
  to_base64   |        pi         | ?column? 
--------------+-------------------+----------
 LS0tWFlaLS0t | 3.141592653589793 |      4.1
 LS0tWFlaLS0t | 3.141592653589793 |      4.1
 LS0tWFlaLS0t | 3.141592653589793 |      4.1
 LS0tWFlaLS0t | 3.141592653589793 |      4.1
 LS0tWFlaLS0t | 3.141592653589793 |      4.1
 LS0tWFlaLS0t | 3.141592653589793 |      4.1
(6 rows)

-- select to_base64 with order by (explain)
--Testcase 1824:
EXPLAIN VERBOSE
SELECT value1, to_base64(str1) FROM s3 ORDER BY to_base64(str1);
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (to_base64(str1))
   Sort Key: (to_base64(s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (to_base64(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.to_base64(str1) FROM public.s3mysql
(7 rows)

-- select to_base64 with order by (result)
--Testcase 1825:
SELECT value1, to_base64(str1) FROM s3 ORDER BY to_base64(str1);
 value1 |  to_base64   
--------+--------------
    0.1 | LS0tWFlaLS0t
    0.2 | LS0tWFlaLS0t
    0.3 | LS0tWFlaLS0t
    1.1 | LS0tWFlaLS0t
    2.2 | LS0tWFlaLS0t
    3.3 | LS0tWFlaLS0t
(6 rows)

-- select to_base64 with order by index (result)
--Testcase 1826:
SELECT value1, to_base64(str1) FROM s3 ORDER BY 2,1;
 value1 |  to_base64   
--------+--------------
    0.1 | LS0tWFlaLS0t
    0.2 | LS0tWFlaLS0t
    0.3 | LS0tWFlaLS0t
    1.1 | LS0tWFlaLS0t
    2.2 | LS0tWFlaLS0t
    3.3 | LS0tWFlaLS0t
(6 rows)

-- select to_base64 with order by index (result)
--Testcase 1827:
SELECT value1, to_base64(str1) FROM s3 ORDER BY 2,1;
 value1 |  to_base64   
--------+--------------
    0.1 | LS0tWFlaLS0t
    0.2 | LS0tWFlaLS0t
    0.3 | LS0tWFlaLS0t
    1.1 | LS0tWFlaLS0t
    2.2 | LS0tWFlaLS0t
    3.3 | LS0tWFlaLS0t
(6 rows)

-- select to_base64 with group by (explain)
--Testcase 1828:
EXPLAIN VERBOSE
SELECT count(value1), to_base64(str1) FROM s3 GROUP BY to_base64(str1);
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (to_base64(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.to_base64(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select to_base64 with group by (result)
--Testcase 1829:
SELECT count(value1), to_base64(str1) FROM s3 GROUP BY to_base64(str1);
 count |  to_base64   
-------+--------------
     6 | LS0tWFlaLS0t
(1 row)

-- select to_base64 with group by index (result)
--Testcase 1830:
SELECT value1, to_base64(str1) FROM s3 GROUP BY 2,1;
 value1 |  to_base64   
--------+--------------
    0.1 | LS0tWFlaLS0t
    0.2 | LS0tWFlaLS0t
    0.3 | LS0tWFlaLS0t
    1.1 | LS0tWFlaLS0t
    2.2 | LS0tWFlaLS0t
    3.3 | LS0tWFlaLS0t
(6 rows)

-- select to_base64 with group by having (explain)
--Testcase 1831:
EXPLAIN VERBOSE
SELECT count(value1), to_base64(str1) FROM s3 GROUP BY to_base64(str1), str1 HAVING to_base64(str1) IS NOT NULL;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (to_base64(str1)), str1
   Filter: ((to_base64(s3.str1)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.to_base64(str1), str1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.to_base64(str1) IS NOT NULL))
(7 rows)

-- select to_base64 with group by having (result)
--Testcase 1832:
SELECT count(value1), to_base64(str1) FROM s3 GROUP BY to_base64(str1), str1 HAVING to_base64(str1) IS NOT NULL;
 count |  to_base64   
-------+--------------
     6 | LS0tWFlaLS0t
(1 row)

-- select to_base64 with group by index having (result)
--Testcase 1833:
SELECT value1, to_base64(str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |  to_base64   
--------+--------------
    1.1 | LS0tWFlaLS0t
    2.2 | LS0tWFlaLS0t
    3.3 | LS0tWFlaLS0t
(3 rows)

--
-- test trim()
--
-- select trim (stub function, explain)
--Testcase 1834:
EXPLAIN VERBOSE
SELECT trim(str1), trim(str2) FROM s3;
                             QUERY PLAN                              
---------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (btrim(str1)), (btrim(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT btrim(str1), btrim(str2) FROM public.s3mysql
(4 rows)

-- select trim (stub function, result)
--Testcase 1835:
SELECT trim(str1), trim(str2) FROM s3;
   btrim   | btrim 
-----------+-------
 ---XYZ--- | XYZ
 ---XYZ--- | XYZ
 ---XYZ--- | XYZ
 ---XYZ--- | XYZ
 ---XYZ--- | XYZ
 ---XYZ--- | XYZ
(6 rows)

-- select trim (stub function, explain)
--Testcase 1836:
EXPLAIN VERBOSE
SELECT trim(LEADING '-' FROM str1), trim(LEADING ' ' FROM str2) FROM s3;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (ltrim(str1, '-'::text)), (ltrim(str2, ' '::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT ltrim(str1, '-'::text), ltrim(str2, ' '::text) FROM public.s3mysql
(4 rows)

-- select trim (stub function, result)
--Testcase 1837:
SELECT trim(LEADING '-' FROM str1), trim(LEADING ' ' FROM str2) FROM s3;
 ltrim  | ltrim  
--------+--------
 XYZ--- | XYZ   
 XYZ--- | XYZ   
 XYZ--- | XYZ   
 XYZ--- | XYZ   
 XYZ--- | XYZ   
 XYZ--- | XYZ   
(6 rows)

-- select trim (stub function, explain)
--Testcase 1838:
EXPLAIN VERBOSE
SELECT trim(BOTH '-' FROM str1), trim(BOTH ' ' FROM str2) FROM s3;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (btrim(str1, '-'::text)), (btrim(str2, ' '::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT btrim(str1, '-'::text), btrim(str2, ' '::text) FROM public.s3mysql
(4 rows)

-- select trim (stub function, result)
--Testcase 1839:
SELECT trim(BOTH '-' FROM str1), trim(BOTH ' ' FROM str2) FROM s3;
 btrim | btrim 
-------+-------
 XYZ   | XYZ
 XYZ   | XYZ
 XYZ   | XYZ
 XYZ   | XYZ
 XYZ   | XYZ
 XYZ   | XYZ
(6 rows)

-- select trim (stub function, explain)
--Testcase 1840:
EXPLAIN VERBOSE
SELECT trim(TRAILING '-' FROM str1), trim(TRAILING ' ' FROM str2) FROM s3;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (rtrim(str1, '-'::text)), (rtrim(str2, ' '::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT rtrim(str1, '-'::text), rtrim(str2, ' '::text) FROM public.s3mysql
(4 rows)

-- select trim (stub function, result)
--Testcase 1841:
SELECT trim(TRAILING '-' FROM str1), trim(TRAILING ' ' FROM str2) FROM s3;
 rtrim  | rtrim  
--------+--------
 ---XYZ |    XYZ
 ---XYZ |    XYZ
 ---XYZ |    XYZ
 ---XYZ |    XYZ
 ---XYZ |    XYZ
 ---XYZ |    XYZ
(6 rows)

-- select trim (stub function, explain)
--Testcase 1842:
EXPLAIN VERBOSE
SELECT trim('-' FROM str1), trim(' ' FROM str2) FROM s3;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.45 rows=3413 width=64)
   Output: (btrim(str1, '-'::text)), (btrim(str2, ' '::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT btrim(str1, '-'::text), btrim(str2, ' '::text) FROM public.s3mysql
(4 rows)

-- select trim (stub function, result)
--Testcase 1843:
SELECT trim('-' FROM str1), trim(' ' FROM str2) FROM s3;
 btrim | btrim 
-------+-------
 XYZ   | XYZ
 XYZ   | XYZ
 XYZ   | XYZ
 XYZ   | XYZ
 XYZ   | XYZ
 XYZ   | XYZ
(6 rows)

-- select trim (stub function, not pushdown constraints, explain)
--Testcase 1844:
EXPLAIN VERBOSE
SELECT value1, trim('-' FROM str1) FROM s3 WHERE to_hex(value2) = '64';
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (btrim(str1, '-'::text))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, btrim(str1, '-'::text), value2 FROM public.s3mysql
(5 rows)

-- select trim (stub function, not pushdown constraints, result)
--Testcase 1845:
SELECT value1, trim('-' FROM str1) FROM s3 WHERE to_hex(value2) = '64';
 value1 | btrim 
--------+-------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
(3 rows)

-- select trim (stub function, pushdown constraints, explain)
--Testcase 1846:
EXPLAIN VERBOSE
SELECT value1, trim(TRAILING '-' FROM str1) FROM s3 WHERE value2 != 200;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (rtrim(str1, '-'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, rtrim(str1, '-'::text) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select trim (stub function, pushdown constraints, result)
--Testcase 1847:
SELECT value1, trim(TRAILING '-' FROM str1) FROM s3 WHERE value2 != 200;
 value1 | rtrim  
--------+--------
    0.1 | ---XYZ
    0.2 | ---XYZ
    0.3 | ---XYZ
(3 rows)

-- select trim with non pushdown func and explicit constant (explain)
--Testcase 1848:
EXPLAIN VERBOSE
SELECT trim(TRAILING '-' FROM str1), pi(), 4.1 FROM s3;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (rtrim(str1, '-'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT rtrim(str1, '-'::text), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select trim with non pushdown func and explicit constant (result)
--Testcase 1849:
SELECT trim(TRAILING '-' FROM str1), pi(), 4.1 FROM s3;
 rtrim  |        pi         | ?column? 
--------+-------------------+----------
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
 ---XYZ | 3.141592653589793 |      4.1
(6 rows)

-- select trim with order by (explain)
--Testcase 1850:
EXPLAIN VERBOSE
SELECT value1, trim(TRAILING '-' FROM str1) FROM s3 ORDER BY trim(TRAILING '-' FROM str1);
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (rtrim(str1, '-'::text))
   Sort Key: (rtrim(s3.str1, '-'::text))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (rtrim(str1, '-'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, rtrim(str1, '-'::text) FROM public.s3mysql
(7 rows)

-- select trim with order by (result)
--Testcase 1851:
SELECT value1, trim(TRAILING '-' FROM str1) FROM s3 ORDER BY trim(TRAILING '-' FROM str1);
 value1 | rtrim  
--------+--------
    0.1 | ---XYZ
    0.2 | ---XYZ
    0.3 | ---XYZ
    1.1 | ---XYZ
    2.2 | ---XYZ
    3.3 | ---XYZ
(6 rows)

-- select trim with order by index (result)
--Testcase 1852:
SELECT value1, trim('-' FROM str1) FROM s3 ORDER BY 2,1;
 value1 | btrim 
--------+-------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(6 rows)

-- select trim with order by index (result)
--Testcase 1853:
SELECT value1, trim('-' FROM str1) FROM s3 ORDER BY 1,2;
 value1 | btrim 
--------+-------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(6 rows)

-- select trim with group by (explain)
--Testcase 1854:
EXPLAIN VERBOSE
SELECT count(value1), trim('-' FROM str1) FROM s3 GROUP BY trim('-' FROM str1);
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (btrim(str1, '-'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), btrim(str1, '-'::text) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select trim with group by (result)
--Testcase 1855:
SELECT count(value1), trim('-' FROM str1) FROM s3 GROUP BY trim('-' FROM str1);
 count | btrim 
-------+-------
     6 | XYZ
(1 row)

-- select trim with group by index (result)
--Testcase 1856:
SELECT value1, trim('-' FROM str1) FROM s3 GROUP BY 2,1;
 value1 | btrim 
--------+-------
    0.1 | XYZ
    0.2 | XYZ
    0.3 | XYZ
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(6 rows)

-- select trim with group by having (explain)
--Testcase 1857:
EXPLAIN VERBOSE
SELECT count(value1), trim('-' FROM str1) FROM s3 GROUP BY trim('-' FROM str1) , str1 HAVING trim('-' FROM str1) IS NOT NULL;
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (btrim(str1, '-'::text)), str1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), btrim(str1, '-'::text), str1 FROM public.s3mysql WHERE ((btrim(str1, '-'::text) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select trim with group by having (result)
--Testcase 1858:
SELECT count(value1), trim('-' FROM str1) FROM s3 GROUP BY trim('-' FROM str1) , str1 HAVING trim('-' FROM str1) IS NOT NULL;
 count | btrim 
-------+-------
     6 | XYZ
(1 row)

-- select trim with group by index having (result)
--Testcase 1859:
SELECT value1, trim('-' FROM str1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | btrim 
--------+-------
    1.1 | XYZ
    2.2 | XYZ
    3.3 | XYZ
(3 rows)

--
-- test ucase()
--
-- select ucase (stub function, explain)
--Testcase 1860:
EXPLAIN VERBOSE
SELECT ucase(tag1) FROM s3;
                              QUERY PLAN                              
----------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (ucase(tag1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.ucase(tag1) FROM public.s3mysql
(4 rows)

-- select ucase (stub function, result)
--Testcase 1861:
SELECT ucase(tag1) FROM s3;
 ucase 
-------
 A
 A
 A
 B
 B
 B
(6 rows)

-- select ucase (stub function, not pushdown constraints, explain)
--Testcase 1862:
EXPLAIN VERBOSE
SELECT value1, ucase(tag1) FROM s3 WHERE to_hex(value2) = '64';
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (ucase(tag1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.ucase(tag1), value2 FROM public.s3mysql
(5 rows)

-- select ucase (stub function, not pushdown constraints, result)
--Testcase 1863:
SELECT value1, ucase(tag1) FROM s3 WHERE to_hex(value2) = '64';
 value1 | ucase 
--------+-------
    0.1 | A
    0.2 | A
    0.3 | A
(3 rows)

-- select ucase (stub function, pushdown constraints, explain)
--Testcase 1864:
EXPLAIN VERBOSE
SELECT value1, ucase(tag1) FROM s3 WHERE value2 != 200;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (ucase(tag1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.ucase(tag1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select ucase (stub function, pushdown constraints, result)
--Testcase 1865:
SELECT value1, ucase(tag1) FROM s3 WHERE value2 != 200;
 value1 | ucase 
--------+-------
    0.1 | A
    0.2 | A
    0.3 | A
(3 rows)

-- select ucase with non pushdown func and explicit constant (explain)
--Testcase 1866:
EXPLAIN VERBOSE
SELECT ucase(tag1), pi(), 4.1 FROM s3;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (ucase(tag1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.ucase(tag1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select ucase with non pushdown func and explicit constant (result)
--Testcase 1867:
SELECT ucase(tag1), pi(), 4.1 FROM s3;
 ucase |        pi         | ?column? 
-------+-------------------+----------
 A     | 3.141592653589793 |      4.1
 A     | 3.141592653589793 |      4.1
 A     | 3.141592653589793 |      4.1
 B     | 3.141592653589793 |      4.1
 B     | 3.141592653589793 |      4.1
 B     | 3.141592653589793 |      4.1
(6 rows)

-- select ucase with order by (explain)
--Testcase 1868:
EXPLAIN VERBOSE
SELECT value1, ucase(tag1) FROM s3 ORDER BY ucase(tag1);
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (ucase(tag1))
   Sort Key: (ucase(s3.tag1))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (ucase(tag1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.ucase(tag1) FROM public.s3mysql
(7 rows)

-- select ucase with order by (result)
--Testcase 1869:
SELECT value1, ucase(tag1) FROM s3 ORDER BY ucase(tag1);
 value1 | ucase 
--------+-------
    0.1 | A
    0.2 | A
    0.3 | A
    1.1 | B
    2.2 | B
    3.3 | B
(6 rows)

-- select ucase with order by index (result)
--Testcase 1870:
SELECT value1, ucase(tag1) FROM s3 ORDER BY 2,1;
 value1 | ucase 
--------+-------
    0.1 | A
    0.2 | A
    0.3 | A
    1.1 | B
    2.2 | B
    3.3 | B
(6 rows)

-- select ucase with order by index (result)
--Testcase 1871:
SELECT value1, ucase(tag1) FROM s3 ORDER BY 1,2;
 value1 | ucase 
--------+-------
    0.1 | A
    0.2 | A
    0.3 | A
    1.1 | B
    2.2 | B
    3.3 | B
(6 rows)

-- select ucase with group by (explain)
--Testcase 1872:
EXPLAIN VERBOSE
SELECT count(value1), ucase(tag1) FROM s3 GROUP BY ucase(tag1);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (ucase(tag1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.ucase(tag1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select ucase with group by (result)
--Testcase 1873:
SELECT count(value1), ucase(tag1) FROM s3 GROUP BY ucase(tag1);
 count | ucase 
-------+-------
     3 | A
     3 | B
(2 rows)

-- select ucase with group by index (result)
--Testcase 1874:
SELECT value1, ucase(tag1) FROM s3 GROUP BY 2,1;
 value1 | ucase 
--------+-------
    0.1 | A
    0.2 | A
    0.3 | A
    1.1 | B
    2.2 | B
    3.3 | B
(6 rows)

-- select ucase with group by having (explain)
--Testcase 1875:
EXPLAIN VERBOSE
SELECT count(value1), ucase(tag1) FROM s3 GROUP BY ucase(tag1), tag1 HAVING ucase(tag1) IS NOT NULL;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (ucase(tag1)), tag1
   Filter: ((ucase(s3.tag1)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.ucase(tag1), tag1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.ucase(tag1) IS NOT NULL))
(7 rows)

-- select ucase with group by having (result)
--Testcase 1876:
SELECT count(value1), ucase(tag1) FROM s3 GROUP BY ucase(tag1), tag1 HAVING ucase(tag1) IS NOT NULL;
 count | ucase 
-------+-------
     3 | A
     3 | B
(2 rows)

-- select ucase with group by index having (result)
--Testcase 1877:
SELECT value1, ucase(tag1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | ucase 
--------+-------
    1.1 | B
    2.2 | B
    3.3 | B
(3 rows)

--
-- test unhex()
--
-- select unhex (stub function, explain)
--Testcase 1878:
EXPLAIN VERBOSE
SELECT unhex(hex(str1)), unhex(hex(str2)) FROM s3;
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..3625.39 rows=3413 width=64)
   Output: (unhex(hex(str1))), (unhex(hex(str2)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unhex(public.hex(str1)), public.unhex(public.hex(str2)) FROM public.s3mysql
(4 rows)

-- select unhex (stub function, result)
--Testcase 1879:
SELECT unhex(hex(str1)), unhex(hex(str2)) FROM s3;
   unhex   |   unhex   
-----------+-----------
 ---XYZ--- |    XYZ   
 ---XYZ--- |    XYZ   
 ---XYZ--- |    XYZ   
 ---XYZ--- |    XYZ   
 ---XYZ--- |    XYZ   
 ---XYZ--- |    XYZ   
(6 rows)

-- select unhex (stub function, not pushdown constraints, explain)
--Testcase 1880:
EXPLAIN VERBOSE
SELECT value1, unhex(hex(str2)) FROM s3 WHERE to_hex(value2) = '64';
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.69 rows=17 width=40)
   Output: value1, (unhex(hex(str2)))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.unhex(public.hex(str2)), value2 FROM public.s3mysql
(5 rows)

-- select unhex (stub function, not pushdown constraints, result)
--Testcase 1881:
SELECT value1, unhex(hex(str2)) FROM s3 WHERE to_hex(value2) = '64';
 value1 |   unhex   
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
(3 rows)

-- select unhex (stub function, pushdown constraints, explain)
--Testcase 1882:
EXPLAIN VERBOSE
SELECT value1, unhex(hex(str2)) FROM s3 WHERE value2 != 200;
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.58 rows=3396 width=40)
   Output: value1, (unhex(hex(str2)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.unhex(public.hex(str2)) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select unhex (stub function, pushdown constraints, result)
--Testcase 1883:
SELECT value1, unhex(hex(str2)) FROM s3 WHERE value2 != 200;
 value1 |   unhex   
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
(3 rows)

-- select unhex with non pushdown func and explicit constant (explain)
--Testcase 1884:
EXPLAIN VERBOSE
SELECT unhex(hex(str2)), pi(), 4.1 FROM s3;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=72)
   Output: (unhex(hex(str2))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unhex(public.hex(str2)), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select unhex with non pushdown func and explicit constant (result)
--Testcase 1885:
SELECT unhex(hex(str2)), pi(), 4.1 FROM s3;
   unhex   |        pi         | ?column? 
-----------+-------------------+----------
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
    XYZ    | 3.141592653589793 |      4.1
(6 rows)

-- select unhex with order by (explain)
--Testcase 1886:
EXPLAIN VERBOSE
SELECT value1, unhex(hex(str2)) FROM s3 ORDER BY unhex(hex(str2));
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=40)
   Output: value1, (unhex(hex(str2)))
   Sort Key: (unhex(hex(s3.str2)))
   ->  Foreign Scan on public.s3  (cost=100.00..1918.89 rows=3413 width=40)
         Output: value1, (unhex(hex(str2)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.unhex(public.hex(str2)) FROM public.s3mysql
(7 rows)

-- select unhex with order by (result)
--Testcase 1887:
SELECT value1, unhex(hex(str2)) FROM s3 ORDER BY unhex(hex(str2));
 value1 |   unhex   
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(6 rows)

-- select unhex with order by index (result)
--Testcase 1888:
SELECT value1, unhex(hex(str2)) FROM s3 ORDER BY 2,1;
 value1 |   unhex   
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(6 rows)

-- select unhex with order by index (result)
--Testcase 1889:
SELECT value1, unhex(hex(str2)) FROM s3 ORDER BY 1,2;
 value1 |   unhex   
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(6 rows)

-- select unhex with group by (explain)
--Testcase 1890:
EXPLAIN VERBOSE
SELECT count(value1), unhex(hex(str2)) FROM s3 GROUP BY unhex(hex(str2));
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (unhex(hex(str2)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.unhex(public.hex(str2)) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select unhex with group by (result)
--Testcase 1891:
SELECT count(value1), unhex(hex(str2)) FROM s3 GROUP BY unhex(hex(str2));
 count |   unhex   
-------+-----------
     6 |    XYZ   
(1 row)

-- select unhex with group by index (result)
--Testcase 1892:
SELECT value1, unhex(hex(str2)) FROM s3 GROUP BY 2,1;
 value1 |   unhex   
--------+-----------
    0.1 |    XYZ   
    0.2 |    XYZ   
    0.3 |    XYZ   
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(6 rows)

-- select unhex with group by having (explain)
--Testcase 1893:
EXPLAIN VERBOSE
SELECT count(value1), unhex(hex(str2)) FROM s3 GROUP BY unhex(hex(str2)), str2 HAVING unhex(hex(str2)) IS NOT NULL;
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (unhex(hex(str2))), str2
   Filter: ((unhex(hex(s3.str2))) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.unhex(public.hex(str2)), str2 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.unhex(public.hex(str2)) IS NOT NULL))
(7 rows)

-- select unhex with group by having (result)
--Testcase 1894:
SELECT count(value1), unhex(hex(str2)) FROM s3 GROUP BY unhex(hex(str2)), str2 HAVING unhex(hex(str2)) IS NOT NULL;
 count |   unhex   
-------+-----------
     6 |    XYZ   
(1 row)

-- select unhex with group by index having (result)
--Testcase 1895:
SELECT value1, unhex(hex(str2)) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |   unhex   
--------+-----------
    1.1 |    XYZ   
    2.2 |    XYZ   
    3.3 |    XYZ   
(3 rows)

--
-- test upper()
--
-- select upper (stub function, explain)
--Testcase 1896:
EXPLAIN VERBOSE
SELECT upper(tag1), upper(str1), upper(str2) FROM s3;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..237.99 rows=3413 width=96)
   Output: (upper(tag1)), (upper(str1)), (upper(str2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT upper(tag1), upper(str1), upper(str2) FROM public.s3mysql
(4 rows)

-- select upper (stub function, result)
--Testcase 1897:
SELECT upper(tag1), upper(str1), upper(str2) FROM s3;
 upper |   upper   |   upper   
-------+-----------+-----------
 A     | ---XYZ--- |    XYZ   
 A     | ---XYZ--- |    XYZ   
 A     | ---XYZ--- |    XYZ   
 B     | ---XYZ--- |    XYZ   
 B     | ---XYZ--- |    XYZ   
 B     | ---XYZ--- |    XYZ   
(6 rows)

-- select upper (stub function, not pushdown constraints, explain)
--Testcase 1898:
EXPLAIN VERBOSE
SELECT value1, upper(tag1) FROM s3 WHERE to_hex(value2) = '64';
                               QUERY PLAN                               
------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.24 rows=17 width=40)
   Output: value1, (upper(tag1))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, upper(tag1), value2 FROM public.s3mysql
(5 rows)

-- select upper (stub function, not pushdown constraints, result)
--Testcase 1899:
SELECT value1, upper(tag1) FROM s3 WHERE to_hex(value2) = '64';
 value1 | upper 
--------+-------
    0.1 | A
    0.2 | A
    0.3 | A
(3 rows)

-- select upper (stub function, pushdown constraints, explain)
--Testcase 1900:
EXPLAIN VERBOSE
SELECT value1, upper(str1) FROM s3 WHERE value2 != 200;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..229.07 rows=3396 width=40)
   Output: value1, (upper(str1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, upper(str1) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select upper (stub function, pushdown constraints, result)
--Testcase 1901:
SELECT value1, upper(str1) FROM s3 WHERE value2 != 200;
 value1 |   upper   
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
(3 rows)

-- select upper with non pushdown func and explicit constant (explain)
--Testcase 1902:
EXPLAIN VERBOSE
SELECT upper(str1), pi(), 4.1 FROM s3;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=72)
   Output: (upper(str1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT upper(str1), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select ucase with non pushdown func and explicit constant (result)
--Testcase 1903:
SELECT upper(str1), pi(), 4.1 FROM s3;
   upper   |        pi         | ?column? 
-----------+-------------------+----------
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
 ---XYZ--- | 3.141592653589793 |      4.1
(6 rows)

-- select upper with order by (explain)
--Testcase 1904:
EXPLAIN VERBOSE
SELECT value1, upper(str1) FROM s3 ORDER BY upper(str1);
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Sort  (cost=421.21..429.74 rows=3413 width=40)
   Output: value1, (upper(str1))
   Sort Key: (upper(s3.str1))
   ->  Foreign Scan on public.s3  (cost=100.00..220.92 rows=3413 width=40)
         Output: value1, (upper(str1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, upper(str1) FROM public.s3mysql
(7 rows)

-- select upper with order by (result)
--Testcase 1905:
SELECT value1, upper(str1) FROM s3 ORDER BY upper(str1);
 value1 |   upper   
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select upper with order by index (result)
--Testcase 1906:
SELECT value1, upper(str1) FROM s3 ORDER BY 2,1;
 value1 |   upper   
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select upper with order by index (result)
--Testcase 1907:
SELECT value1, upper(str1) FROM s3 ORDER BY 1,2;
 value1 |   upper   
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select upper with group by (explain)
--Testcase 1908:
EXPLAIN VERBOSE
SELECT count(value1), upper(str1) FROM s3 GROUP BY upper(str1);
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (upper(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), upper(str1) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select upper with group by (result)
--Testcase 1909:
SELECT count(value1), upper(str1) FROM s3 GROUP BY upper(str1);
 count |   upper   
-------+-----------
     6 | ---XYZ---
(1 row)

-- select upper with group by index (result)
--Testcase 1910:
SELECT value1, upper(str1) FROM s3 GROUP BY 2,1;
 value1 |   upper   
--------+-----------
    0.1 | ---XYZ---
    0.2 | ---XYZ---
    0.3 | ---XYZ---
    1.1 | ---XYZ---
    2.2 | ---XYZ---
    3.3 | ---XYZ---
(6 rows)

-- select upper with group by having (explain)
--Testcase 1911:
EXPLAIN VERBOSE
SELECT count(value1), upper(str1) FROM s3 GROUP BY upper(str1), tag1 HAVING upper(str1) IS NOT NULL;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (upper(str1)), tag1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), upper(str1), tag1 FROM public.s3mysql WHERE ((upper(str1) IS NOT NULL)) GROUP BY 2, 3
(6 rows)

-- select upper with group by having (result)
--Testcase 1912:
SELECT count(value1), upper(str1) FROM s3 GROUP BY upper(str1), tag1 HAVING upper(str1) IS NOT NULL;
 count |   upper   
-------+-----------
     3 | ---XYZ---
     3 | ---XYZ---
(2 rows)

-- select upper with group by index having (result)
--Testcase 1913:
SELECT value1, upper(tag1) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 | upper 
--------+-------
    1.1 | B
    2.2 | B
    3.3 | B
(3 rows)

--
-- test weight_string()
--
-- select weight_string (stub function, explain)
--Testcase 1914:
EXPLAIN VERBOSE
SELECT weight_string('NULL') FROM s3;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (weight_string('NULL'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weight_string('NULL'::text) FROM public.s3mysql
(4 rows)

-- select weight_string (stub function, result)
--Testcase 1915:
SELECT weight_string('NULL') FROM s3;
 weight_string 
---------------
 
 
 
 
 
 
(6 rows)

-- select weight_string (stub function, explain)
--Testcase 1916:
EXPLAIN VERBOSE
SELECT weight_string(str1), weight_string(str1, 'CHAR', 3), weight_string(str1, 'BINARY', 5) FROM s3;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..2772.14 rows=3413 width=96)
   Output: (weight_string(str1)), (weight_string(str1, 'CHAR'::mysql_string_type, 3)), (weight_string(str1, 'BINARY'::mysql_string_type, 5))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weight_string(str1), public.weight_string(str1, 'CHAR'::public.mysql_string_type, 3), public.weight_string(str1, 'BINARY'::public.mysql_string_type, 5) FROM public.s3mysql
(4 rows)

-- select weight_string (stub function, result)
--Testcase 1917:
SELECT weight_string(str1), weight_string(str1, 'CHAR', 3), weight_string(str1, 'BINARY', 5) FROM s3;
                     weight_string                     |   weight_string    | weight_string 
-------------------------------------------------------+--------------------+---------------
 \x02\r\x02\r\x02\r\x1E\x1F\x0B\x1F!\x02\r\x02\r\x02\r | \x02\r\x02\r\x02\r | ---XY
 \x02\r\x02\r\x02\r\x1E\x1F\x0B\x1F!\x02\r\x02\r\x02\r | \x02\r\x02\r\x02\r | ---XY
 \x02\r\x02\r\x02\r\x1E\x1F\x0B\x1F!\x02\r\x02\r\x02\r | \x02\r\x02\r\x02\r | ---XY
 \x02\r\x02\r\x02\r\x1E\x1F\x0B\x1F!\x02\r\x02\r\x02\r | \x02\r\x02\r\x02\r | ---XY
 \x02\r\x02\r\x02\r\x1E\x1F\x0B\x1F!\x02\r\x02\r\x02\r | \x02\r\x02\r\x02\r | ---XY
 \x02\r\x02\r\x02\r\x1E\x1F\x0B\x1F!\x02\r\x02\r\x02\r | \x02\r\x02\r\x02\r | ---XY
(6 rows)

-- select weight_string (stub function, not pushdown constraints, explain)
--Testcase 1918:
EXPLAIN VERBOSE
SELECT value1, weight_string(str1, 'CHAR', 3) FROM s3 WHERE to_hex(value2) = '64';
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..233.44 rows=17 width=40)
   Output: value1, (weight_string(str1, 'CHAR'::mysql_string_type, 3))
   Filter: (to_hex(s3.value2) = '64'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.weight_string(str1, 'CHAR'::public.mysql_string_type, 3), value2 FROM public.s3mysql
(5 rows)

-- select weight_string (stub function, not pushdown constraints, result)
--Testcase 1919:
SELECT value1, weight_string(str1, 'CHAR', 3) FROM s3 WHERE to_hex(value2) = '64';
 value1 |   weight_string    
--------+--------------------
    0.1 | \x02\r\x02\r\x02\r
    0.2 | \x02\r\x02\r\x02\r
    0.3 | \x02\r\x02\r\x02\r
(3 rows)

-- select weight_string (stub function, pushdown constraints, explain)
--Testcase 1920:
EXPLAIN VERBOSE
SELECT value1, weight_string(str1, 'BINARY', 5) FROM s3 WHERE value2 != 200;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1069.58 rows=3396 width=40)
   Output: value1, (weight_string(str1, 'BINARY'::mysql_string_type, 5))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT value1, public.weight_string(str1, 'BINARY'::public.mysql_string_type, 5) FROM public.s3mysql WHERE ((value2 <> 200))
(4 rows)

-- select weight_string (stub function, pushdown constraints, result)
--Testcase 1921:
SELECT value1, weight_string(str1, 'BINARY', 5) FROM s3 WHERE value2 != 200;
 value1 | weight_string 
--------+---------------
    0.1 | ---XY
    0.2 | ---XY
    0.3 | ---XY
(3 rows)

-- select weight_string with non pushdown func and explicit constant (explain)
--Testcase 1922:
EXPLAIN VERBOSE
SELECT weight_string(str1, 'BINARY', 5), pi(), 4.1 FROM s3;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (weight_string(str1, 'BINARY'::mysql_string_type, 5)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weight_string(str1, 'BINARY'::public.mysql_string_type, 5), 3.141592653589793::double precision, 4.1 FROM public.s3mysql
(4 rows)

-- select weight_string with non pushdown func and explicit constant (result)
--Testcase 1923:
SELECT weight_string(str1, 'BINARY', 5), pi(), 4.1 FROM s3;
 weight_string |        pi         | ?column? 
---------------+-------------------+----------
 ---XY         | 3.141592653589793 |      4.1
 ---XY         | 3.141592653589793 |      4.1
 ---XY         | 3.141592653589793 |      4.1
 ---XY         | 3.141592653589793 |      4.1
 ---XY         | 3.141592653589793 |      4.1
 ---XY         | 3.141592653589793 |      4.1
(6 rows)

-- select weight_string with order by (explain)
--Testcase 1924:
EXPLAIN VERBOSE
SELECT value1, weight_string(str1, 'BINARY', 5) FROM s3 ORDER BY weight_string(str1, 'BINARY', 5);
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=40)
   Output: value1, (weight_string(str1, 'BINARY'::mysql_string_type, 5))
   Sort Key: (weight_string(s3.str1, 'BINARY'::mysql_string_type, 5))
   ->  Foreign Scan on public.s3  (cost=100.00..1065.64 rows=3413 width=40)
         Output: value1, (weight_string(str1, 'BINARY'::mysql_string_type, 5))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT value1, public.weight_string(str1, 'BINARY'::public.mysql_string_type, 5) FROM public.s3mysql
(7 rows)

-- select weight_string with order by (result)
--Testcase 1925:
SELECT value1, weight_string(str1, 'BINARY', 5) FROM s3 ORDER BY weight_string(str1, 'BINARY', 5);
 value1 | weight_string 
--------+---------------
    0.1 | ---XY
    0.2 | ---XY
    0.3 | ---XY
    1.1 | ---XY
    2.2 | ---XY
    3.3 | ---XY
(6 rows)

-- select weight_string with order by index (result)
--Testcase 1926:
SELECT value1, weight_string(str1, 'CHAR', 3) FROM s3 ORDER BY 2,1;
 value1 |   weight_string    
--------+--------------------
    0.1 | \x02\r\x02\r\x02\r
    0.2 | \x02\r\x02\r\x02\r
    0.3 | \x02\r\x02\r\x02\r
    1.1 | \x02\r\x02\r\x02\r
    2.2 | \x02\r\x02\r\x02\r
    3.3 | \x02\r\x02\r\x02\r
(6 rows)

-- select weight_string with order by index (result)
--Testcase 1927:
SELECT value1, weight_string(str1, 'CHAR', 3) FROM s3 ORDER BY 1,2;
 value1 |   weight_string    
--------+--------------------
    0.1 | \x02\r\x02\r\x02\r
    0.2 | \x02\r\x02\r\x02\r
    0.3 | \x02\r\x02\r\x02\r
    1.1 | \x02\r\x02\r\x02\r
    2.2 | \x02\r\x02\r\x02\r
    3.3 | \x02\r\x02\r\x02\r
(6 rows)

-- select weight_string with group by (explain)
--Testcase 1928:
EXPLAIN VERBOSE
SELECT count(value1), weight_string(str1, 'CHAR', 3) FROM s3 GROUP BY weight_string(str1, 'CHAR', 3);
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(value1)), (weight_string(str1, 'CHAR'::mysql_string_type, 3))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.weight_string(str1, 'CHAR'::public.mysql_string_type, 3) FROM public.s3mysql GROUP BY 2
(6 rows)

-- select weight_string with group by (result)
--Testcase 1929:
SELECT count(value1), weight_string(str1, 'CHAR', 3) FROM s3 GROUP BY weight_string(str1, 'CHAR', 3);
 count |   weight_string    
-------+--------------------
     6 | \x02\r\x02\r\x02\r
(1 row)

-- select weight_string with group by index (result)
--Testcase 1930:
SELECT value1, weight_string(str1, 'CHAR', 3) FROM s3 GROUP BY 2,1;
 value1 |   weight_string    
--------+--------------------
    0.1 | \x02\r\x02\r\x02\r
    0.2 | \x02\r\x02\r\x02\r
    0.3 | \x02\r\x02\r\x02\r
    1.1 | \x02\r\x02\r\x02\r
    2.2 | \x02\r\x02\r\x02\r
    3.3 | \x02\r\x02\r\x02\r
(6 rows)

-- select weight_string with group by having (explain)
--Testcase 1931:
EXPLAIN VERBOSE
SELECT count(value1), weight_string(str1, 'CHAR', 3) FROM s3 GROUP BY weight_string(str1, 'CHAR', 3), str1 HAVING weight_string(str1, 'CHAR', 3) IS NOT NULL;
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (count(value1)), (weight_string(str1, 'CHAR'::mysql_string_type, 3)), str1
   Filter: ((weight_string(s3.str1, 'CHAR'::mysql_string_type, 3)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s3)
     Remote SQL: SELECT count(value1), public.weight_string(str1, 'CHAR'::public.mysql_string_type, 3), str1 FROM public.s3mysql GROUP BY 2, 3 HAVING ((public.weight_string(str1, 'CHAR'::public.mysql_string_type, 3) IS NOT NULL))
(7 rows)

-- select weight_string with group by having (result)
--Testcase 1932:
SELECT count(value1), weight_string(str1, 'CHAR', 3) FROM s3 GROUP BY weight_string(str1, 'CHAR', 3), str1 HAVING weight_string(str1, 'CHAR', 3) IS NOT NULL;
 count |   weight_string    
-------+--------------------
     6 | \x02\r\x02\r\x02\r
(1 row)

-- select weight_string with group by index having (result)
--Testcase 1933:
SELECT value1, weight_string(str1, 'CHAR', 3) FROM s3 GROUP BY 1,2 HAVING value1 > 1;
 value1 |   weight_string    
--------+--------------------
    1.1 | \x02\r\x02\r\x02\r
    2.2 | \x02\r\x02\r\x02\r
    3.3 | \x02\r\x02\r\x02\r
(3 rows)

--
-- test for date/time function
--
--Testcase 1934:
CREATE FOREIGN TABLE time_tbl (id int, c1 time without time zone, c2 date, c3 timestamp, __spd_url text) SERVER pgspider_core_svr;
--Testcase 1935:
CREATE FOREIGN TABLE time_tbl__pgspider_svr__0 (id int, c1 time without time zone, c2 date, c3 timestamp, __spd_url text) SERVER pgspider_svr OPTIONS (table_name 'time_tblmysql');
-- ADDDATE()
-- select adddate (stub function, explain)
--Testcase 1936:
EXPLAIN VERBOSE
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl;
                                                                                                                                                       QUERY PLAN                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3642.45 rows=3413 width=24)
   Output: (adddate((c2)::timestamp without time zone, 31)), (adddate((c2)::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, 31))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.adddate(c2, 31), public.adddate(c2, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, 31) FROM public.time_tblmysql
(4 rows)

-- select adddate (stub function, result)
--Testcase 1937:
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl;
  adddate   |       adddate       |       adddate       |  adddate   
------------+---------------------+---------------------+------------
 2021-02-02 | 2021-07-01 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-01 | 2021-06-30 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-10 | 2021-07-09 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-15 | 2021-07-14 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-03-01 | 2021-07-28 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
(5 rows)

-- select adddate (stub function, not pushdown constraints, explain)
--Testcase 1938:
EXPLAIN VERBOSE
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                                       QUERY PLAN                                                                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..246.28 rows=17 width=24)
   Output: (adddate((c2)::timestamp without time zone, 31)), (adddate((c2)::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, 31))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.adddate(c2, 31), public.adddate(c2, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, 31), id FROM public.time_tblmysql
(5 rows)

-- select adddate (stub function, not pushdown constraints, result)
--Testcase 1939:
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl WHERE to_hex(id) = '1';
  adddate   |       adddate       |       adddate       |  adddate   
------------+---------------------+---------------------+------------
 2021-02-01 | 2021-06-30 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
(1 row)

-- select adddate (stub function, pushdown constraints, explain)
--Testcase 1940:
EXPLAIN VERBOSE
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl WHERE id != 0;
                                                                                                                                                              QUERY PLAN                                                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3633.56 rows=3396 width=24)
   Output: (adddate((c2)::timestamp without time zone, 31)), (adddate((c2)::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, 31))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.adddate(c2, 31), public.adddate(c2, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, 31) FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select adddate (stub function, pushdown constraints, result)
--Testcase 1941:
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl WHERE id != 0;
  adddate   |       adddate       |       adddate       |  adddate   
------------+---------------------+---------------------+------------
 2021-02-01 | 2021-06-30 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-10 | 2021-07-09 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-15 | 2021-07-14 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-03-01 | 2021-07-28 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
(4 rows)

-- select adddate (stub function, adddate in constraints, explain)
--Testcase 1942:
EXPLAIN VERBOSE
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl WHERE adddate(c2, 31) != '2021-01-02';
                                                                                                                                                                                 QUERY PLAN                                                                                                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4495.34 rows=3396 width=24)
   Output: (adddate((c2)::timestamp without time zone, 31)), (adddate((c2)::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, 31))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.adddate(c2, 31), public.adddate(c2, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, 31) FROM public.time_tblmysql WHERE ((public.adddate(c2, 31) <> '2021-01-02'::date))
(4 rows)

-- select adddate (stub function, adddate in constraints, result)
--Testcase 1943:
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl WHERE adddate(c2, 31) != '2021-01-02';
  adddate   |       adddate       |       adddate       |  adddate   
------------+---------------------+---------------------+------------
 2021-02-02 | 2021-07-01 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-01 | 2021-06-30 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-10 | 2021-07-09 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-15 | 2021-07-14 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-03-01 | 2021-07-28 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
(5 rows)

-- select adddate (stub function, adddate in constraints, explain)
--Testcase 1944:
EXPLAIN VERBOSE
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl WHERE adddate('2021-01-02'::date, 31) > '2021-01-02';
                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2172.36 rows=1138 width=24)
   Output: (adddate((c2)::timestamp without time zone, 31)), (adddate((c2)::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, 31))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.adddate(c2, 31), public.adddate(c2, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, 31) FROM public.time_tblmysql WHERE ((public.adddate('2021-01-02 00:00:00'::timestamp without time zone, 31) > '2021-01-02'::date))
(4 rows)

-- select adddate (stub function, adddate in constraints, result)
--Testcase 1945:
SELECT adddate(c2, 31), adddate(c2, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), adddate('2021-01-02'::date, 31) FROM time_tbl WHERE adddate('2021-01-02'::date, 31) > '2021-01-02';
  adddate   |       adddate       |       adddate       |  adddate   
------------+---------------------+---------------------+------------
 2021-02-02 | 2021-07-01 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-01 | 2021-06-30 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-10 | 2021-07-09 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-02-15 | 2021-07-14 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
 2021-03-01 | 2021-07-28 02:30:00 | 2021-07-01 02:30:00 | 2021-02-02
(5 rows)

-- select adddate as nest function with agg (pushdown, explain)
--Testcase 1946:
EXPLAIN VERBOSE
SELECT max(id), adddate('2021-01-02'::date, max(id)) FROM time_tbl;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (max(id)), (adddate('2021-01-02 00:00:00'::timestamp without time zone, max(id)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(id), public.adddate('2021-01-02 00:00:00'::timestamp without time zone, max(id)) FROM public.time_tblmysql
(6 rows)

-- select adddate as nest function with agg (pushdown, result)
--Testcase 1947:
SELECT max(id), adddate('2021-01-02'::date, max(id)) FROM time_tbl;
 max |  adddate   
-----+------------
   4 | 2021-01-06
(1 row)

-- select adddate as nest with stub (pushdown, explain)
--Testcase 1948:
EXPLAIN VERBOSE
SELECT adddate(makedate(2019, id), 31) FROM time_tbl;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=4)
   Output: (adddate((makedate(2019, id))::timestamp without time zone, 31))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.adddate(public.makedate(2019, id), 31) FROM public.time_tblmysql
(4 rows)

-- select adddate as nest with stub (pushdown, result)
--Testcase 1949:
SELECT adddate(makedate(2019, id), 31) FROM time_tbl;
  adddate   
------------
 
 2019-02-01
 2019-02-02
 2019-02-03
 2019-02-04
(5 rows)

-- select adddate with non pushdown func and explicit constant (explain)
--Testcase 1950:
EXPLAIN VERBOSE
SELECT adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), pi(), 4.1 FROM time_tbl;
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=48)
   Output: (adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.adddate('2021-01-02 00:00:00'::timestamp without time zone, '@ 6 mons 2 hours 30 mins'::interval), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select adddate with non pushdown func and explicit constant (result)
--Testcase 1951:
SELECT adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes'), pi(), 4.1 FROM time_tbl;
       adddate       |        pi         | ?column? 
---------------------+-------------------+----------
 2021-07-01 02:30:00 | 3.141592653589793 |      4.1
 2021-07-01 02:30:00 | 3.141592653589793 |      4.1
 2021-07-01 02:30:00 | 3.141592653589793 |      4.1
 2021-07-01 02:30:00 | 3.141592653589793 |      4.1
 2021-07-01 02:30:00 | 3.141592653589793 |      4.1
(5 rows)

-- select adddate with order by (explain)
--Testcase 1952:
EXPLAIN VERBOSE
SELECT id, adddate(c2, id + 5) FROM time_tbl order by adddate(c2, id + 5);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Sort  (cost=1282.99..1291.53 rows=3413 width=8)
   Output: id, (adddate((c2)::timestamp without time zone, (id + 5)))
   Sort Key: (adddate((time_tbl.c2)::timestamp without time zone, (time_tbl.id + 5)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1082.70 rows=3413 width=8)
         Output: id, (adddate((c2)::timestamp without time zone, (id + 5)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.adddate(c2, (id + 5)) FROM public.time_tblmysql
(7 rows)

-- select adddate with order by (result)
--Testcase 1953:
SELECT id, adddate(c2, id + 5) FROM time_tbl order by adddate(c2, id + 5);
 id |  adddate   
----+------------
  0 | 2021-01-07
  1 | 2021-01-07
  2 | 2021-01-17
  3 | 2021-01-23
  4 | 2021-02-07
(5 rows)

-- select adddate with order by index (explain)
--Testcase 1954:
EXPLAIN VERBOSE
SELECT id, adddate(c2, id + 5) FROM time_tbl order by 1,2;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Sort  (cost=1282.99..1291.53 rows=3413 width=8)
   Output: id, (adddate((c2)::timestamp without time zone, (id + 5)))
   Sort Key: time_tbl.id, (adddate((time_tbl.c2)::timestamp without time zone, (time_tbl.id + 5)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1082.70 rows=3413 width=8)
         Output: id, (adddate((c2)::timestamp without time zone, (id + 5)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.adddate(c2, (id + 5)) FROM public.time_tblmysql
(7 rows)

-- select adddate with order by index (result)
--Testcase 1955:
SELECT id, adddate(c2, id + 5) FROM time_tbl order by 1,2;
 id |  adddate   
----+------------
  0 | 2021-01-07
  1 | 2021-01-07
  2 | 2021-01-17
  3 | 2021-01-23
  4 | 2021-02-07
(5 rows)

-- select adddate with group by (explain)
--Testcase 1956:
EXPLAIN VERBOSE
SELECT count(id), adddate(c2, id + 5) FROM time_tbl group by adddate(c2, id + 5);
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (adddate((c2)::timestamp without time zone, (id + 5)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.adddate(c2, (id + 5)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select adddate with group by (result)
--Testcase 1957:
SELECT count(id), adddate(c2, id + 5) FROM time_tbl group by adddate(c2, id + 5);
 count |  adddate   
-------+------------
     2 | 2021-01-07
     1 | 2021-01-17
     1 | 2021-01-23
     1 | 2021-02-07
(4 rows)

-- select adddate with group by index (result)
--Testcase 1958:
SELECT id, adddate(c2, id + 5) FROM time_tbl group by 2,1;
 id |  adddate   
----+------------
  0 | 2021-01-07
  1 | 2021-01-07
  2 | 2021-01-17
  3 | 2021-01-23
  4 | 2021-02-07
(5 rows)

-- select adddate with group by index (result)
--Testcase 1959:
SELECT id, adddate(c2, id + 5) FROM time_tbl group by 1,2;
 id |  adddate   
----+------------
  0 | 2021-01-07
  1 | 2021-01-07
  2 | 2021-01-17
  3 | 2021-01-23
  4 | 2021-02-07
(5 rows)

-- select adddate with group by having (explain)
--Testcase 1960:
EXPLAIN VERBOSE
SELECT count(id), adddate(c2, id + 5) FROM time_tbl group by adddate(c2, id + 5), id,c2 HAVING adddate(c2, id + 5) > '2000-01-02';
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (count(id)), (adddate((c2)::timestamp without time zone, (id + 5))), id, c2
   Filter: ((adddate((time_tbl.c2)::timestamp without time zone, (time_tbl.id + 5))) > '2000-01-02'::date)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.adddate(c2, (id + 5)), id, c2 FROM public.time_tblmysql GROUP BY 2, 3, 4
(7 rows)

-- select adddate with group by having (result)
--Testcase 1961:
SELECT count(id), adddate(c2, id + 5) FROM time_tbl group by adddate(c2, id + 5), id,c2 HAVING adddate(c2, id + 5) > '2000-01-02';
 count |  adddate   
-------+------------
     1 | 2021-01-07
     1 | 2021-01-07
     1 | 2021-01-17
     1 | 2021-01-23
     1 | 2021-02-07
(5 rows)

-- select adddate with group by index having (result)
--Testcase 1962:
SELECT id, adddate(c2, id + 5), c2 FROM time_tbl group by 3,2,1 HAVING adddate(c2, id + 5) > '2000-01-02';
 id |  adddate   |     c2     
----+------------+------------
  0 | 2021-01-07 | 2021-01-02
  1 | 2021-01-07 | 2021-01-01
  2 | 2021-01-17 | 2021-01-10
  3 | 2021-01-23 | 2021-01-15
  4 | 2021-02-07 | 2021-01-29
(5 rows)

-- select adddate with group by index having (result)
--Testcase 1963:
SELECT id, adddate(c2, id + 5), c2 FROM time_tbl group by 1,2,3 HAVING adddate(c2, id + 5) > '2000-01-02';
 id |  adddate   |     c2     
----+------------+------------
  0 | 2021-01-07 | 2021-01-02
  1 | 2021-01-07 | 2021-01-01
  2 | 2021-01-17 | 2021-01-10
  3 | 2021-01-23 | 2021-01-15
  4 | 2021-02-07 | 2021-01-29
(5 rows)

-- select adddate and as
--Testcase 1964:
SELECT adddate('2021-01-02'::date, INTERVAL '6 months 2 hours 30 minutes') as adddate1 FROM time_tbl;
      adddate1       
---------------------
 2021-07-01 02:30:00
 2021-07-01 02:30:00
 2021-07-01 02:30:00
 2021-07-01 02:30:00
 2021-07-01 02:30:00
(5 rows)

-- ADDTIME()
-- select addtime (stub function, explain)
--Testcase 1965:
EXPLAIN VERBOSE
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl;
                                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4478.64 rows=3413 width=48)
   Output: (addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (addtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (addtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.addtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.addtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql
(4 rows)

-- select addtime (stub function, result)
--Testcase 1966:
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl;
       addtime       |       addtime       |           addtime           |           addtime           
---------------------+---------------------+-----------------------------+-----------------------------
 2021-01-05 01:09:40 | 2021-02-07 11:10:29 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-06 12:11:23 | 2021-02-08 22:12:12 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-07 00:11:22 | 2021-02-09 10:12:11 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-08 04:59:10 | 2021-02-10 14:59:59 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-08 13:59:09 | 2021-02-10 23:59:58 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
(5 rows)

-- select addtime (stub function, not pushdown constraints, explain)
--Testcase 1967:
EXPLAIN VERBOSE
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.44 rows=17 width=48)
   Output: (addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (addtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (addtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.addtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.addtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval), id FROM public.time_tblmysql
(5 rows)

-- select addtime (stub function, not pushdown constraints, result)
--Testcase 1968:
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE to_hex(id) = '1';
       addtime       |       addtime       |           addtime           |           addtime           
---------------------+---------------------+-----------------------------+-----------------------------
 2021-01-06 12:11:23 | 2021-02-08 22:12:12 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
(1 row)

-- select addtime (stub function, pushdown constraints, explain)
--Testcase 1969:
EXPLAIN VERBOSE
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE id != 0;
                                                                                                                                                                                                               QUERY PLAN                                                                                                                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4465.58 rows=3396 width=48)
   Output: (addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (addtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (addtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.addtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.addtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select addtime (stub function, pushdown constraints, result)
--Testcase 1970:
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE id != 0;
       addtime       |       addtime       |           addtime           |           addtime           
---------------------+---------------------+-----------------------------+-----------------------------
 2021-01-06 12:11:23 | 2021-02-08 22:12:12 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-07 00:11:22 | 2021-02-09 10:12:11 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-08 04:59:10 | 2021-02-10 14:59:59 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-08 13:59:09 | 2021-02-10 23:59:58 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
(4 rows)

-- select addtime (stub function, addtime in constraints, explain)
--Testcase 1971:
EXPLAIN VERBOSE
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE addtime(c3, '1 12:59:10') != '2000-01-01';
                                                                                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5318.83 rows=3396 width=48)
   Output: (addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (addtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (addtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.addtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.addtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((public.addtime(c3, '1 day 12:59:10'::interval) <> '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- select addtime (stub function, addtime in constraints, result)
--Testcase 1972:
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE addtime(c3, '1 12:59:10') != '2000-01-01';
       addtime       |       addtime       |           addtime           |           addtime           
---------------------+---------------------+-----------------------------+-----------------------------
 2021-01-05 01:09:40 | 2021-02-07 11:10:29 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-06 12:11:23 | 2021-02-08 22:12:12 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-07 00:11:22 | 2021-02-09 10:12:11 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-08 04:59:10 | 2021-02-10 14:59:59 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-08 13:59:09 | 2021-02-10 23:59:58 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
(5 rows)

-- select addtime (stub function, addtime in constraints, explain)
--Testcase 1973:
EXPLAIN VERBOSE
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') > '1';
                                                                                                                                                                                                                                                           QUERY PLAN                                                                                                                                                                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2451.17 rows=1138 width=48)
   Output: (addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (addtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (addtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.addtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.addtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.addtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.addtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((public.addtime('1 day 12:59:10'::interval, '6 mons 02:30:00'::interval) > '00:00:01'::interval))
(4 rows)

-- select addtime (stub function, addtime in constraints, result)
--Testcase 1974:
SELECT addtime(c3, '1 12:59:10'), addtime(c3, INTERVAL '6 months 2 hours 30 minutes'), addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE addtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') > '1';
       addtime       |       addtime       |           addtime           |           addtime           
---------------------+---------------------+-----------------------------+-----------------------------
 2021-01-05 01:09:40 | 2021-02-07 11:10:29 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-06 12:11:23 | 2021-02-08 22:12:12 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-07 00:11:22 | 2021-02-09 10:12:11 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-08 04:59:10 | 2021-02-10 14:59:59 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
 2021-01-08 13:59:09 | 2021-02-10 23:59:58 | @ 838 hours 59 mins 59 secs | @ 838 hours 59 mins 59 secs
(5 rows)

-- select addtime with agg (pushdown, explain)
--Testcase 1975:
EXPLAIN VERBOSE
SELECT max(c1), addtime('2021-01-02'::date, max(c1)) FROM time_tbl;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c1)), (addtime('2021-01-02 00:00:00'::timestamp without time zone, (max(c1))::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c1), public.addtime('2021-01-02 00:00:00'::timestamp without time zone, max(c1)) FROM public.time_tblmysql
(6 rows)

-- select addtime as nest function with agg (pushdown, result)
--Testcase 1976:
SELECT max(c1), addtime('2021-01-02'::date, max(c1)) FROM time_tbl;
   max    |       addtime       
----------+---------------------
 23:12:13 | 2021-01-02 23:12:13
(1 row)

-- select addtime as nest with stub (pushdown, explain)
--Testcase 1977:
EXPLAIN VERBOSE
SELECT addtime(maketime(12, 15, 30), '1 12:59:10') FROM time_tbl;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (addtime((maketime(12, 15, 30))::interval, '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.addtime(public.maketime(12, 15, 30), '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql
(4 rows)

-- select addtime as nest with stub (pushdown, result)
--Testcase 1978:
SELECT addtime(maketime(12, 15, 30), '1 12:59:10') FROM time_tbl;
          addtime           
----------------------------
 @ 49 hours 14 mins 40 secs
 @ 49 hours 14 mins 40 secs
 @ 49 hours 14 mins 40 secs
 @ 49 hours 14 mins 40 secs
 @ 49 hours 14 mins 40 secs
(5 rows)

-- select addtime with non pushdown func and explicit constant (explain)
--Testcase 1979:
EXPLAIN VERBOSE
SELECT addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), pi(), 4.1 FROM time_tbl;
                                                                                                           QUERY PLAN                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=56)
   Output: (addtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.addtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select addtime with non pushdown func and explicit constant (result)
--Testcase 1980:
SELECT addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), pi(), 4.1 FROM time_tbl;
           addtime           |        pi         | ?column? 
-----------------------------+-------------------+----------
 @ 838 hours 59 mins 59 secs | 3.141592653589793 |      4.1
 @ 838 hours 59 mins 59 secs | 3.141592653589793 |      4.1
 @ 838 hours 59 mins 59 secs | 3.141592653589793 |      4.1
 @ 838 hours 59 mins 59 secs | 3.141592653589793 |      4.1
 @ 838 hours 59 mins 59 secs | 3.141592653589793 |      4.1
(5 rows)

-- select addtime with order by (explain)
--Testcase 1981:
EXPLAIN VERBOSE
SELECT id, addtime(c1, c1 + '1 12:59:10') FROM time_tbl order by addtime(c1, c1 + '1 12:59:10');
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1291.53..1300.06 rows=3413 width=20)
   Output: id, (addtime((c1)::interval, ((c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval))::interval))
   Sort Key: (addtime((time_tbl.c1)::interval, ((time_tbl.c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval))::interval))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1091.24 rows=3413 width=20)
         Output: id, (addtime((c1)::interval, ((c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval))::interval))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.addtime(c1, (c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select addtime with order by (result)
--Testcase 1982:
SELECT id, addtime(c1, c1 + '1 12:59:10') FROM time_tbl order by addtime(c1, c1 + '1 12:59:10');
 id |          addtime           
----+----------------------------
  2 | @ 22 hours 24 mins 25 secs
  0 | @ 24 hours 21 mins 1 sec
  3 | @ 32 hours 1 sec
  1 | @ 46 hours 24 mins 27 secs
  4 | 
(5 rows)

-- select addtime with order by index (result)
--Testcase 1983:
SELECT id, addtime(c1, c1 + '1 12:59:10') FROM time_tbl order by 2,1;
 id |          addtime           
----+----------------------------
  2 | @ 22 hours 24 mins 25 secs
  0 | @ 24 hours 21 mins 1 sec
  3 | @ 32 hours 1 sec
  1 | @ 46 hours 24 mins 27 secs
  4 | 
(5 rows)

-- select addtime with order by index (result)
--Testcase 1984:
SELECT id, addtime(c1, c1 + '1 12:59:10') FROM time_tbl order by 1,2;
 id |          addtime           
----+----------------------------
  0 | @ 24 hours 21 mins 1 sec
  1 | @ 46 hours 24 mins 27 secs
  2 | @ 22 hours 24 mins 25 secs
  3 | @ 32 hours 1 sec
  4 | 
(5 rows)

-- select addtime with group by (explain)
--Testcase 1985:
EXPLAIN VERBOSE
SELECT count(id), addtime(c1, c1 + '1 12:59:10') FROM time_tbl group by addtime(c1, c1 + '1 12:59:10');
                                                                   QUERY PLAN                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (count(id)), (addtime((c1)::interval, ((c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval))::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.addtime(c1, (c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select addtime with group by (result)
--Testcase 1986:
SELECT count(id), addtime(c1, c1 + '1 12:59:10') FROM time_tbl group by addtime(c1, c1 + '1 12:59:10');
 count |          addtime           
-------+----------------------------
     1 | @ 24 hours 21 mins 1 sec
     1 | @ 46 hours 24 mins 27 secs
     1 | @ 22 hours 24 mins 25 secs
     1 | @ 32 hours 1 sec
     1 | 
(5 rows)

-- select addtime with group by index (result)
--Testcase 1987:
SELECT id, addtime(c1, c1 + '1 12:59:10') FROM time_tbl group by 2,1;
 id |          addtime           
----+----------------------------
  0 | @ 24 hours 21 mins 1 sec
  1 | @ 46 hours 24 mins 27 secs
  2 | @ 22 hours 24 mins 25 secs
  3 | @ 32 hours 1 sec
  4 | 
(5 rows)

-- select addtime with group by index (result)
--Testcase 1988:
SELECT id, addtime(c1, c1 + '1 12:59:10') FROM time_tbl group by 1,2;
 id |          addtime           
----+----------------------------
  0 | @ 24 hours 21 mins 1 sec
  1 | @ 46 hours 24 mins 27 secs
  2 | @ 22 hours 24 mins 25 secs
  3 | @ 32 hours 1 sec
  4 | 
(5 rows)

-- select addtime with group by having (explain)
--Testcase 1989:
EXPLAIN VERBOSE
SELECT count(id), addtime(c1, c1 + '1 12:59:10') FROM time_tbl group by addtime(c1, c1 + '1 12:59:10'), c1 HAVING addtime(c1, c1 + '1 12:59:10') > '1 12:59:10';
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (count(id)), (addtime((c1)::interval, ((c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval))::interval)), c1
   Filter: ((addtime((time_tbl.c1)::interval, ((time_tbl.c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval))::interval)) > '@ 1 day 12 hours 59 mins 10 secs'::interval)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.addtime(c1, (c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c1 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select addtime with group by having (result)
--Testcase 1990:
SELECT count(id), addtime(c1, c1 + '1 12:59:10') FROM time_tbl group by addtime(c1, c1 + '1 12:59:10'), c1 HAVING addtime(c1, c1 + '1 12:59:10') > '1 12:59:10';
 count |          addtime           
-------+----------------------------
     1 | @ 46 hours 24 mins 27 secs
(1 row)

-- select addtime and as
--Testcase 1991:
SELECT addtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes') as addtime1 FROM time_tbl;
          addtime1           
-----------------------------
 @ 838 hours 59 mins 59 secs
 @ 838 hours 59 mins 59 secs
 @ 838 hours 59 mins 59 secs
 @ 838 hours 59 mins 59 secs
 @ 838 hours 59 mins 59 secs
(5 rows)

-- CONVERT_TZ
-- select convert_tz (stub function, explain)
--Testcase 1992:
EXPLAIN VERBOSE
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl;
                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4478.64 rows=3413 width=32)
   Output: (convert_tz(c3, '+00:00'::text, '+10:00'::text)), (convert_tz(c3, 'GMT'::text, 'MET'::text)), (convert_tz(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text)), (convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert_tz(c3, '+00:00'::text, '+10:00'::text), public.convert_tz(c3, 'GMT'::text, 'MET'::text), public.convert_tz(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text), public.convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text) FROM public.time_tblmysql
(4 rows)

-- select convert_tz (stub function, result)
--Testcase 1993:
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl;
     convert_tz      |     convert_tz      |     convert_tz      |     convert_tz      
---------------------+---------------------+---------------------+---------------------
 2021-01-03 22:10:30 | 2021-01-03 13:10:30 | 2021-01-02 00:11:20 | 2021-01-01 22:00:00
 2021-01-05 09:12:13 | 2021-01-05 00:12:13 | 2021-01-03 11:13:03 | 2021-01-01 22:00:00
 2021-01-05 21:12:12 | 2021-01-05 12:12:12 | 2021-01-03 23:13:02 | 2021-01-01 22:00:00
 2021-01-07 02:00:00 | 2021-01-06 17:00:00 | 2021-01-05 04:00:50 | 2021-01-01 22:00:00
 2021-01-07 10:59:59 | 2021-01-07 01:59:59 | 2021-01-05 13:00:49 | 2021-01-01 22:00:00
(5 rows)

-- select convert_tz (stub function, not pushdown constraints, explain)
--Testcase 1994:
EXPLAIN VERBOSE
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.44 rows=17 width=32)
   Output: (convert_tz(c3, '+00:00'::text, '+10:00'::text)), (convert_tz(c3, 'GMT'::text, 'MET'::text)), (convert_tz(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text)), (convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert_tz(c3, '+00:00'::text, '+10:00'::text), public.convert_tz(c3, 'GMT'::text, 'MET'::text), public.convert_tz(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text), public.convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text), id FROM public.time_tblmysql
(5 rows)

-- select convert_tz (stub function, not pushdown constraints, result)
--Testcase 1995:
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl WHERE to_hex(id) = '1';
     convert_tz      |     convert_tz      |     convert_tz      |     convert_tz      
---------------------+---------------------+---------------------+---------------------
 2021-01-05 09:12:13 | 2021-01-05 00:12:13 | 2021-01-03 11:13:03 | 2021-01-01 22:00:00
(1 row)

-- select convert_tz (stub function, pushdown constraints, explain)
--Testcase 1996:
EXPLAIN VERBOSE
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl WHERE id != 0;
                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4465.58 rows=3396 width=32)
   Output: (convert_tz(c3, '+00:00'::text, '+10:00'::text)), (convert_tz(c3, 'GMT'::text, 'MET'::text)), (convert_tz(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text)), (convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert_tz(c3, '+00:00'::text, '+10:00'::text), public.convert_tz(c3, 'GMT'::text, 'MET'::text), public.convert_tz(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text), public.convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text) FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select convert_tz (stub function, pushdown constraints, result)
--Testcase 1997:
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl WHERE id != 0;
     convert_tz      |     convert_tz      |     convert_tz      |     convert_tz      
---------------------+---------------------+---------------------+---------------------
 2021-01-05 09:12:13 | 2021-01-05 00:12:13 | 2021-01-03 11:13:03 | 2021-01-01 22:00:00
 2021-01-05 21:12:12 | 2021-01-05 12:12:12 | 2021-01-03 23:13:02 | 2021-01-01 22:00:00
 2021-01-07 02:00:00 | 2021-01-06 17:00:00 | 2021-01-05 04:00:50 | 2021-01-01 22:00:00
 2021-01-07 10:59:59 | 2021-01-07 01:59:59 | 2021-01-05 13:00:49 | 2021-01-01 22:00:00
(4 rows)

-- select convert_tz (stub function, convert_tz in constraints, explain)
--Testcase 1998:
EXPLAIN VERBOSE
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl WHERE convert_tz(c3,'+00:00','+10:00') != '2000-01-01';
                                                                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5318.83 rows=3396 width=32)
   Output: (convert_tz(c3, '+00:00'::text, '+10:00'::text)), (convert_tz(c3, 'GMT'::text, 'MET'::text)), (convert_tz(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text)), (convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert_tz(c3, '+00:00'::text, '+10:00'::text), public.convert_tz(c3, 'GMT'::text, 'MET'::text), public.convert_tz(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text), public.convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text) FROM public.time_tblmysql WHERE ((public.convert_tz(c3, '+00:00'::text, '+10:00'::text) <> '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- select convert_tz (stub function, convert_tz in constraints, result)
--Testcase 1999:
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl WHERE convert_tz(c3,'+00:00','+10:00') != '2000-01-01';
     convert_tz      |     convert_tz      |     convert_tz      |     convert_tz      
---------------------+---------------------+---------------------+---------------------
 2021-01-03 22:10:30 | 2021-01-03 13:10:30 | 2021-01-02 00:11:20 | 2021-01-01 22:00:00
 2021-01-05 09:12:13 | 2021-01-05 00:12:13 | 2021-01-03 11:13:03 | 2021-01-01 22:00:00
 2021-01-05 21:12:12 | 2021-01-05 12:12:12 | 2021-01-03 23:13:02 | 2021-01-01 22:00:00
 2021-01-07 02:00:00 | 2021-01-06 17:00:00 | 2021-01-05 04:00:50 | 2021-01-01 22:00:00
 2021-01-07 10:59:59 | 2021-01-07 01:59:59 | 2021-01-05 13:00:49 | 2021-01-01 22:00:00
(5 rows)

-- select convert_tz (stub function, convert_tz in constraints, explain)
--Testcase 2000:
EXPLAIN VERBOSE
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl WHERE convert_tz('2021-01-01 12:00:00','+00:00','+10:00') > '2000-01-01';
                                                                                                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                                                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2451.17 rows=1138 width=32)
   Output: (convert_tz(c3, '+00:00'::text, '+10:00'::text)), (convert_tz(c3, 'GMT'::text, 'MET'::text)), (convert_tz(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text)), (convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert_tz(c3, '+00:00'::text, '+10:00'::text), public.convert_tz(c3, 'GMT'::text, 'MET'::text), public.convert_tz(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text), public.convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text) FROM public.time_tblmysql WHERE ((public.convert_tz('2021-01-01 12:00:00'::timestamp without time zone, '+00:00'::text, '+10:00'::text) > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- select convert_tz (stub function, convert_tz in constraints, result)
--Testcase 2001:
SELECT convert_tz(c3,'+00:00','+10:00'), convert_tz(c3, 'GMT', 'MET'), convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), convert_tz('2021-01-01 12:00:00','+00:00','+10:00') FROM time_tbl WHERE convert_tz('2021-01-01 12:00:00','+00:00','+10:00') > '2000-01-01';
     convert_tz      |     convert_tz      |     convert_tz      |     convert_tz      
---------------------+---------------------+---------------------+---------------------
 2021-01-03 22:10:30 | 2021-01-03 13:10:30 | 2021-01-02 00:11:20 | 2021-01-01 22:00:00
 2021-01-05 09:12:13 | 2021-01-05 00:12:13 | 2021-01-03 11:13:03 | 2021-01-01 22:00:00
 2021-01-05 21:12:12 | 2021-01-05 12:12:12 | 2021-01-03 23:13:02 | 2021-01-01 22:00:00
 2021-01-07 02:00:00 | 2021-01-06 17:00:00 | 2021-01-05 04:00:50 | 2021-01-01 22:00:00
 2021-01-07 10:59:59 | 2021-01-07 01:59:59 | 2021-01-05 13:00:49 | 2021-01-01 22:00:00
(5 rows)

-- select convert_tz with agg (pushdown, explain)
--Testcase 2002:
EXPLAIN VERBOSE
SELECT max(c3), convert_tz(max(c3), '+00:00','+10:00') FROM time_tbl;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (convert_tz(max(c3), '+00:00'::text, '+10:00'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.convert_tz(max(c3), '+00:00'::text, '+10:00'::text) FROM public.time_tblmysql
(6 rows)

-- select convert_tz as nest function with agg (pushdown, result)
--Testcase 2003:
SELECT max(c3), convert_tz(max(c3), '+00:00','+10:00') FROM time_tbl;
         max         |     convert_tz      
---------------------+---------------------
 2021-01-07 00:59:59 | 2021-01-07 10:59:59
(1 row)

-- select convert_tz with non pushdown func and explicit constant (explain)
--Testcase 2004:
EXPLAIN VERBOSE
SELECT convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), pi(), 4.1 FROM time_tbl;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (convert_tz(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.convert_tz(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), 'GMT'::text, 'MET'::text), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select convert_tz with non pushdown func and explicit constant (result)
--Testcase 2005:
SELECT convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET'), pi(), 4.1 FROM time_tbl;
     convert_tz      |        pi         | ?column? 
---------------------+-------------------+----------
 2021-01-02 00:11:20 | 3.141592653589793 |      4.1
 2021-01-03 11:13:03 | 3.141592653589793 |      4.1
 2021-01-03 23:13:02 | 3.141592653589793 |      4.1
 2021-01-05 04:00:50 | 3.141592653589793 |      4.1
 2021-01-05 13:00:49 | 3.141592653589793 |      4.1
(5 rows)

-- select convert_tz with order by (explain)
--Testcase 2006:
EXPLAIN VERBOSE
SELECT id, convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl order by convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00');
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=12)
   Output: id, (convert_tz((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text))
   Sort Key: (convert_tz((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=12)
         Output: id, (convert_tz((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.convert_tz((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text) FROM public.time_tblmysql
(7 rows)

-- select convert_tz with order by (result)
--Testcase 2007:
SELECT id, convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl order by convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00');
 id |     convert_tz      
----+---------------------
  0 | 2021-01-05 11:09:40
  1 | 2021-01-06 22:11:23
  2 | 2021-01-07 10:11:22
  3 | 2021-01-08 14:59:10
  4 | 2021-01-08 23:59:09
(5 rows)

-- select convert_tz with order by index (result)
--Testcase 2008:
SELECT id, convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl order by 2,1;
 id |     convert_tz      
----+---------------------
  0 | 2021-01-05 11:09:40
  1 | 2021-01-06 22:11:23
  2 | 2021-01-07 10:11:22
  3 | 2021-01-08 14:59:10
  4 | 2021-01-08 23:59:09
(5 rows)

-- select convert_tz with order by index (result)
--Testcase 2009:
SELECT id, convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl order by 1,2;
 id |     convert_tz      
----+---------------------
  0 | 2021-01-05 11:09:40
  1 | 2021-01-06 22:11:23
  2 | 2021-01-07 10:11:22
  3 | 2021-01-08 14:59:10
  4 | 2021-01-08 23:59:09
(5 rows)

-- select convert_tz with group by (explain)
--Testcase 2010:
EXPLAIN VERBOSE
SELECT count(id), convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl group by convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00');
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(id)), (convert_tz((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.convert_tz((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select convert_tz with group by (result)
--Testcase 2011:
SELECT count(id), convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl group by convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00');
 count |     convert_tz      
-------+---------------------
     1 | 2021-01-05 11:09:40
     1 | 2021-01-06 22:11:23
     1 | 2021-01-07 10:11:22
     1 | 2021-01-08 14:59:10
     1 | 2021-01-08 23:59:09
(5 rows)

-- select convert_tz with group by index (result)
--Testcase 2012:
SELECT id, convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl group by 2,1;
 id |     convert_tz      
----+---------------------
  0 | 2021-01-05 11:09:40
  1 | 2021-01-06 22:11:23
  2 | 2021-01-07 10:11:22
  3 | 2021-01-08 14:59:10
  4 | 2021-01-08 23:59:09
(5 rows)

-- select convert_tz with group by index (result)
--Testcase 2013:
SELECT id, convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl group by 1,2;
 id |     convert_tz      
----+---------------------
  0 | 2021-01-05 11:09:40
  1 | 2021-01-06 22:11:23
  2 | 2021-01-07 10:11:22
  3 | 2021-01-08 14:59:10
  4 | 2021-01-08 23:59:09
(5 rows)

-- select convert_tz with group by having (explain)
--Testcase 2014:
EXPLAIN VERBOSE
SELECT count(id), convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl group by convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00'),id,c3 HAVING convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') > '2000-01-01 12:59:10';
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=28)
   Output: (count(id)), (convert_tz((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text)), id, c3
   Filter: ((convert_tz((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text)) > '2000-01-01 12:59:10'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.convert_tz((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '+00:00'::text, '+10:00'::text), id, c3 FROM public.time_tblmysql GROUP BY 2, 3, 4
(7 rows)

-- select convert_tz with group by having (result)
--Testcase 2015:
SELECT count(id), convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl group by convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00'),id,c3 HAVING convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') > '2000-01-01 12:59:10';
 count |     convert_tz      
-------+---------------------
     1 | 2021-01-05 11:09:40
     1 | 2021-01-06 22:11:23
     1 | 2021-01-07 10:11:22
     1 | 2021-01-08 14:59:10
     1 | 2021-01-08 23:59:09
(5 rows)

-- select convert_tz with group by index having (result)
--Testcase 2016:
SELECT id, c3, convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') FROM time_tbl group by 3,2,1 HAVING convert_tz(c3 + '1 12:59:10' , '+00:00','+10:00') > '2000-01-01 12:59:10';
 id |         c3          |     convert_tz      
----+---------------------+---------------------
  0 | 2021-01-03 12:10:30 | 2021-01-05 11:09:40
  1 | 2021-01-04 23:12:13 | 2021-01-06 22:11:23
  2 | 2021-01-05 11:12:12 | 2021-01-07 10:11:22
  3 | 2021-01-06 16:00:00 | 2021-01-08 14:59:10
  4 | 2021-01-07 00:59:59 | 2021-01-08 23:59:09
(5 rows)

-- select convert_tz and as
--Testcase 2017:
SELECT convert_tz(date_sub(c3, '1 12:59:10'), 'GMT', 'MET') as convert_tz1 FROM time_tbl;
     convert_tz1     
---------------------
 2021-01-02 00:11:20
 2021-01-03 11:13:03
 2021-01-03 23:13:02
 2021-01-05 04:00:50
 2021-01-05 13:00:49
(5 rows)

-- CURDATE()
-- curdate is mutable function, some executes will return different result
-- select curdate (stub function, explain)
--Testcase 2018:
EXPLAIN VERBOSE
SELECT curdate() FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (curdate())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curdate() FROM public.time_tblmysql
(4 rows)

-- select curdate (stub function, not pushdown constraints, explain)
--Testcase 2019:
EXPLAIN VERBOSE
SELECT curdate() FROM time_tbl WHERE to_hex(id) > '0';
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=4)
   Output: (curdate())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curdate(), id FROM public.time_tblmysql
(5 rows)

-- select curdate (stub function, pushdown constraints, explain)
--Testcase 2020:
EXPLAIN VERBOSE
SELECT curdate() FROM time_tbl WHERE id = 1;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=4)
   Output: (curdate())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curdate() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select curdate (stub function, curdate in constraints, explain)
--Testcase 2021:
EXPLAIN VERBOSE
SELECT curdate() FROM time_tbl WHERE curdate() > '2000-01-01';
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=4)
   Output: (curdate())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curdate() FROM public.time_tblmysql WHERE ((public.curdate() > '2000-01-01'::date))
(4 rows)

-- curdate in constrains (stub function, explain)
--Testcase 2022:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE curdate() > '2000-01-01';
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.curdate() > '2000-01-01'::date))
(4 rows)

-- curdate in constrains (stub function, result)
--Testcase 2023:
SELECT c1 FROM time_tbl WHERE curdate() > '2000-01-01';
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- curdate as parameter of adddate(stub function, explain)
--Testcase 2024:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE adddate(curdate(), 31) > '2000-01-01';
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.adddate(public.curdate(), 31) > '2000-01-01'::date))
(4 rows)

-- curdate as parameter of adddate(stub function, result)
--Testcase 2025:
SELECT c1 FROM time_tbl WHERE adddate(curdate(), 31) > '2000-01-01';
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select curdate and agg (pushdown, explain)
--Testcase 2026:
EXPLAIN VERBOSE
SELECT curdate(), sum(id) FROM time_tbl;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (curdate()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curdate(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select curdate and log2 (pushdown, explain)
--Testcase 2027:
EXPLAIN VERBOSE
SELECT curdate(), log2(id) FROM time_tbl;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=12)
   Output: (curdate()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curdate(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select curdate with non pushdown func and explicit constant (explain)
--Testcase 2028:
EXPLAIN VERBOSE
SELECT curdate(), to_hex(id), 4 FROM time_tbl;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=40)
   Output: (curdate()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curdate(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select curdate with order by (explain)
--Testcase 2029:
EXPLAIN VERBOSE
SELECT curdate(), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=12)
   Output: curdate(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- select curdate with order by index (explain)
--Testcase 2030:
EXPLAIN VERBOSE
SELECT curdate(), c1 FROM time_tbl ORDER BY 2;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=12)
   Output: curdate(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- curdate constraints with order by (explain)
--Testcase 2031:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE adddate(curdate(), 31) > '2000-01-01' ORDER BY c1;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1948.22..1951.07 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.adddate(public.curdate(), 31) > '2000-01-01'::date))
(7 rows)

-- curdate constraints with order by (result)
--Testcase 2032:
SELECT c1 FROM time_tbl WHERE adddate(curdate(), 31) > '2000-01-01' ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select curdate with group by (explain)
--Testcase 2033:
EXPLAIN VERBOSE
SELECT curdate(), c1 FROM time_tbl GROUP BY c1;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=12)
   Output: (curdate()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curdate(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select curdate with group by index (explain)
--Testcase 2034:
EXPLAIN VERBOSE
SELECT curdate(), c1 FROM time_tbl GROUP BY 2;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=12)
   Output: (curdate()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curdate(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select curdate with group by having (explain)
--Testcase 2035:
EXPLAIN VERBOSE
SELECT curdate(), c1 FROM time_tbl GROUP BY curdate(),c1 HAVING curdate() > '2000-01-01';
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (curdate()), c1
   Filter: ((curdate()) > '2000-01-01'::date)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curdate(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.curdate() > '2000-01-01'::date))
(7 rows)

-- select curdate with group by index having (explain)
--Testcase 2036:
EXPLAIN VERBOSE
SELECT curdate(), c1 FROM time_tbl GROUP BY 1,2 HAVING curdate() > '2000-01-01';
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (curdate()), c1
   Filter: ((curdate()) > '2000-01-01'::date)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curdate(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.curdate() > '2000-01-01'::date))
(7 rows)

-- curdate constraints with group by (explain)
--Testcase 2037:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE adddate(curdate(), 31) > '2000-01-01' GROUP BY c1;
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.adddate(public.curdate(), 31) > '2000-01-01'::date)) GROUP BY 1
(6 rows)

-- curdate constraints with group by (result)
--Testcase 2038:
SELECT c1 FROM time_tbl WHERE adddate(curdate(), 31) > '2000-01-01' GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select curdate and as
--Testcase 2039:
EXPLAIN VERBOSE
SELECT curdate() as curdate1 FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (curdate())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curdate() FROM public.time_tblmysql
(4 rows)

-- CURRENT_DATE()
-- mysql_current_date is mutable function, some executes will return different result
-- select mysql_current_date (stub function, explain)
--Testcase 2040:
EXPLAIN VERBOSE
SELECT mysql_current_date() FROM time_tbl;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (mysql_current_date())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_date() FROM public.time_tblmysql
(4 rows)

-- select mysql_current_date (stub function, not pushdown constraints, explain)
--Testcase 2041:
EXPLAIN VERBOSE
SELECT mysql_current_date() FROM time_tbl WHERE to_hex(id) > '0';
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=4)
   Output: (mysql_current_date())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_date(), id FROM public.time_tblmysql
(5 rows)

-- select mysql_current_date (stub function, pushdown constraints, explain)
--Testcase 2042:
EXPLAIN VERBOSE
SELECT mysql_current_date() FROM time_tbl WHERE id = 1;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=4)
   Output: (mysql_current_date())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_date() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select mysql_current_date (stub function, mysql_current_date in constraints, explain)
--Testcase 2043:
EXPLAIN VERBOSE
SELECT mysql_current_date() FROM time_tbl WHERE mysql_current_date() > '2000-01-01';
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=4)
   Output: (mysql_current_date())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_date() FROM public.time_tblmysql WHERE ((public.mysql_current_date() > '2000-01-01'::date))
(4 rows)

-- mysql_current_date in constrains (stub function, explain)
--Testcase 2044:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE mysql_current_date() > '2000-01-01';
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.mysql_current_date() > '2000-01-01'::date))
(4 rows)

-- mysql_current_date in constrains (stub function, result)
--Testcase 2045:
SELECT c1 FROM time_tbl WHERE mysql_current_date() > '2000-01-01';
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- mysql_current_date as parameter of adddate(stub function, explain)
--Testcase 2046:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE adddate(mysql_current_date(), 31) > '2000-01-01';
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.adddate(public.mysql_current_date(), 31) > '2000-01-01'::date))
(4 rows)

-- mysql_current_date as parameter of adddate(stub function, result)
--Testcase 2047:
SELECT c1 FROM time_tbl WHERE adddate(mysql_current_date(), 31) > '2000-01-01';
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_current_date and agg (pushdown, explain)
--Testcase 2048:
EXPLAIN VERBOSE
SELECT mysql_current_date(), sum(id) FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (mysql_current_date()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_date(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select mysql_current_date and log2 (pushdown, explain)
--Testcase 2049:
EXPLAIN VERBOSE
SELECT mysql_current_date(), log2(id) FROM time_tbl;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=12)
   Output: (mysql_current_date()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_date(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select mysql_current_date with non pushdown func and explicit constant (explain)
--Testcase 2050:
EXPLAIN VERBOSE
SELECT mysql_current_date(), to_hex(id), 4 FROM time_tbl;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=40)
   Output: (mysql_current_date()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_date(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select mysql_current_date with order by (explain)
--Testcase 2051:
EXPLAIN VERBOSE
SELECT mysql_current_date(), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=12)
   Output: mysql_current_date(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- select mysql_current_date with order by index (explain)
--Testcase 2052:
EXPLAIN VERBOSE
SELECT mysql_current_date(), c1 FROM time_tbl ORDER BY 2;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=12)
   Output: mysql_current_date(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- mysql_current_date constraints with order by (explain)
--Testcase 2053:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE adddate(mysql_current_date(), 31) > '2000-01-01' ORDER BY c1;
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1948.22..1951.07 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.adddate(public.mysql_current_date(), 31) > '2000-01-01'::date))
(7 rows)

-- mysql_current_date constraints with order by (result)
--Testcase 2054:
SELECT c1 FROM time_tbl WHERE adddate(mysql_current_date(), 31) > '2000-01-01' ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select mysql_current_date with group by (explain)
--Testcase 2055:
EXPLAIN VERBOSE
SELECT mysql_current_date(), c1 FROM time_tbl GROUP BY c1;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=12)
   Output: (mysql_current_date()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_date(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_current_date with group by index (explain)
--Testcase 2056:
EXPLAIN VERBOSE
SELECT mysql_current_date(), c1 FROM time_tbl GROUP BY 2;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=12)
   Output: (mysql_current_date()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_date(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_current_date with group by having (explain)
--Testcase 2057:
EXPLAIN VERBOSE
SELECT mysql_current_date(), c1 FROM time_tbl GROUP BY mysql_current_date(), c1 HAVING mysql_current_date() > '2000-01-01';
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (mysql_current_date()), c1
   Filter: ((mysql_current_date()) > '2000-01-01'::date)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_date(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.mysql_current_date() > '2000-01-01'::date))
(7 rows)

-- select mysql_current_date with group by index having (explain)
--Testcase 2058:
EXPLAIN VERBOSE
SELECT mysql_current_date(), c1 FROM time_tbl GROUP BY 2,1 HAVING mysql_current_date() > '2000-01-01';
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (mysql_current_date()), c1
   Filter: ((mysql_current_date()) > '2000-01-01'::date)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_date(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.mysql_current_date() > '2000-01-01'::date))
(7 rows)

-- mysql_current_date constraints with group by (explain)
--Testcase 2059:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE adddate(mysql_current_date(), 31) > '2000-01-01' GROUP BY c1;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.adddate(public.mysql_current_date(), 31) > '2000-01-01'::date)) GROUP BY 1
(6 rows)

-- mysql_current_date constraints with group by (result)
--Testcase 2060:
SELECT c1 FROM time_tbl WHERE adddate(mysql_current_date(), 31) > '2000-01-01' GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_current_date and as
--Testcase 2061:
EXPLAIN VERBOSE
SELECT mysql_current_date() as mysql_current_date1 FROM time_tbl;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (mysql_current_date())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_date() FROM public.time_tblmysql
(4 rows)

-- CURTIME()
-- curtime is mutable function, some executes will return different result
-- select curtime (stub function, explain)
--Testcase 2062:
EXPLAIN VERBOSE
SELECT curtime() FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (curtime())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curtime() FROM public.time_tblmysql
(4 rows)

-- select curtime (stub function, not pushdown constraints, explain)
--Testcase 2063:
EXPLAIN VERBOSE
SELECT curtime() FROM time_tbl WHERE to_hex(id) > '0';
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (curtime())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curtime(), id FROM public.time_tblmysql
(5 rows)

-- select curtime (stub function, pushdown constraints, explain)
--Testcase 2064:
EXPLAIN VERBOSE
SELECT curtime() FROM time_tbl WHERE id = 1;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (curtime())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curtime() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select curtime (stub function, curtime in constraints, explain)
--Testcase 2065:
EXPLAIN VERBOSE
SELECT curtime() FROM time_tbl WHERE curtime() > '00:00:00';
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (curtime())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curtime() FROM public.time_tblmysql WHERE ((public.curtime() > '00:00:00'::time without time zone))
(4 rows)

-- curtime in constrains (stub function, explain)
--Testcase 2066:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE curtime() > '00:00:00';
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.curtime() > '00:00:00'::time without time zone))
(4 rows)

-- curtime in constrains (stub function, result)
--Testcase 2067:
SELECT c1 FROM time_tbl WHERE curtime() > '00:00:00';
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- curtime as parameter of addtime(stub function, explain)
--Testcase 2068:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(curtime(), '1 12:59:10') > '00:00:00';
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.curtime(), '1 day 12:59:10'::interval) > '00:00:00'::interval))
(4 rows)

-- curtime as parameter of addtime(stub function, result)
--Testcase 2069:
SELECT c1 FROM time_tbl WHERE addtime(curtime(), '1 12:59:10') > '00:00:00';
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select curtime and agg (pushdown, explain)
--Testcase 2070:
EXPLAIN VERBOSE
SELECT curtime(), sum(id) FROM time_tbl;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (curtime()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curtime(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select curtime and log2 (pushdown, explain)
--Testcase 2071:
EXPLAIN VERBOSE
SELECT curtime(), log2(id) FROM time_tbl;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (curtime()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curtime(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select curtime with non pushdown func and explicit constant (explain)
--Testcase 2072:
EXPLAIN VERBOSE
SELECT curtime(), to_hex(id), 4 FROM time_tbl;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (curtime()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curtime(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select curtime with order by (explain)
--Testcase 2073:
EXPLAIN VERBOSE
SELECT curtime(), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=16)
   Output: curtime(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- select curtime with order by index (explain)
--Testcase 2074:
EXPLAIN VERBOSE
SELECT curtime(), c1 FROM time_tbl ORDER BY 2;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=16)
   Output: curtime(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- curtime constraints with order by (explain)
--Testcase 2075:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(curtime(), '1 12:59:10') > '00:00:00' ORDER BY c1;
                                                                       QUERY PLAN                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1948.22..1951.07 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.curtime(), '1 day 12:59:10'::interval) > '00:00:00'::interval))
(7 rows)

-- curtime constraints with order by (result)
--Testcase 2076:
SELECT c1 FROM time_tbl WHERE addtime(curtime(), '1 12:59:10') > '00:00:00' ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select curtime with group by (explain)
--Testcase 2077:
EXPLAIN VERBOSE
SELECT curtime(), c1 FROM time_tbl GROUP BY c1;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (curtime()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curtime(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select curtime with group by index (explain)
--Testcase 2078:
EXPLAIN VERBOSE
SELECT curtime(), c1 FROM time_tbl GROUP BY 2;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (curtime()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curtime(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select curtime with group by having (explain)
--Testcase 2079:
EXPLAIN VERBOSE
SELECT curtime(), c1 FROM time_tbl GROUP BY curtime(),c1 HAVING curtime() > '00:00:00';
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (curtime()), c1
   Filter: ((curtime()) > '00:00:00'::time without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curtime(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.curtime() > '00:00:00'::time without time zone))
(7 rows)

-- select curtime with group by index having (explain)
--Testcase 2080:
EXPLAIN VERBOSE
SELECT curtime(), c1 FROM time_tbl GROUP BY 2,1 HAVING curtime() > '00:00:00';
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (curtime()), c1
   Filter: ((curtime()) > '00:00:00'::time without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.curtime(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.curtime() > '00:00:00'::time without time zone))
(7 rows)

-- curtime constraints with group by (explain)
--Testcase 2081:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(curtime(), '1 12:59:10') > '00:00:00' GROUP BY c1;
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.curtime(), '1 day 12:59:10'::interval) > '00:00:00'::interval)) GROUP BY 1
(6 rows)

-- curtime constraints with group by (result)
--Testcase 2082:
SELECT c1 FROM time_tbl WHERE addtime(curtime(), '1 12:59:10') > '00:00:00' GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select curtime and as
--Testcase 2083:
EXPLAIN VERBOSE
SELECT curtime() as curtime1 FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (curtime())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.curtime() FROM public.time_tblmysql
(4 rows)

-- CURRENT_TIME()
-- mysql_current_time is mutable function, some executes will return different result
-- select mysql_current_time (stub function, explain)
--Testcase 2084:
EXPLAIN VERBOSE
SELECT mysql_current_time() FROM time_tbl;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_current_time())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_time() FROM public.time_tblmysql
(4 rows)

-- select mysql_current_time (stub function, not pushdown constraints, explain)
--Testcase 2085:
EXPLAIN VERBOSE
SELECT mysql_current_time() FROM time_tbl WHERE to_hex(id) > '0';
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (mysql_current_time())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_time(), id FROM public.time_tblmysql
(5 rows)

-- select mysql_current_time (stub function, pushdown constraints, explain)
--Testcase 2086:
EXPLAIN VERBOSE
SELECT mysql_current_time() FROM time_tbl WHERE id = 1;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (mysql_current_time())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_time() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select mysql_current_time (stub function, mysql_current_time in constraints, explain)
--Testcase 2087:
EXPLAIN VERBOSE
SELECT mysql_current_time() FROM time_tbl WHERE mysql_current_time() > '00:00:00';
                                                                       QUERY PLAN                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (mysql_current_time())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_time() FROM public.time_tblmysql WHERE ((public.mysql_current_time() > '00:00:00'::time without time zone))
(4 rows)

-- mysql_current_time in constrains (stub function, explain)
--Testcase 2088:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE mysql_current_time() > '00:00:00';
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.mysql_current_time() > '00:00:00'::time without time zone))
(4 rows)

-- mysql_current_time in constrains (stub function, result)
--Testcase 2089:
SELECT c1 FROM time_tbl WHERE mysql_current_time() > '00:00:00';
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- mysql_current_time as parameter of addtime(stub function, explain)
--Testcase 2090:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_time(), '1 12:59:10') > '00:00:00';
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_current_time(), '1 day 12:59:10'::interval) > '00:00:00'::interval))
(4 rows)

-- mysql_current_time as parameter of addtime(stub function, result)
--Testcase 2091:
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_time(), '1 12:59:10') > '00:00:00';
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_current_time and agg (pushdown, explain)
--Testcase 2092:
EXPLAIN VERBOSE
SELECT mysql_current_time(), sum(id) FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_current_time()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_time(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select mysql_current_time and log2 (pushdown, explain)
--Testcase 2093:
EXPLAIN VERBOSE
SELECT mysql_current_time(), log2(id) FROM time_tbl;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (mysql_current_time()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_time(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select mysql_current_time with non pushdown func and explicit constant (explain)
--Testcase 2094:
EXPLAIN VERBOSE
SELECT mysql_current_time(), to_hex(id), 4 FROM time_tbl;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (mysql_current_time()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_time(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select mysql_current_time with order by (explain)
--Testcase 2095:
EXPLAIN VERBOSE
SELECT mysql_current_time(), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=16)
   Output: mysql_current_time(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- select mysql_current_time with order by index (explain)
--Testcase 2096:
EXPLAIN VERBOSE
SELECT mysql_current_time(), c1 FROM time_tbl ORDER BY 2;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=16)
   Output: mysql_current_time(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- mysql_current_time constraints with order by (explain)
--Testcase 2097:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_time(), '1 12:59:10') > '00:00:00' ORDER BY c1;
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1948.22..1951.07 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_current_time(), '1 day 12:59:10'::interval) > '00:00:00'::interval))
(7 rows)

-- mysql_current_time constraints with order by (result)
--Testcase 2098:
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_time(), '1 12:59:10') > '00:00:00' ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select mysql_current_time with group by (explain)
--Testcase 2099:
EXPLAIN VERBOSE
SELECT mysql_current_time(), c1 FROM time_tbl GROUP BY c1;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_current_time()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_time(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_current_time with group by index (explain)
--Testcase 2100:
EXPLAIN VERBOSE
SELECT mysql_current_time(), c1 FROM time_tbl GROUP BY 2;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_current_time()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_time(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_current_time with group by having (explain)
--Testcase 2101:
EXPLAIN VERBOSE
SELECT mysql_current_time(), c1 FROM time_tbl GROUP BY mysql_current_time(),c1 HAVING mysql_current_time() > '00:00:00';
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_current_time()), c1
   Filter: ((mysql_current_time()) > '00:00:00'::time without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_time(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.mysql_current_time() > '00:00:00'::time without time zone))
(7 rows)

-- select mysql_current_time with group by index having (explain)
--Testcase 2102:
EXPLAIN VERBOSE
SELECT mysql_current_time(), c1 FROM time_tbl GROUP BY 2,1 HAVING mysql_current_time() > '00:00:00';
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_current_time()), c1
   Filter: ((mysql_current_time()) > '00:00:00'::time without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_time(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.mysql_current_time() > '00:00:00'::time without time zone))
(7 rows)

-- mysql_current_time constraints with group by (explain)
--Testcase 2103:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_time(), '1 12:59:10') > '00:00:00' GROUP BY c1;
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_current_time(), '1 day 12:59:10'::interval) > '00:00:00'::interval)) GROUP BY 1
(6 rows)

-- mysql_current_time constraints with group by (result)
--Testcase 2104:
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_time(), '1 12:59:10') > '00:00:00' GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_current_time and as
--Testcase 2105:
EXPLAIN VERBOSE
SELECT mysql_current_time() as mysql_current_time1 FROM time_tbl;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_current_time())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_time() FROM public.time_tblmysql
(4 rows)

-- CURRENT_TIMESTAMP
-- mysql_current_timestamp is mutable function, some executes will return different result
-- select mysql_current_timestamp (stub function, explain)
--Testcase 2106:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp() FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_current_timestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_timestamp() FROM public.time_tblmysql
(4 rows)

-- select mysql_current_timestamp (stub function, not pushdown constraints, explain)
--Testcase 2107:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp() FROM time_tbl WHERE to_hex(id) > '0';
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (mysql_current_timestamp())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_timestamp(), id FROM public.time_tblmysql
(5 rows)

-- select mysql_current_timestamp (stub function, pushdown constraints, explain)
--Testcase 2108:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp() FROM time_tbl WHERE id = 1;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (mysql_current_timestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_timestamp() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select mysql_current_timestamp (stub function, mysql_current_timestamp in constraints, explain)
--Testcase 2109:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp() FROM time_tbl WHERE mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp;
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (mysql_current_timestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_timestamp() FROM public.time_tblmysql WHERE ((public.mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_current_timestamp in constrains (stub function, explain)
--Testcase 2110:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp;
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_current_timestamp in constrains (stub function, result)
--Testcase 2111:
SELECT c1 FROM time_tbl WHERE mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- mysql_current_timestamp as parameter of addtime(stub function, explain)
--Testcase 2112:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_timestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp;
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_current_timestamp(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_current_timestamp as parameter of addtime(stub function, result)
--Testcase 2113:
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_timestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_current_timestamp and agg (pushdown, explain)
--Testcase 2114:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), sum(id) FROM time_tbl;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_current_timestamp()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_timestamp(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select mysql_current_timestamp and log2 (pushdown, explain)
--Testcase 2115:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), log2(id) FROM time_tbl;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (mysql_current_timestamp()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_timestamp(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select mysql_current_timestamp with non pushdown func and explicit constant (explain)
--Testcase 2116:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), to_hex(id), 4 FROM time_tbl;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (mysql_current_timestamp()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_timestamp(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select mysql_current_timestamp with order by (explain)
--Testcase 2117:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), c1 FROM time_tbl ORDER BY mysql_current_timestamp();
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (mysql_current_timestamp()), c1
   Sort Key: (mysql_current_timestamp())
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (mysql_current_timestamp()), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_current_timestamp(), c1 FROM public.time_tblmysql
(7 rows)

-- select mysql_current_timestamp with order by index (explain)
--Testcase 2118:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), c1 FROM time_tbl ORDER BY 1;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (mysql_current_timestamp()), c1
   Sort Key: (mysql_current_timestamp())
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (mysql_current_timestamp()), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_current_timestamp(), c1 FROM public.time_tblmysql
(7 rows)

-- mysql_current_timestamp constraints with order by (explain)
--Testcase 2119:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_timestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp ORDER BY c1;
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_current_timestamp(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- mysql_current_timestamp constraints with order by (result)
--Testcase 2120:
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_timestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select mysql_current_timestamp with group by (explain)
--Testcase 2121:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), c1 FROM time_tbl GROUP BY c1;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_current_timestamp()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_timestamp(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_current_timestamp with group by index (explain)
--Testcase 2122:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), c1 FROM time_tbl GROUP BY 2;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_current_timestamp()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_timestamp(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_current_timestamp with group by having (explain)
--Testcase 2123:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), c1 FROM time_tbl GROUP BY mysql_current_timestamp(),c1 HAVING mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp;
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_current_timestamp()), c1
   Filter: ((mysql_current_timestamp()) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_timestamp(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- select mysql_current_timestamp with group by index having (explain)
--Testcase 2124:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp(), c1 FROM time_tbl GROUP BY 2,1 HAVING mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp;
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_current_timestamp()), c1
   Filter: ((mysql_current_timestamp()) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_current_timestamp(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.mysql_current_timestamp() > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- mysql_current_timestamp constraints with group by (explain)
--Testcase 2125:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_timestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp GROUP BY c1;
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_current_timestamp(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone)) GROUP BY 1
(6 rows)

-- mysql_current_timestamp constraints with group by (result)
--Testcase 2126:
SELECT c1 FROM time_tbl WHERE addtime(mysql_current_timestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_current_timestamp and as
--Testcase 2127:
EXPLAIN VERBOSE
SELECT mysql_current_timestamp() as mysql_current_timestamp1 FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_current_timestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_current_timestamp() FROM public.time_tblmysql
(4 rows)

-- DATE()
-- select date (stub function, explain)
--Testcase 2128:
EXPLAIN VERBOSE
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl;
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1082.70 rows=3413 width=16)
   Output: (date(c3)), c2, (date(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '2021-01-01'::date
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT date(c3), c2, date(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), '2021-01-01'::date FROM public.time_tblmysql
(4 rows)

-- select date (stub function, result)
--Testcase 2129:
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl;
    date    |    date    |    date    |    date    
------------+------------+------------+------------
 2021-01-03 | 2021-01-02 | 2021-01-01 | 2021-01-01
 2021-01-04 | 2021-01-01 | 2021-01-03 | 2021-01-01
 2021-01-05 | 2021-01-10 | 2021-01-03 | 2021-01-01
 2021-01-06 | 2021-01-15 | 2021-01-05 | 2021-01-01
 2021-01-07 | 2021-01-29 | 2021-01-05 | 2021-01-01
(5 rows)

-- select date (stub function, not pushdown constraints, explain)
--Testcase 2130:
EXPLAIN VERBOSE
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl WHERE to_hex(id) = '1';
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..233.53 rows=17 width=16)
   Output: (date(c3)), c2, (date(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '2021-01-01'::date
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT date(c3), c2, date(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), '2021-01-01'::date, id FROM public.time_tblmysql
(5 rows)

-- select date (stub function, not pushdown constraints, result)
--Testcase 2131:
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl WHERE to_hex(id) = '1';
    date    |    date    |    date    |    date    
------------+------------+------------+------------
 2021-01-04 | 2021-01-01 | 2021-01-03 | 2021-01-01
(1 row)

-- select date (stub function, pushdown constraints, explain)
--Testcase 2132:
EXPLAIN VERBOSE
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl WHERE id != 0;
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1086.56 rows=3396 width=16)
   Output: (date(c3)), c2, (date(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '2021-01-01'::date
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT date(c3), c2, date(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), '2021-01-01'::date FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select date (stub function, pushdown constraints, result)
--Testcase 2133:
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl WHERE id != 0;
    date    |    date    |    date    |    date    
------------+------------+------------+------------
 2021-01-04 | 2021-01-01 | 2021-01-03 | 2021-01-01
 2021-01-05 | 2021-01-10 | 2021-01-03 | 2021-01-01
 2021-01-06 | 2021-01-15 | 2021-01-05 | 2021-01-01
 2021-01-07 | 2021-01-29 | 2021-01-05 | 2021-01-01
(4 rows)

-- select date (stub function, date in constraints, explain)
--Testcase 2134:
EXPLAIN VERBOSE
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl WHERE date(c3) != '2000-01-01';
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1095.10 rows=3396 width=16)
   Output: (date(c3)), c2, (date(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '2021-01-01'::date
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT date(c3), c2, date(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), '2021-01-01'::date FROM public.time_tblmysql WHERE ((date(c3) <> '2000-01-01'::date))
(4 rows)

-- select date (stub function, date in constraints, result)
--Testcase 2135:
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl WHERE date(c3) != '2000-01-01';
    date    |    date    |    date    |    date    
------------+------------+------------+------------
 2021-01-03 | 2021-01-02 | 2021-01-01 | 2021-01-01
 2021-01-04 | 2021-01-01 | 2021-01-03 | 2021-01-01
 2021-01-05 | 2021-01-10 | 2021-01-03 | 2021-01-01
 2021-01-06 | 2021-01-15 | 2021-01-05 | 2021-01-01
 2021-01-07 | 2021-01-29 | 2021-01-05 | 2021-01-01
(5 rows)

-- select date (stub function, date in constraints, explain)
--Testcase 2136:
EXPLAIN VERBOSE
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl WHERE date('2021-01-01 12:00:00') > '2000-01-01';
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1082.70 rows=3413 width=16)
   Output: (date(c3)), c2, (date(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '2021-01-01'::date
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT date(c3), c2, date(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), '2021-01-01'::date FROM public.time_tblmysql
(4 rows)

-- select date (stub function, date in constraints, result)
--Testcase 2137:
SELECT date(c3), date(c2), date(date_sub(c3, '1 12:59:10')), date('2021-01-01 12:00:00') FROM time_tbl WHERE date('2021-01-01 12:00:00') > '2000-01-01';
    date    |    date    |    date    |    date    
------------+------------+------------+------------
 2021-01-03 | 2021-01-02 | 2021-01-01 | 2021-01-01
 2021-01-04 | 2021-01-01 | 2021-01-03 | 2021-01-01
 2021-01-05 | 2021-01-10 | 2021-01-03 | 2021-01-01
 2021-01-06 | 2021-01-15 | 2021-01-05 | 2021-01-01
 2021-01-07 | 2021-01-29 | 2021-01-05 | 2021-01-01
(5 rows)

-- select date with agg (pushdown, explain)
--Testcase 2138:
EXPLAIN VERBOSE
SELECT max(c3), date(max(c3)) FROM time_tbl;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (date(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), date(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select date as nest function with agg (pushdown, result)
--Testcase 2139:
SELECT max(c3), date(max(c3)) FROM time_tbl;
         max         |    date    
---------------------+------------
 2021-01-07 00:59:59 | 2021-01-07
(1 row)

-- select date with non pushdown func and explicit constant (explain)
--Testcase 2140:
EXPLAIN VERBOSE
SELECT date(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (date(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT date(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select date with non pushdown func and explicit constant (result)
--Testcase 2141:
SELECT date(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
    date    |        pi         | ?column? 
------------+-------------------+----------
 2021-01-01 | 3.141592653589793 |      4.1
 2021-01-03 | 3.141592653589793 |      4.1
 2021-01-03 | 3.141592653589793 |      4.1
 2021-01-05 | 3.141592653589793 |      4.1
 2021-01-05 | 3.141592653589793 |      4.1
(5 rows)

-- select date with order by (explain)
--Testcase 2142:
EXPLAIN VERBOSE
SELECT id, date(c3 + '1 12:59:10') FROM time_tbl order by date(c3 + '1 12:59:10');
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Sort  (cost=429.74..438.28 rows=3413 width=8)
   Output: id, (date((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (date((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..229.45 rows=3413 width=8)
         Output: id, (date((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, date((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select date with order by (result)
--Testcase 2143:
SELECT id, date(c3 + '1 12:59:10') FROM time_tbl order by date(c3 + '1 12:59:10');
 id |    date    
----+------------
  0 | 2021-01-05
  1 | 2021-01-06
  2 | 2021-01-07
  3 | 2021-01-08
  4 | 2021-01-08
(5 rows)

-- select date with order by index (result)
--Testcase 2144:
SELECT id, date(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id |    date    
----+------------
  0 | 2021-01-05
  1 | 2021-01-06
  2 | 2021-01-07
  3 | 2021-01-08
  4 | 2021-01-08
(5 rows)

-- select date with order by index (result)
--Testcase 2145:
SELECT id, date(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id |    date    
----+------------
  0 | 2021-01-05
  1 | 2021-01-06
  2 | 2021-01-07
  3 | 2021-01-08
  4 | 2021-01-08
(5 rows)

-- select date with group by (explain)
--Testcase 2146:
EXPLAIN VERBOSE
SELECT max(c3), date(c3 + '1 12:59:10') FROM time_tbl group by date(c3 + '1 12:59:10');
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (date((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), date((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select date with group by (result)
--Testcase 2147:
SELECT max(c3), date(c3 + '1 12:59:10') FROM time_tbl group by date(c3 + '1 12:59:10');
         max         |    date    
---------------------+------------
 2021-01-03 12:10:30 | 2021-01-05
 2021-01-04 23:12:13 | 2021-01-06
 2021-01-05 11:12:12 | 2021-01-07
 2021-01-07 00:59:59 | 2021-01-08
(4 rows)

-- select date with group by index (result)
--Testcase 2148:
SELECT id, date(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id |    date    
----+------------
  0 | 2021-01-05
  1 | 2021-01-06
  2 | 2021-01-07
  3 | 2021-01-08
  4 | 2021-01-08
(5 rows)

-- select date with group by index (result)
--Testcase 2149:
SELECT id, date(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id |    date    
----+------------
  0 | 2021-01-05
  1 | 2021-01-06
  2 | 2021-01-07
  3 | 2021-01-08
  4 | 2021-01-08
(5 rows)

-- select date with group by having (explain)
--Testcase 2150:
EXPLAIN VERBOSE
SELECT max(c3), date(c3 + '1 12:59:10') FROM time_tbl group by date(c3 + '1 12:59:10'), c3 HAVING date(c3) > '2000-01-01';
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (date((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), date((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql WHERE ((date(c3) > '2000-01-01'::date)) GROUP BY 2, 3
(6 rows)

-- select date with group by having (result)
--Testcase 2151:
SELECT max(c3), date(c3 + '1 12:59:10') FROM time_tbl group by date(c3 + '1 12:59:10'), c3 HAVING date(c3) > '2000-01-01';
         max         |    date    
---------------------+------------
 2021-01-03 12:10:30 | 2021-01-05
 2021-01-04 23:12:13 | 2021-01-06
 2021-01-05 11:12:12 | 2021-01-07
 2021-01-06 16:00:00 | 2021-01-08
 2021-01-07 00:59:59 | 2021-01-08
(5 rows)

-- select date with group by index having (result)
--Testcase 2152:
SELECT id, date(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING date(c3 + '1 12:59:10') > '2000-01-01';
 id |    date    |         c3          
----+------------+---------------------
  0 | 2021-01-05 | 2021-01-03 12:10:30
  1 | 2021-01-06 | 2021-01-04 23:12:13
  2 | 2021-01-07 | 2021-01-05 11:12:12
  3 | 2021-01-08 | 2021-01-06 16:00:00
  4 | 2021-01-08 | 2021-01-07 00:59:59
(5 rows)

-- select date with group by index having (result)
--Testcase 2153:
SELECT id, date(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING date(c3 + '1 12:59:10') > '2000-01-01';
 id |    date    |         c3          
----+------------+---------------------
  0 | 2021-01-05 | 2021-01-03 12:10:30
  1 | 2021-01-06 | 2021-01-04 23:12:13
  2 | 2021-01-07 | 2021-01-05 11:12:12
  3 | 2021-01-08 | 2021-01-06 16:00:00
  4 | 2021-01-08 | 2021-01-07 00:59:59
(5 rows)

-- select date and as
--Testcase 2154:
SELECT date(date_sub(c3, '1 12:59:10')) as date1 FROM time_tbl;
   date1    
------------
 2021-01-01
 2021-01-03
 2021-01-03
 2021-01-05
 2021-01-05
(5 rows)

-- DATE_ADD()
-- select date_add (stub function, explain)
--Testcase 2155:
EXPLAIN VERBOSE
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl;
                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=32)
   Output: (date_add((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval)), (date_add(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_add(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval), public.date_add(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval) FROM public.time_tblmysql
(4 rows)

-- select date_add (stub function, result)
--Testcase 2156:
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl;
      date_add       |      date_add       |      date_add       |      date_add       
---------------------+---------------------+---------------------+---------------------
 2021-01-03 12:59:10 | 2022-03-02 00:00:00 | 2022-03-01 23:11:20 | 2022-03-02 00:00:00
 2021-01-02 12:59:10 | 2022-03-02 00:00:00 | 2022-03-03 10:13:03 | 2022-03-02 00:00:00
 2021-01-11 12:59:10 | 2022-03-02 00:00:00 | 2022-03-03 22:13:02 | 2022-03-02 00:00:00
 2021-01-16 12:59:10 | 2022-03-02 00:00:00 | 2022-03-05 03:00:50 | 2022-03-02 00:00:00
 2021-01-30 12:59:10 | 2022-03-02 00:00:00 | 2022-03-05 12:00:49 | 2022-03-02 00:00:00
(5 rows)

-- select date_add (stub function, not pushdown constraints, explain)
--Testcase 2157:
EXPLAIN VERBOSE
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=32)
   Output: (date_add((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval)), (date_add(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_add(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval), public.date_add(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval), id FROM public.time_tblmysql
(5 rows)

-- select date_add (stub function, not pushdown constraints, result)
--Testcase 2158:
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl WHERE to_hex(id) = '1';
      date_add       |      date_add       |      date_add       |      date_add       
---------------------+---------------------+---------------------+---------------------
 2021-01-02 12:59:10 | 2022-03-02 00:00:00 | 2022-03-03 10:13:03 | 2022-03-02 00:00:00
(1 row)

-- select date_add (stub function, pushdown constraints, explain)
--Testcase 2159:
EXPLAIN VERBOSE
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl WHERE id != 1;
                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=32)
   Output: (date_add((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval)), (date_add(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_add(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval), public.date_add(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval) FROM public.time_tblmysql WHERE ((id <> 1))
(4 rows)

-- select date_add (stub function, pushdown constraints, result)
--Testcase 2160:
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl WHERE id != 1;
      date_add       |      date_add       |      date_add       |      date_add       
---------------------+---------------------+---------------------+---------------------
 2021-01-03 12:59:10 | 2022-03-02 00:00:00 | 2022-03-01 23:11:20 | 2022-03-02 00:00:00
 2021-01-11 12:59:10 | 2022-03-02 00:00:00 | 2022-03-03 22:13:02 | 2022-03-02 00:00:00
 2021-01-16 12:59:10 | 2022-03-02 00:00:00 | 2022-03-05 03:00:50 | 2022-03-02 00:00:00
 2021-01-30 12:59:10 | 2022-03-02 00:00:00 | 2022-03-05 12:00:49 | 2022-03-02 00:00:00
(4 rows)

-- select date_add (stub function, date_add in constraints, explain)
--Testcase 2161:
EXPLAIN VERBOSE
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl WHERE date_add(c2, '1 12:59:10'::interval) != '2000-01-01';
                                                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5335.85 rows=3396 width=32)
   Output: (date_add((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval)), (date_add(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_add(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval), public.date_add(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval) FROM public.time_tblmysql WHERE ((public.date_add(c2, '1 day 12:59:10'::interval) <> '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- select date_add (stub function, date_add in constraints, result)
--Testcase 2162:
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl WHERE date_add(c2, '1 12:59:10'::interval) != '2000-01-01';
      date_add       |      date_add       |      date_add       |      date_add       
---------------------+---------------------+---------------------+---------------------
 2021-01-03 12:59:10 | 2022-03-02 00:00:00 | 2022-03-01 23:11:20 | 2022-03-02 00:00:00
 2021-01-02 12:59:10 | 2022-03-02 00:00:00 | 2022-03-03 10:13:03 | 2022-03-02 00:00:00
 2021-01-11 12:59:10 | 2022-03-02 00:00:00 | 2022-03-03 22:13:02 | 2022-03-02 00:00:00
 2021-01-16 12:59:10 | 2022-03-02 00:00:00 | 2022-03-05 03:00:50 | 2022-03-02 00:00:00
 2021-01-30 12:59:10 | 2022-03-02 00:00:00 | 2022-03-05 12:00:49 | 2022-03-02 00:00:00
(5 rows)

-- select date_add (stub function, date_add in constraints, explain)
--Testcase 2163:
EXPLAIN VERBOSE
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl WHERE date_add('2021-01-02', '1-2'::interval) > '2000-01-01';
                                                                                                                                                                                                                                             QUERY PLAN                                                                                                                                                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2454.02 rows=1138 width=32)
   Output: (date_add((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval)), (date_add(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval)), (date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_add(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_add('2021-01-02 00:00:00'::timestamp without time zone, '@ 1 year 2 mons'::interval), public.date_add(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval) FROM public.time_tblmysql WHERE ((public.date_add('2021-01-02 00:00:00'::timestamp without time zone, '1 year 2 mons'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- select date_add (stub function, date_add in constraints, result)
--Testcase 2164:
SELECT date_add(c2, '1 12:59:10'::interval), date_add('2021-01-02', '1-2'::interval), date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), date_add('2021-01-02', '1-2'::interval) FROM time_tbl WHERE date_add('2021-01-02', '1-2'::interval) > '2000-01-01';
      date_add       |      date_add       |      date_add       |      date_add       
---------------------+---------------------+---------------------+---------------------
 2021-01-03 12:59:10 | 2022-03-02 00:00:00 | 2022-03-01 23:11:20 | 2022-03-02 00:00:00
 2021-01-02 12:59:10 | 2022-03-02 00:00:00 | 2022-03-03 10:13:03 | 2022-03-02 00:00:00
 2021-01-11 12:59:10 | 2022-03-02 00:00:00 | 2022-03-03 22:13:02 | 2022-03-02 00:00:00
 2021-01-16 12:59:10 | 2022-03-02 00:00:00 | 2022-03-05 03:00:50 | 2022-03-02 00:00:00
 2021-01-30 12:59:10 | 2022-03-02 00:00:00 | 2022-03-05 12:00:49 | 2022-03-02 00:00:00
(5 rows)

-- select date_add with agg (pushdown, explain)
--Testcase 2165:
EXPLAIN VERBOSE
SELECT max(c3), date_add(max(c2) , '1-2'::interval) FROM time_tbl;
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (date_add((max(c2))::timestamp without time zone, '@ 1 year 2 mons'::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_add(max(c2), '@ 1 year 2 mons'::interval) FROM public.time_tblmysql
(6 rows)

-- select date_add as nest function with agg (pushdown, result)
--Testcase 2166:
SELECT max(c3), date_add(max(c2) , '1-2'::interval) FROM time_tbl;
         max         |      date_add       
---------------------+---------------------
 2021-01-07 00:59:59 | 2022-03-29 00:00:00
(1 row)

-- select date_add with non pushdown func and explicit constant (explain)
--Testcase 2167:
EXPLAIN VERBOSE
SELECT date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), pi(), 4.1 FROM time_tbl;
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (date_add(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_add(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 2 mons'::interval), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select date_add with non pushdown func and explicit constant (result)
--Testcase 2168:
SELECT date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval), pi(), 4.1 FROM time_tbl;
      date_add       |        pi         | ?column? 
---------------------+-------------------+----------
 2022-03-01 23:11:20 | 3.141592653589793 |      4.1
 2022-03-03 10:13:03 | 3.141592653589793 |      4.1
 2022-03-03 22:13:02 | 3.141592653589793 |      4.1
 2022-03-05 03:00:50 | 3.141592653589793 |      4.1
 2022-03-05 12:00:49 | 3.141592653589793 |      4.1
(5 rows)

-- select date_add with order by (explain)
--Testcase 2169:
EXPLAIN VERBOSE
SELECT id, date_add(c2 + '1 d'::interval , '1-2'::interval) FROM time_tbl order by date_add(c2 + '1 d'::interval , '1-2'::interval);
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=12)
   Output: id, (date_add((c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval))
   Sort Key: (date_add((time_tbl.c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=12)
         Output: id, (date_add((c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.date_add((c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval) FROM public.time_tblmysql
(7 rows)

-- select date_add with order by (result)
--Testcase 2170:
SELECT id, date_add(c2 + '1 d'::interval , '1-2'::interval) FROM time_tbl order by date_add(c2 + '1 d'::interval , '1-2'::interval);
 id |      date_add       
----+---------------------
  1 | 2022-03-02 00:00:00
  0 | 2022-03-03 00:00:00
  2 | 2022-03-11 00:00:00
  3 | 2022-03-16 00:00:00
  4 | 2022-03-30 00:00:00
(5 rows)

-- select date_add with order by index (result)
--Testcase 2171:
SELECT id, date_add(c2 + '1 d'::interval , '1-2'::interval) FROM time_tbl order by 2,1;
 id |      date_add       
----+---------------------
  1 | 2022-03-02 00:00:00
  0 | 2022-03-03 00:00:00
  2 | 2022-03-11 00:00:00
  3 | 2022-03-16 00:00:00
  4 | 2022-03-30 00:00:00
(5 rows)

-- select date_add with order by index (result)
--Testcase 2172:
SELECT id, date_add(c2 + '1 d'::interval , '1-2'::interval) FROM time_tbl order by 1,2;
 id |      date_add       
----+---------------------
  0 | 2022-03-03 00:00:00
  1 | 2022-03-02 00:00:00
  2 | 2022-03-11 00:00:00
  3 | 2022-03-16 00:00:00
  4 | 2022-03-30 00:00:00
(5 rows)

-- select date_add with group by (explain)
--Testcase 2173:
EXPLAIN VERBOSE
SELECT max(c3), date_add(c2 + '1 d'::interval , '1-2'::interval) FROM time_tbl group by date_add(c2 + '1 d'::interval , '1-2'::interval);
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (date_add((c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_add((c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select date_add with group by (result)
--Testcase 2174:
SELECT max(c3), date_add(c2 + '1 d'::interval , '1-2'::interval) FROM time_tbl group by date_add(c2 + '1 d'::interval , '1-2'::interval);
         max         |      date_add       
---------------------+---------------------
 2021-01-03 12:10:30 | 2022-03-03 00:00:00
 2021-01-04 23:12:13 | 2022-03-02 00:00:00
 2021-01-05 11:12:12 | 2022-03-11 00:00:00
 2021-01-06 16:00:00 | 2022-03-16 00:00:00
 2021-01-07 00:59:59 | 2022-03-30 00:00:00
(5 rows)

-- select date_add with group by index (result)
--Testcase 2175:
SELECT id, date_add(c2 + '1 d'::interval , '1-2'::interval) FROM time_tbl group by 2,1;
 id |      date_add       
----+---------------------
  0 | 2022-03-03 00:00:00
  1 | 2022-03-02 00:00:00
  2 | 2022-03-11 00:00:00
  3 | 2022-03-16 00:00:00
  4 | 2022-03-30 00:00:00
(5 rows)

-- select date_add with group by index (result)
--Testcase 2176:
SELECT id, date_add(c2 + '1 d'::interval , '1-2'::interval) FROM time_tbl group by 1,2;
 id |      date_add       
----+---------------------
  0 | 2022-03-03 00:00:00
  1 | 2022-03-02 00:00:00
  2 | 2022-03-11 00:00:00
  3 | 2022-03-16 00:00:00
  4 | 2022-03-30 00:00:00
(5 rows)

-- select date_add with group by having (explain)
--Testcase 2177:
EXPLAIN VERBOSE
SELECT max(c3), date_add(c2 + '1 d'::interval , '1-2'::interval), c2 FROM time_tbl group by date_add(c2 + '1 d'::interval , '1-2'::interval), c3,c2 HAVING date_add(c2 + '1 d'::interval , '1-2'::interval) > '2000-01-01';
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=28)
   Output: (max(c3)), (date_add((c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval)), c2, c3
   Filter: ((date_add((time_tbl.c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval)) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_add((c2 + '@ 1 day'::interval), '@ 1 year 2 mons'::interval), c2, c3 FROM public.time_tblmysql GROUP BY 2, 4, 3
(7 rows)

-- select date_add with group by having (result)
--Testcase 2178:
SELECT max(c3), date_add(c2 + '1 d'::interval , '1-2'::interval), c2 FROM time_tbl group by date_add(c2 + '1 d'::interval , '1-2'::interval), c3,c2 HAVING date_add(c2 + '1 d'::interval , '1-2'::interval) > '2000-01-01';
         max         |      date_add       |     c2     
---------------------+---------------------+------------
 2021-01-03 12:10:30 | 2022-03-03 00:00:00 | 2021-01-02
 2021-01-04 23:12:13 | 2022-03-02 00:00:00 | 2021-01-01
 2021-01-05 11:12:12 | 2022-03-11 00:00:00 | 2021-01-10
 2021-01-06 16:00:00 | 2022-03-16 00:00:00 | 2021-01-15
 2021-01-07 00:59:59 | 2022-03-30 00:00:00 | 2021-01-29
(5 rows)

-- select date_add with group by index having (result)
--Testcase 2179:
SELECT c2, date_add(c2 + '1 d'::interval , '1-2'::interval), c3 FROM time_tbl group by 3, 2, 1 HAVING date_add(c2 + '1 d'::interval , '1-2'::interval) > '2000-01-01';
     c2     |      date_add       |         c3          
------------+---------------------+---------------------
 2021-01-02 | 2022-03-03 00:00:00 | 2021-01-03 12:10:30
 2021-01-01 | 2022-03-02 00:00:00 | 2021-01-04 23:12:13
 2021-01-10 | 2022-03-11 00:00:00 | 2021-01-05 11:12:12
 2021-01-15 | 2022-03-16 00:00:00 | 2021-01-06 16:00:00
 2021-01-29 | 2022-03-30 00:00:00 | 2021-01-07 00:59:59
(5 rows)

-- select date_add with group by index having (result)
--Testcase 2180:
SELECT c2, date_add(c2 + '1 d'::interval , '1-2'::interval), c3 FROM time_tbl group by 1, 2, 3 HAVING date_add(c2 + '1 d'::interval , '1-2'::interval) > '2000-01-01';
     c2     |      date_add       |         c3          
------------+---------------------+---------------------
 2021-01-02 | 2022-03-03 00:00:00 | 2021-01-03 12:10:30
 2021-01-01 | 2022-03-02 00:00:00 | 2021-01-04 23:12:13
 2021-01-10 | 2022-03-11 00:00:00 | 2021-01-05 11:12:12
 2021-01-15 | 2022-03-16 00:00:00 | 2021-01-06 16:00:00
 2021-01-29 | 2022-03-30 00:00:00 | 2021-01-07 00:59:59
(5 rows)

-- select date_add and as
--Testcase 2181:
SELECT date_add(date_sub(c3, '1 12:59:10'),  '1-2'::interval) as date_add1 FROM time_tbl;
      date_add1      
---------------------
 2022-03-01 23:11:20
 2022-03-03 10:13:03
 2022-03-03 22:13:02
 2022-03-05 03:00:50
 2022-03-05 12:00:49
(5 rows)

-- DATE_FORMAT()
-- select date_format (stub function, explain)
--Testcase 2182:
EXPLAIN VERBOSE
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl;
                                                                                                                                    QUERY PLAN                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3633.92 rows=3413 width=128)
   Output: (date_format(c3, '%H %k %I %r %T %S %w'::text)), (date_format(c3, '%W %M %Y'::text)), (date_format((c2)::timestamp without time zone, '%X %V'::text)), (date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_format(c3, '%H %k %I %r %T %S %w'::text), public.date_format(c3, '%W %M %Y'::text), public.date_format(c2, '%X %V'::text), public.date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text) FROM public.time_tblmysql
(4 rows)

-- select date_format (stub function, result)
--Testcase 2183:
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl;
            date_format             |      date_format       | date_format |     date_format     
------------------------------------+------------------------+-------------+---------------------
 12 12 12 12:10:30 PM 12:10:30 30 0 | Sunday January 2021    | 2020 52     | Sunday October 2009
 23 23 11 11:12:13 PM 23:12:13 13 1 | Monday January 2021    | 2020 52     | Sunday October 2009
 11 11 11 11:12:12 AM 11:12:12 12 2 | Tuesday January 2021   | 2021 02     | Sunday October 2009
 16 16 04 04:00:00 PM 16:00:00 00 3 | Wednesday January 2021 | 2021 02     | Sunday October 2009
 00 0 12 12:59:59 AM 00:59:59 59 4  | Thursday January 2021  | 2021 04     | Sunday October 2009
(5 rows)

-- select date_format (stub function, not pushdown constraints, explain)
--Testcase 2184:
EXPLAIN VERBOSE
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                      QUERY PLAN                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..246.24 rows=17 width=128)
   Output: (date_format(c3, '%H %k %I %r %T %S %w'::text)), (date_format(c3, '%W %M %Y'::text)), (date_format((c2)::timestamp without time zone, '%X %V'::text)), (date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_format(c3, '%H %k %I %r %T %S %w'::text), public.date_format(c3, '%W %M %Y'::text), public.date_format(c2, '%X %V'::text), public.date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text), id FROM public.time_tblmysql
(5 rows)

-- select date_format (stub function, not pushdown constraints, result)
--Testcase 2185:
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl WHERE to_hex(id) = '1';
            date_format             |     date_format     | date_format |     date_format     
------------------------------------+---------------------+-------------+---------------------
 23 23 11 11:12:13 PM 23:12:13 13 1 | Monday January 2021 | 2020 52     | Sunday October 2009
(1 row)

-- select date_format (stub function, pushdown constraints, explain)
--Testcase 2186:
EXPLAIN VERBOSE
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl WHERE id != 1;
                                                                                                                                             QUERY PLAN                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3625.07 rows=3396 width=128)
   Output: (date_format(c3, '%H %k %I %r %T %S %w'::text)), (date_format(c3, '%W %M %Y'::text)), (date_format((c2)::timestamp without time zone, '%X %V'::text)), (date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_format(c3, '%H %k %I %r %T %S %w'::text), public.date_format(c3, '%W %M %Y'::text), public.date_format(c2, '%X %V'::text), public.date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text) FROM public.time_tblmysql WHERE ((id <> 1))
(4 rows)

-- select date_format (stub function, pushdown constraints, result)
--Testcase 2187:
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl WHERE id != 1;
            date_format             |      date_format       | date_format |     date_format     
------------------------------------+------------------------+-------------+---------------------
 12 12 12 12:10:30 PM 12:10:30 30 0 | Sunday January 2021    | 2020 52     | Sunday October 2009
 11 11 11 11:12:12 AM 11:12:12 12 2 | Tuesday January 2021   | 2021 02     | Sunday October 2009
 16 16 04 04:00:00 PM 16:00:00 00 3 | Wednesday January 2021 | 2021 02     | Sunday October 2009
 00 0 12 12:59:59 AM 00:59:59 59 4  | Thursday January 2021  | 2021 04     | Sunday October 2009
(4 rows)

-- select date_format (stub function, date_format in constraints, explain)
--Testcase 2188:
EXPLAIN VERBOSE
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl WHERE date_format(c3,'%H %k %I %r %T %S %w') NOT LIKE '2000-01-01';
                                                                                                                                                                               QUERY PLAN                                                                                                                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4478.32 rows=3396 width=128)
   Output: (date_format(c3, '%H %k %I %r %T %S %w'::text)), (date_format(c3, '%W %M %Y'::text)), (date_format((c2)::timestamp without time zone, '%X %V'::text)), (date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_format(c3, '%H %k %I %r %T %S %w'::text), public.date_format(c3, '%W %M %Y'::text), public.date_format(c2, '%X %V'::text), public.date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text) FROM public.time_tblmysql WHERE ((public.date_format(c3, '%H %k %I %r %T %S %w'::text) !~~ '2000-01-01'::text))
(4 rows)

-- select date_format (stub function, date_format in constraints, result)
--Testcase 2189:
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl WHERE date_format(c3,'%H %k %I %r %T %S %w') NOT LIKE '2000-01-01';
            date_format             |      date_format       | date_format |     date_format     
------------------------------------+------------------------+-------------+---------------------
 12 12 12 12:10:30 PM 12:10:30 30 0 | Sunday January 2021    | 2020 52     | Sunday October 2009
 23 23 11 11:12:13 PM 23:12:13 13 1 | Monday January 2021    | 2020 52     | Sunday October 2009
 11 11 11 11:12:12 AM 11:12:12 12 2 | Tuesday January 2021   | 2021 02     | Sunday October 2009
 16 16 04 04:00:00 PM 16:00:00 00 3 | Wednesday January 2021 | 2021 02     | Sunday October 2009
 00 0 12 12:59:59 AM 00:59:59 59 4  | Thursday January 2021  | 2021 04     | Sunday October 2009
(5 rows)

-- select date_format (stub function, date_format in constraints, explain)
--Testcase 2190:
EXPLAIN VERBOSE
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl WHERE date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') IS NOT NULL;
                                                                                                                                                                                           QUERY PLAN                                                                                                                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4469.79 rows=3396 width=128)
   Output: (date_format(c3, '%H %k %I %r %T %S %w'::text)), (date_format(c3, '%W %M %Y'::text)), (date_format((c2)::timestamp without time zone, '%X %V'::text)), (date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_format(c3, '%H %k %I %r %T %S %w'::text), public.date_format(c3, '%W %M %Y'::text), public.date_format(c2, '%X %V'::text), public.date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text) FROM public.time_tblmysql WHERE ((public.date_format('2009-10-04 22:23:00'::timestamp without time zone, '%W %M %Y'::text) IS NOT NULL))
(4 rows)

-- select date_format (stub function, date_format in constraints, result)
--Testcase 2191:
SELECT date_format(c3,'%H %k %I %r %T %S %w'), date_format(c3, '%W %M %Y'), date_format(c2, '%X %V'), date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') FROM time_tbl WHERE date_format('2009-10-04 22:23:00'::timestamp, '%W %M %Y') IS NOT NULL;
            date_format             |      date_format       | date_format |     date_format     
------------------------------------+------------------------+-------------+---------------------
 12 12 12 12:10:30 PM 12:10:30 30 0 | Sunday January 2021    | 2020 52     | Sunday October 2009
 23 23 11 11:12:13 PM 23:12:13 13 1 | Monday January 2021    | 2020 52     | Sunday October 2009
 11 11 11 11:12:12 AM 11:12:12 12 2 | Tuesday January 2021   | 2021 02     | Sunday October 2009
 16 16 04 04:00:00 PM 16:00:00 00 3 | Wednesday January 2021 | 2021 02     | Sunday October 2009
 00 0 12 12:59:59 AM 00:59:59 59 4  | Thursday January 2021  | 2021 04     | Sunday October 2009
(5 rows)

-- select date_format with agg (pushdown, explain)
--Testcase 2192:
EXPLAIN VERBOSE
SELECT max(c3), date_format(max(c3), '%H %k %I %r %T %S %w') FROM time_tbl;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (date_format(max(c3), '%H %k %I %r %T %S %w'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_format(max(c3), '%H %k %I %r %T %S %w'::text) FROM public.time_tblmysql
(6 rows)

-- select date_format as nest function with agg (pushdown, result)
--Testcase 2193:
SELECT max(c3), date_format(max(c3), '%H %k %I %r %T %S %w') FROM time_tbl;
         max         |            date_format            
---------------------+-----------------------------------
 2021-01-07 00:59:59 | 00 0 12 12:59:59 AM 00:59:59 59 4
(1 row)

-- select date_format with non pushdown func and explicit constant (explain)
--Testcase 2194:
EXPLAIN VERBOSE
SELECT date_format(c2, '%X %V'), pi(), 4.1 FROM time_tbl;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (date_format((c2)::timestamp without time zone, '%X %V'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_format(c2, '%X %V'::text), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select date_format with non pushdown func and explicit constant (result)
--Testcase 2195:
SELECT date_format(c2, '%X %V'), pi(), 4.1 FROM time_tbl;
 date_format |        pi         | ?column? 
-------------+-------------------+----------
 2020 52     | 3.141592653589793 |      4.1
 2020 52     | 3.141592653589793 |      4.1
 2021 02     | 3.141592653589793 |      4.1
 2021 02     | 3.141592653589793 |      4.1
 2021 04     | 3.141592653589793 |      4.1
(5 rows)

-- select date_format with order by (explain)
--Testcase 2196:
EXPLAIN VERBOSE
SELECT id, date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl order by date_format(c3 + '1 12:59:10', '%H:%i:%s');
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=36)
   Output: id, (date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text))
   Sort Key: (date_format((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=36)
         Output: id, (date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text) FROM public.time_tblmysql
(7 rows)

-- select date_format with order by (result)
--Testcase 2197:
SELECT id, date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl order by date_format(c3 + '1 12:59:10', '%H:%i:%s');
 id | date_format 
----+-------------
  2 | 00:11:22
  0 | 01:09:40
  3 | 04:59:10
  1 | 12:11:23
  4 | 13:59:09
(5 rows)

-- select date_format with order by index (result)
--Testcase 2198:
SELECT id, date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl order by 2,1;
 id | date_format 
----+-------------
  2 | 00:11:22
  0 | 01:09:40
  3 | 04:59:10
  1 | 12:11:23
  4 | 13:59:09
(5 rows)

-- select date_format with order by index (result)
--Testcase 2199:
SELECT id, date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl order by 1,2;
 id | date_format 
----+-------------
  0 | 01:09:40
  1 | 12:11:23
  2 | 00:11:22
  3 | 04:59:10
  4 | 13:59:09
(5 rows)

-- select date_format with group by (explain)
--Testcase 2200:
EXPLAIN VERBOSE
SELECT max(c3), date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl group by date_format(c3 + '1 12:59:10', '%H:%i:%s');
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select date_format with group by (result)
--Testcase 2201:
SELECT max(c3), date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl group by date_format(c3 + '1 12:59:10', '%H:%i:%s');
         max         | date_format 
---------------------+-------------
 2021-01-03 12:10:30 | 01:09:40
 2021-01-04 23:12:13 | 12:11:23
 2021-01-05 11:12:12 | 00:11:22
 2021-01-06 16:00:00 | 04:59:10
 2021-01-07 00:59:59 | 13:59:09
(5 rows)

-- select date_format with group by index (result)
--Testcase 2202:
SELECT id, date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl group by 2,1;
 id | date_format 
----+-------------
  0 | 01:09:40
  1 | 12:11:23
  2 | 00:11:22
  3 | 04:59:10
  4 | 13:59:09
(5 rows)

-- select date_format with group by index (result)
--Testcase 2203:
SELECT id, date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl group by 1,2;
 id | date_format 
----+-------------
  0 | 01:09:40
  1 | 12:11:23
  2 | 00:11:22
  3 | 04:59:10
  4 | 13:59:09
(5 rows)

-- select date_format with group by having (explain)
--Testcase 2204:
EXPLAIN VERBOSE
SELECT max(c3), date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl group by date_format(c3 + '1 12:59:10', '%H:%i:%s'), c3 HAVING date_format(c3 + '1 12:59:10', '%H:%i:%s') > '2000-01-01';
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=48)
   Output: (max(c3)), (date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text)), c3
   Filter: ((date_format((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text)) > '2000-01-01'::text)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '%H:%i:%s'::text), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select date_format with group by having (result)
--Testcase 2205:
SELECT max(c3), date_format(c3 + '1 12:59:10', '%H:%i:%s') FROM time_tbl group by date_format(c3 + '1 12:59:10', '%H:%i:%s'), c3 HAVING date_format(c3 + '1 12:59:10', '%H:%i:%s') > '2000-01-01';
 max | date_format 
-----+-------------
(0 rows)

-- select date_format with group by index having (result)
--Testcase 2206:
SELECT id, date_format(c3 + '1 12:59:10', '%H:%i:%s'), c3 FROM time_tbl group by 3, 2, 1 HAVING date_format(c3 + '1 12:59:10', '%H:%i:%s') IS NOT NULL;
 id | date_format |         c3          
----+-------------+---------------------
  0 | 01:09:40    | 2021-01-03 12:10:30
  1 | 12:11:23    | 2021-01-04 23:12:13
  2 | 00:11:22    | 2021-01-05 11:12:12
  3 | 04:59:10    | 2021-01-06 16:00:00
  4 | 13:59:09    | 2021-01-07 00:59:59
(5 rows)

-- select date_format with group by index having (result)
--Testcase 2207:
SELECT id, date_format(c3 + '1 12:59:10', '%H:%i:%s'), c3 FROM time_tbl group by 1, 2, 3 HAVING date_format(c3 + '1 12:59:10', '%H:%i:%s') IS NOT NULL;
 id | date_format |         c3          
----+-------------+---------------------
  0 | 01:09:40    | 2021-01-03 12:10:30
  1 | 12:11:23    | 2021-01-04 23:12:13
  2 | 00:11:22    | 2021-01-05 11:12:12
  3 | 04:59:10    | 2021-01-06 16:00:00
  4 | 13:59:09    | 2021-01-07 00:59:59
(5 rows)

-- select date_format and as
--Testcase 2208:
SELECT date_format(c2, '%X %V') as date_format1 FROM time_tbl;
 date_format1 
--------------
 2020 52
 2020 52
 2021 02
 2021 02
 2021 04
(5 rows)

-- DATE_SUB()
-- select date_sub (stub function, explain)
--Testcase 2209:
EXPLAIN VERBOSE
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl;
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4478.64 rows=3413 width=24)
   Output: (date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_sub(c2, '@ 1 year 1 mon'::interval)), (date_sub(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval)), (date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_sub(c2, '@ 1 year 1 mon'::interval), public.date_sub(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval), public.date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval) FROM public.time_tblmysql
(4 rows)

-- select date_sub (stub function, result)
--Testcase 2210:
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl;
  date_sub  |  date_sub  |      date_sub       |      date_sub       
------------+------------+---------------------+---------------------
 2020-12-31 | 2019-12-02 | 2019-12-01 23:11:20 | 2019-12-01 12:00:00
 2020-12-30 | 2019-12-01 | 2019-12-03 10:13:03 | 2019-12-01 12:00:00
 2021-01-08 | 2019-12-10 | 2019-12-03 22:13:02 | 2019-12-01 12:00:00
 2021-01-13 | 2019-12-15 | 2019-12-05 03:00:50 | 2019-12-01 12:00:00
 2021-01-27 | 2019-12-29 | 2019-12-05 12:00:49 | 2019-12-01 12:00:00
(5 rows)

-- select date_sub (stub function, not pushdown constraints, explain)
--Testcase 2211:
EXPLAIN VERBOSE
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.44 rows=17 width=24)
   Output: (date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_sub(c2, '@ 1 year 1 mon'::interval)), (date_sub(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval)), (date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_sub(c2, '@ 1 year 1 mon'::interval), public.date_sub(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval), public.date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval), id FROM public.time_tblmysql
(5 rows)

-- select date_sub (stub function, not pushdown constraints, result)
--Testcase 2212:
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl WHERE to_hex(id) = '1';
  date_sub  |  date_sub  |      date_sub       |      date_sub       
------------+------------+---------------------+---------------------
 2020-12-30 | 2019-12-01 | 2019-12-03 10:13:03 | 2019-12-01 12:00:00
(1 row)

-- select date_sub (stub function, pushdown constraints, explain)
--Testcase 2213:
EXPLAIN VERBOSE
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl WHERE id != 1;
                                                                                                                                                                                               QUERY PLAN                                                                                                                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4465.58 rows=3396 width=24)
   Output: (date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_sub(c2, '@ 1 year 1 mon'::interval)), (date_sub(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval)), (date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_sub(c2, '@ 1 year 1 mon'::interval), public.date_sub(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval), public.date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval) FROM public.time_tblmysql WHERE ((id <> 1))
(4 rows)

-- select date_sub (stub function, pushdown constraints, result)
--Testcase 2214:
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl WHERE id != 1;
  date_sub  |  date_sub  |      date_sub       |      date_sub       
------------+------------+---------------------+---------------------
 2020-12-31 | 2019-12-02 | 2019-12-01 23:11:20 | 2019-12-01 12:00:00
 2021-01-08 | 2019-12-10 | 2019-12-03 22:13:02 | 2019-12-01 12:00:00
 2021-01-13 | 2019-12-15 | 2019-12-05 03:00:50 | 2019-12-01 12:00:00
 2021-01-27 | 2019-12-29 | 2019-12-05 12:00:49 | 2019-12-01 12:00:00
(4 rows)

-- select date_sub (stub function, date_sub in constraints, explain)
--Testcase 2215:
EXPLAIN VERBOSE
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl WHERE date_sub(c2, '1 12:59:10') != '2000-01-01';
                                                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5318.83 rows=3396 width=24)
   Output: (date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_sub(c2, '@ 1 year 1 mon'::interval)), (date_sub(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval)), (date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_sub(c2, '@ 1 year 1 mon'::interval), public.date_sub(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval), public.date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval) FROM public.time_tblmysql WHERE ((public.date_sub(c2, '1 day 12:59:10'::interval) <> '2000-01-01'::date))
(4 rows)

-- select date_sub (stub function, date_sub in constraints, result)
--Testcase 2216:
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl WHERE date_sub(c2, '1 12:59:10') != '2000-01-01';
  date_sub  |  date_sub  |      date_sub       |      date_sub       
------------+------------+---------------------+---------------------
 2020-12-31 | 2019-12-02 | 2019-12-01 23:11:20 | 2019-12-01 12:00:00
 2020-12-30 | 2019-12-01 | 2019-12-03 10:13:03 | 2019-12-01 12:00:00
 2021-01-08 | 2019-12-10 | 2019-12-03 22:13:02 | 2019-12-01 12:00:00
 2021-01-13 | 2019-12-15 | 2019-12-05 03:00:50 | 2019-12-01 12:00:00
 2021-01-27 | 2019-12-29 | 2019-12-05 12:00:49 | 2019-12-01 12:00:00
(5 rows)

-- select date_sub (stub function, date_sub in constraints, explain)
--Testcase 2217:
EXPLAIN VERBOSE
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl WHERE date_sub('2021-01-01 12:00:00'::timestamp, '1-1') > '2000-01-01';
                                                                                                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2451.17 rows=1138 width=24)
   Output: (date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (date_sub(c2, '@ 1 year 1 mon'::interval)), (date_sub(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval)), (date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_sub(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.date_sub(c2, '@ 1 year 1 mon'::interval), public.date_sub(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval), public.date_sub('2021-01-01 12:00:00'::timestamp without time zone, '@ 1 year 1 mon'::interval) FROM public.time_tblmysql WHERE ((public.date_sub('2021-01-01 12:00:00'::timestamp without time zone, '1 year 1 mon'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- select date_sub (stub function, date_sub in constraints, result)
--Testcase 2218:
SELECT date_sub(c2, '1 12:59:10'), date_sub(c2, '1-1'), date_sub(date_sub(c3, '1 12:59:10'), '1-1'), date_sub('2021-01-01 12:00:00'::timestamp, '1-1') FROM time_tbl WHERE date_sub('2021-01-01 12:00:00'::timestamp, '1-1') > '2000-01-01';
  date_sub  |  date_sub  |      date_sub       |      date_sub       
------------+------------+---------------------+---------------------
 2020-12-31 | 2019-12-02 | 2019-12-01 23:11:20 | 2019-12-01 12:00:00
 2020-12-30 | 2019-12-01 | 2019-12-03 10:13:03 | 2019-12-01 12:00:00
 2021-01-08 | 2019-12-10 | 2019-12-03 22:13:02 | 2019-12-01 12:00:00
 2021-01-13 | 2019-12-15 | 2019-12-05 03:00:50 | 2019-12-01 12:00:00
 2021-01-27 | 2019-12-29 | 2019-12-05 12:00:49 | 2019-12-01 12:00:00
(5 rows)

-- select date_sub with agg (pushdown, explain)
--Testcase 2219:
EXPLAIN VERBOSE
SELECT max(c3), date_sub(max(c3), '1 12:59:10') FROM time_tbl;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (date_sub(max(c3), '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_sub(max(c3), '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql
(6 rows)

-- select date_sub as nest function with agg (pushdown, result)
--Testcase 2220:
SELECT max(c3), date_sub(max(c3), '1 12:59:10') FROM time_tbl;
         max         |      date_sub       
---------------------+---------------------
 2021-01-07 00:59:59 | 2021-01-05 12:00:49
(1 row)

-- select date_sub with non pushdown func and explicit constant (explain)
--Testcase 2221:
EXPLAIN VERBOSE
SELECT date_sub(date_sub(c3, '1 12:59:10'), '1-1'), pi(), 4.1 FROM time_tbl;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (date_sub(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.date_sub(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 year 1 mon'::interval), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select date_sub with non pushdown func and explicit constant (result)
--Testcase 2222:
SELECT date_sub(date_sub(c3, '1 12:59:10'), '1-1'), pi(), 4.1 FROM time_tbl;
      date_sub       |        pi         | ?column? 
---------------------+-------------------+----------
 2019-12-01 23:11:20 | 3.141592653589793 |      4.1
 2019-12-03 10:13:03 | 3.141592653589793 |      4.1
 2019-12-03 22:13:02 | 3.141592653589793 |      4.1
 2019-12-05 03:00:50 | 3.141592653589793 |      4.1
 2019-12-05 12:00:49 | 3.141592653589793 |      4.1
(5 rows)

-- select date_sub with order by (explain)
--Testcase 2223:
EXPLAIN VERBOSE
SELECT id, date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl order by date_sub(c3 + '1 12:59:10', '1 12:59:10');
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=12)
   Output: id, (date_sub((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Sort Key: (date_sub((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=12)
         Output: id, (date_sub((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.date_sub((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql
(7 rows)

-- select date_sub with order by (result)
--Testcase 2224:
SELECT id, date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl order by date_sub(c3 + '1 12:59:10', '1 12:59:10');
 id |      date_sub       
----+---------------------
  0 | 2021-01-03 12:10:30
  1 | 2021-01-04 23:12:13
  2 | 2021-01-05 11:12:12
  3 | 2021-01-06 16:00:00
  4 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub with order by index (result)
--Testcase 2225:
SELECT id, date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl order by 2,1;
 id |      date_sub       
----+---------------------
  0 | 2021-01-03 12:10:30
  1 | 2021-01-04 23:12:13
  2 | 2021-01-05 11:12:12
  3 | 2021-01-06 16:00:00
  4 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub with order by index (result)
--Testcase 2226:
SELECT id, date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl order by 1,2;
 id |      date_sub       
----+---------------------
  0 | 2021-01-03 12:10:30
  1 | 2021-01-04 23:12:13
  2 | 2021-01-05 11:12:12
  3 | 2021-01-06 16:00:00
  4 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub with group by (explain)
--Testcase 2227:
EXPLAIN VERBOSE
SELECT max(c3), date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl group by date_sub(c3 + '1 12:59:10', '1 12:59:10');
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (date_sub((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_sub((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select date_sub with group by (result)
--Testcase 2228:
SELECT max(c3), date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl group by date_sub(c3 + '1 12:59:10', '1 12:59:10');
         max         |      date_sub       
---------------------+---------------------
 2021-01-03 12:10:30 | 2021-01-03 12:10:30
 2021-01-04 23:12:13 | 2021-01-04 23:12:13
 2021-01-05 11:12:12 | 2021-01-05 11:12:12
 2021-01-06 16:00:00 | 2021-01-06 16:00:00
 2021-01-07 00:59:59 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub with group by index (result)
--Testcase 2229:
SELECT id, date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl group by 2,1;
 id |      date_sub       
----+---------------------
  0 | 2021-01-03 12:10:30
  1 | 2021-01-04 23:12:13
  2 | 2021-01-05 11:12:12
  3 | 2021-01-06 16:00:00
  4 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub with group by index (result)
--Testcase 2230:
SELECT id, date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl group by 1,2;
 id |      date_sub       
----+---------------------
  0 | 2021-01-03 12:10:30
  1 | 2021-01-04 23:12:13
  2 | 2021-01-05 11:12:12
  3 | 2021-01-06 16:00:00
  4 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub with group by having (explain)
--Testcase 2231:
EXPLAIN VERBOSE
SELECT max(c3), date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl group by date_sub(c3 + '1 12:59:10', '1 12:59:10'), c3 HAVING date_sub(c3 + '1 12:59:10', '1 12:59:10') > '2000-01-01';
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (date_sub((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3
   Filter: ((date_sub((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval)) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.date_sub((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select date_sub with group by having (result)
--Testcase 2232:
SELECT max(c3), date_sub(c3 + '1 12:59:10', '1 12:59:10') FROM time_tbl group by date_sub(c3 + '1 12:59:10', '1 12:59:10'), c3 HAVING date_sub(c3 + '1 12:59:10', '1 12:59:10') > '2000-01-01';
         max         |      date_sub       
---------------------+---------------------
 2021-01-03 12:10:30 | 2021-01-03 12:10:30
 2021-01-04 23:12:13 | 2021-01-04 23:12:13
 2021-01-05 11:12:12 | 2021-01-05 11:12:12
 2021-01-06 16:00:00 | 2021-01-06 16:00:00
 2021-01-07 00:59:59 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub with group by index having (result)
--Testcase 2233:
SELECT id, date_sub(c3 + '1 12:59:10', '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING date_sub(c3 + '1 12:59:10', '1 12:59:10') > '2000-01-01';
 id |      date_sub       |         c3          
----+---------------------+---------------------
  0 | 2021-01-03 12:10:30 | 2021-01-03 12:10:30
  1 | 2021-01-04 23:12:13 | 2021-01-04 23:12:13
  2 | 2021-01-05 11:12:12 | 2021-01-05 11:12:12
  3 | 2021-01-06 16:00:00 | 2021-01-06 16:00:00
  4 | 2021-01-07 00:59:59 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub with group by index having (result)
--Testcase 2234:
SELECT id, date_sub(c3 + '1 12:59:10', '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING date_sub(c3 + '1 12:59:10', '1 12:59:10') > '2000-01-01';
 id |      date_sub       |         c3          
----+---------------------+---------------------
  0 | 2021-01-03 12:10:30 | 2021-01-03 12:10:30
  1 | 2021-01-04 23:12:13 | 2021-01-04 23:12:13
  2 | 2021-01-05 11:12:12 | 2021-01-05 11:12:12
  3 | 2021-01-06 16:00:00 | 2021-01-06 16:00:00
  4 | 2021-01-07 00:59:59 | 2021-01-07 00:59:59
(5 rows)

-- select date_sub and as
--Testcase 2235:
SELECT date_sub(date_sub(c3, '1 12:59:10'), '1-1') as date_sub1 FROM time_tbl;
      date_sub1      
---------------------
 2019-12-01 23:11:20
 2019-12-03 10:13:03
 2019-12-03 22:13:02
 2019-12-05 03:00:50
 2019-12-05 12:00:49
(5 rows)

-- DATEDIFF()
-- select datediff (stub function, explain)
--Testcase 2236:
EXPLAIN VERBOSE
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl;
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3650.99 rows=3413 width=16)
   Output: (datediff(c3, (c2)::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2004-10-19 10:23:54'::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2007-12-31 00:00:00'::timestamp without time zone)), (datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(c3, c2), public.datediff(c2, '2004-10-19 10:23:54'::timestamp without time zone), public.datediff(c2, '2007-12-31 00:00:00'::timestamp without time zone), public.datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select datediff (stub function, result)
--Testcase 2237:
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl;
 datediff | datediff | datediff | datediff 
----------+----------+----------+----------
        1 |     5919 |     4751 |        1
        3 |     5918 |     4750 |        1
       -5 |     5927 |     4759 |        1
       -9 |     5932 |     4764 |        1
      -22 |     5946 |     4778 |        1
(5 rows)

-- select datediff (stub function, not pushdown constraints, explain)
--Testcase 2238:
EXPLAIN VERBOSE
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..246.32 rows=17 width=16)
   Output: (datediff(c3, (c2)::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2004-10-19 10:23:54'::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2007-12-31 00:00:00'::timestamp without time zone)), (datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(c3, c2), public.datediff(c2, '2004-10-19 10:23:54'::timestamp without time zone), public.datediff(c2, '2007-12-31 00:00:00'::timestamp without time zone), public.datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select datediff (stub function, not pushdown constraints, result)
--Testcase 2239:
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl WHERE to_hex(id) = '1';
 datediff | datediff | datediff | datediff 
----------+----------+----------+----------
        3 |     5918 |     4750 |        1
(1 row)

-- select datediff (stub function, pushdown constraints, explain)
--Testcase 2240:
EXPLAIN VERBOSE
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl WHERE id != 0;
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3642.05 rows=3396 width=16)
   Output: (datediff(c3, (c2)::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2004-10-19 10:23:54'::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2007-12-31 00:00:00'::timestamp without time zone)), (datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(c3, c2), public.datediff(c2, '2004-10-19 10:23:54'::timestamp without time zone), public.datediff(c2, '2007-12-31 00:00:00'::timestamp without time zone), public.datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select datediff (stub function, pushdown constraints, result)
--Testcase 2241:
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl WHERE id != 0;
 datediff | datediff | datediff | datediff 
----------+----------+----------+----------
        3 |     5918 |     4750 |        1
       -5 |     5927 |     4759 |        1
       -9 |     5932 |     4764 |        1
      -22 |     5946 |     4778 |        1
(4 rows)

-- select datediff (stub function, datediff in constraints, explain)
--Testcase 2242:
EXPLAIN VERBOSE
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl WHERE datediff(c3, c2) != 0;
                                                                                                                                                                                         QUERY PLAN                                                                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4503.84 rows=3396 width=16)
   Output: (datediff(c3, (c2)::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2004-10-19 10:23:54'::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2007-12-31 00:00:00'::timestamp without time zone)), (datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(c3, c2), public.datediff(c2, '2004-10-19 10:23:54'::timestamp without time zone), public.datediff(c2, '2007-12-31 00:00:00'::timestamp without time zone), public.datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.datediff(c3, c2) <> 0))
(4 rows)

-- select datediff (stub function, datediff in constraints, result)
--Testcase 2243:
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl WHERE datediff(c3, c2) != 0;
 datediff | datediff | datediff | datediff 
----------+----------+----------+----------
        1 |     5919 |     4751 |        1
        3 |     5918 |     4750 |        1
       -5 |     5927 |     4759 |        1
       -9 |     5932 |     4764 |        1
      -22 |     5946 |     4778 |        1
(5 rows)

-- select datediff (stub function, datediff in constraints, explain)
--Testcase 2244:
EXPLAIN VERBOSE
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl WHERE datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') > 0;
                                                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2175.21 rows=1138 width=16)
   Output: (datediff(c3, (c2)::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2004-10-19 10:23:54'::timestamp without time zone)), (datediff((c2)::timestamp without time zone, '2007-12-31 00:00:00'::timestamp without time zone)), (datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(c3, c2), public.datediff(c2, '2004-10-19 10:23:54'::timestamp without time zone), public.datediff(c2, '2007-12-31 00:00:00'::timestamp without time zone), public.datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.datediff('2007-12-31 23:59:59'::timestamp without time zone, '2007-12-30 00:00:00'::timestamp without time zone) > 0))
(4 rows)

-- select datediff (stub function, datediff in constraints, result)
--Testcase 2245:
SELECT datediff(c3, c2), datediff(c2, '2004-10-19 10:23:54'::timestamp), datediff(c2, '2007-12-31'::date), datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') FROM time_tbl WHERE datediff('2007-12-31 23:59:59'::timestamp, '2007-12-30') > 0;
 datediff | datediff | datediff | datediff 
----------+----------+----------+----------
        1 |     5919 |     4751 |        1
        3 |     5918 |     4750 |        1
       -5 |     5927 |     4759 |        1
       -9 |     5932 |     4764 |        1
      -22 |     5946 |     4778 |        1
(5 rows)

-- select datediff as nest function with agg (pushdown, explain)
--Testcase 2246:
EXPLAIN VERBOSE
SELECT max(c2), datediff('2021-01-02'::date, max(c2)) FROM time_tbl;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (max(c2)), (datediff('2021-01-02 00:00:00'::timestamp without time zone, (max(c2))::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c2), public.datediff('2021-01-02 00:00:00'::timestamp without time zone, max(c2)) FROM public.time_tblmysql
(6 rows)

-- select datediff as nest function with agg (pushdown, result)
--Testcase 2247:
SELECT max(c2), datediff('2021-01-02'::date, max(c2)) FROM time_tbl;
    max     | datediff 
------------+----------
 2021-01-29 |      -27
(1 row)

-- select datediff as nest with stub (pushdown, explain)
--Testcase 2248:
EXPLAIN VERBOSE
SELECT datediff(makedate(2019, id), c2) FROM time_tbl;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1935.95 rows=3413 width=4)
   Output: (datediff((makedate(2019, id))::timestamp without time zone, (c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(public.makedate(2019, id), c2) FROM public.time_tblmysql
(4 rows)

-- select datediff as nest with stub (pushdown, result)
--Testcase 2249:
SELECT datediff(makedate(2019, id), c2) FROM time_tbl;
 datediff 
----------
         
     -731
     -739
     -743
     -756
(5 rows)

-- select datediff with non pushdown func and explicit constant (explain)
--Testcase 2250:
EXPLAIN VERBOSE
SELECT datediff(c2, '2007-12-31'::date), pi(), 4.1 FROM time_tbl;
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (datediff((c2)::timestamp without time zone, '2007-12-31 00:00:00'::timestamp without time zone)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(c2, '2007-12-31 00:00:00'::timestamp without time zone), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select datediff with non pushdown func and explicit constant (result)
--Testcase 2251:
SELECT datediff(c2, '2007-12-31'::date), pi(), 4.1 FROM time_tbl;
 datediff |        pi         | ?column? 
----------+-------------------+----------
     4751 | 3.141592653589793 |      4.1
     4750 | 3.141592653589793 |      4.1
     4759 | 3.141592653589793 |      4.1
     4764 | 3.141592653589793 |      4.1
     4778 | 3.141592653589793 |      4.1
(5 rows)

-- select datediff with order by (explain)
--Testcase 2252:
EXPLAIN VERBOSE
SELECT id, datediff(c3 + '1 12:59:10', c2 ) FROM time_tbl order by datediff(c3 + '1 12:59:10', c2 );
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1282.99..1291.53 rows=3413 width=8)
   Output: id, (datediff((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), (c2)::timestamp without time zone))
   Sort Key: (datediff((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), (time_tbl.c2)::timestamp without time zone))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1082.70 rows=3413 width=8)
         Output: id, (datediff((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), (c2)::timestamp without time zone))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.datediff((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), c2) FROM public.time_tblmysql
(7 rows)

-- select datediff with order by (result)
--Testcase 2253:
SELECT id, datediff(c3 + '1 12:59:10', c2 ) FROM time_tbl order by datediff(c3 + '1 12:59:10', c2 );
 id | datediff 
----+----------
  4 |      -21
  3 |       -7
  2 |       -3
  0 |        3
  1 |        5
(5 rows)

-- select datediff with order by index (result)
--Testcase 2254:
SELECT id, datediff(c3 + '1 12:59:10', c2 ) FROM time_tbl order by 2,1;
 id | datediff 
----+----------
  4 |      -21
  3 |       -7
  2 |       -3
  0 |        3
  1 |        5
(5 rows)

-- select datediff with order by index (result)
--Testcase 2255:
SELECT id, datediff(c3 + '1 12:59:10', c2 ) FROM time_tbl order by 1,2;
 id | datediff 
----+----------
  0 |        3
  1 |        5
  2 |       -3
  3 |       -7
  4 |      -21
(5 rows)

-- select datediff with group by (explain)
--Testcase 2256:
EXPLAIN VERBOSE
SELECT count(id), datediff(c3 + '1 12:59:10', c2 ) FROM time_tbl group by datediff(c3 + '1 12:59:10', c2 );
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (datediff((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), (c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.datediff((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), c2) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select datediff with group by (result)
--Testcase 2257:
SELECT count(id), datediff(c3 + '1 12:59:10', c2 ) FROM time_tbl group by datediff(c3 + '1 12:59:10', c2 );
 count | datediff 
-------+----------
     1 |        3
     1 |        5
     1 |       -3
     1 |       -7
     1 |      -21
(5 rows)

-- select datediff with group by index (result)
--Testcase 2258:
SELECT id, datediff(c3 + '1 12:59:10', c2 ) FROM time_tbl group by 2,1;
 id | datediff 
----+----------
  0 |        3
  1 |        5
  2 |       -3
  3 |       -7
  4 |      -21
(5 rows)

-- select datediff with group by index (result)
--Testcase 2259:
SELECT id, datediff(c3 + '1 12:59:10', c2 ) FROM time_tbl group by 1,2;
 id | datediff 
----+----------
  0 |        3
  1 |        5
  2 |       -3
  3 |       -7
  4 |      -21
(5 rows)

-- select datediff with group by having (explain)
--Testcase 2260:
EXPLAIN VERBOSE
SELECT count(id), datediff(c3 + '1 12:59:10', c2 ), c2, c3 FROM time_tbl group by datediff(c3 + '1 12:59:10', c2 ), id,c2,c3 HAVING datediff(c3 + '1 12:59:10', c2 ) > 0;
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=28)
   Output: (count(id)), (datediff((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), (c2)::timestamp without time zone)), c2, c3, id
   Filter: ((datediff((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), (time_tbl.c2)::timestamp without time zone)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.datediff((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), c2), c2, c3, id FROM public.time_tblmysql GROUP BY 2, 5, 3, 4
(7 rows)

-- select datediff with group by having (result)
--Testcase 2261:
SELECT count(id), datediff(c3 + '1 12:59:10', c2 ), c2, c3 FROM time_tbl group by datediff(c3 + '1 12:59:10', c2 ), id,c2,c3 HAVING datediff(c3 + '1 12:59:10', c2 ) > 0;
 count | datediff |     c2     |         c3          
-------+----------+------------+---------------------
     1 |        3 | 2021-01-02 | 2021-01-03 12:10:30
     1 |        5 | 2021-01-01 | 2021-01-04 23:12:13
(2 rows)

-- select datediff with group by index having (result)
--Testcase 2262:
SELECT id, datediff(c3 + '1 12:59:10', c2 ), c2, c3 FROM time_tbl group by 4,3,2,1 HAVING datediff(c3 + '1 12:59:10', c2 ) > 0;
 id | datediff |     c2     |         c3          
----+----------+------------+---------------------
  0 |        3 | 2021-01-02 | 2021-01-03 12:10:30
  1 |        5 | 2021-01-01 | 2021-01-04 23:12:13
(2 rows)

-- select datediff with group by index having (result)
--Testcase 2263:
SELECT id, datediff(c3 + '1 12:59:10', c2 ), c2, c3 FROM time_tbl group by 1,2,3,4 HAVING datediff(c3 + '1 12:59:10', c2 ) > 0;
 id | datediff |     c2     |         c3          
----+----------+------------+---------------------
  0 |        3 | 2021-01-02 | 2021-01-03 12:10:30
  1 |        5 | 2021-01-01 | 2021-01-04 23:12:13
(2 rows)

-- select datediff and as
--Testcase 2264:
SELECT datediff(c2, '2007-12-31'::date) as datediff1 FROM time_tbl;
 datediff1 
-----------
      4751
      4750
      4759
      4764
      4778
(5 rows)

-- YEARWEEK()
-- select yearweek (stub function, explain)
--Testcase 2265:
EXPLAIN VERBOSE
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=16)
   Output: (yearweek(c3)), (yearweek((c2)::timestamp without time zone)), (yearweek(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (yearweek('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.yearweek(c3), public.yearweek(c2), public.yearweek(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.yearweek('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select yearweek (stub function, result)
--Testcase 2266:
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
 yearweek | yearweek | yearweek | yearweek 
----------+----------+----------+----------
   202101 |   202052 |   202052 |   202052
   202101 |   202052 |   202101 |   202052
   202101 |   202102 |   202101 |   202052
   202101 |   202102 |   202101 |   202052
   202101 |   202104 |   202101 |   202052
(5 rows)

-- select yearweek (stub function, not pushdown constraints, explain)
--Testcase 2267:
EXPLAIN VERBOSE
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                       QUERY PLAN                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=16)
   Output: (yearweek(c3)), (yearweek((c2)::timestamp without time zone)), (yearweek(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (yearweek('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.yearweek(c3), public.yearweek(c2), public.yearweek(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.yearweek('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select yearweek (stub function, not pushdown constraints, result)
--Testcase 2268:
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 yearweek | yearweek | yearweek | yearweek 
----------+----------+----------+----------
   202101 |   202052 |   202101 |   202052
(1 row)

-- select yearweek (stub function, pushdown constraints, explain)
--Testcase 2269:
EXPLAIN VERBOSE
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                               QUERY PLAN                                                                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=16)
   Output: (yearweek(c3)), (yearweek((c2)::timestamp without time zone)), (yearweek(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (yearweek('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.yearweek(c3), public.yearweek(c2), public.yearweek(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.yearweek('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select yearweek (stub function, pushdown constraints, result)
--Testcase 2270:
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 yearweek | yearweek | yearweek | yearweek 
----------+----------+----------+----------
   202101 |   202052 |   202052 |   202052
   202101 |   202052 |   202101 |   202052
   202101 |   202102 |   202101 |   202052
   202101 |   202102 |   202101 |   202052
   202101 |   202104 |   202101 |   202052
(5 rows)

-- select yearweek (stub function, yearweek in constraints, explain)
--Testcase 2271:
EXPLAIN VERBOSE
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE yearweek(c3) != yearweek('2000-01-01'::timestamp);
                                                                                                                                                                       QUERY PLAN                                                                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..6180.57 rows=3396 width=16)
   Output: (yearweek(c3)), (yearweek((c2)::timestamp without time zone)), (yearweek(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (yearweek('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.yearweek(c3), public.yearweek(c2), public.yearweek(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.yearweek('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.yearweek(c3) <> public.yearweek('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select yearweek (stub function, yearweek in constraints, result)
--Testcase 2272:
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE yearweek(c3) != yearweek('2000-01-01'::timestamp);
 yearweek | yearweek | yearweek | yearweek 
----------+----------+----------+----------
   202101 |   202052 |   202052 |   202052
   202101 |   202052 |   202101 |   202052
   202101 |   202102 |   202101 |   202052
   202101 |   202102 |   202101 |   202052
   202101 |   202104 |   202101 |   202052
(5 rows)

-- select yearweek (stub function, yearweek in constraints, explain)
--Testcase 2273:
EXPLAIN VERBOSE
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE yearweek('2021-01-01 12:00:00'::timestamp) > '1';
                                                                                                                                                              QUERY PLAN                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2454.02 rows=1138 width=16)
   Output: (yearweek(c3)), (yearweek((c2)::timestamp without time zone)), (yearweek(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (yearweek('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.yearweek(c3), public.yearweek(c2), public.yearweek(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.yearweek('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.yearweek('2021-01-01 12:00:00'::timestamp without time zone) > 1))
(4 rows)

-- select yearweek (stub function, yearweek in constraints, result)
--Testcase 2274:
SELECT yearweek(c3), yearweek(c2), yearweek(date_sub(c3, '1 12:59:10')), yearweek('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE yearweek('2021-01-01 12:00:00'::timestamp) > '1';
 yearweek | yearweek | yearweek | yearweek 
----------+----------+----------+----------
   202101 |   202052 |   202052 |   202052
   202101 |   202052 |   202101 |   202052
   202101 |   202102 |   202101 |   202052
   202101 |   202102 |   202101 |   202052
   202101 |   202104 |   202101 |   202052
(5 rows)

-- select yearweek with agg (pushdown, explain)
--Testcase 2275:
EXPLAIN VERBOSE
SELECT max(c3), yearweek(max(c3)) FROM time_tbl;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (yearweek(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.yearweek(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select yearweek as nest function with agg (pushdown, result)
--Testcase 2276:
SELECT max(c3), yearweek(max(c3)) FROM time_tbl;
         max         | yearweek 
---------------------+----------
 2021-01-07 00:59:59 |   202101
(1 row)

-- select yearweek with non pushdown func and explicit constant (explain)
--Testcase 2277:
EXPLAIN VERBOSE
SELECT yearweek(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (yearweek(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.yearweek(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select yearweek with non pushdown func and explicit constant (result)
--Testcase 2278:
SELECT yearweek(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 yearweek |        pi         | ?column? 
----------+-------------------+----------
   202052 | 3.141592653589793 |      4.1
   202101 | 3.141592653589793 |      4.1
   202101 | 3.141592653589793 |      4.1
   202101 | 3.141592653589793 |      4.1
   202101 | 3.141592653589793 |      4.1
(5 rows)

-- select yearweek with order by (explain)
--Testcase 2279:
EXPLAIN VERBOSE
SELECT id, yearweek(c3 + '1 12:59:10') FROM time_tbl order by yearweek(c3 + '1 12:59:10');
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=8)
   Output: id, (yearweek((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (yearweek((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=8)
         Output: id, (yearweek((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.yearweek((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select yearweek with order by (result)
--Testcase 2280:
SELECT id, yearweek(c3 + '1 12:59:10') FROM time_tbl order by yearweek(c3 + '1 12:59:10');
 id | yearweek 
----+----------
  0 |   202101
  1 |   202101
  2 |   202101
  3 |   202101
  4 |   202101
(5 rows)

-- select yearweek with order by index (result)
--Testcase 2281:
SELECT id, yearweek(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | yearweek 
----+----------
  0 |   202101
  1 |   202101
  2 |   202101
  3 |   202101
  4 |   202101
(5 rows)

-- select yearweek with order by index (result)
--Testcase 2282:
SELECT id, yearweek(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | yearweek 
----+----------
  0 |   202101
  1 |   202101
  2 |   202101
  3 |   202101
  4 |   202101
(5 rows)

-- select yearweek with group by (explain)
--Testcase 2283:
EXPLAIN VERBOSE
SELECT max(c3), yearweek(c3 + '1 12:59:10') FROM time_tbl group by yearweek(c3 + '1 12:59:10');
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (yearweek((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.yearweek((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select yearweek with group by (result)
--Testcase 2284:
SELECT max(c3), yearweek(c3 + '1 12:59:10') FROM time_tbl group by yearweek(c3 + '1 12:59:10');
         max         | yearweek 
---------------------+----------
 2021-01-07 00:59:59 |   202101
(1 row)

-- select yearweek with group by index (result)
--Testcase 2285:
SELECT id, yearweek(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | yearweek 
----+----------
  0 |   202101
  1 |   202101
  2 |   202101
  3 |   202101
  4 |   202101
(5 rows)

-- select yearweek with group by index (result)
--Testcase 2286:
SELECT id, yearweek(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | yearweek 
----+----------
  0 |   202101
  1 |   202101
  2 |   202101
  3 |   202101
  4 |   202101
(5 rows)

-- select yearweek with group by having (explain)
--Testcase 2287:
EXPLAIN VERBOSE
SELECT max(c3), yearweek(c3 + '1 12:59:10') FROM time_tbl group by yearweek(c3 + '1 12:59:10'), c3 HAVING yearweek(c3 + '1 12:59:10') > 201010;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (yearweek((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((yearweek((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) > 201010)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.yearweek((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select yearweek with group by having (result)
--Testcase 2288:
SELECT max(c3), yearweek(c3 + '1 12:59:10') FROM time_tbl group by yearweek(c3 + '1 12:59:10'), c3 HAVING yearweek(c3 + '1 12:59:10') > 201010;
         max         | yearweek 
---------------------+----------
 2021-01-03 12:10:30 |   202101
 2021-01-04 23:12:13 |   202101
 2021-01-05 11:12:12 |   202101
 2021-01-06 16:00:00 |   202101
 2021-01-07 00:59:59 |   202101
(5 rows)

-- select yearweek with group by index having (result)
--Testcase 2289:
SELECT id, yearweek(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING yearweek(c3 + '1 12:59:10') > 201010;
 id | yearweek |         c3          
----+----------+---------------------
  0 |   202101 | 2021-01-03 12:10:30
  1 |   202101 | 2021-01-04 23:12:13
  2 |   202101 | 2021-01-05 11:12:12
  3 |   202101 | 2021-01-06 16:00:00
  4 |   202101 | 2021-01-07 00:59:59
(5 rows)

-- select yearweek with group by index having (result)
--Testcase 2290:
SELECT id, yearweek(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING yearweek(c3 + '1 12:59:10') > 201010;
 id | yearweek |         c3          
----+----------+---------------------
  0 |   202101 | 2021-01-03 12:10:30
  1 |   202101 | 2021-01-04 23:12:13
  2 |   202101 | 2021-01-05 11:12:12
  3 |   202101 | 2021-01-06 16:00:00
  4 |   202101 | 2021-01-07 00:59:59
(5 rows)

-- select yearweek and as
--Testcase 2291:
SELECT yearweek(date_sub(c3, '1 12:59:10')) as yearweek1 FROM time_tbl;
 yearweek1 
-----------
    202052
    202101
    202101
    202101
    202101
(5 rows)

-- YEAR()
-- select year (stub function, explain)
--Testcase 2292:
EXPLAIN VERBOSE
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=16)
   Output: (year(c3)), (year((c2)::timestamp without time zone)), (year(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (year('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.year(c3), public.year(c2), public.year(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.year('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select year (stub function, result)
--Testcase 2293:
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
 year | year | year | year 
------+------+------+------
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
(5 rows)

-- select year (stub function, not pushdown constraints, explain)
--Testcase 2294:
EXPLAIN VERBOSE
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                               QUERY PLAN                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=16)
   Output: (year(c3)), (year((c2)::timestamp without time zone)), (year(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (year('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.year(c3), public.year(c2), public.year(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.year('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select year (stub function, not pushdown constraints, result)
--Testcase 2295:
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 year | year | year | year 
------+------+------+------
 2021 | 2021 | 2021 | 2021
(1 row)

-- select year (stub function, pushdown constraints, explain)
--Testcase 2296:
EXPLAIN VERBOSE
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                       QUERY PLAN                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=16)
   Output: (year(c3)), (year((c2)::timestamp without time zone)), (year(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (year('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.year(c3), public.year(c2), public.year(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.year('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select year (stub function, pushdown constraints, result)
--Testcase 2297:
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 year | year | year | year 
------+------+------+------
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
(5 rows)

-- select year (stub function, year in constraints, explain)
--Testcase 2298:
EXPLAIN VERBOSE
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE year(c3) != year('2000-01-01'::timestamp);
                                                                                                                                                           QUERY PLAN                                                                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..6180.57 rows=3396 width=16)
   Output: (year(c3)), (year((c2)::timestamp without time zone)), (year(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (year('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.year(c3), public.year(c2), public.year(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.year('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.year(c3) <> public.year('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select year (stub function, year in constraints, result)
--Testcase 2299:
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE year(c3) != year('2000-01-01'::timestamp);
 year | year | year | year 
------+------+------+------
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
(5 rows)

-- select year (stub function, year in constraints, explain)
--Testcase 2300:
EXPLAIN VERBOSE
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE year('2021-01-01 12:00:00'::timestamp) > '1';
                                                                                                                                                    QUERY PLAN                                                                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2454.02 rows=1138 width=16)
   Output: (year(c3)), (year((c2)::timestamp without time zone)), (year(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (year('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.year(c3), public.year(c2), public.year(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.year('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.year('2021-01-01 12:00:00'::timestamp without time zone) > 1))
(4 rows)

-- select year (stub function, year in constraints, result)
--Testcase 2301:
SELECT year(c3), year(c2), year(date_sub(c3, '1 12:59:10')), year('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE year('2021-01-01 12:00:00'::timestamp) > '1';
 year | year | year | year 
------+------+------+------
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
 2021 | 2021 | 2021 | 2021
(5 rows)

-- select year with agg (pushdown, explain)
--Testcase 2302:
EXPLAIN VERBOSE
SELECT max(c3), year(max(c3)) FROM time_tbl;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (year(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.year(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select year as nest function with agg (pushdown, result)
--Testcase 2303:
SELECT max(c3), year(max(c3)) FROM time_tbl;
         max         | year 
---------------------+------
 2021-01-07 00:59:59 | 2021
(1 row)

-- select year with non pushdown func and explicit constant (explain)
--Testcase 2304:
EXPLAIN VERBOSE
SELECT year(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (year(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.year(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select year with non pushdown func and explicit constant (result)
--Testcase 2305:
SELECT year(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 year |        pi         | ?column? 
------+-------------------+----------
 2021 | 3.141592653589793 |      4.1
 2021 | 3.141592653589793 |      4.1
 2021 | 3.141592653589793 |      4.1
 2021 | 3.141592653589793 |      4.1
 2021 | 3.141592653589793 |      4.1
(5 rows)

-- select year with order by (explain)
--Testcase 2306:
EXPLAIN VERBOSE
SELECT id, year(c3 + '1 12:59:10') FROM time_tbl order by year(c3 + '1 12:59:10');
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=8)
   Output: id, (year((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (year((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=8)
         Output: id, (year((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.year((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select year with order by (result)
--Testcase 2307:
SELECT id, year(c3 + '1 12:59:10') FROM time_tbl order by year(c3 + '1 12:59:10');
 id | year 
----+------
  0 | 2021
  1 | 2021
  2 | 2021
  3 | 2021
  4 | 2021
(5 rows)

-- select year with order by index (result)
--Testcase 2308:
SELECT id, year(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | year 
----+------
  0 | 2021
  1 | 2021
  2 | 2021
  3 | 2021
  4 | 2021
(5 rows)

-- select year with order by index (result)
--Testcase 2309:
SELECT id, year(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | year 
----+------
  0 | 2021
  1 | 2021
  2 | 2021
  3 | 2021
  4 | 2021
(5 rows)

-- select year with group by (explain)
--Testcase 2310:
EXPLAIN VERBOSE
SELECT max(c3), year(c3 + '1 12:59:10') FROM time_tbl group by year(c3 + '1 12:59:10');
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (year((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.year((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select year with group by (result)
--Testcase 2311:
SELECT max(c3), year(c3 + '1 12:59:10') FROM time_tbl group by year(c3 + '1 12:59:10');
         max         | year 
---------------------+------
 2021-01-07 00:59:59 | 2021
(1 row)

-- select year with group by index (result)
--Testcase 2312:
SELECT id, year(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | year 
----+------
  0 | 2021
  1 | 2021
  2 | 2021
  3 | 2021
  4 | 2021
(5 rows)

-- select year with group by index (result)
--Testcase 2313:
SELECT id, year(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | year 
----+------
  0 | 2021
  1 | 2021
  2 | 2021
  3 | 2021
  4 | 2021
(5 rows)

-- select year with group by having (explain)
--Testcase 2314:
EXPLAIN VERBOSE
SELECT max(c3), year(c3 + '1 12:59:10') FROM time_tbl group by year(c3 + '1 12:59:10'), c3 HAVING year(c3 + '1 12:59:10') > 2000;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (year((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((year((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) > 2000)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.year((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select year with group by having (result)
--Testcase 2315:
SELECT max(c3), year(c3 + '1 12:59:10') FROM time_tbl group by year(c3 + '1 12:59:10'), c3 HAVING year(c3 + '1 12:59:10') > 2000;
         max         | year 
---------------------+------
 2021-01-03 12:10:30 | 2021
 2021-01-04 23:12:13 | 2021
 2021-01-05 11:12:12 | 2021
 2021-01-06 16:00:00 | 2021
 2021-01-07 00:59:59 | 2021
(5 rows)

-- select year with group by index having (result)
--Testcase 2316:
SELECT id, year(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING year(c3 + '1 12:59:10') > 2000;
 id | year |         c3          
----+------+---------------------
  0 | 2021 | 2021-01-03 12:10:30
  1 | 2021 | 2021-01-04 23:12:13
  2 | 2021 | 2021-01-05 11:12:12
  3 | 2021 | 2021-01-06 16:00:00
  4 | 2021 | 2021-01-07 00:59:59
(5 rows)

-- select year with group by index having (result)
--Testcase 2317:
SELECT id, year(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING year(c3 + '1 12:59:10') > 2000;
 id | year |         c3          
----+------+---------------------
  0 | 2021 | 2021-01-03 12:10:30
  1 | 2021 | 2021-01-04 23:12:13
  2 | 2021 | 2021-01-05 11:12:12
  3 | 2021 | 2021-01-06 16:00:00
  4 | 2021 | 2021-01-07 00:59:59
(5 rows)

-- select year and as
--Testcase 2318:
SELECT year(date_sub(c3, '1 12:59:10')) as year1 FROM time_tbl;
 year1 
-------
  2021
  2021
  2021
  2021
  2021
(5 rows)

-- WEEKFORYEAR()
-- select weekofyear (stub function, explain)
--Testcase 2319:
EXPLAIN VERBOSE
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=16)
   Output: (weekofyear(c3)), (weekofyear((c2)::timestamp without time zone)), (weekofyear(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekofyear('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekofyear(c3), public.weekofyear(c2), public.weekofyear(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekofyear('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select weekofyear (stub function, result)
--Testcase 2320:
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
 weekofyear | weekofyear | weekofyear | weekofyear 
------------+------------+------------+------------
         53 |         53 |         53 |         53
          1 |         53 |         53 |         53
          1 |          1 |         53 |         53
          1 |          2 |          1 |         53
          1 |          4 |          1 |         53
(5 rows)

-- select weekofyear (stub function, not pushdown constraints, explain)
--Testcase 2321:
EXPLAIN VERBOSE
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=16)
   Output: (weekofyear(c3)), (weekofyear((c2)::timestamp without time zone)), (weekofyear(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekofyear('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekofyear(c3), public.weekofyear(c2), public.weekofyear(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekofyear('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select weekofyear (stub function, not pushdown constraints, result)
--Testcase 2322:
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 weekofyear | weekofyear | weekofyear | weekofyear 
------------+------------+------------+------------
          1 |         53 |         53 |         53
(1 row)

-- select weekofyear (stub function, pushdown constraints, explain)
--Testcase 2323:
EXPLAIN VERBOSE
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                                   QUERY PLAN                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=16)
   Output: (weekofyear(c3)), (weekofyear((c2)::timestamp without time zone)), (weekofyear(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekofyear('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekofyear(c3), public.weekofyear(c2), public.weekofyear(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekofyear('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select weekofyear (stub function, pushdown constraints, result)
--Testcase 2324:
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 weekofyear | weekofyear | weekofyear | weekofyear 
------------+------------+------------+------------
         53 |         53 |         53 |         53
          1 |         53 |         53 |         53
          1 |          1 |         53 |         53
          1 |          2 |          1 |         53
          1 |          4 |          1 |         53
(5 rows)

-- select weekofyear (stub function, weekofyear in constraints, explain)
--Testcase 2325:
EXPLAIN VERBOSE
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE weekofyear(c3) != weekofyear('2000-01-01'::timestamp);
                                                                                                                                                                             QUERY PLAN                                                                                                                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..6180.57 rows=3396 width=16)
   Output: (weekofyear(c3)), (weekofyear((c2)::timestamp without time zone)), (weekofyear(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekofyear('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekofyear(c3), public.weekofyear(c2), public.weekofyear(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekofyear('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.weekofyear(c3) <> public.weekofyear('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select weekofyear (stub function, weekofyear in constraints, result)
--Testcase 2326:
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE weekofyear(c3) != weekofyear('2000-01-01'::timestamp);
 weekofyear | weekofyear | weekofyear | weekofyear 
------------+------------+------------+------------
         53 |         53 |         53 |         53
          1 |         53 |         53 |         53
          1 |          1 |         53 |         53
          1 |          2 |          1 |         53
          1 |          4 |          1 |         53
(5 rows)

-- select weekofyear (stub function, weekofyear in constraints, explain)
--Testcase 2327:
EXPLAIN VERBOSE
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE weekofyear('2021-01-01 12:00:00'::timestamp) > '1';
                                                                                                                                                                   QUERY PLAN                                                                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2454.02 rows=1138 width=16)
   Output: (weekofyear(c3)), (weekofyear((c2)::timestamp without time zone)), (weekofyear(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekofyear('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekofyear(c3), public.weekofyear(c2), public.weekofyear(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekofyear('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.weekofyear('2021-01-01 12:00:00'::timestamp without time zone) > 1))
(4 rows)

-- select weekofyear (stub function, weekofyear in constraints, result)
--Testcase 2328:
SELECT weekofyear(c3), weekofyear(c2), weekofyear(date_sub(c3, '1 12:59:10')), weekofyear('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE weekofyear('2021-01-01 12:00:00'::timestamp) > '1';
 weekofyear | weekofyear | weekofyear | weekofyear 
------------+------------+------------+------------
         53 |         53 |         53 |         53
          1 |         53 |         53 |         53
          1 |          1 |         53 |         53
          1 |          2 |          1 |         53
          1 |          4 |          1 |         53
(5 rows)

-- select weekofyear with agg (pushdown, explain)
--Testcase 2329:
EXPLAIN VERBOSE
SELECT max(c3), weekofyear(max(c3)) FROM time_tbl;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (weekofyear(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.weekofyear(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select weekofyear as nest function with agg (pushdown, result)
--Testcase 2330:
SELECT max(c3), weekofyear(max(c3)) FROM time_tbl;
         max         | weekofyear 
---------------------+------------
 2021-01-07 00:59:59 |          1
(1 row)

-- select weekofyear with non pushdown func and explicit constant (explain)
--Testcase 2331:
EXPLAIN VERBOSE
SELECT weekofyear(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (weekofyear(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekofyear(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select weekofyear with non pushdown func and explicit constant (result)
--Testcase 2332:
SELECT weekofyear(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 weekofyear |        pi         | ?column? 
------------+-------------------+----------
         53 | 3.141592653589793 |      4.1
         53 | 3.141592653589793 |      4.1
         53 | 3.141592653589793 |      4.1
          1 | 3.141592653589793 |      4.1
          1 | 3.141592653589793 |      4.1
(5 rows)

-- select weekofyear with order by (explain)
--Testcase 2333:
EXPLAIN VERBOSE
SELECT id, weekofyear(c3 + '1 12:59:10') FROM time_tbl order by weekofyear(c3 + '1 12:59:10');
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=8)
   Output: id, (weekofyear((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (weekofyear((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=8)
         Output: id, (weekofyear((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.weekofyear((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select weekofyear with order by (result)
--Testcase 2334:
SELECT id, weekofyear(c3 + '1 12:59:10') FROM time_tbl order by weekofyear(c3 + '1 12:59:10');
 id | weekofyear 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
(5 rows)

-- select weekofyear with order by index (result)
--Testcase 2335:
SELECT id, weekofyear(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | weekofyear 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
(5 rows)

-- select weekofyear with order by index (result)
--Testcase 2336:
SELECT id, weekofyear(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | weekofyear 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
(5 rows)

-- select weekofyear with group by (explain)
--Testcase 2337:
EXPLAIN VERBOSE
SELECT max(c3), weekofyear(c3 + '1 12:59:10') FROM time_tbl group by weekofyear(c3 + '1 12:59:10');
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (weekofyear((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.weekofyear((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select weekofyear with group by (result)
--Testcase 2338:
SELECT max(c3), weekofyear(c3 + '1 12:59:10') FROM time_tbl group by weekofyear(c3 + '1 12:59:10');
         max         | weekofyear 
---------------------+------------
 2021-01-07 00:59:59 |          1
(1 row)

-- select weekofyear with group by index (result)
--Testcase 2339:
SELECT id, weekofyear(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | weekofyear 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
(5 rows)

-- select weekofyear with group by index (result)
--Testcase 2340:
SELECT id, weekofyear(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | weekofyear 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
(5 rows)

-- select weekofyear with group by having (explain)
--Testcase 2341:
EXPLAIN VERBOSE
SELECT max(c3), weekofyear(c3 + '1 12:59:10') FROM time_tbl group by weekofyear(c3 + '1 12:59:10'), c3 HAVING weekofyear(c3 + '1 12:59:10') > 0;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (weekofyear((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((weekofyear((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.weekofyear((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select weekofyear with group by having (result)
--Testcase 2342:
SELECT max(c3), weekofyear(c3 + '1 12:59:10') FROM time_tbl group by weekofyear(c3 + '1 12:59:10'), c3 HAVING weekofyear(c3 + '1 12:59:10') > 0;
         max         | weekofyear 
---------------------+------------
 2021-01-03 12:10:30 |          1
 2021-01-04 23:12:13 |          1
 2021-01-05 11:12:12 |          1
 2021-01-06 16:00:00 |          1
 2021-01-07 00:59:59 |          1
(5 rows)

-- select weekofyear with group by index having (result)
--Testcase 2343:
SELECT id, weekofyear(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING weekofyear(c3 + '1 12:59:10') > 0;
 id | weekofyear |         c3          
----+------------+---------------------
  0 |          1 | 2021-01-03 12:10:30
  1 |          1 | 2021-01-04 23:12:13
  2 |          1 | 2021-01-05 11:12:12
  3 |          1 | 2021-01-06 16:00:00
  4 |          1 | 2021-01-07 00:59:59
(5 rows)

-- select weekofyear with group by index having (result)
--Testcase 2344:
SELECT id, weekofyear(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING weekofyear(c3 + '1 12:59:10') > 0;
 id | weekofyear |         c3          
----+------------+---------------------
  0 |          1 | 2021-01-03 12:10:30
  1 |          1 | 2021-01-04 23:12:13
  2 |          1 | 2021-01-05 11:12:12
  3 |          1 | 2021-01-06 16:00:00
  4 |          1 | 2021-01-07 00:59:59
(5 rows)

-- select weekofyear and as
--Testcase 2345:
SELECT weekofyear(date_sub(c3, '1 12:59:10')) as weekofyear1 FROM time_tbl;
 weekofyear1 
-------------
          53
          53
          53
           1
           1
(5 rows)

-- WEEKDAY()
-- select weekday (stub function, explain)
--Testcase 2346:
EXPLAIN VERBOSE
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=16)
   Output: (weekday(c3)), (weekday((c2)::timestamp without time zone)), (weekday(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekday('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekday(c3), public.weekday(c2), public.weekday(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekday('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select weekday (stub function, result)
--Testcase 2347:
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
 weekday | weekday | weekday | weekday 
---------+---------+---------+---------
       6 |       5 |       4 |       4
       0 |       4 |       6 |       4
       1 |       6 |       6 |       4
       2 |       4 |       1 |       4
       3 |       4 |       1 |       4
(5 rows)

-- select weekday (stub function, not pushdown constraints, explain)
--Testcase 2348:
EXPLAIN VERBOSE
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=16)
   Output: (weekday(c3)), (weekday((c2)::timestamp without time zone)), (weekday(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekday('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekday(c3), public.weekday(c2), public.weekday(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekday('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select weekday (stub function, not pushdown constraints, result)
--Testcase 2349:
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 weekday | weekday | weekday | weekday 
---------+---------+---------+---------
       0 |       4 |       6 |       4
(1 row)

-- select weekday (stub function, pushdown constraints, explain)
--Testcase 2350:
EXPLAIN VERBOSE
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=16)
   Output: (weekday(c3)), (weekday((c2)::timestamp without time zone)), (weekday(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekday('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekday(c3), public.weekday(c2), public.weekday(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekday('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select weekday (stub function, pushdown constraints, result)
--Testcase 2351:
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 weekday | weekday | weekday | weekday 
---------+---------+---------+---------
       6 |       5 |       4 |       4
       0 |       4 |       6 |       4
       1 |       6 |       6 |       4
       2 |       4 |       1 |       4
       3 |       4 |       1 |       4
(5 rows)

-- select weekday (stub function, weekday in constraints, explain)
--Testcase 2352:
EXPLAIN VERBOSE
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE weekday(c3) != weekday('2000-01-01'::timestamp);
                                                                                                                                                                    QUERY PLAN                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..6180.57 rows=3396 width=16)
   Output: (weekday(c3)), (weekday((c2)::timestamp without time zone)), (weekday(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekday('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekday(c3), public.weekday(c2), public.weekday(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekday('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.weekday(c3) <> public.weekday('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select weekday (stub function, weekday in constraints, result)
--Testcase 2353:
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE weekday(c3) != weekday('2000-01-01'::timestamp);
 weekday | weekday | weekday | weekday 
---------+---------+---------+---------
       6 |       5 |       4 |       4
       0 |       4 |       6 |       4
       1 |       6 |       6 |       4
       2 |       4 |       1 |       4
       3 |       4 |       1 |       4
(5 rows)

-- select weekday (stub function, weekday in constraints, explain)
--Testcase 2354:
EXPLAIN VERBOSE
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE weekday('2021-01-01 12:00:00'::timestamp) > '1';
                                                                                                                                                           QUERY PLAN                                                                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2454.02 rows=1138 width=16)
   Output: (weekday(c3)), (weekday((c2)::timestamp without time zone)), (weekday(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (weekday('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekday(c3), public.weekday(c2), public.weekday(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.weekday('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.weekday('2021-01-01 12:00:00'::timestamp without time zone) > 1))
(4 rows)

-- select weekday (stub function, weekday in constraints, result)
--Testcase 2355:
SELECT weekday(c3), weekday(c2), weekday(date_sub(c3, '1 12:59:10')), weekday('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE weekday('2021-01-01 12:00:00'::timestamp) > '1';
 weekday | weekday | weekday | weekday 
---------+---------+---------+---------
       6 |       5 |       4 |       4
       0 |       4 |       6 |       4
       1 |       6 |       6 |       4
       2 |       4 |       1 |       4
       3 |       4 |       1 |       4
(5 rows)

-- select weekday with agg (pushdown, explain)
--Testcase 2356:
EXPLAIN VERBOSE
SELECT max(c3), weekday(max(c3)) FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (weekday(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.weekday(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select weekday as nest function with agg (pushdown, result)
--Testcase 2357:
SELECT max(c3), weekday(max(c3)) FROM time_tbl;
         max         | weekday 
---------------------+---------
 2021-01-07 00:59:59 |       3
(1 row)

-- select weekday with non pushdown func and explicit constant (explain)
--Testcase 2358:
EXPLAIN VERBOSE
SELECT weekday(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (weekday(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.weekday(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select weekday with non pushdown func and explicit constant (result)
--Testcase 2359:
SELECT weekday(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 weekday |        pi         | ?column? 
---------+-------------------+----------
       4 | 3.141592653589793 |      4.1
       6 | 3.141592653589793 |      4.1
       6 | 3.141592653589793 |      4.1
       1 | 3.141592653589793 |      4.1
       1 | 3.141592653589793 |      4.1
(5 rows)

-- select weekday with order by (explain)
--Testcase 2360:
EXPLAIN VERBOSE
SELECT id, weekday(c3 + '1 12:59:10') FROM time_tbl order by weekday(c3 + '1 12:59:10');
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=8)
   Output: id, (weekday((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (weekday((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=8)
         Output: id, (weekday((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.weekday((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select weekday with order by (result)
--Testcase 2361:
SELECT id, weekday(c3 + '1 12:59:10') FROM time_tbl order by weekday(c3 + '1 12:59:10');
 id | weekday 
----+---------
  0 |       1
  1 |       2
  2 |       3
  3 |       4
  4 |       4
(5 rows)

-- select weekday with order by index (result)
--Testcase 2362:
SELECT id, weekday(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | weekday 
----+---------
  0 |       1
  1 |       2
  2 |       3
  3 |       4
  4 |       4
(5 rows)

-- select weekday with order by index (result)
--Testcase 2363:
SELECT id, weekday(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | weekday 
----+---------
  0 |       1
  1 |       2
  2 |       3
  3 |       4
  4 |       4
(5 rows)

-- select weekday with group by (explain)
--Testcase 2364:
EXPLAIN VERBOSE
SELECT max(c3), weekday(c3 + '1 12:59:10') FROM time_tbl group by weekday(c3 + '1 12:59:10');
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (weekday((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.weekday((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select weekday with group by (result)
--Testcase 2365:
SELECT max(c3), weekday(c3 + '1 12:59:10') FROM time_tbl group by weekday(c3 + '1 12:59:10');
         max         | weekday 
---------------------+---------
 2021-01-03 12:10:30 |       1
 2021-01-04 23:12:13 |       2
 2021-01-05 11:12:12 |       3
 2021-01-07 00:59:59 |       4
(4 rows)

-- select weekday with group by index (result)
--Testcase 2366:
SELECT id, weekday(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | weekday 
----+---------
  0 |       1
  1 |       2
  2 |       3
  3 |       4
  4 |       4
(5 rows)

-- select weekday with group by index (result)
--Testcase 2367:
SELECT id, weekday(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | weekday 
----+---------
  0 |       1
  1 |       2
  2 |       3
  3 |       4
  4 |       4
(5 rows)

-- select weekday with group by having (explain)
--Testcase 2368:
EXPLAIN VERBOSE
SELECT max(c3), weekday(c3 + '1 12:59:10') FROM time_tbl group by weekday(c3 + '1 12:59:10'), c3 HAVING weekday(c3 + '1 12:59:10') > 0;
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (weekday((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((weekday((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.weekday((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select weekday with group by having (result)
--Testcase 2369:
SELECT max(c3), weekday(c3 + '1 12:59:10') FROM time_tbl group by weekday(c3 + '1 12:59:10'), c3 HAVING weekday(c3 + '1 12:59:10') > 0;
         max         | weekday 
---------------------+---------
 2021-01-03 12:10:30 |       1
 2021-01-04 23:12:13 |       2
 2021-01-05 11:12:12 |       3
 2021-01-06 16:00:00 |       4
 2021-01-07 00:59:59 |       4
(5 rows)

-- select weekday with group by index having (result)
--Testcase 2370:
SELECT id, weekday(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING weekday(c3 + '1 12:59:10') > 0;
 id | weekday |         c3          
----+---------+---------------------
  0 |       1 | 2021-01-03 12:10:30
  1 |       2 | 2021-01-04 23:12:13
  2 |       3 | 2021-01-05 11:12:12
  3 |       4 | 2021-01-06 16:00:00
  4 |       4 | 2021-01-07 00:59:59
(5 rows)

-- select weekday with group by index having (result)
--Testcase 2371:
SELECT id, weekday(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING weekday(c3 + '1 12:59:10') > 0;
 id | weekday |         c3          
----+---------+---------------------
  0 |       1 | 2021-01-03 12:10:30
  1 |       2 | 2021-01-04 23:12:13
  2 |       3 | 2021-01-05 11:12:12
  3 |       4 | 2021-01-06 16:00:00
  4 |       4 | 2021-01-07 00:59:59
(5 rows)

-- select weekday and as
--Testcase 2372:
SELECT weekday(date_sub(c3, '1 12:59:10')) as weekday1 FROM time_tbl;
 weekday1 
----------
        4
        6
        6
        1
        1
(5 rows)

-- WEEK()
-- select week (stub function, explain)
--Testcase 2373:
EXPLAIN VERBOSE
SELECT id, week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl;
                                                                                                               QUERY PLAN                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3642.45 rows=3413 width=20)
   Output: id, (week((c2)::timestamp without time zone, 7)), (week((c2)::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 7))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.week(c2, 7), public.week(c2, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 7) FROM public.time_tblmysql
(4 rows)

-- select week (stub function, result)
--Testcase 2374:
SELECT id, week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl;
 id | week | week | week | week 
----+------+------+------+------
  0 |   52 |    0 |    0 |   52
  1 |   52 |    0 |    0 |   52
  2 |    1 |    1 |    0 |   52
  3 |    2 |    2 |    0 |   52
  4 |    4 |    4 |    0 |   52
(5 rows)

-- select week (stub function, not pushdown constraints, explain)
--Testcase 2375:
EXPLAIN VERBOSE
SELECT week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..246.28 rows=17 width=16)
   Output: (week((c2)::timestamp without time zone, 7)), (week((c2)::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 7))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.week(c2, 7), public.week(c2, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 7), id FROM public.time_tblmysql
(5 rows)

-- select week (stub function, not pushdown constraints, result)
--Testcase 2376:
SELECT week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl WHERE to_hex(id) = '1';
 week | week | week | week 
------+------+------+------
   52 |    0 |    0 |   52
(1 row)

-- select week (stub function, pushdown constraints, explain)
--Testcase 2377:
EXPLAIN VERBOSE
SELECT id, week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl WHERE id != 0;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3633.56 rows=3396 width=20)
   Output: id, (week((c2)::timestamp without time zone, 7)), (week((c2)::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 7))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.week(c2, 7), public.week(c2, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 7) FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select week (stub function, pushdown constraints, result)
--Testcase 2378:
SELECT id, week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl WHERE id != 0;
 id | week | week | week | week 
----+------+------+------+------
  1 |   52 |    0 |    0 |   52
  2 |    1 |    1 |    0 |   52
  3 |    2 |    2 |    0 |   52
  4 |    4 |    4 |    0 |   52
(4 rows)

-- select week (stub function, week in constraints, explain)
--Testcase 2379:
EXPLAIN VERBOSE
SELECT id, week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl WHERE week(c2, 7) != week('2021-01-02'::timestamp, 1);
                                                                                                                                                               QUERY PLAN                                                                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5348.59 rows=3396 width=20)
   Output: id, (week((c2)::timestamp without time zone, 7)), (week((c2)::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 7))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.week(c2, 7), public.week(c2, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 7) FROM public.time_tblmysql WHERE ((public.week(c2, 7) <> public.week('2021-01-02 00:00:00'::timestamp without time zone, 1)))
(4 rows)

-- select week (stub function, week in constraints, result)
--Testcase 2380:
SELECT id, week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl WHERE week(c2, 7) != week('2021-01-02'::timestamp, 1);
 id | week | week | week | week 
----+------+------+------+------
  0 |   52 |    0 |    0 |   52
  1 |   52 |    0 |    0 |   52
  2 |    1 |    1 |    0 |   52
  3 |    2 |    2 |    0 |   52
  4 |    4 |    4 |    0 |   52
(5 rows)

-- select week (stub function, week in constraints, explain)
--Testcase 2381:
EXPLAIN VERBOSE
SELECT id, week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl WHERE week('2021-01-02'::date, 7) > week('2021-01-02'::timestamp, 1);
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3025.61 rows=1138 width=20)
   Output: id, (week((c2)::timestamp without time zone, 7)), (week((c2)::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 1)), (week('2021-01-02 00:00:00'::timestamp without time zone, 7))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.week(c2, 7), public.week(c2, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 1), public.week('2021-01-02 00:00:00'::timestamp without time zone, 7) FROM public.time_tblmysql WHERE ((public.week('2021-01-02 00:00:00'::timestamp without time zone, 7) > public.week('2021-01-02 00:00:00'::timestamp without time zone, 1)))
(4 rows)

-- select week (stub function, week in constraints, result)
--Testcase 2382:
SELECT id, week(c2, 7), week(c2, 1), week('2021-01-02'::date, 1), week('2021-01-02'::date, 7) FROM time_tbl WHERE week('2021-01-02'::date, 7) > week('2021-01-02'::timestamp, 1);
 id | week | week | week | week 
----+------+------+------+------
  0 |   52 |    0 |    0 |   52
  1 |   52 |    0 |    0 |   52
  2 |    1 |    1 |    0 |   52
  3 |    2 |    2 |    0 |   52
  4 |    4 |    4 |    0 |   52
(5 rows)

-- select week as nest function with agg (pushdown, explain)
--Testcase 2383:
EXPLAIN VERBOSE
SELECT max(id), week('2021-01-02'::date, max(id)) FROM time_tbl;
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (max(id)), (week('2021-01-02 00:00:00'::timestamp without time zone, max(id)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(id), public.week('2021-01-02 00:00:00'::timestamp without time zone, max(id)) FROM public.time_tblmysql
(6 rows)

-- select week as nest function with agg (pushdown, result)
--Testcase 2384:
SELECT max(id), week('2021-01-02'::date, max(id)) FROM time_tbl;
 max | week 
-----+------
   4 |    0
(1 row)

-- select week as nest with stub (pushdown, explain)
--Testcase 2385:
EXPLAIN VERBOSE
SELECT id, week(makedate(2019, id), 7) FROM time_tbl;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=8)
   Output: id, (week((makedate(2019, id))::timestamp without time zone, 7))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.week(public.makedate(2019, id), 7) FROM public.time_tblmysql
(4 rows)

-- select week as nest with stub (pushdown, result)
--Testcase 2386:
SELECT id, week(makedate(2019, id), 7) FROM time_tbl;
 id | week 
----+------
  0 |     
  1 |   53
  2 |   53
  3 |   53
  4 |   53
(5 rows)

-- select week with non pushdown func and explicit constant (explain)
--Testcase 2387:
EXPLAIN VERBOSE
SELECT week('2021-01-02'::date, 1), pi(), 4.1 FROM time_tbl;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (week('2021-01-02 00:00:00'::timestamp without time zone, 1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.week('2021-01-02 00:00:00'::timestamp without time zone, 1), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select week with non pushdown func and explicit constant (result)
--Testcase 2388:
SELECT week('2021-01-02'::date, 1), pi(), 4.1 FROM time_tbl;
 week |        pi         | ?column? 
------+-------------------+----------
    0 | 3.141592653589793 |      4.1
    0 | 3.141592653589793 |      4.1
    0 | 3.141592653589793 |      4.1
    0 | 3.141592653589793 |      4.1
    0 | 3.141592653589793 |      4.1
(5 rows)

-- select week with order by (explain)
--Testcase 2389:
EXPLAIN VERBOSE
SELECT id, week(c2, id + 5) FROM time_tbl order by id,week(c2, id + 5);
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Sort  (cost=1282.99..1291.53 rows=3413 width=8)
   Output: id, (week((c2)::timestamp without time zone, (id + 5)))
   Sort Key: time_tbl.id, (week((time_tbl.c2)::timestamp without time zone, (time_tbl.id + 5)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1082.70 rows=3413 width=8)
         Output: id, (week((c2)::timestamp without time zone, (id + 5)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.week(c2, (id + 5)) FROM public.time_tblmysql
(7 rows)

-- select week with order by (result)
--Testcase 2390:
SELECT id, week(c2, id + 5) FROM time_tbl order by id,week(c2, id + 5);
 id | week 
----+------
  0 |    0
  1 |   53
  2 |    1
  3 |    2
  4 |    4
(5 rows)

-- select week with order by index (result)
--Testcase 2391:
SELECT id, week(c2, id + 5) FROM time_tbl order by 2,1;
 id | week 
----+------
  0 |    0
  2 |    1
  3 |    2
  4 |    4
  1 |   53
(5 rows)

-- select week with order by index (result)
--Testcase 2392:
SELECT id, week(c2, id + 5) FROM time_tbl order by 1,2;
 id | week 
----+------
  0 |    0
  1 |   53
  2 |    1
  3 |    2
  4 |    4
(5 rows)

-- select week with group by (explain)
--Testcase 2393:
EXPLAIN VERBOSE
SELECT id, week(c2, id + 5) FROM time_tbl group by id, week(c2, id + 5);
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: id, (week((c2)::timestamp without time zone, (id + 5)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT id, public.week(c2, (id + 5)) FROM public.time_tblmysql GROUP BY 1, 2
(6 rows)

-- select week with group by (result)
--Testcase 2394:
SELECT id, week(c2, id + 5) FROM time_tbl group by id, week(c2, id + 5);
 id | week 
----+------
  0 |    0
  1 |   53
  2 |    1
  3 |    2
  4 |    4
(5 rows)

-- select week with group by index (result)
--Testcase 2395:
SELECT id, week(c2, id + 5) FROM time_tbl group by 2,1;
 id | week 
----+------
  0 |    0
  1 |   53
  2 |    1
  3 |    2
  4 |    4
(5 rows)

-- select week with group by index (result)
--Testcase 2396:
SELECT id, week(c2, id + 5) FROM time_tbl group by 1,2;
 id | week 
----+------
  0 |    0
  1 |   53
  2 |    1
  3 |    2
  4 |    4
(5 rows)

-- select week with group by having (explain)
--Testcase 2397:
EXPLAIN VERBOSE
SELECT count(id), week(c2, id + 5) FROM time_tbl group by week(c2, id + 5), id,c2 HAVING week(c2, id + 5) = 0;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (count(id)), (week((c2)::timestamp without time zone, (id + 5))), id, c2
   Filter: ((week((time_tbl.c2)::timestamp without time zone, (time_tbl.id + 5))) = 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.week(c2, (id + 5)), id, c2 FROM public.time_tblmysql GROUP BY 2, 3, 4
(7 rows)

-- select week with group by having (result)
--Testcase 2398:
SELECT count(id), week(c2, id + 5) FROM time_tbl group by week(c2, id + 5), id,c2 HAVING week(c2, id + 5) = 0;
 count | week 
-------+------
     1 |    0
(1 row)

-- select week with group by index having (result)
--Testcase 2399:
SELECT id, week(c2, id + 5), c2 FROM time_tbl group by 3,2,1 HAVING week(c2, id + 5) > 0;
 id | week |     c2     
----+------+------------
  1 |   53 | 2021-01-01
  2 |    1 | 2021-01-10
  3 |    2 | 2021-01-15
  4 |    4 | 2021-01-29
(4 rows)

-- select week with group by index having (result)
--Testcase 2400:
SELECT id, week(c2, id + 5), c2 FROM time_tbl group by 1,2,3 HAVING id > 1;
 id | week |     c2     
----+------+------------
  2 |    1 | 2021-01-10
  3 |    2 | 2021-01-15
  4 |    4 | 2021-01-29
(3 rows)

-- select week and as
--Testcase 2401:
SELECT week('2021-01-02'::date, 53) as week1 FROM time_tbl;
 week1 
-------
     0
     0
     0
     0
     0
(5 rows)

-- UTC_TIMESTAMP()
-- select utc_timestamp (stub function, explain)
--Testcase 2402:
EXPLAIN VERBOSE
SELECT utc_timestamp() FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (utc_timestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_timestamp() FROM public.time_tblmysql
(4 rows)

-- select utc_timestamp (stub function, not pushdown constraints, explain)
--Testcase 2403:
EXPLAIN VERBOSE
SELECT utc_timestamp() FROM time_tbl WHERE to_hex(id) > '0';
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (utc_timestamp())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_timestamp(), id FROM public.time_tblmysql
(5 rows)

-- select utc_timestamp (stub function, pushdown constraints, explain)
--Testcase 2404:
EXPLAIN VERBOSE
SELECT utc_timestamp() FROM time_tbl WHERE id = 1;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (utc_timestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_timestamp() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select utc_timestamp (stub function, utc_timestamp in constraints, explain)
--Testcase 2405:
EXPLAIN VERBOSE
SELECT utc_timestamp() FROM time_tbl WHERE utc_timestamp() > '1997-10-14 00:00:00'::timestamp;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (utc_timestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_timestamp() FROM public.time_tblmysql WHERE ((public.utc_timestamp() > '1997-10-14 00:00:00'::timestamp without time zone))
(4 rows)

-- utc_timestamp in constrains (stub function, explain)
--Testcase 2406:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE utc_timestamp() > '1997-10-14 00:00:00'::timestamp;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.utc_timestamp() > '1997-10-14 00:00:00'::timestamp without time zone))
(4 rows)

-- utc_timestamp in constrains (stub function, result)
--Testcase 2407:
SELECT c1 FROM time_tbl WHERE utc_timestamp() > '1997-10-14 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- utc_timestamp as parameter of addtime(stub function, explain)
--Testcase 2408:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(utc_timestamp(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp;
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.utc_timestamp(), '1 day 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp without time zone))
(4 rows)

-- utc_timestamp as parameter of addtime(stub function, result)
--Testcase 2409:
SELECT c1 FROM time_tbl WHERE addtime(utc_timestamp(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select utc_timestamp and agg (pushdown, explain)
--Testcase 2410:
EXPLAIN VERBOSE
SELECT utc_timestamp(), sum(id) FROM time_tbl;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (utc_timestamp()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_timestamp(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select utc_timestamp and log2 (pushdown, explain)
--Testcase 2411:
EXPLAIN VERBOSE
SELECT utc_timestamp(), log2(id) FROM time_tbl;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (utc_timestamp()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_timestamp(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select utc_timestamp with non pushdown func and explicit constant (explain)
--Testcase 2412:
EXPLAIN VERBOSE
SELECT utc_timestamp(), to_hex(id), 4 FROM time_tbl;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (utc_timestamp()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_timestamp(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select utc_timestamp with order by (explain)
--Testcase 2413:
EXPLAIN VERBOSE
SELECT utc_timestamp(), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=16)
   Output: utc_timestamp(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- select utc_timestamp with order by index (explain)
--Testcase 2414:
EXPLAIN VERBOSE
SELECT utc_timestamp(), c1 FROM time_tbl ORDER BY 2;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=16)
   Output: utc_timestamp(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- utc_timestamp constraints with order by (explain)
--Testcase 2415:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(utc_timestamp(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp ORDER BY c1;
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.utc_timestamp(), '1 day 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp without time zone))
(7 rows)

-- utc_timestamp constraints with order by (result)
--Testcase 2416:
SELECT c1 FROM time_tbl WHERE addtime(utc_timestamp(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select utc_timestamp with group by (explain)
--Testcase 2417:
EXPLAIN VERBOSE
SELECT utc_timestamp(), c1 FROM time_tbl GROUP BY c1;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (utc_timestamp()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_timestamp(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select utc_timestamp with group by index (explain)
--Testcase 2418:
EXPLAIN VERBOSE
SELECT utc_timestamp(), c1 FROM time_tbl GROUP BY 2;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (utc_timestamp()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_timestamp(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select utc_timestamp with group by having (explain)
--Testcase 2419:
EXPLAIN VERBOSE
SELECT utc_timestamp(), c1 FROM time_tbl GROUP BY utc_timestamp(),c1 HAVING utc_timestamp() > '1997-10-14 00:00:00'::timestamp;
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (utc_timestamp()), c1
   Filter: ((utc_timestamp()) > '1997-10-14 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_timestamp(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.utc_timestamp() > '1997-10-14 00:00:00'::timestamp without time zone))
(7 rows)

-- select utc_timestamp with group by index having (explain)
--Testcase 2420:
EXPLAIN VERBOSE
SELECT utc_timestamp(), c1 FROM time_tbl GROUP BY 2,1 HAVING utc_timestamp() > '1997-10-14 00:00:00'::timestamp;
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (utc_timestamp()), c1
   Filter: ((utc_timestamp()) > '1997-10-14 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_timestamp(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.utc_timestamp() > '1997-10-14 00:00:00'::timestamp without time zone))
(7 rows)

-- utc_timestamp constraints with group by (explain)
--Testcase 2421:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(utc_timestamp(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp GROUP BY c1;
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.utc_timestamp(), '1 day 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp without time zone)) GROUP BY 1
(6 rows)

-- utc_timestamp constraints with group by (result)
--Testcase 2422:
SELECT c1 FROM time_tbl WHERE addtime(utc_timestamp(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select utc_timestamp and as
--Testcase 2423:
EXPLAIN VERBOSE
SELECT utc_timestamp() as utc_timestamp1 FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (utc_timestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_timestamp() FROM public.time_tblmysql
(4 rows)

-- UTC_TIME()
-- select utc_time (stub function, explain)
--Testcase 2424:
EXPLAIN VERBOSE
SELECT utc_time() FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (utc_time())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_time() FROM public.time_tblmysql
(4 rows)

-- select utc_time (stub function, not pushdown constraints, explain)
--Testcase 2425:
EXPLAIN VERBOSE
SELECT utc_time() FROM time_tbl WHERE to_hex(id) > '0';
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (utc_time())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_time(), id FROM public.time_tblmysql
(5 rows)

-- select utc_time (stub function, pushdown constraints, explain)
--Testcase 2426:
EXPLAIN VERBOSE
SELECT utc_time() FROM time_tbl WHERE id = 1;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (utc_time())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_time() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select utc_time (stub function, utc_time in constraints, explain)
--Testcase 2427:
EXPLAIN VERBOSE
SELECT utc_time() FROM time_tbl WHERE utc_time() > '1997-10-14 00:00:00'::time;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (utc_time())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_time() FROM public.time_tblmysql WHERE ((public.utc_time() > '00:00:00'::time without time zone))
(4 rows)

-- utc_time in constrains (stub function, explain)
--Testcase 2428:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE utc_time() > '1997-10-14 00:00:00'::time;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.utc_time() > '00:00:00'::time without time zone))
(4 rows)

-- utc_time in constrains (stub function, result)
--Testcase 2429:
SELECT c1 FROM time_tbl WHERE utc_time() > '1997-10-14 00:00:00'::time;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- utc_time as parameter of second(stub function, explain)
--Testcase 2430:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE second(utc_time()) > 10;
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.second(public.utc_time()) > 10))
(4 rows)

-- utc_time as parameter of second(stub function, result)
--Testcase 2431:
SELECT c1 FROM time_tbl WHERE (60-second(utc_time())) >= 0;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select utc_time and agg (pushdown, explain)
--Testcase 2432:
EXPLAIN VERBOSE
SELECT utc_time(), sum(id) FROM time_tbl;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (utc_time()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_time(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select utc_time and log2 (pushdown, explain)
--Testcase 2433:
EXPLAIN VERBOSE
SELECT utc_time(), log2(id) FROM time_tbl;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (utc_time()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_time(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select utc_time with non pushdown func and explicit constant (explain)
--Testcase 2434:
EXPLAIN VERBOSE
SELECT utc_time(), to_hex(id), 4 FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (utc_time()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_time(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select utc_time with order by (explain)
--Testcase 2435:
EXPLAIN VERBOSE
SELECT utc_time(), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=16)
   Output: utc_time(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- select utc_time with order by index (explain)
--Testcase 2436:
EXPLAIN VERBOSE
SELECT utc_time(), c1 FROM time_tbl ORDER BY 2;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=16)
   Output: utc_time(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- utc_time constraints with order by (explain)
--Testcase 2437:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE second(utc_time()) > 10 ORDER BY c1;
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.second(public.utc_time()) > 10))
(7 rows)

-- utc_time constraints with order by (result)
--Testcase 2438:
SELECT c1 FROM time_tbl WHERE (60-second(utc_time())) >= 0 ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select utc_time with group by (explain)
--Testcase 2439:
EXPLAIN VERBOSE
SELECT utc_time(), c1 FROM time_tbl GROUP BY c1;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (utc_time()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_time(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select utc_time with group by index (explain)
--Testcase 2440:
EXPLAIN VERBOSE
SELECT utc_time(), c1 FROM time_tbl GROUP BY 2;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (utc_time()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_time(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select utc_time with group by having (explain)
--Testcase 2441:
EXPLAIN VERBOSE
SELECT utc_time(), c1 FROM time_tbl GROUP BY utc_time(),c1 HAVING utc_time() > '1997-10-14 00:00:00'::time;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (utc_time()), c1
   Filter: ((utc_time()) > '00:00:00'::time without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_time(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.utc_time() > '00:00:00'::time without time zone))
(7 rows)

-- select utc_time with group by index having (explain)
--Testcase 2442:
EXPLAIN VERBOSE
SELECT utc_time(), c1 FROM time_tbl GROUP BY 2,1 HAVING utc_time() > '1997-10-14 00:00:00'::time;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (utc_time()), c1
   Filter: ((utc_time()) > '00:00:00'::time without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_time(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.utc_time() > '00:00:00'::time without time zone))
(7 rows)

-- utc_time constraints with group by (explain)
--Testcase 2443:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE second(utc_time()) > 10 GROUP BY c1;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.second(public.utc_time()) > 10)) GROUP BY 1
(6 rows)

-- utc_time constraints with group by (result)
--Testcase 2444:
SELECT c1 FROM time_tbl WHERE (60-second(utc_time())) >= 0 GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select utc_time and as
--Testcase 2445:
EXPLAIN VERBOSE
SELECT utc_time() as utc_time1 FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (utc_time())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_time() FROM public.time_tblmysql
(4 rows)

-- UTC_DATE()
-- select utc_date (stub function, explain)
--Testcase 2446:
EXPLAIN VERBOSE
SELECT utc_date() FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (utc_date())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_date() FROM public.time_tblmysql
(4 rows)

-- select utc_date (stub function, not pushdown constraints, explain)
--Testcase 2447:
EXPLAIN VERBOSE
SELECT utc_date() FROM time_tbl WHERE to_hex(id) > '0';
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=4)
   Output: (utc_date())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_date(), id FROM public.time_tblmysql
(5 rows)

-- select utc_date (stub function, pushdown constraints, explain)
--Testcase 2448:
EXPLAIN VERBOSE
SELECT utc_date() FROM time_tbl WHERE id = 1;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=4)
   Output: (utc_date())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_date() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select utc_date (stub function, utc_date in constraints, explain)
--Testcase 2449:
EXPLAIN VERBOSE
SELECT utc_date() FROM time_tbl WHERE utc_date() > '1997-10-14 00:00:00'::date;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=4)
   Output: (utc_date())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_date() FROM public.time_tblmysql WHERE ((public.utc_date() > '1997-10-14'::date))
(4 rows)

-- utc_date in constrains (stub function, explain)
--Testcase 2450:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE utc_date() > '1997-10-14 00:00:00'::date;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.utc_date() > '1997-10-14'::date))
(4 rows)

-- utc_date in constrains (stub function, result)
--Testcase 2451:
SELECT c1 FROM time_tbl WHERE utc_date() > '1997-10-14 00:00:00'::date;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- utc_date as parameter of addtime(stub function, explain)
--Testcase 2452:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(utc_date(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::date;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.utc_date(), '1 day 12:59:10'::interval) > '1997-10-14'::date))
(4 rows)

-- utc_date as parameter of addtime(stub function, result)
--Testcase 2453:
SELECT c1 FROM time_tbl WHERE addtime(utc_date(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::date;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select utc_date and agg (pushdown, explain)
--Testcase 2454:
EXPLAIN VERBOSE
SELECT utc_date(), sum(id) FROM time_tbl;
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (utc_date()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_date(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select utc_date and log2 (pushdown, explain)
--Testcase 2455:
EXPLAIN VERBOSE
SELECT utc_date(), log2(id) FROM time_tbl;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=12)
   Output: (utc_date()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_date(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select utc_date with non pushdown func and explicit constant (explain)
--Testcase 2456:
EXPLAIN VERBOSE
SELECT utc_date(), to_hex(id), 4 FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=40)
   Output: (utc_date()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_date(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select utc_date with order by (explain)
--Testcase 2457:
EXPLAIN VERBOSE
SELECT utc_date(), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=12)
   Output: utc_date(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- select utc_date with order by index (explain)
--Testcase 2458:
EXPLAIN VERBOSE
SELECT utc_date(), c1 FROM time_tbl ORDER BY 2;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Result  (cost=412.68..1308.59 rows=3413 width=12)
   Output: utc_date(), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=8)
         Output: c1
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=8)
               Output: c1
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1 FROM public.time_tblmysql
(9 rows)

-- utc_date constraints with order by (explain)
--Testcase 2459:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(utc_date(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp ORDER BY c1;
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1948.22..1951.07 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.utc_date(), '1 day 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp without time zone))
(7 rows)

-- utc_date constraints with order by (result)
--Testcase 2460:
SELECT c1 FROM time_tbl WHERE addtime(utc_date(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select utc_date with group by (explain)
--Testcase 2461:
EXPLAIN VERBOSE
SELECT utc_date(), c1 FROM time_tbl GROUP BY c1;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=12)
   Output: (utc_date()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_date(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select utc_date with group by index (explain)
--Testcase 2462:
EXPLAIN VERBOSE
SELECT utc_date(), c1 FROM time_tbl GROUP BY 2;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=12)
   Output: (utc_date()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_date(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select utc_date with group by having (explain)
--Testcase 2463:
EXPLAIN VERBOSE
SELECT utc_date(), c1 FROM time_tbl GROUP BY utc_date(),c1 HAVING utc_date() > '1997-10-14 00:00:00'::timestamp;
                                                                               QUERY PLAN                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (utc_date()), c1
   Filter: ((utc_date()) > '1997-10-14 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_date(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.utc_date() > '1997-10-14 00:00:00'::timestamp without time zone))
(7 rows)

-- select utc_date with group by index having (explain)
--Testcase 2464:
EXPLAIN VERBOSE
SELECT utc_date(), c1 FROM time_tbl GROUP BY 2,1 HAVING utc_date() > '1997-10-14 00:00:00'::timestamp;
                                                                               QUERY PLAN                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (utc_date()), c1
   Filter: ((utc_date()) > '1997-10-14 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.utc_date(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.utc_date() > '1997-10-14 00:00:00'::timestamp without time zone))
(7 rows)

-- utc_date constraints with group by (explain)
--Testcase 2465:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(utc_date(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp GROUP BY c1;
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.utc_date(), '1 day 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp without time zone)) GROUP BY 1
(6 rows)

-- utc_date constraints with group by (result)
--Testcase 2466:
SELECT c1 FROM time_tbl WHERE addtime(utc_date(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select utc_date and as
--Testcase 2467:
EXPLAIN VERBOSE
SELECT utc_date() as utc_date1 FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=4)
   Output: (utc_date())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.utc_date() FROM public.time_tblmysql
(4 rows)

-- UNIX_TIMESTAMP()
-- select unix_timestamp (stub function, explain)
--Testcase 2468:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2) FROM time_tbl;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=96)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2) FROM public.time_tblmysql
(4 rows)

-- select unix_timestamp (stub function, not pushdown constraints, explain)
--Testcase 2469:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2) FROM time_tbl WHERE to_hex(id) > '0';
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1085.80 rows=1138 width=96)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2), id FROM public.time_tblmysql
(5 rows)

-- select unix_timestamp (stub function, pushdown constraints, explain)
--Testcase 2470:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2) FROM time_tbl WHERE id = 1;
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..165.79 rows=17 width=96)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2) FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select unix_timestamp (stub function, unix_timestamp in constraints, explain)
--Testcase 2471:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2) FROM time_tbl WHERE unix_timestamp() > unix_timestamp('1997-10-14 00:00:00'::timestamp);
                                                                                                                  QUERY PLAN                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2738.27 rows=1138 width=96)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2) FROM public.time_tblmysql WHERE ((public.unix_timestamp() > public.unix_timestamp('1997-10-14 00:00:00'::timestamp without time zone)))
(4 rows)

-- unix_timestamp in constrains (stub function, explain)
--Testcase 2472:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE unix_timestamp() > unix_timestamp('1997-10-14 00:00:00'::timestamp);
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.unix_timestamp() > public.unix_timestamp('1997-10-14 00:00:00'::timestamp without time zone)))
(4 rows)

-- unix_timestamp in constrains (stub function, result)
--Testcase 2473:
SELECT c1 FROM time_tbl WHERE unix_timestamp() > unix_timestamp('1997-10-14 00:00:00'::timestamp);
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select unix_timestamp and agg (pushdown, explain)
--Testcase 2474:
EXPLAIN VERBOSE
SELECT unix_timestamp(), sum(id) FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (unix_timestamp()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.unix_timestamp(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select unix_timestamp and log2 (pushdown, explain)
--Testcase 2475:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2), log2(id) FROM time_tbl;
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3642.45 rows=3413 width=104)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone)), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select unix_timestamp with non pushdown func and explicit constant (explain)
--Testcase 2476:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2), to_hex(id), 4 FROM time_tbl;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2789.20 rows=3413 width=132)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone)), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select unix_timestamp with order by (explain)
--Testcase 2477:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2), c1 FROM time_tbl ORDER BY c1;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Result  (cost=412.68..3023.62 rows=3413 width=104)
   Output: unix_timestamp(), unix_timestamp(c3), unix_timestamp((c2)::timestamp without time zone), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=20)
         Output: c1, c3, c2
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=20)
               Output: c1, c3, c2
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1, c2, c3 FROM public.time_tblmysql
(9 rows)

-- select unix_timestamp with order by index (explain)
--Testcase 2478:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2), c1 FROM time_tbl ORDER BY 2;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Result  (cost=1265.93..3876.87 rows=3413 width=104)
   Output: unix_timestamp(), (unix_timestamp(c3)), unix_timestamp((c2)::timestamp without time zone), c1
   ->  Sort  (cost=1265.93..1274.46 rows=3413 width=44)
         Output: (unix_timestamp(c3)), c1, c2
         Sort Key: (unix_timestamp(time_tbl.c3))
         ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=44)
               Output: (unix_timestamp(c3)), c1, c2
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT public.unix_timestamp(c3), c1, c2 FROM public.time_tblmysql
(9 rows)

-- select unix_timestamp with group by (explain)
--Testcase 2479:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2), c1 FROM time_tbl GROUP BY c1,c2,c3;
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=116)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone)), c1, c2, c3
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2), c1, c2, c3 FROM public.time_tblmysql GROUP BY 4, 5, 6
(6 rows)

-- select unix_timestamp with group by index (explain)
--Testcase 2480:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2), c1 FROM time_tbl GROUP BY 1,2,3,4;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=104)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone)), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2), c1 FROM public.time_tblmysql GROUP BY 1, 2, 3, 4
(6 rows)

-- select unix_timestamp with group by having (explain)
--Testcase 2481:
EXPLAIN VERBOSE
SELECT unix_timestamp(), c1 FROM time_tbl GROUP BY unix_timestamp(),c1 HAVING unix_timestamp() > 100000;
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (unix_timestamp()), c1
   Filter: ((unix_timestamp()) > '100000'::numeric)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.unix_timestamp(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.unix_timestamp() > 100000::numeric))
(7 rows)

-- select unix_timestamp with group by index having (explain)
--Testcase 2482:
EXPLAIN VERBOSE
SELECT unix_timestamp(), c1 FROM time_tbl GROUP BY 2,1 HAVING unix_timestamp() > 100000;
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (unix_timestamp()), c1
   Filter: ((unix_timestamp()) > '100000'::numeric)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.unix_timestamp(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.unix_timestamp() > 100000::numeric))
(7 rows)

-- select unix_timestamp and as
--Testcase 2483:
EXPLAIN VERBOSE
SELECT unix_timestamp(), unix_timestamp(c3), unix_timestamp(c2) as unix_timestamp1 FROM time_tbl;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=96)
   Output: (unix_timestamp()), (unix_timestamp(c3)), (unix_timestamp((c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.unix_timestamp(), public.unix_timestamp(c3), public.unix_timestamp(c2) FROM public.time_tblmysql
(4 rows)

-- TO_SECONDS()
-- select to_seconds (stub function, explain)
--Testcase 2484:
EXPLAIN VERBOSE
SELECT to_seconds(id + 200719), to_seconds(c3), to_seconds(c2) FROM time_tbl;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2789.20 rows=3413 width=24)
   Output: (to_seconds((id + 200719))), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_seconds((id + 200719)), public.to_seconds(c3), public.to_seconds(c2) FROM public.time_tblmysql
(4 rows)

-- select to_seconds (stub function, not pushdown constraints, explain)
--Testcase 2485:
EXPLAIN VERBOSE
SELECT to_seconds(id + 200719), to_seconds(c3), to_seconds(c2) FROM time_tbl WHERE to_hex(id) > '0';
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1088.64 rows=1138 width=24)
   Output: (to_seconds((id + 200719))), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_seconds((id + 200719)), public.to_seconds(c3), public.to_seconds(c2), id FROM public.time_tblmysql
(5 rows)

-- select to_seconds (stub function, pushdown constraints, explain)
--Testcase 2486:
EXPLAIN VERBOSE
SELECT to_seconds(id + 200719), to_seconds(c3), to_seconds(c2) FROM time_tbl WHERE id = 1;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..165.84 rows=17 width=24)
   Output: (to_seconds((id + 200719))), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_seconds((id + 200719)), public.to_seconds(c3), public.to_seconds(c2) FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select to_seconds (stub function, to_seconds in constraints, explain)
--Testcase 2487:
EXPLAIN VERBOSE
SELECT to_seconds(id + 200719), to_seconds(c3), to_seconds(c2) FROM time_tbl WHERE to_seconds(id + 200719) > to_seconds('1997-10-14 00:00:00'::timestamp);
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2749.64 rows=1138 width=24)
   Output: (to_seconds((id + 200719))), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_seconds((id + 200719)), public.to_seconds(c3), public.to_seconds(c2) FROM public.time_tblmysql WHERE ((public.to_seconds((id + 200719)) > public.to_seconds('1997-10-14 00:00:00'::timestamp without time zone)))
(4 rows)

-- to_seconds in constrains (stub function, explain)
--Testcase 2488:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE to_seconds(id + 200719) > to_seconds('1997-10-14 00:00:00'::timestamp);
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, c1 FROM public.time_tblmysql WHERE ((public.to_seconds((id + 200719)) > public.to_seconds('1997-10-14 00:00:00'::timestamp without time zone)))
(4 rows)

-- to_seconds in constrains (stub function, result)
--Testcase 2489:
SELECT c1 FROM time_tbl WHERE to_seconds(id + 200719) > to_seconds('1997-10-14 00:00:00'::timestamp);
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select to_seconds and agg (pushdown, explain)
--Testcase 2490:
EXPLAIN VERBOSE
SELECT to_seconds('1997-10-14 00:00:00'::timestamp), to_seconds('1997-10-14 00:00:00'::date), sum(id) FROM time_tbl;
                                                                       QUERY PLAN                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (to_seconds('1997-10-14 00:00:00'::timestamp without time zone)), (to_seconds('1997-10-14 00:00:00'::timestamp without time zone)), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_seconds('1997-10-14 00:00:00'::timestamp without time zone), sum(id) FROM public.time_tblmysql
(6 rows)

-- select to_seconds and log2 (pushdown, explain)
--Testcase 2491:
EXPLAIN VERBOSE
SELECT to_seconds('1997-10-14 00:00:00'::timestamp), to_seconds(c3), to_seconds(c2), log2(id) FROM time_tbl;
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3642.45 rows=3413 width=32)
   Output: (to_seconds('1997-10-14 00:00:00'::timestamp without time zone)), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone)), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_seconds('1997-10-14 00:00:00'::timestamp without time zone), public.to_seconds(c3), public.to_seconds(c2), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select to_seconds with non pushdown func and explicit constant (explain)
--Testcase 2492:
EXPLAIN VERBOSE
SELECT to_seconds('1997-10-14 00:00:00'::timestamp), to_seconds(c3), to_seconds(c2), to_hex(id), 4 FROM time_tbl;
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2789.20 rows=3413 width=60)
   Output: (to_seconds('1997-10-14 00:00:00'::timestamp without time zone)), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone)), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_seconds('1997-10-14 00:00:00'::timestamp without time zone), public.to_seconds(c3), public.to_seconds(c2), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select to_seconds with order by (explain)
--Testcase 2493:
EXPLAIN VERBOSE
SELECT to_seconds(id + 200719), to_seconds(c3), to_seconds(c2), c1 FROM time_tbl ORDER BY c1;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Result  (cost=412.68..3032.16 rows=3413 width=32)
   Output: to_seconds((id + 200719)), to_seconds(c3), to_seconds((c2)::timestamp without time zone), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=24)
         Output: c1, id, c3, c2
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=24)
               Output: c1, id, c3, c2
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT id, c1, c2, c3 FROM public.time_tblmysql
(9 rows)

-- select to_seconds with order by index (explain)
--Testcase 2494:
EXPLAIN VERBOSE
SELECT to_seconds(id + 200719), to_seconds(c3), to_seconds(c2), c1 FROM time_tbl ORDER BY 2;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Result  (cost=1265.93..3885.41 rows=3413 width=32)
   Output: to_seconds((id + 200719)), (to_seconds(c3)), to_seconds((c2)::timestamp without time zone), c1
   ->  Sort  (cost=1265.93..1274.46 rows=3413 width=24)
         Output: (to_seconds(c3)), c1, id, c2
         Sort Key: (to_seconds(time_tbl.c3))
         ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=24)
               Output: (to_seconds(c3)), c1, id, c2
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT public.to_seconds(c3), c1, id, c2 FROM public.time_tblmysql
(9 rows)

-- to_seconds constraints with order by (explain)
--Testcase 2495:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE to_seconds('2020-10-14 00:00:00'::timestamp) > to_seconds('1997-10-14 00:00:00'::timestamp) ORDER BY c1;
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.to_seconds('2020-10-14 00:00:00'::timestamp without time zone) > public.to_seconds('1997-10-14 00:00:00'::timestamp without time zone)))
(7 rows)

-- to_seconds constraints with order by (result)
--Testcase 2496:
SELECT c1 FROM time_tbl WHERE to_seconds('2020-10-14 00:00:00'::timestamp) > to_seconds('1997-10-14 00:00:00'::timestamp) ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select to_seconds with group by (explain)
--Testcase 2497:
EXPLAIN VERBOSE
SELECT to_seconds(971014), to_seconds(c3), to_seconds(c2), c1 FROM time_tbl GROUP BY c1,c2,c3;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=44)
   Output: (to_seconds(971014)), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone)), c1, c2, c3
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_seconds(971014), public.to_seconds(c3), public.to_seconds(c2), c1, c2, c3 FROM public.time_tblmysql GROUP BY 4, 5, 6
(6 rows)

-- select to_seconds with group by index (explain)
--Testcase 2498:
EXPLAIN VERBOSE
SELECT to_seconds(971014), to_seconds(c3), to_seconds(c2), c1 FROM time_tbl GROUP BY 1,2,3,4;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=32)
   Output: (to_seconds(971014)), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone)), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_seconds(971014), public.to_seconds(c3), public.to_seconds(c2), c1 FROM public.time_tblmysql GROUP BY 1, 2, 3, 4
(6 rows)

-- select to_seconds with group by having (explain)
--Testcase 2499:
EXPLAIN VERBOSE
SELECT to_seconds(971014), c1 FROM time_tbl GROUP BY to_seconds(971014),c1 HAVING to_seconds(971014) > 100000;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (to_seconds(971014)), c1
   Filter: ((to_seconds(971014)) > 100000)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_seconds(971014), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.to_seconds(971014) > 100000))
(7 rows)

-- select to_seconds with group by index having (explain)
--Testcase 2500:
EXPLAIN VERBOSE
SELECT to_seconds(971014), c1 FROM time_tbl GROUP BY 2,1 HAVING to_seconds(971014) > 100000;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (to_seconds(971014)), c1
   Filter: ((to_seconds(971014)) > 100000)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_seconds(971014), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.to_seconds(971014) > 100000))
(7 rows)

-- select to_seconds and as
--Testcase 2501:
EXPLAIN VERBOSE
SELECT to_seconds(971014), to_seconds(c3), to_seconds(c2) as to_seconds1 FROM time_tbl;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=24)
   Output: (to_seconds(971014)), (to_seconds(c3)), (to_seconds((c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_seconds(971014), public.to_seconds(c3), public.to_seconds(c2) FROM public.time_tblmysql
(4 rows)

-- TO_DAYS()
-- select to_days (stub function, explain)
--Testcase 2502:
EXPLAIN VERBOSE
SELECT to_days(id + 200719), to_days(c2) FROM time_tbl;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=8)
   Output: (to_days((id + 200719))), (to_days(c2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_days((id + 200719)), public.to_days(c2) FROM public.time_tblmysql
(4 rows)

-- select to_days (stub function, not pushdown constraints, explain)
--Testcase 2503:
EXPLAIN VERBOSE
SELECT to_days(id + 200719), to_days(c2) FROM time_tbl WHERE to_hex(id) > '0';
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..801.30 rows=1138 width=8)
   Output: (to_days((id + 200719))), (to_days(c2))
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_days((id + 200719)), public.to_days(c2), id FROM public.time_tblmysql
(5 rows)

-- select to_days (stub function, pushdown constraints, explain)
--Testcase 2504:
EXPLAIN VERBOSE
SELECT to_days(id + 200719), to_days(c2) FROM time_tbl WHERE id = 1;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..161.54 rows=17 width=8)
   Output: (to_days((id + 200719))), (to_days(c2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_days((id + 200719)), public.to_days(c2) FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select to_days (stub function, to_days in constraints, explain)
--Testcase 2505:
EXPLAIN VERBOSE
SELECT to_days(id + 200719), to_days(c2) FROM time_tbl WHERE to_days(id + 200719) > to_days('1997-10-14 00:00:00'::date);
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2462.30 rows=1138 width=8)
   Output: (to_days((id + 200719))), (to_days(c2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_days((id + 200719)), public.to_days(c2) FROM public.time_tblmysql WHERE ((public.to_days((id + 200719)) > public.to_days('1997-10-14'::date)))
(4 rows)

-- to_days in constrains (stub function, explain)
--Testcase 2506:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE to_days(id + 200719) > to_days('1997-10-14 00:00:00'::date);
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1890.46 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, c1 FROM public.time_tblmysql WHERE ((public.to_days((id + 200719)) > public.to_days('1997-10-14'::date)))
(4 rows)

-- to_days in constrains (stub function, result)
--Testcase 2507:
SELECT c1 FROM time_tbl WHERE to_days(id + 200719) > to_days('1997-10-14 00:00:00'::date);
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select to_days and agg (pushdown, explain)
--Testcase 2508:
EXPLAIN VERBOSE
SELECT to_days('1997-10-14 00:00:00'::date), to_days('1997-10-14 00:00:00'::date), sum(id) FROM time_tbl;
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (to_days('1997-10-14'::date)), (to_days('1997-10-14'::date)), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_days('1997-10-14'::date), sum(id) FROM public.time_tblmysql
(6 rows)

-- select to_days and log2 (pushdown, explain)
--Testcase 2509:
EXPLAIN VERBOSE
SELECT to_days('1997-10-14 00:00:00'::date), to_days(c2), log2(id) FROM time_tbl;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=16)
   Output: (to_days('1997-10-14'::date)), (to_days(c2)), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_days('1997-10-14'::date), public.to_days(c2), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select to_days with non pushdown func and explicit constant (explain)
--Testcase 2510:
EXPLAIN VERBOSE
SELECT to_days('1997-10-14 00:00:00'::date), to_days(c2), to_hex(id), 4 FROM time_tbl;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=44)
   Output: (to_days('1997-10-14'::date)), (to_days(c2)), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_days('1997-10-14'::date), public.to_days(c2), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select to_days with order by (explain)
--Testcase 2511:
EXPLAIN VERBOSE
SELECT to_days(id + 200719), to_days(c2), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Result  (cost=412.68..2170.37 rows=3413 width=16)
   Output: to_days((id + 200719)), to_days(c2), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=16)
         Output: c1, id, c2
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=16)
               Output: c1, id, c2
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT id, c1, c2 FROM public.time_tblmysql
(9 rows)

-- select to_days with order by index (explain)
--Testcase 2512:
EXPLAIN VERBOSE
SELECT to_days(id + 200719), to_days(c2), c1 FROM time_tbl ORDER BY 2;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Result  (cost=1265.93..3023.62 rows=3413 width=16)
   Output: to_days((id + 200719)), (to_days(c2)), c1
   ->  Sort  (cost=1265.93..1274.46 rows=3413 width=16)
         Output: (to_days(c2)), c1, id
         Sort Key: (to_days(time_tbl.c2))
         ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
               Output: (to_days(c2)), c1, id
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT public.to_days(c2), c1, id FROM public.time_tblmysql
(9 rows)

-- to_days constraints with order by (explain)
--Testcase 2513:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE to_days('2020-10-14 00:00:00'::date) > to_days('1997-10-14 00:00:00'::date) ORDER BY c1;
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.to_days('2020-10-14'::date) > public.to_days('1997-10-14'::date)))
(7 rows)

-- to_days constraints with order by (result)
--Testcase 2514:
SELECT c1 FROM time_tbl WHERE to_days('2020-10-14 00:00:00'::date) > to_days('1997-10-14 00:00:00'::date) ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select to_days with group by (explain)
--Testcase 2515:
EXPLAIN VERBOSE
SELECT to_days(971014), to_days(c2), c1 FROM time_tbl GROUP BY c1,c2;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=20)
   Output: (to_days(971014)), (to_days(c2)), c1, c2
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_days(971014), public.to_days(c2), c1, c2 FROM public.time_tblmysql GROUP BY 3, 4
(6 rows)

-- select to_days with group by index (explain)
--Testcase 2516:
EXPLAIN VERBOSE
SELECT to_days(971014), to_days(c2), c1 FROM time_tbl GROUP BY 1,2,3;
                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (to_days(971014)), (to_days(c2)), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_days(971014), public.to_days(c2), c1 FROM public.time_tblmysql GROUP BY 1, 2, 3
(6 rows)

-- select to_days with group by having (explain)
--Testcase 2517:
EXPLAIN VERBOSE
SELECT to_days(971014), c1 FROM time_tbl GROUP BY c1,to_days(971014) HAVING to_days(971014) > 1000;
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (to_days(971014)), c1
   Filter: ((to_days(971014)) > 1000)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_days(971014), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.to_days(971014) > 1000))
(7 rows)

-- select to_days with group by index having (explain)
--Testcase 2518:
EXPLAIN VERBOSE
SELECT to_days(971014), c1 FROM time_tbl GROUP BY 2,1 HAVING to_days(971014) > 1000;
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (to_days(971014)), c1
   Filter: ((to_days(971014)) > 1000)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.to_days(971014), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.to_days(971014) > 1000))
(7 rows)

-- select to_days and as
--Testcase 2519:
EXPLAIN VERBOSE
SELECT to_days(971014), to_days(c2) as to_days1 FROM time_tbl;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (to_days(971014)), (to_days(c2))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.to_days(971014), public.to_days(c2) FROM public.time_tblmysql
(4 rows)

-- TIMESTAMPDIFF()
-- select timestampdiff (stub function, explain)
--Testcase 2520:
EXPLAIN VERBOSE
SELECT timestampdiff('MINUTE', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('MONTH', c2, '2080-01-01'::date), timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                                                                                                       QUERY PLAN                                                                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3650.99 rows=3413 width=32)
   Output: (timestampdiff('MINUTE'::time_unit, (c2)::timestamp without time zone, c3)), (timestampdiff('DAY'::time_unit, c3, (c2)::timestamp without time zone)), (timestampdiff('MONTH'::time_unit, (c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('YEAR'::time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampdiff('MINUTE'::public.time_unit, c2, c3), public.timestampdiff('DAY'::public.time_unit, c3, c2), public.timestampdiff('MONTH'::public.time_unit, c2, '2080-01-01 00:00:00'::timestamp without time zone), public.timestampdiff('YEAR'::public.time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select timestampdiff (stub function, result)
--Testcase 2521:
SELECT timestampdiff('MINUTE', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('MONTH', c2, '2080-01-01'::date), timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl;
 timestampdiff | timestampdiff | timestampdiff | timestampdiff 
---------------+---------------+---------------+---------------
          2170 |            -1 |           707 |            58
          5712 |            -3 |           708 |            58
         -6527 |             4 |           707 |            58
        -12000 |             8 |           707 |            58
        -31620 |            21 |           707 |            58
(5 rows)

-- select timestampdiff (stub function, not pushdown constraints, explain)
--Testcase 2522:
EXPLAIN VERBOSE
SELECT timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..246.32 rows=17 width=32)
   Output: (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, c3)), (timestampdiff('DAY'::time_unit, c3, (c2)::timestamp without time zone)), (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('YEAR'::time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampdiff('DAY'::public.time_unit, c2, c3), public.timestampdiff('DAY'::public.time_unit, c3, c2), public.timestampdiff('DAY'::public.time_unit, c2, '2080-01-01 00:00:00'::timestamp without time zone), public.timestampdiff('YEAR'::public.time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select timestampdiff (stub function, not pushdown constraints, result)
--Testcase 2523:
SELECT timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 timestampdiff | timestampdiff | timestampdiff | timestampdiff 
---------------+---------------+---------------+---------------
             3 |            -3 |         21549 |            58
(1 row)

-- select timestampdiff (stub function, pushdown constraints, explain)
--Testcase 2524:
EXPLAIN VERBOSE
SELECT timestampdiff('YEAR', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3642.05 rows=3396 width=32)
   Output: (timestampdiff('YEAR'::time_unit, (c2)::timestamp without time zone, c3)), (timestampdiff('DAY'::time_unit, c3, (c2)::timestamp without time zone)), (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('YEAR'::time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampdiff('YEAR'::public.time_unit, c2, c3), public.timestampdiff('DAY'::public.time_unit, c3, c2), public.timestampdiff('DAY'::public.time_unit, c2, '2080-01-01 00:00:00'::timestamp without time zone), public.timestampdiff('YEAR'::public.time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select timestampdiff (stub function, pushdown constraints, result)
--Testcase 2525:
SELECT timestampdiff('YEAR', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 timestampdiff | timestampdiff | timestampdiff | timestampdiff 
---------------+---------------+---------------+---------------
             0 |            -1 |         21548 |            58
             0 |            -3 |         21549 |            58
             0 |             4 |         21540 |            58
             0 |             8 |         21535 |            58
             0 |            21 |         21521 |            58
(5 rows)

-- select timestampdiff (stub function, timestampdiff in constraints, explain)
--Testcase 2526:
EXPLAIN VERBOSE
SELECT timestampdiff('YEAR', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl WHERE timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) < 100;
                                                                                                                                                                                                                                                       QUERY PLAN                                                                                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2175.21 rows=1138 width=32)
   Output: (timestampdiff('YEAR'::time_unit, (c2)::timestamp without time zone, c3)), (timestampdiff('DAY'::time_unit, c3, (c2)::timestamp without time zone)), (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('YEAR'::time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampdiff('YEAR'::public.time_unit, c2, c3), public.timestampdiff('DAY'::public.time_unit, c3, c2), public.timestampdiff('DAY'::public.time_unit, c2, '2080-01-01 00:00:00'::timestamp without time zone), public.timestampdiff('YEAR'::public.time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.timestampdiff('YEAR'::public.time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone) < 100::double precision))
(4 rows)

-- select timestampdiff (stub function, timestampdiff in constraints, result)
--Testcase 2527:
SELECT timestampdiff('YEAR', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl WHERE timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) < 100;
 timestampdiff | timestampdiff | timestampdiff | timestampdiff 
---------------+---------------+---------------+---------------
             0 |            -1 |         21548 |            58
             0 |            -3 |         21549 |            58
             0 |             4 |         21540 |            58
             0 |             8 |         21535 |            58
             0 |            21 |         21521 |            58
(5 rows)

-- select timestampdiff with agg (pushdown, explain)
--Testcase 2528:
EXPLAIN VERBOSE
SELECT max(c3), timestampdiff('DAY', max(c2), max(c3)), timestampdiff('MONTH', min(c2), min(c3)) FROM time_tbl;
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (timestampdiff('DAY'::time_unit, (max(c2))::timestamp without time zone, max(c3))), (timestampdiff('MONTH'::time_unit, (min(c2))::timestamp without time zone, min(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.timestampdiff('DAY'::public.time_unit, max(c2), max(c3)), public.timestampdiff('MONTH'::public.time_unit, min(c2), min(c3)) FROM public.time_tblmysql
(6 rows)

-- select timestampdiff as nest function with agg (pushdown, result)
--Testcase 2529:
SELECT max(c3), timestampdiff('DAY', max(c2), max(c3)), timestampdiff('MONTH', min(c2), min(c3)) FROM time_tbl;
         max         | timestampdiff | timestampdiff 
---------------------+---------------+---------------
 2021-01-07 00:59:59 |           -21 |             0
(1 row)

-- select timestampdiff with non pushdown func and explicit constant (explain)
--Testcase 2530:
EXPLAIN VERBOSE
SELECT timestampdiff('MONTH', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp), pi(), 4.1 FROM time_tbl;
                                                                                                                                                QUERY PLAN                                                                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=56)
   Output: (timestampdiff('MONTH'::time_unit, (c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('DAY'::time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampdiff('MONTH'::public.time_unit, c2, '2080-01-01 00:00:00'::timestamp without time zone), public.timestampdiff('DAY'::public.time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select timestampdiff with non pushdown func and explicit constant (result)
--Testcase 2531:
SELECT timestampdiff('MONTH', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp), pi(), 4.1 FROM time_tbl;
 timestampdiff | timestampdiff |        pi         | ?column? 
---------------+---------------+-------------------+----------
           707 |         21546 | 3.141592653589793 |      4.1
           708 |         21545 | 3.141592653589793 |      4.1
           707 |         21545 | 3.141592653589793 |      4.1
           707 |         21543 | 3.141592653589793 |      4.1
           707 |         21543 | 3.141592653589793 |      4.1
(5 rows)

-- select timestampdiff with order by (explain)
--Testcase 2532:
EXPLAIN VERBOSE
SELECT id, timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl order by timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp);
                                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=3851.28..3859.81 rows=3413 width=36)
   Output: id, (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, c3)), (timestampdiff('DAY'::time_unit, c3, (c2)::timestamp without time zone)), (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('DAY'::time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone))
   Sort Key: (timestampdiff('DAY'::time_unit, (time_tbl.c2)::timestamp without time zone, time_tbl.c3)), (timestampdiff('DAY'::time_unit, time_tbl.c3, (time_tbl.c2)::timestamp without time zone)), (timestampdiff('DAY'::time_unit, (time_tbl.c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('DAY'::time_unit, time_tbl.c3, '2080-01-01 12:00:00'::timestamp without time zone))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..3650.99 rows=3413 width=36)
         Output: id, (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, c3)), (timestampdiff('DAY'::time_unit, c3, (c2)::timestamp without time zone)), (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('DAY'::time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.timestampdiff('DAY'::public.time_unit, c2, c3), public.timestampdiff('DAY'::public.time_unit, c3, c2), public.timestampdiff('DAY'::public.time_unit, c2, '2080-01-01 00:00:00'::timestamp without time zone), public.timestampdiff('DAY'::public.time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(7 rows)

-- select timestampdiff with order by (result)
--Testcase 2533:
SELECT id, timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl order by timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp);
 id | timestampdiff | timestampdiff | timestampdiff | timestampdiff 
----+---------------+---------------+---------------+---------------
  4 |           -21 |            21 |         21521 |         21543
  3 |            -8 |             8 |         21535 |         21543
  2 |            -4 |             4 |         21540 |         21545
  0 |             1 |            -1 |         21548 |         21546
  1 |             3 |            -3 |         21549 |         21545
(5 rows)

-- select timestampdiff with order by index (result)
--Testcase 2534:
SELECT id, timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl order by 5,4,3,2,1;
 id | timestampdiff | timestampdiff | timestampdiff | timestampdiff 
----+---------------+---------------+---------------+---------------
  4 |           -21 |            21 |         21521 |         21543
  3 |            -8 |             8 |         21535 |         21543
  2 |            -4 |             4 |         21540 |         21545
  1 |             3 |            -3 |         21549 |         21545
  0 |             1 |            -1 |         21548 |         21546
(5 rows)

-- select timestampdiff with order by index (result)
--Testcase 2535:
SELECT id, timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl order by 1,2,3,4,5;
 id | timestampdiff | timestampdiff | timestampdiff | timestampdiff 
----+---------------+---------------+---------------+---------------
  0 |             1 |            -1 |         21548 |         21546
  1 |             3 |            -3 |         21549 |         21545
  2 |            -4 |             4 |         21540 |         21545
  3 |            -8 |             8 |         21535 |         21543
  4 |           -21 |            21 |         21521 |         21543
(5 rows)

-- select timestampdiff with group by (explain)
--Testcase 2536:
EXPLAIN VERBOSE
SELECT max(c3), timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl group by timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp);
                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, c3)), (timestampdiff('DAY'::time_unit, c3, (c2)::timestamp without time zone)), (timestampdiff('DAY'::time_unit, (c2)::timestamp without time zone, '2080-01-01 00:00:00'::timestamp without time zone)), (timestampdiff('DAY'::time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.timestampdiff('DAY'::public.time_unit, c2, c3), public.timestampdiff('DAY'::public.time_unit, c3, c2), public.timestampdiff('DAY'::public.time_unit, c2, '2080-01-01 00:00:00'::timestamp without time zone), public.timestampdiff('DAY'::public.time_unit, c3, '2080-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql GROUP BY 2, 3, 4, 5
(6 rows)

-- select timestampdiff with group by (result)
--Testcase 2537:
SELECT max(c3), timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp) FROM time_tbl group by timestampdiff('DAY', c2, c3), timestampdiff('DAY', c3, c2), timestampdiff('DAY', c2, '2080-01-01'::date), timestampdiff('DAY', c3, '2080-01-01 12:00:00'::timestamp);
         max         | timestampdiff | timestampdiff | timestampdiff | timestampdiff 
---------------------+---------------+---------------+---------------+---------------
 2021-01-03 12:10:30 |             1 |            -1 |         21548 |         21546
 2021-01-04 23:12:13 |             3 |            -3 |         21549 |         21545
 2021-01-05 11:12:12 |            -4 |             4 |         21540 |         21545
 2021-01-06 16:00:00 |            -8 |             8 |         21535 |         21543
 2021-01-07 00:59:59 |           -21 |            21 |         21521 |         21543
(5 rows)

-- select timestampdiff with group by index (result)
--Testcase 2538:
SELECT id, timestampdiff('DAY', '2021-01-01 12:00:00'::timestamp, '2080-01-01'::date), timestampdiff('DAY', '2019-01-01'::date, '2080-01-01 12:00:00'::timestamp) FROM time_tbl group by 3,2,1;
 id | timestampdiff | timestampdiff 
----+---------------+---------------
  0 |         21548 |         22280
  1 |         21548 |         22280
  2 |         21548 |         22280
  3 |         21548 |         22280
  4 |         21548 |         22280
(5 rows)

-- select timestampdiff with group by index (result)
--Testcase 2539:
SELECT id, timestampdiff('DAY', '2021-01-01 12:00:00'::timestamp, '2080-01-01'::date), timestampdiff('DAY', '2019-01-01'::date, '2080-01-01 12:00:00'::timestamp) FROM time_tbl group by 1,2,3;
 id | timestampdiff | timestampdiff 
----+---------------+---------------
  0 |         21548 |         22280
  1 |         21548 |         22280
  2 |         21548 |         22280
  3 |         21548 |         22280
  4 |         21548 |         22280
(5 rows)

-- select timestampdiff and as
--Testcase 2540:
SELECT timestampdiff('MINUTE', c2, c3) as timestampdiff1, timestampdiff('DAY', c3, c2) as timestampdiff2, timestampdiff('MONTH', c2, '2080-01-01'::date) as timestampdiff3, timestampdiff('YEAR', c3, '2080-01-01 12:00:00'::timestamp) as timestampdiff4 FROM time_tbl;
 timestampdiff1 | timestampdiff2 | timestampdiff3 | timestampdiff4 
----------------+----------------+----------------+----------------
           2170 |             -1 |            707 |             58
           5712 |             -3 |            708 |             58
          -6527 |              4 |            707 |             58
         -12000 |              8 |            707 |             58
         -31620 |             21 |            707 |             58
(5 rows)

-- TIMESTAMPADD()
-- select timestampadd (stub function, explain)
--Testcase 2541:
EXPLAIN VERBOSE
SELECT timestampadd('MINUTE', 5, c3), timestampadd('DAY', 5, c2) FROM time_tbl;
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (timestampadd('MINUTE'::time_unit, 5, c3)), (timestampadd('DAY'::time_unit, 5, (c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampadd('MINUTE'::public.time_unit, 5, c3), public.timestampadd('DAY'::public.time_unit, 5, c2) FROM public.time_tblmysql
(4 rows)

-- select timestampadd (stub function, result)
--Testcase 2542:
SELECT timestampadd('MINUTE', 5, c3), timestampadd('DAY', 5, c2) FROM time_tbl;
    timestampadd     |    timestampadd     
---------------------+---------------------
 2021-01-03 12:15:30 | 2021-01-07 00:00:00
 2021-01-04 23:17:13 | 2021-01-06 00:00:00
 2021-01-05 11:17:12 | 2021-01-15 00:00:00
 2021-01-06 16:05:00 | 2021-01-20 00:00:00
 2021-01-07 01:04:59 | 2021-02-03 00:00:00
(5 rows)

-- select timestampadd (stub function, not pushdown constraints, explain)
--Testcase 2543:
EXPLAIN VERBOSE
SELECT timestampadd('MINUTE', 10, c3), timestampadd('YEAR', 5, c2) FROM time_tbl WHERE to_hex(id) = '1';
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.74 rows=17 width=16)
   Output: (timestampadd('MINUTE'::time_unit, 10, c3)), (timestampadd('YEAR'::time_unit, 5, (c2)::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampadd('MINUTE'::public.time_unit, 10, c3), public.timestampadd('YEAR'::public.time_unit, 5, c2), id FROM public.time_tblmysql
(5 rows)

-- select timestampadd (stub function, not pushdown constraints, result)
--Testcase 2544:
SELECT timestampadd('MINUTE', 10, c3), timestampadd('YEAR', 5, c2) FROM time_tbl WHERE to_hex(id) = '1';
    timestampadd     |    timestampadd     
---------------------+---------------------
 2021-01-04 23:22:13 | 2026-01-01 00:00:00
(1 row)

-- select timestampadd (stub function, pushdown constraints, explain)
--Testcase 2545:
EXPLAIN VERBOSE
SELECT timestampadd('MINUTE', 6, c3), timestampadd('YEAR', 5, c2) FROM time_tbl WHERE id != 200;
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.07 rows=3396 width=16)
   Output: (timestampadd('MINUTE'::time_unit, 6, c3)), (timestampadd('YEAR'::time_unit, 5, (c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampadd('MINUTE'::public.time_unit, 6, c3), public.timestampadd('YEAR'::public.time_unit, 5, c2) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select timestampadd (stub function, pushdown constraints, result)
--Testcase 2546:
SELECT timestampadd('MINUTE', 6, c3), timestampadd('YEAR', 5, c2) FROM time_tbl WHERE id != 200;
    timestampadd     |    timestampadd     
---------------------+---------------------
 2021-01-03 12:16:30 | 2026-01-02 00:00:00
 2021-01-04 23:18:13 | 2026-01-01 00:00:00
 2021-01-05 11:18:12 | 2026-01-10 00:00:00
 2021-01-06 16:06:00 | 2026-01-15 00:00:00
 2021-01-07 01:05:59 | 2026-01-29 00:00:00
(5 rows)

-- select timestampadd (stub function, timestampadd in constraints, explain)
--Testcase 2547:
EXPLAIN VERBOSE
SELECT timestampadd('MINUTE', 6, c3), timestampadd('YEAR', 10, c2) FROM time_tbl WHERE timestampadd('YEAR', 1, c2) > '1997-01-01 12:00:00'::timestamp;
                                                                                                                                     QUERY PLAN                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1609.05 rows=1138 width=16)
   Output: (timestampadd('MINUTE'::time_unit, 6, c3)), (timestampadd('YEAR'::time_unit, 10, (c2)::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timestampadd('MINUTE'::public.time_unit, 6, c3), public.timestampadd('YEAR'::public.time_unit, 10, c2) FROM public.time_tblmysql WHERE ((public.timestampadd('YEAR'::public.time_unit, 1, c2) > '1997-01-01 12:00:00'::timestamp without time zone))
(4 rows)

-- select timestampadd (stub function, timestampadd in constraints, result)
--Testcase 2548:
SELECT timestampadd('MINUTE', 6, c3), timestampadd('YEAR', 10, c2) FROM time_tbl WHERE timestampadd('YEAR', 1, c2) > '1997-01-01 12:00:00'::timestamp;
    timestampadd     |    timestampadd     
---------------------+---------------------
 2021-01-03 12:16:30 | 2031-01-02 00:00:00
 2021-01-04 23:18:13 | 2031-01-01 00:00:00
 2021-01-05 11:18:12 | 2031-01-10 00:00:00
 2021-01-06 16:06:00 | 2031-01-15 00:00:00
 2021-01-07 01:05:59 | 2031-01-29 00:00:00
(5 rows)

-- select timestampadd with agg (pushdown, explain)
--Testcase 2549:
EXPLAIN VERBOSE
SELECT max(c3), timestampadd('DAY', 2, max(c3)), timestampadd('MONTH', 2, min(c2)) FROM time_tbl;
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (timestampadd('DAY'::time_unit, 2, max(c3))), (timestampadd('MONTH'::time_unit, 2, (min(c2))::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.timestampadd('DAY'::public.time_unit, 2, max(c3)), public.timestampadd('MONTH'::public.time_unit, 2, min(c2)) FROM public.time_tblmysql
(6 rows)

-- select timestampadd as nest function with agg (pushdown, result)
--Testcase 2550:
SELECT max(c3), timestampadd('DAY', 2, max(c3)), timestampadd('MONTH', 2, min(c2)) FROM time_tbl;
         max         |    timestampadd     |    timestampadd     
---------------------+---------------------+---------------------
 2021-01-07 00:59:59 | 2021-01-09 00:59:59 | 2021-03-01 00:00:00
(1 row)

-- select timestampadd with non pushdown func and explicit constant (explain)
--Testcase 2551:
EXPLAIN VERBOSE
SELECT timestampadd('MINUTE', 2, max(c3)), timestampadd('MONTH', 60, min(c2)), pi(), 4.1 FROM time_tbl;
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=56)
   Output: (timestampadd('MINUTE'::time_unit, 2, max(c3))), (timestampadd('MONTH'::time_unit, 60, (min(c2))::timestamp without time zone)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.timestampadd('MINUTE'::public.time_unit, 2, max(c3)), public.timestampadd('MONTH'::public.time_unit, 60, min(c2)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(6 rows)

-- select timestampadd with non pushdown func and explicit constant (result)
--Testcase 2552:
SELECT timestampadd('MINUTE', 2, max(c3)), timestampadd('MONTH', 60, min(c2)), pi(), 4.1 FROM time_tbl;
    timestampadd     |    timestampadd     |        pi         | ?column? 
---------------------+---------------------+-------------------+----------
 2021-01-07 01:01:59 | 2026-01-01 00:00:00 | 3.141592653589793 |      4.1
(1 row)

-- select timestampadd with order by (explain)
--Testcase 2553:
EXPLAIN VERBOSE
SELECT id, timestampadd('MINUTE', 60, c3), timestampadd('YEAR', 10, c2) FROM time_tbl order by timestampadd('MINUTE', 60, c3), timestampadd('YEAR', 10, c2);
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2127.71..2136.24 rows=3413 width=20)
   Output: id, (timestampadd('MINUTE'::time_unit, 60, c3)), (timestampadd('YEAR'::time_unit, 10, (c2)::timestamp without time zone))
   Sort Key: (timestampadd('MINUTE'::time_unit, 60, time_tbl.c3)), (timestampadd('YEAR'::time_unit, 10, (time_tbl.c2)::timestamp without time zone))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=20)
         Output: id, (timestampadd('MINUTE'::time_unit, 60, c3)), (timestampadd('YEAR'::time_unit, 10, (c2)::timestamp without time zone))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.timestampadd('MINUTE'::public.time_unit, 60, c3), public.timestampadd('YEAR'::public.time_unit, 10, c2) FROM public.time_tblmysql
(7 rows)

-- select timestampadd with order by (result)
--Testcase 2554:
SELECT id, timestampadd('MINUTE', 60, c3), timestampadd('YEAR', 10, c2) FROM time_tbl order by timestampadd('MINUTE', 60, c3), timestampadd('YEAR', 10, c2);
 id |    timestampadd     |    timestampadd     
----+---------------------+---------------------
  0 | 2021-01-03 13:10:30 | 2031-01-02 00:00:00
  1 | 2021-01-05 00:12:13 | 2031-01-01 00:00:00
  2 | 2021-01-05 12:12:12 | 2031-01-10 00:00:00
  3 | 2021-01-06 17:00:00 | 2031-01-15 00:00:00
  4 | 2021-01-07 01:59:59 | 2031-01-29 00:00:00
(5 rows)

-- select timestampadd with order by index (result)
--Testcase 2555:
SELECT id,timestampadd('MINUTE', 60, c3), timestampadd('YEAR', 10, c2) FROM time_tbl order by 3,2,1;
 id |    timestampadd     |    timestampadd     
----+---------------------+---------------------
  1 | 2021-01-05 00:12:13 | 2031-01-01 00:00:00
  0 | 2021-01-03 13:10:30 | 2031-01-02 00:00:00
  2 | 2021-01-05 12:12:12 | 2031-01-10 00:00:00
  3 | 2021-01-06 17:00:00 | 2031-01-15 00:00:00
  4 | 2021-01-07 01:59:59 | 2031-01-29 00:00:00
(5 rows)

-- select timestampadd with order by index (result)
--Testcase 2556:
SELECT id, timestampadd('MINUTE', 60, c3), timestampadd('YEAR', 10, c2) FROM time_tbl order by 1,2,3;
 id |    timestampadd     |    timestampadd     
----+---------------------+---------------------
  0 | 2021-01-03 13:10:30 | 2031-01-02 00:00:00
  1 | 2021-01-05 00:12:13 | 2031-01-01 00:00:00
  2 | 2021-01-05 12:12:12 | 2031-01-10 00:00:00
  3 | 2021-01-06 17:00:00 | 2031-01-15 00:00:00
  4 | 2021-01-07 01:59:59 | 2031-01-29 00:00:00
(5 rows)

-- select timestampadd with group by (explain)
--Testcase 2557:
EXPLAIN VERBOSE
SELECT max(c3), timestampadd('YEAR', 2, '1997-01-01 12:00:00'::timestamp), timestampadd('MONTH', 12, '1997-01-01'::date) FROM time_tbl group by timestampadd('YEAR', 2, '1997-01-01 12:00:00'::timestamp), timestampadd('MONTH', 12, '1997-01-01'::date);
                                                                                                                                      QUERY PLAN                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (timestampadd('YEAR'::time_unit, 2, '1997-01-01 12:00:00'::timestamp without time zone)), (timestampadd('MONTH'::time_unit, 12, '1997-01-01 00:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.timestampadd('YEAR'::public.time_unit, 2, '1997-01-01 12:00:00'::timestamp without time zone), public.timestampadd('MONTH'::public.time_unit, 12, '1997-01-01 00:00:00'::timestamp without time zone) FROM public.time_tblmysql GROUP BY 2, 3
(6 rows)

-- select timestampadd with group by (result)
--Testcase 2558:
SELECT max(c3), timestampadd('YEAR', 2, '1997-01-01 12:00:00'::timestamp), timestampadd('MONTH', 12, '1997-01-01'::date) FROM time_tbl group by timestampadd('YEAR', 2, '1997-01-01 12:00:00'::timestamp), timestampadd('MONTH', 12, '1997-01-01'::date);
         max         |    timestampadd     |    timestampadd     
---------------------+---------------------+---------------------
 2021-01-07 00:59:59 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
(1 row)

-- select timestampadd with group by index (result)
--Testcase 2559:
SELECT id, timestampadd('YEAR', 2, '1997-01-01 12:00:00'::timestamp), timestampadd('MONTH', 12, '1997-01-01'::date) FROM time_tbl group by 3,2,1;
 id |    timestampadd     |    timestampadd     
----+---------------------+---------------------
  0 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
  1 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
  2 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
  3 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
  4 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
(5 rows)

-- select timestampadd with group by index (result)
--Testcase 2560:
SELECT id, timestampadd('YEAR', 2, '1997-01-01 12:00:00'::timestamp), timestampadd('MONTH', 12, '1997-01-01'::date) FROM time_tbl group by 1,2,3;
 id |    timestampadd     |    timestampadd     
----+---------------------+---------------------
  0 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
  1 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
  2 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
  3 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
  4 | 1999-01-01 12:00:00 | 1998-01-01 00:00:00
(5 rows)

-- select timestampadd and as
--Testcase 2561:
SELECT timestampadd('MINUTE', 60, c2) as timestampadd1, timestampadd('MONTH', 12, '2080-01-01 12:01:00'::timestamp) as timestampadd2 FROM time_tbl;
    timestampadd1    |    timestampadd2    
---------------------+---------------------
 2021-01-02 01:00:00 | 2081-01-01 12:01:00
 2021-01-01 01:00:00 | 2081-01-01 12:01:00
 2021-01-10 01:00:00 | 2081-01-01 12:01:00
 2021-01-15 01:00:00 | 2081-01-01 12:01:00
 2021-01-29 01:00:00 | 2081-01-01 12:01:00
(5 rows)

-- TIMESTAMP()
-- select mysql_timestamp (stub function, explain)
--Testcase 2562:
EXPLAIN VERBOSE
SELECT mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=24)
   Output: (mysql_timestamp((c2)::timestamp without time zone)), (mysql_timestamp(c3)), (mysql_timestamp(c3, c1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_timestamp(c2), public.mysql_timestamp(c3), public.mysql_timestamp(c3, c1) FROM public.time_tblmysql
(4 rows)

-- select mysql_timestamp (stub function, result)
--Testcase 2563:
SELECT mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl;
   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
---------------------+---------------------+---------------------
 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- select mysql_timestamp (stub function, not pushdown constraints, explain)
--Testcase 2564:
EXPLAIN VERBOSE
SELECT mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl WHERE to_hex(id) = '1';
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..241.99 rows=17 width=24)
   Output: (mysql_timestamp((c2)::timestamp without time zone)), (mysql_timestamp(c3)), (mysql_timestamp(c3, c1))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_timestamp(c2), public.mysql_timestamp(c3), public.mysql_timestamp(c3, c1), id FROM public.time_tblmysql
(5 rows)

-- select mysql_timestamp (stub function, not pushdown constraints, result)
--Testcase 2565:
SELECT mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl WHERE to_hex(id) = '1';
   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
---------------------+---------------------+---------------------
 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
(1 row)

-- select mysql_timestamp (stub function, pushdown constraints, explain)
--Testcase 2566:
EXPLAIN VERBOSE
SELECT mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl WHERE id != 200;
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2776.07 rows=3396 width=24)
   Output: (mysql_timestamp((c2)::timestamp without time zone)), (mysql_timestamp(c3)), (mysql_timestamp(c3, c1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_timestamp(c2), public.mysql_timestamp(c3), public.mysql_timestamp(c3, c1) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select mysql_timestamp (stub function, pushdown constraints, result)
--Testcase 2567:
SELECT mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl WHERE id != 200;
   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
---------------------+---------------------+---------------------
 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- select mysql_timestamp (stub function, mysql_timestamp in constraints, explain)
--Testcase 2568:
EXPLAIN VERBOSE
SELECT mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl WHERE mysql_timestamp(c3, '23:11:59.123456'::time) < '2080-01-01 12:00:00'::timestamp;
                                                                                                                                  QUERY PLAN                                                                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1885.02 rows=1138 width=24)
   Output: (mysql_timestamp((c2)::timestamp without time zone)), (mysql_timestamp(c3)), (mysql_timestamp(c3, c1))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_timestamp(c2), public.mysql_timestamp(c3), public.mysql_timestamp(c3, c1) FROM public.time_tblmysql WHERE ((public.mysql_timestamp(c3, '23:11:59.123456'::time without time zone) < '2080-01-01 12:00:00'::timestamp without time zone))
(4 rows)

-- select mysql_timestamp (stub function, mysql_timestamp in constraints, result)
--Testcase 2569:
SELECT mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl WHERE mysql_timestamp(c3, '23:11:59.123456'::time) < '2080-01-01 12:00:00'::timestamp;
   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
---------------------+---------------------+---------------------
 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- select mysql_timestamp with agg (pushdown, explain)
--Testcase 2570:
EXPLAIN VERBOSE
SELECT max(c3), mysql_timestamp(max(c2)), mysql_timestamp(max(c3)), mysql_timestamp(max(c3), '11:12:12.112233'::time) FROM time_tbl;
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (max(c3)), (mysql_timestamp((max(c2))::timestamp without time zone)), (mysql_timestamp(max(c3))), (mysql_timestamp(max(c3), '11:12:12.112233'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.mysql_timestamp(max(c2)), public.mysql_timestamp(max(c3)), public.mysql_timestamp(max(c3), '11:12:12.112233'::time without time zone) FROM public.time_tblmysql
(6 rows)

-- select mysql_timestamp as nest function with agg (pushdown, result)
--Testcase 2571:
SELECT max(c3), mysql_timestamp(max(c2)), mysql_timestamp(max(c3)), mysql_timestamp(max(c3), '11:12:12.112233'::time) FROM time_tbl;
         max         |   mysql_timestamp   |   mysql_timestamp   |      mysql_timestamp       
---------------------+---------------------+---------------------+----------------------------
 2021-01-07 00:59:59 | 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 12:12:11.112233
(1 row)

-- select mysql_timestamp with non pushdown func and explicit constant (explain)
--Testcase 2572:
EXPLAIN VERBOSE
SELECT mysql_timestamp(max(c2)), mysql_timestamp(max(c3)), mysql_timestamp(max(c3), '11:12:12.112233'::time), pi(), 4.1 FROM time_tbl;
                                                                                                               QUERY PLAN                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=64)
   Output: (mysql_timestamp((max(c2))::timestamp without time zone)), (mysql_timestamp(max(c3))), (mysql_timestamp(max(c3), '11:12:12.112233'::time without time zone)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_timestamp(max(c2)), public.mysql_timestamp(max(c3)), public.mysql_timestamp(max(c3), '11:12:12.112233'::time without time zone), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(6 rows)

-- select mysql_timestamp with non pushdown func and explicit constant (result)
--Testcase 2573:
SELECT mysql_timestamp(max(c2)), mysql_timestamp(max(c3)), mysql_timestamp(max(c3), '11:12:12.112233'::time), pi(), 4.1 FROM time_tbl;
   mysql_timestamp   |   mysql_timestamp   |      mysql_timestamp       |        pi         | ?column? 
---------------------+---------------------+----------------------------+-------------------+----------
 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 12:12:11.112233 | 3.141592653589793 |      4.1
(1 row)

-- select mysql_timestamp with order by (explain)
--Testcase 2574:
EXPLAIN VERBOSE
SELECT id, mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl order by mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1);
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2980.96..2989.49 rows=3413 width=28)
   Output: id, (mysql_timestamp((c2)::timestamp without time zone)), (mysql_timestamp(c3)), (mysql_timestamp(c3, c1))
   Sort Key: (mysql_timestamp((time_tbl.c2)::timestamp without time zone)), (mysql_timestamp(time_tbl.c3)), (mysql_timestamp(time_tbl.c3, time_tbl.c1))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=28)
         Output: id, (mysql_timestamp((c2)::timestamp without time zone)), (mysql_timestamp(c3)), (mysql_timestamp(c3, c1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.mysql_timestamp(c2), public.mysql_timestamp(c3), public.mysql_timestamp(c3, c1) FROM public.time_tblmysql
(7 rows)

-- select mysql_timestamp with order by (result)
--Testcase 2575:
SELECT id, mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl order by mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1);
 id |   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
----+---------------------+---------------------+---------------------
  1 | 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
  0 | 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
  2 | 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
  3 | 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
  4 | 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- select mysql_timestamp with order by index (result)
--Testcase 2576:
SELECT id, mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl order by 4,3,2,1;
 id |   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
----+---------------------+---------------------+---------------------
  0 | 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
  2 | 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
  1 | 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
  4 | 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
  3 | 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
(5 rows)

-- select mysql_timestamp with order by index (result)
--Testcase 2577:
SELECT id, mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl order by 1,2,3,4;
 id |   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
----+---------------------+---------------------+---------------------
  0 | 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
  1 | 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
  2 | 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
  3 | 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
  4 | 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- select mysql_timestamp with group by (explain)
--Testcase 2578:
EXPLAIN VERBOSE
SELECT max(c3), mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl group by mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1);
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (max(c3)), (mysql_timestamp((c2)::timestamp without time zone)), (mysql_timestamp(c3)), (mysql_timestamp(c3, c1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.mysql_timestamp(c2), public.mysql_timestamp(c3), public.mysql_timestamp(c3, c1) FROM public.time_tblmysql GROUP BY 2, 3, 4
(6 rows)

-- select mysql_timestamp with group by (result)
--Testcase 2579:
SELECT max(c3), mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl group by mysql_timestamp('2080-01-01 12:00:00'::date), c1, c2, c3;
         max         |   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
---------------------+---------------------+---------------------+---------------------
 2021-01-03 12:10:30 | 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
 2021-01-04 23:12:13 | 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
 2021-01-05 11:12:12 | 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
 2021-01-06 16:00:00 | 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
 2021-01-07 00:59:59 | 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- select mysql_timestamp with group by index (result)
--Testcase 2580:
SELECT id, mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl group by 4,3,2,1;
 id |   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
----+---------------------+---------------------+---------------------
  0 | 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
  1 | 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
  2 | 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
  3 | 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
  4 | 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- select mysql_timestamp with group by index (result)
--Testcase 2581:
SELECT id, mysql_timestamp(c2), mysql_timestamp(c3), mysql_timestamp(c3, c1) FROM time_tbl group by 1,2,3,4;
 id |   mysql_timestamp   |   mysql_timestamp   |   mysql_timestamp   
----+---------------------+---------------------+---------------------
  0 | 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
  1 | 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
  2 | 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
  3 | 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
  4 | 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- select mysql_timestamp with group by index having (result)
--Testcase 2582:
SELECT id, mysql_timestamp(c2), c2 FROM time_tbl group by 3, 2, 1 HAVING mysql_timestamp(c2) > '2019-01-01'::date;
 id |   mysql_timestamp   |     c2     
----+---------------------+------------
  0 | 2021-01-02 00:00:00 | 2021-01-02
  1 | 2021-01-01 00:00:00 | 2021-01-01
  2 | 2021-01-10 00:00:00 | 2021-01-10
  3 | 2021-01-15 00:00:00 | 2021-01-15
  4 | 2021-01-29 00:00:00 | 2021-01-29
(5 rows)

-- select mysql_timestamp with group by index having (result)
--Testcase 2583:
SELECT id, mysql_timestamp(c2), c2 FROM time_tbl group by 1, 2, 3 HAVING mysql_timestamp(c2) > '2019-01-01'::date;
 id |   mysql_timestamp   |     c2     
----+---------------------+------------
  0 | 2021-01-02 00:00:00 | 2021-01-02
  1 | 2021-01-01 00:00:00 | 2021-01-01
  2 | 2021-01-10 00:00:00 | 2021-01-10
  3 | 2021-01-15 00:00:00 | 2021-01-15
  4 | 2021-01-29 00:00:00 | 2021-01-29
(5 rows)

-- select mysql_timestamp and as
--Testcase 2584:
SELECT mysql_timestamp(c2) as mysql_timestamp1, mysql_timestamp(c3) as mysql_timestamp2,  mysql_timestamp(c3, c1) as mysql_timestamp3 FROM time_tbl;
  mysql_timestamp1   |  mysql_timestamp2   |  mysql_timestamp3   
---------------------+---------------------+---------------------
 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 2021-01-04 00:21:00
 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 2021-01-05 22:24:26
 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 2021-01-05 22:24:24
 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 2021-01-07 08:00:00
 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 2021-01-07 01:59:58
(5 rows)

-- TIMEDIFF()
-- select timediff (stub function, explain)
--Testcase 2585:
EXPLAIN VERBOSE
SELECT timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                        QUERY PLAN                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=32)
   Output: (timediff(c1, '12:12:12.051555'::time without time zone)), (timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timediff(c1, '12:12:12.051555'::time without time zone), public.timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select timediff (stub function, result)
--Testcase 2586:
SELECT timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl;
               timediff                |          timediff           
---------------------------------------+-----------------------------
 @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
 @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
 @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
 @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
 @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
(5 rows)

-- select timediff (stub function, not pushdown constraints, explain)
--Testcase 2587:
EXPLAIN VERBOSE
SELECT timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.69 rows=17 width=32)
   Output: (timediff(c1, '12:12:12.051555'::time without time zone)), (timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timediff(c1, '12:12:12.051555'::time without time zone), public.timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select timediff (stub function, not pushdown constraints, result)
--Testcase 2588:
SELECT timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
         timediff         |          timediff           
--------------------------+-----------------------------
 @ 11 hours 0.948445 secs | @ 838 hours 59 mins 59 secs
(1 row)

-- select timediff (stub function, pushdown constraints, explain)
--Testcase 2589:
EXPLAIN VERBOSE
SELECT timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.58 rows=3396 width=32)
   Output: (timediff(c1, '12:12:12.051555'::time without time zone)), (timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timediff(c1, '12:12:12.051555'::time without time zone), public.timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select timediff (stub function, pushdown constraints, result)
--Testcase 2590:
SELECT timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
               timediff                |          timediff           
---------------------------------------+-----------------------------
 @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
 @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
 @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
 @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
 @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
(5 rows)

-- select timediff (stub function, timediff in constraints, explain)
--Testcase 2591:
EXPLAIN VERBOSE
SELECT timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl WHERE timediff(c1, '23:11:59.123456'::time) > '1 day 01:00:00'::interval;
                                                                                                                                           QUERY PLAN                                                                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1597.67 rows=1138 width=32)
   Output: (timediff(c1, '12:12:12.051555'::time without time zone)), (timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.timediff(c1, '12:12:12.051555'::time without time zone), public.timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.timediff(c1, '23:11:59.123456'::time without time zone) > '1 day 01:00:00'::interval))
(4 rows)

-- select timediff (stub function, timediff in constraints, result)
--Testcase 2592:
SELECT timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl WHERE timediff(c1, '23:11:59.123456'::time) > '1 day 01:00:00'::interval;
 timediff | timediff 
----------+----------
(0 rows)

-- select timediff with agg (pushdown, explain)
--Testcase 2593:
EXPLAIN VERBOSE
SELECT max(c3), timediff('12:12:12.051555'::time, max(c1)), timediff('1997-01-01 12:00:00'::timestamp, max(c3)) FROM time_tbl;
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (timediff('12:12:12.051555'::time without time zone, max(c1))), (timediff('1997-01-01 12:00:00'::timestamp without time zone, max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.timediff('12:12:12.051555'::time without time zone, max(c1)), public.timediff('1997-01-01 12:00:00'::timestamp without time zone, max(c3)) FROM public.time_tblmysql
(6 rows)

-- select timediff as nest function with agg (pushdown, result)
--Testcase 2594:
SELECT max(c3), timediff('12:12:12.051555'::time, max(c1)), timediff('1997-01-01 12:00:00'::timestamp, max(c3)) FROM time_tbl;
         max         |           timediff           |            timediff             
---------------------+------------------------------+---------------------------------
 2021-01-07 00:59:59 | @ 11 hours 0.948445 secs ago | @ 838 hours 59 mins 59 secs ago
(1 row)

-- select timediff with non pushdown func and explicit constant (explain)
--Testcase 2595:
EXPLAIN VERBOSE
SELECT timediff('12:12:12.051555'::time, max(c1)), timediff('1997-01-01 12:00:00'::timestamp, max(c3)), pi(), 4.1 FROM time_tbl;
                                                                                                                  QUERY PLAN                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (timediff('12:12:12.051555'::time without time zone, max(c1))), (timediff('1997-01-01 12:00:00'::timestamp without time zone, max(c3))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.timediff('12:12:12.051555'::time without time zone, max(c1)), public.timediff('1997-01-01 12:00:00'::timestamp without time zone, max(c3)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(6 rows)

-- select timediff with non pushdown func and explicit constant (result)
--Testcase 2596:
SELECT timediff('12:12:12.051555'::time, max(c1)), timediff('1997-01-01 12:00:00'::timestamp, max(c3)), pi(), 4.1 FROM time_tbl;
           timediff           |            timediff             |        pi         | ?column? 
------------------------------+---------------------------------+-------------------+----------
 @ 11 hours 0.948445 secs ago | @ 838 hours 59 mins 59 secs ago | 3.141592653589793 |      4.1
(1 row)

-- select timediff with order by (explain)
--Testcase 2597:
EXPLAIN VERBOSE
SELECT id, timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl order by timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp);
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=36)
   Output: id, (timediff(c1, '12:12:12.051555'::time without time zone)), (timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone))
   Sort Key: (timediff(time_tbl.c1, '12:12:12.051555'::time without time zone)), (timediff(time_tbl.c3, '1997-01-01 12:00:00'::timestamp without time zone))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=36)
         Output: id, (timediff(c1, '12:12:12.051555'::time without time zone)), (timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.timediff(c1, '12:12:12.051555'::time without time zone), public.timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(7 rows)

-- select timediff with order by (result)
--Testcase 2598:
SELECT id, timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl order by timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp);
 id |               timediff                |          timediff           
----+---------------------------------------+-----------------------------
  4 | @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
  2 | @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
  0 | @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
  3 | @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
  1 | @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
(5 rows)

-- select timediff with order by index (result)
--Testcase 2599:
SELECT id, timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl order by 3,2,1;
 id |               timediff                |          timediff           
----+---------------------------------------+-----------------------------
  4 | @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
  2 | @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
  0 | @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
  3 | @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
  1 | @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
(5 rows)

-- select timediff with order by index (result)
--Testcase 2600:
SELECT id, timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl order by 1,2,3;
 id |               timediff                |          timediff           
----+---------------------------------------+-----------------------------
  0 | @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
  1 | @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
  2 | @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
  3 | @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
  4 | @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
(5 rows)

-- select timediff with group by (explain)
--Testcase 2601:
EXPLAIN VERBOSE
SELECT max(c3), timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl group by timediff('2080-01-01 12:00:00'::timestamp, c3), c1, c3;
                                                                                                                                             QUERY PLAN                                                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (max(c3)), (timediff(c1, '12:12:12.051555'::time without time zone)), (timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone)), (timediff('2080-01-01 12:00:00'::timestamp without time zone, c3)), c1, c3
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.timediff(c1, '12:12:12.051555'::time without time zone), public.timediff(c3, '1997-01-01 12:00:00'::timestamp without time zone), public.timediff('2080-01-01 12:00:00'::timestamp without time zone, c3), c1, c3 FROM public.time_tblmysql GROUP BY 4, 5, 6
(6 rows)

-- select timediff with group by (result)
--Testcase 2602:
SELECT max(c3), timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl group by timediff('2080-01-01 12:00:00'::timestamp, c3), c1, c3;
         max         |               timediff                |          timediff           
---------------------+---------------------------------------+-----------------------------
 2021-01-03 12:10:30 | @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
 2021-01-04 23:12:13 | @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
 2021-01-05 11:12:12 | @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
 2021-01-06 16:00:00 | @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
 2021-01-07 00:59:59 | @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
(5 rows)

-- select timediff with group by index (result)
--Testcase 2603:
SELECT id, timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl group by 3,2,1;
 id |               timediff                |          timediff           
----+---------------------------------------+-----------------------------
  0 | @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
  1 | @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
  2 | @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
  3 | @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
  4 | @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
(5 rows)

-- select timediff with group by index (result)
--Testcase 2604:
SELECT id, timediff(c1, '12:12:12.051555'::time), timediff(c3, '1997-01-01 12:00:00'::timestamp) FROM time_tbl group by 1,2,3;
 id |               timediff                |          timediff           
----+---------------------------------------+-----------------------------
  0 | @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
  1 | @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
  2 | @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
  3 | @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
  4 | @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
(5 rows)

-- select timediff with group by index having (result)
--Testcase 2605:
SELECT id, timediff(c1, '12:12:12.051555'::time), c1 FROM time_tbl group by 3, 2, 1 HAVING timediff(c1, '12:12:12.051555'::time) < '1 days'::interval;
 id |               timediff                |    c1    
----+---------------------------------------+----------
  0 | @ 1 min 42.051555 secs ago            | 12:10:30
  2 | @ 1 hour 0.051555 secs ago            | 11:12:12
  3 | @ 3 hours 47 mins 47.948445 secs      | 16:00:00
  4 | @ 11 hours 12 mins 13.051555 secs ago | 00:59:59
(4 rows)

-- select timediff with group by index having (result)
--Testcase 2606:
SELECT id, timediff(c1, '12:12:12.051555'::time), c1 FROM time_tbl group by 1, 2, 3 HAVING timediff(c1, '12:12:12.051555'::time) < '1 days'::interval;
 id |               timediff                |    c1    
----+---------------------------------------+----------
  0 | @ 1 min 42.051555 secs ago            | 12:10:30
  2 | @ 1 hour 0.051555 secs ago            | 11:12:12
  3 | @ 3 hours 47 mins 47.948445 secs      | 16:00:00
  4 | @ 11 hours 12 mins 13.051555 secs ago | 00:59:59
(4 rows)

-- select timediff and as
--Testcase 2607:
SELECT timediff(c1, '12:12:12.051555'::time) as timediff1, timediff(c3, '1997-01-01 12:00:00'::timestamp) as timediff2 FROM time_tbl;
               timediff1               |          timediff2          
---------------------------------------+-----------------------------
 @ 1 min 42.051555 secs ago            | @ 838 hours 59 mins 59 secs
 @ 11 hours 0.948445 secs              | @ 838 hours 59 mins 59 secs
 @ 1 hour 0.051555 secs ago            | @ 838 hours 59 mins 59 secs
 @ 3 hours 47 mins 47.948445 secs      | @ 838 hours 59 mins 59 secs
 @ 11 hours 12 mins 13.051555 secs ago | @ 838 hours 59 mins 59 secs
(5 rows)

-- TIME_TO_SEC()
-- select time_to_sec (stub function, explain)
--Testcase 2608:
EXPLAIN VERBOSE
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl;
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3625.39 rows=3413 width=12)
   Output: (time_to_sec(c1)), (time_to_sec(mysql_time(c3))), (time_to_sec('01:02:03.040505'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_to_sec(c1), public.time_to_sec(public.mysql_time(c3)), public.time_to_sec('01:02:03.040505'::time without time zone) FROM public.time_tblmysql
(4 rows)

-- select time_to_sec (stub function, result)
--Testcase 2609:
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl;
 time_to_sec | time_to_sec | time_to_sec 
-------------+-------------+-------------
       43830 |       43830 |        3723
       83533 |       83533 |        3723
       40332 |       40332 |        3723
       57600 |       57600 |        3723
        3599 |        3599 |        3723
(5 rows)

-- select time_to_sec (stub function, not pushdown constraints, explain)
--Testcase 2610:
EXPLAIN VERBOSE
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl WHERE to_hex(id) = '2';
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..246.19 rows=17 width=12)
   Output: (time_to_sec(c1)), (time_to_sec(mysql_time(c3))), (time_to_sec('01:02:03.040505'::time without time zone))
   Filter: (to_hex(time_tbl.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_to_sec(c1), public.time_to_sec(public.mysql_time(c3)), public.time_to_sec('01:02:03.040505'::time without time zone), id FROM public.time_tblmysql
(5 rows)

-- select time_to_sec (stub function, not pushdown constraints, result)
--Testcase 2611:
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl WHERE to_hex(id) = '2';
 time_to_sec | time_to_sec | time_to_sec 
-------------+-------------+-------------
       40332 |       40332 |        3723
(1 row)

-- select time_to_sec (stub function, pushdown constraints, explain)
--Testcase 2612:
EXPLAIN VERBOSE
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl WHERE id != 200;
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3616.58 rows=3396 width=12)
   Output: (time_to_sec(c1)), (time_to_sec(mysql_time(c3))), (time_to_sec('01:02:03.040505'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_to_sec(c1), public.time_to_sec(public.mysql_time(c3)), public.time_to_sec('01:02:03.040505'::time without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select time_to_sec (stub function, pushdown constraints, result)
--Testcase 2613:
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl WHERE id != 200;
 time_to_sec | time_to_sec | time_to_sec 
-------------+-------------+-------------
       43830 |       43830 |        3723
       83533 |       83533 |        3723
       40332 |       40332 |        3723
       57600 |       57600 |        3723
        3599 |        3599 |        3723
(5 rows)

-- select time_to_sec (stub function, time_to_sec in constraints, explain)
--Testcase 2614:
EXPLAIN VERBOSE
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl WHERE time_to_sec(c1) != 12345;
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4469.83 rows=3396 width=12)
   Output: (time_to_sec(c1)), (time_to_sec(mysql_time(c3))), (time_to_sec('01:02:03.040505'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_to_sec(c1), public.time_to_sec(public.mysql_time(c3)), public.time_to_sec('01:02:03.040505'::time without time zone) FROM public.time_tblmysql WHERE ((public.time_to_sec(c1) <> 12345))
(4 rows)

-- select time_to_sec (stub function, time_to_sec in constraints, result)
--Testcase 2615:
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl WHERE time_to_sec(c1) != 12345;
 time_to_sec | time_to_sec | time_to_sec 
-------------+-------------+-------------
       43830 |       43830 |        3723
       83533 |       83533 |        3723
       40332 |       40332 |        3723
       57600 |       57600 |        3723
        3599 |        3599 |        3723
(5 rows)

-- select time_to_sec (stub function, time_to_sec in constraints, explain)
--Testcase 2616:
EXPLAIN VERBOSE
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl WHERE time_to_sec('06:05:04.030201'::time) > 1;
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2166.67 rows=1138 width=12)
   Output: (time_to_sec(c1)), (time_to_sec(mysql_time(c3))), (time_to_sec('01:02:03.040505'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_to_sec(c1), public.time_to_sec(public.mysql_time(c3)), public.time_to_sec('01:02:03.040505'::time without time zone) FROM public.time_tblmysql WHERE ((public.time_to_sec('06:05:04.030201'::time without time zone) > 1))
(4 rows)

-- select time_to_sec (stub function, time_to_sec in constraints, result)
--Testcase 2617:
SELECT time_to_sec(c1), time_to_sec(mysql_time(c3)), time_to_sec('01:02:03.040505'::time) FROM time_tbl WHERE time_to_sec('06:05:04.030201'::time) > 1;
 time_to_sec | time_to_sec | time_to_sec 
-------------+-------------+-------------
       43830 |       43830 |        3723
       83533 |       83533 |        3723
       40332 |       40332 |        3723
       57600 |       57600 |        3723
        3599 |        3599 |        3723
(5 rows)

-- select time_to_sec with agg (pushdown, explain)
--Testcase 2618:
EXPLAIN VERBOSE
SELECT max(c3), time_to_sec(max(c1)) FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (time_to_sec(max(c1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.time_to_sec(max(c1)) FROM public.time_tblmysql
(6 rows)

-- select time_to_sec as nest function with agg (pushdown, result)
--Testcase 2619:
SELECT max(c3), time_to_sec(max(c1)) FROM time_tbl;
         max         | time_to_sec 
---------------------+-------------
 2021-01-07 00:59:59 |       83533
(1 row)

-- select time_to_sec with non pushdown func and explicit constant (explain)
--Testcase 2620:
EXPLAIN VERBOSE
SELECT time_to_sec(mysql_time(c3)), pi(), 4.1 FROM time_tbl;
                                                              QUERY PLAN                                                              
--------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (time_to_sec(mysql_time(c3))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_to_sec(public.mysql_time(c3)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select time_to_sec with non pushdown func and explicit constant (result)
--Testcase 2621:
SELECT time_to_sec(mysql_time(c3)), pi(), 4.1 FROM time_tbl;
 time_to_sec |        pi         | ?column? 
-------------+-------------------+----------
       43830 | 3.141592653589793 |      4.1
       83533 | 3.141592653589793 |      4.1
       40332 | 3.141592653589793 |      4.1
       57600 | 3.141592653589793 |      4.1
        3599 | 3.141592653589793 |      4.1
(5 rows)

-- select time_to_sec with order by (explain)
--Testcase 2622:
EXPLAIN VERBOSE
SELECT id, time_to_sec(c1) FROM time_tbl order by time_to_sec(c1);
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=8)
   Output: id, (time_to_sec(c1))
   Sort Key: (time_to_sec(time_tbl.c1))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
         Output: id, (time_to_sec(c1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.time_to_sec(c1) FROM public.time_tblmysql
(7 rows)

-- select time_to_sec with order by (result)
--Testcase 2623:
SELECT id, time_to_sec(c1) FROM time_tbl order by time_to_sec(c1);
 id | time_to_sec 
----+-------------
  4 |        3599
  2 |       40332
  0 |       43830
  3 |       57600
  1 |       83533
(5 rows)

-- select time_to_sec with order by index (result)
--Testcase 2624:
SELECT id, time_to_sec(c1) FROM time_tbl order by 2,1;
 id | time_to_sec 
----+-------------
  4 |        3599
  2 |       40332
  0 |       43830
  3 |       57600
  1 |       83533
(5 rows)

-- select time_to_sec with order by index (result)
--Testcase 2625:
SELECT id, time_to_sec(c1) FROM time_tbl order by 1,2;
 id | time_to_sec 
----+-------------
  0 |       43830
  1 |       83533
  2 |       40332
  3 |       57600
  4 |        3599
(5 rows)

-- select time_to_sec with group by (explain)
--Testcase 2626:
EXPLAIN VERBOSE
SELECT max(c3), time_to_sec(c1) FROM time_tbl group by c1, time_to_sec('06:05:04.030201'::time);
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (time_to_sec(c1)), c1, (time_to_sec('06:05:04.030201'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.time_to_sec(c1), c1, public.time_to_sec('06:05:04.030201'::time without time zone) FROM public.time_tblmysql GROUP BY 3, 4
(6 rows)

-- select time_to_sec with group by (result)
--Testcase 2627:
SELECT max(c3), time_to_sec(c1) FROM time_tbl group by c1, time_to_sec('06:05:04.030201'::time);
         max         | time_to_sec 
---------------------+-------------
 2021-01-03 12:10:30 |       43830
 2021-01-04 23:12:13 |       83533
 2021-01-05 11:12:12 |       40332
 2021-01-06 16:00:00 |       57600
 2021-01-07 00:59:59 |        3599
(5 rows)

-- select time_to_sec with group by index (result)
--Testcase 2628:
SELECT id, time_to_sec(c1) FROM time_tbl group by 2,1;
 id | time_to_sec 
----+-------------
  0 |       43830
  1 |       83533
  2 |       40332
  3 |       57600
  4 |        3599
(5 rows)

-- select time_to_sec with group by index (result)
--Testcase 2629:
SELECT id, time_to_sec(c1) FROM time_tbl group by 1,2;
 id | time_to_sec 
----+-------------
  0 |       43830
  1 |       83533
  2 |       40332
  3 |       57600
  4 |        3599
(5 rows)

-- select time_to_sec with group by having (explain)
--Testcase 2630:
EXPLAIN VERBOSE
SELECT max(c3), time_to_sec(c1), c1 FROM time_tbl group by time_to_sec(c1), c3, c1 HAVING time_to_sec(c1) > 100;
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=28)
   Output: (max(c3)), (time_to_sec(c1)), c1, c3
   Filter: ((time_to_sec(time_tbl.c1)) > 100)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.time_to_sec(c1), c1, c3 FROM public.time_tblmysql GROUP BY 2, 4, 3 HAVING ((public.time_to_sec(c1) > 100))
(7 rows)

-- select time_to_sec with group by having (result)
--Testcase 2631:
SELECT max(c3), time_to_sec(c1), c1 FROM time_tbl group by time_to_sec(c1), c3, c1 HAVING time_to_sec(c1) > 100;
         max         | time_to_sec |    c1    
---------------------+-------------+----------
 2021-01-03 12:10:30 |       43830 | 12:10:30
 2021-01-04 23:12:13 |       83533 | 23:12:13
 2021-01-05 11:12:12 |       40332 | 11:12:12
 2021-01-06 16:00:00 |       57600 | 16:00:00
 2021-01-07 00:59:59 |        3599 | 00:59:59
(5 rows)

-- select time_to_sec with group by index having (result)
--Testcase 2632:
SELECT id, time_to_sec(c1), c1 FROM time_tbl group by 3, 2, 1 HAVING time_to_sec(c1) > 100;
 id | time_to_sec |    c1    
----+-------------+----------
  0 |       43830 | 12:10:30
  1 |       83533 | 23:12:13
  2 |       40332 | 11:12:12
  3 |       57600 | 16:00:00
  4 |        3599 | 00:59:59
(5 rows)

-- select time_to_sec with group by index having (result)
--Testcase 2633:
SELECT id, time_to_sec(c1), c1 FROM time_tbl group by 1, 2, 3 HAVING time_to_sec(c1) > 100;
 id | time_to_sec |    c1    
----+-------------+----------
  0 |       43830 | 12:10:30
  1 |       83533 | 23:12:13
  2 |       40332 | 11:12:12
  3 |       57600 | 16:00:00
  4 |        3599 | 00:59:59
(5 rows)

-- select time_to_sec and as
--Testcase 2634:
SELECT time_to_sec(c1) as time_to_sec1 FROM time_tbl;
 time_to_sec1 
--------------
        43830
        83533
        40332
        57600
         3599
(5 rows)

-- TIME_FORMAT()
-- select time_format (stub function, explain)
--Testcase 2635:
EXPLAIN VERBOSE
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl;
                                                                                                                        QUERY PLAN                                                                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3625.39 rows=3413 width=96)
   Output: (time_format(c1, '%H %k %h %I %l'::text)), (time_format(mysql_time(c3), '%H %k %h %I %l'::text)), (time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_format(c1, '%H %k %h %I %l'::text), public.time_format(public.mysql_time(c3), '%H %k %h %I %l'::text), public.time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text) FROM public.time_tblmysql
(4 rows)

-- select time_format (stub function, result)
--Testcase 2636:
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl;
  time_format   |  time_format   | time_format  
----------------+----------------+--------------
 12 12 12 12 12 | 12 12 12 12 12 | 01 1 01 01 1
 23 23 11 11 11 | 23 23 11 11 11 | 01 1 01 01 1
 11 11 11 11 11 | 11 11 11 11 11 | 01 1 01 01 1
 16 16 04 04 4  | 16 16 04 04 4  | 01 1 01 01 1
 00 0 12 12 12  | 00 0 12 12 12  | 01 1 01 01 1
(5 rows)

-- select time_format (stub function, not pushdown constraints, explain)
--Testcase 2637:
EXPLAIN VERBOSE
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl WHERE to_hex(id) = '2';
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..246.19 rows=17 width=96)
   Output: (time_format(c1, '%H %k %h %I %l'::text)), (time_format(mysql_time(c3), '%H %k %h %I %l'::text)), (time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text))
   Filter: (to_hex(time_tbl.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_format(c1, '%H %k %h %I %l'::text), public.time_format(public.mysql_time(c3), '%H %k %h %I %l'::text), public.time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text), id FROM public.time_tblmysql
(5 rows)

-- select time_format (stub function, not pushdown constraints, result)
--Testcase 2638:
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl WHERE to_hex(id) = '2';
  time_format   |  time_format   | time_format  
----------------+----------------+--------------
 11 11 11 11 11 | 11 11 11 11 11 | 01 1 01 01 1
(1 row)

-- select time_format (stub function, pushdown constraints, explain)
--Testcase 2639:
EXPLAIN VERBOSE
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl WHERE id != 200;
                                                                                                                                  QUERY PLAN                                                                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3616.58 rows=3396 width=96)
   Output: (time_format(c1, '%H %k %h %I %l'::text)), (time_format(mysql_time(c3), '%H %k %h %I %l'::text)), (time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_format(c1, '%H %k %h %I %l'::text), public.time_format(public.mysql_time(c3), '%H %k %h %I %l'::text), public.time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select time_format (stub function, pushdown constraints, result)
--Testcase 2640:
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl WHERE id != 200;
  time_format   |  time_format   | time_format  
----------------+----------------+--------------
 12 12 12 12 12 | 12 12 12 12 12 | 01 1 01 01 1
 23 23 11 11 11 | 23 23 11 11 11 | 01 1 01 01 1
 11 11 11 11 11 | 11 11 11 11 11 | 01 1 01 01 1
 16 16 04 04 4  | 16 16 04 04 4  | 01 1 01 01 1
 00 0 12 12 12  | 00 0 12 12 12  | 01 1 01 01 1
(5 rows)

-- select time_format (stub function, time_format in constraints, explain)
--Testcase 2641:
EXPLAIN VERBOSE
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl WHERE time_format(c1, '%H %k %h %I %l') != '100 100 04 04 4';
                                                                                                                                                                  QUERY PLAN                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4469.83 rows=3396 width=96)
   Output: (time_format(c1, '%H %k %h %I %l'::text)), (time_format(mysql_time(c3), '%H %k %h %I %l'::text)), (time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_format(c1, '%H %k %h %I %l'::text), public.time_format(public.mysql_time(c3), '%H %k %h %I %l'::text), public.time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text) FROM public.time_tblmysql WHERE ((public.time_format(c1, '%H %k %h %I %l'::text) <> '100 100 04 04 4'::text))
(4 rows)

-- select time_format (stub function, time_format in constraints, result)
--Testcase 2642:
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl WHERE time_format(c1, '%H %k %h %I %l') != '100 100 04 04 4';
  time_format   |  time_format   | time_format  
----------------+----------------+--------------
 12 12 12 12 12 | 12 12 12 12 12 | 01 1 01 01 1
 23 23 11 11 11 | 23 23 11 11 11 | 01 1 01 01 1
 11 11 11 11 11 | 11 11 11 11 11 | 01 1 01 01 1
 16 16 04 04 4  | 16 16 04 04 4  | 01 1 01 01 1
 00 0 12 12 12  | 00 0 12 12 12  | 01 1 01 01 1
(5 rows)

-- select time_format (stub function, time_format in constraints, explain)
--Testcase 2643:
EXPLAIN VERBOSE
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl WHERE time_format(c1, '%H %k %h %I %l') = '12 12 12 12 12';
                                                                                                                                                                 QUERY PLAN                                                                                                                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1023.25 rows=17 width=96)
   Output: (time_format(c1, '%H %k %h %I %l'::text)), (time_format(mysql_time(c3), '%H %k %h %I %l'::text)), (time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_format(c1, '%H %k %h %I %l'::text), public.time_format(public.mysql_time(c3), '%H %k %h %I %l'::text), public.time_format('01:02:03.040505'::time without time zone, '%H %k %h %I %l'::text) FROM public.time_tblmysql WHERE ((public.time_format(c1, '%H %k %h %I %l'::text) = '12 12 12 12 12'::text))
(4 rows)

-- select time_format (stub function, time_format in constraints, result)
--Testcase 2644:
SELECT time_format(c1, '%H %k %h %I %l'), time_format(mysql_time(c3), '%H %k %h %I %l'), time_format('01:02:03.040505'::time, '%H %k %h %I %l') FROM time_tbl WHERE time_format(c1, '%H %k %h %I %l') = '12 12 12 12 12';
  time_format   |  time_format   | time_format  
----------------+----------------+--------------
 12 12 12 12 12 | 12 12 12 12 12 | 01 1 01 01 1
(1 row)

-- select time_format with agg (pushdown, explain)
--Testcase 2645:
EXPLAIN VERBOSE
SELECT max(c3), time_format(max(c1), '%H %k %h %I %l') FROM time_tbl;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (time_format(max(c1), '%H %k %h %I %l'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.time_format(max(c1), '%H %k %h %I %l'::text) FROM public.time_tblmysql
(6 rows)

-- select time_format as nest function with agg (pushdown, result)
--Testcase 2646:
SELECT max(c3), time_format(max(c1), '%H %k %h %I %l') FROM time_tbl;
         max         |  time_format   
---------------------+----------------
 2021-01-07 00:59:59 | 23 23 11 11 11
(1 row)

-- select time_format with non pushdown func and explicit constant (explain)
--Testcase 2647:
EXPLAIN VERBOSE
SELECT time_format(mysql_time(c3), '%H %k %h %I %l'), pi(), 4.1 FROM time_tbl;
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=72)
   Output: (time_format(mysql_time(c3), '%H %k %h %I %l'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.time_format(public.mysql_time(c3), '%H %k %h %I %l'::text), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select time_format with non pushdown func and explicit constant (result)
--Testcase 2648:
SELECT time_format(mysql_time(c3), '%H %k %h %I %l'), pi(), 4.1 FROM time_tbl;
  time_format   |        pi         | ?column? 
----------------+-------------------+----------
 12 12 12 12 12 | 3.141592653589793 |      4.1
 23 23 11 11 11 | 3.141592653589793 |      4.1
 11 11 11 11 11 | 3.141592653589793 |      4.1
 16 16 04 04 4  | 3.141592653589793 |      4.1
 00 0 12 12 12  | 3.141592653589793 |      4.1
(5 rows)

-- select time_format with order by (explain)
--Testcase 2649:
EXPLAIN VERBOSE
SELECT id, time_format(c1, '%H %k %h %I %l') FROM time_tbl order by time_format(c1, '%H %k %h %I %l');
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=36)
   Output: id, (time_format(c1, '%H %k %h %I %l'::text))
   Sort Key: (time_format(time_tbl.c1, '%H %k %h %I %l'::text))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=36)
         Output: id, (time_format(c1, '%H %k %h %I %l'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.time_format(c1, '%H %k %h %I %l'::text) FROM public.time_tblmysql
(7 rows)

-- select time_format with order by (result)
--Testcase 2650:
SELECT id, time_format(c1, '%H %k %h %I %l') FROM time_tbl order by time_format(c1, '%H %k %h %I %l');
 id |  time_format   
----+----------------
  4 | 00 0 12 12 12
  2 | 11 11 11 11 11
  0 | 12 12 12 12 12
  3 | 16 16 04 04 4
  1 | 23 23 11 11 11
(5 rows)

-- select time_format with order by index (result)
--Testcase 2651:
SELECT id, time_format(c1, '%H %k %h %I %l') FROM time_tbl order by 2,1;
 id |  time_format   
----+----------------
  4 | 00 0 12 12 12
  2 | 11 11 11 11 11
  0 | 12 12 12 12 12
  3 | 16 16 04 04 4
  1 | 23 23 11 11 11
(5 rows)

-- select time_format with order by index (result)
--Testcase 2652:
SELECT id, time_format(c1, '%H %k %h %I %l') FROM time_tbl order by 1,2;
 id |  time_format   
----+----------------
  0 | 12 12 12 12 12
  1 | 23 23 11 11 11
  2 | 11 11 11 11 11
  3 | 16 16 04 04 4
  4 | 00 0 12 12 12
(5 rows)

-- select time_format with group by (explain)
--Testcase 2653:
EXPLAIN VERBOSE
SELECT max(c3), time_format(c1, '%H %k %h %I %l') FROM time_tbl group by c1, time_format('06:05:04.030201'::time, '%H %k %h %I %l');
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=80)
   Output: (max(c3)), (time_format(c1, '%H %k %h %I %l'::text)), c1, (time_format('06:05:04.030201'::time without time zone, '%H %k %h %I %l'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.time_format(c1, '%H %k %h %I %l'::text), c1, public.time_format('06:05:04.030201'::time without time zone, '%H %k %h %I %l'::text) FROM public.time_tblmysql GROUP BY 3, 4
(6 rows)

-- select time_format with group by (result)
--Testcase 2654:
SELECT max(c3), time_format(c1, '%H %k %h %I %l') FROM time_tbl group by c1, time_format('06:05:04.030201'::time, '%H %k %h %I %l');
         max         |  time_format   
---------------------+----------------
 2021-01-03 12:10:30 | 12 12 12 12 12
 2021-01-04 23:12:13 | 23 23 11 11 11
 2021-01-05 11:12:12 | 11 11 11 11 11
 2021-01-06 16:00:00 | 16 16 04 04 4
 2021-01-07 00:59:59 | 00 0 12 12 12
(5 rows)

-- select time_format with group by index (result)
--Testcase 2655:
SELECT id, time_format(c1, '%H %k %h %I %l') FROM time_tbl group by 2,1;
 id |  time_format   
----+----------------
  0 | 12 12 12 12 12
  1 | 23 23 11 11 11
  2 | 11 11 11 11 11
  3 | 16 16 04 04 4
  4 | 00 0 12 12 12
(5 rows)

-- select time_format with group by index (result)
--Testcase 2656:
SELECT id, time_format(c1, '%H %k %h %I %l') FROM time_tbl group by 1,2;
 id |  time_format   
----+----------------
  0 | 12 12 12 12 12
  1 | 23 23 11 11 11
  2 | 11 11 11 11 11
  3 | 16 16 04 04 4
  4 | 00 0 12 12 12
(5 rows)

-- select time_format with group by having (explain)
--Testcase 2657:
EXPLAIN VERBOSE
SELECT max(c3), time_format(c1, '%H %k %h %I %l') FROM time_tbl group by time_format(c1, '%H %k %h %I %l'), c3, c1 HAVING time_format(c1, '%H %k %h %I %l') != '100 100 04 04 4';
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=56)
   Output: (max(c3)), (time_format(c1, '%H %k %h %I %l'::text)), c3, c1
   Filter: ((time_format(time_tbl.c1, '%H %k %h %I %l'::text)) <> '100 100 04 04 4'::text)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.time_format(c1, '%H %k %h %I %l'::text), c3, c1 FROM public.time_tblmysql GROUP BY 2, 3, 4 HAVING ((public.time_format(c1, '%H %k %h %I %l'::text) <> '100 100 04 04 4'::text))
(7 rows)

-- select time_format with group by having (result)
--Testcase 2658:
SELECT max(c3), time_format(c1, '%H %k %h %I %l') FROM time_tbl group by time_format(c1, '%H %k %h %I %l'), c3, c1 HAVING time_format(c1, '%H %k %h %I %l') != '100 100 04 04 4';
         max         |  time_format   
---------------------+----------------
 2021-01-03 12:10:30 | 12 12 12 12 12
 2021-01-04 23:12:13 | 23 23 11 11 11
 2021-01-05 11:12:12 | 11 11 11 11 11
 2021-01-06 16:00:00 | 16 16 04 04 4
 2021-01-07 00:59:59 | 00 0 12 12 12
(5 rows)

-- select time_format with group by index having (result)
--Testcase 2659:
SELECT id, c1, time_format(c1, '%H %k %h %I %l'), c3 FROM time_tbl group by 4, 3, 2, 1 HAVING time_format(c1, '%H %k %h %I %l') != '100 100 04 04 4';
 id |    c1    |  time_format   |         c3          
----+----------+----------------+---------------------
  0 | 12:10:30 | 12 12 12 12 12 | 2021-01-03 12:10:30
  1 | 23:12:13 | 23 23 11 11 11 | 2021-01-04 23:12:13
  2 | 11:12:12 | 11 11 11 11 11 | 2021-01-05 11:12:12
  3 | 16:00:00 | 16 16 04 04 4  | 2021-01-06 16:00:00
  4 | 00:59:59 | 00 0 12 12 12  | 2021-01-07 00:59:59
(5 rows)

-- select time_format with group by index having (result)
--Testcase 2660:
SELECT id, c1, time_format(c1, '%H %k %h %I %l'), c3 FROM time_tbl group by 1, 2, 3, 4 HAVING time_format(c1, '%H %k %h %I %l') != '100 100 04 04 4';
 id |    c1    |  time_format   |         c3          
----+----------+----------------+---------------------
  0 | 12:10:30 | 12 12 12 12 12 | 2021-01-03 12:10:30
  1 | 23:12:13 | 23 23 11 11 11 | 2021-01-04 23:12:13
  2 | 11:12:12 | 11 11 11 11 11 | 2021-01-05 11:12:12
  3 | 16:00:00 | 16 16 04 04 4  | 2021-01-06 16:00:00
  4 | 00:59:59 | 00 0 12 12 12  | 2021-01-07 00:59:59
(5 rows)

-- select time_format and as
--Testcase 2661:
SELECT time_format(c1, '%H %k %h %I %l') as time_format1 FROM time_tbl;
  time_format1  
----------------
 12 12 12 12 12
 23 23 11 11 11
 11 11 11 11 11
 16 16 04 04 4
 00 0 12 12 12
(5 rows)

-- TIME()
-- select mysql_time (stub function, explain)
--Testcase 2662:
EXPLAIN VERBOSE
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00') FROM time_tbl;
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=32)
   Output: (mysql_time(c3)), (mysql_time((c2)::timestamp without time zone)), (mysql_time(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (mysql_time('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_time(c3), public.mysql_time(c2), public.mysql_time(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.mysql_time('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select mysql_time (stub function, result)
--Testcase 2663:
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00') FROM time_tbl;
 mysql_time | mysql_time | mysql_time | mysql_time 
------------+------------+------------+------------
 12:10:30   | 00:00:00   | 23:11:20   | 12:00:00
 23:12:13   | 00:00:00   | 10:13:03   | 12:00:00
 11:12:12   | 00:00:00   | 22:13:02   | 12:00:00
 16:00:00   | 00:00:00   | 03:00:50   | 12:00:00
 00:59:59   | 00:00:00   | 12:00:49   | 12:00:00
(5 rows)

-- select mysql_time (stub function, not pushdown constraints, explain)
--Testcase 2664:
EXPLAIN VERBOSE
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00') FROM time_tbl WHERE to_hex(id) = '0';
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=32)
   Output: (mysql_time(c3)), (mysql_time((c2)::timestamp without time zone)), (mysql_time(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (mysql_time('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_time(c3), public.mysql_time(c2), public.mysql_time(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.mysql_time('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select mysql_time (stub function, not pushdown constraints, result)
--Testcase 2665:
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00') FROM time_tbl WHERE to_hex(id) = '0';
 mysql_time | mysql_time | mysql_time | mysql_time 
------------+------------+------------+------------
 12:10:30   | 00:00:00   | 23:11:20   | 12:00:00
(1 row)

-- select mysql_time (stub function, pushdown constraints, explain)
--Testcase 2666:
EXPLAIN VERBOSE
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00') FROM time_tbl WHERE id != 200;
                                                                                                                                   QUERY PLAN                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=32)
   Output: (mysql_time(c3)), (mysql_time((c2)::timestamp without time zone)), (mysql_time(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (mysql_time('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_time(c3), public.mysql_time(c2), public.mysql_time(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.mysql_time('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select mysql_time (stub function, pushdown constraints, result)
--Testcase 2667:
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00') FROM time_tbl WHERE id != 200;
 mysql_time | mysql_time | mysql_time | mysql_time 
------------+------------+------------+------------
 12:10:30   | 00:00:00   | 23:11:20   | 12:00:00
 23:12:13   | 00:00:00   | 10:13:03   | 12:00:00
 11:12:12   | 00:00:00   | 22:13:02   | 12:00:00
 16:00:00   | 00:00:00   | 03:00:50   | 12:00:00
 00:59:59   | 00:00:00   | 12:00:49   | 12:00:00
(5 rows)

-- select mysql_time (stub function, mysql_time in constraints, explain)
--Testcase 2668:
EXPLAIN VERBOSE
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE mysql_time(c3) != '06:05:04.030201'::time;
                                                                                                                                                               QUERY PLAN                                                                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5327.32 rows=3396 width=32)
   Output: (mysql_time(c3)), (mysql_time((c2)::timestamp without time zone)), (mysql_time(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (mysql_time('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_time(c3), public.mysql_time(c2), public.mysql_time(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.mysql_time('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.mysql_time(c3) <> '06:05:04.030201'::time without time zone))
(4 rows)

-- select mysql_time (stub function, mysql_time in constraints, result)
--Testcase 2669:
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE mysql_time(c3) != '06:05:04.030201'::time;
 mysql_time | mysql_time | mysql_time | mysql_time 
------------+------------+------------+------------
 12:10:30   | 00:00:00   | 23:11:20   | 12:00:00
 23:12:13   | 00:00:00   | 10:13:03   | 12:00:00
 11:12:12   | 00:00:00   | 22:13:02   | 12:00:00
 16:00:00   | 00:00:00   | 03:00:50   | 12:00:00
 00:59:59   | 00:00:00   | 12:00:49   | 12:00:00
(5 rows)

-- select mysql_time (stub function, mysql_time in constraints, explain)
--Testcase 2670:
EXPLAIN VERBOSE
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE mysql_time('2021-01-01 12:00:00'::timestamp) > '06:05:04.030201'::time;
                                                                                                                                                                                       QUERY PLAN                                                                                                                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2454.02 rows=1138 width=32)
   Output: (mysql_time(c3)), (mysql_time((c2)::timestamp without time zone)), (mysql_time(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (mysql_time('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_time(c3), public.mysql_time(c2), public.mysql_time(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.mysql_time('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.mysql_time('2021-01-01 12:00:00'::timestamp without time zone) > '06:05:04.030201'::time without time zone))
(4 rows)

-- select mysql_time (stub function, mysql_time in constraints, result)
--Testcase 2671:
SELECT mysql_time(c3), mysql_time(c2), mysql_time(date_sub(c3, '1 12:59:10')), mysql_time('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE mysql_time('2021-01-01 12:00:00'::timestamp) > '06:05:04.030201'::time;
 mysql_time | mysql_time | mysql_time | mysql_time 
------------+------------+------------+------------
 12:10:30   | 00:00:00   | 23:11:20   | 12:00:00
 23:12:13   | 00:00:00   | 10:13:03   | 12:00:00
 11:12:12   | 00:00:00   | 22:13:02   | 12:00:00
 16:00:00   | 00:00:00   | 03:00:50   | 12:00:00
 00:59:59   | 00:00:00   | 12:00:49   | 12:00:00
(5 rows)

-- select mysql_time with agg (pushdown, explain)
--Testcase 2672:
EXPLAIN VERBOSE
SELECT max(c3), mysql_time(max(c3)) FROM time_tbl;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (mysql_time(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.mysql_time(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select mysql_time as nest function with agg (pushdown, result)
--Testcase 2673:
SELECT max(c3), mysql_time(max(c3)) FROM time_tbl;
         max         | mysql_time 
---------------------+------------
 2021-01-07 00:59:59 | 00:59:59
(1 row)

-- select mysql_time with non pushdown func and explicit constant (explain)
--Testcase 2674:
EXPLAIN VERBOSE
SELECT mysql_time(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (mysql_time(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_time(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select mysql_time with non pushdown func and explicit constant (result)
--Testcase 2675:
SELECT mysql_time(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 mysql_time |        pi         | ?column? 
------------+-------------------+----------
 23:11:20   | 3.141592653589793 |      4.1
 10:13:03   | 3.141592653589793 |      4.1
 22:13:02   | 3.141592653589793 |      4.1
 03:00:50   | 3.141592653589793 |      4.1
 12:00:49   | 3.141592653589793 |      4.1
(5 rows)

-- select mysql_time with order by (explain)
--Testcase 2676:
EXPLAIN VERBOSE
SELECT id, mysql_time(c3 + '1 12:59:10') FROM time_tbl order by mysql_time(c3 + '1 12:59:10');
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=12)
   Output: id, (mysql_time((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (mysql_time((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=12)
         Output: id, (mysql_time((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.mysql_time((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select mysql_time with order by (result)
--Testcase 2677:
SELECT id, mysql_time(c3 + '1 12:59:10') FROM time_tbl order by mysql_time(c3 + '1 12:59:10');
 id | mysql_time 
----+------------
  2 | 00:11:22
  0 | 01:09:40
  3 | 04:59:10
  1 | 12:11:23
  4 | 13:59:09
(5 rows)

-- select mysql_time with order by index (result)
--Testcase 2678:
SELECT id, mysql_time(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | mysql_time 
----+------------
  2 | 00:11:22
  0 | 01:09:40
  3 | 04:59:10
  1 | 12:11:23
  4 | 13:59:09
(5 rows)

-- select mysql_time with order by index (result)
--Testcase 2679:
SELECT id, mysql_time(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | mysql_time 
----+------------
  0 | 01:09:40
  1 | 12:11:23
  2 | 00:11:22
  3 | 04:59:10
  4 | 13:59:09
(5 rows)

-- select mysql_time with group by (explain)
--Testcase 2680:
EXPLAIN VERBOSE
SELECT max(c3), mysql_time(c3 + '1 12:59:10') FROM time_tbl group by mysql_time(c3 + '1 12:59:10');
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (mysql_time((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.mysql_time((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_time with group by (result)
--Testcase 2681:
SELECT max(c3), mysql_time(c3 + '1 12:59:10') FROM time_tbl group by mysql_time(c3 + '1 12:59:10');
         max         | mysql_time 
---------------------+------------
 2021-01-03 12:10:30 | 01:09:40
 2021-01-04 23:12:13 | 12:11:23
 2021-01-05 11:12:12 | 00:11:22
 2021-01-06 16:00:00 | 04:59:10
 2021-01-07 00:59:59 | 13:59:09
(5 rows)

-- select mysql_time with group by index (result)
--Testcase 2682:
SELECT id, mysql_time(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | mysql_time 
----+------------
  0 | 01:09:40
  1 | 12:11:23
  2 | 00:11:22
  3 | 04:59:10
  4 | 13:59:09
(5 rows)

-- select mysql_time with group by index (result)
--Testcase 2683:
SELECT id, mysql_time(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | mysql_time 
----+------------
  0 | 01:09:40
  1 | 12:11:23
  2 | 00:11:22
  3 | 04:59:10
  4 | 13:59:09
(5 rows)

-- select mysql_time with group by having (explain)
--Testcase 2684:
EXPLAIN VERBOSE
SELECT max(c3), mysql_time(c3 + '1 12:59:10') FROM time_tbl group by mysql_time(c3 + '1 12:59:10'), c3 HAVING mysql_time(c3 + '1 12:59:10') > '06:05:04.030201'::time;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (mysql_time((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((mysql_time((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) > '06:05:04.030201'::time without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.mysql_time((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select mysql_time with group by having (result)
--Testcase 2685:
SELECT max(c3), mysql_time(c3 + '1 12:59:10') FROM time_tbl group by mysql_time(c3 + '1 12:59:10'), c3 HAVING mysql_time(c3 + '1 12:59:10') > '06:05:04.030201'::time;
         max         | mysql_time 
---------------------+------------
 2021-01-04 23:12:13 | 12:11:23
 2021-01-07 00:59:59 | 13:59:09
(2 rows)

-- select mysql_time with group by index having (result)
--Testcase 2686:
SELECT id, mysql_time(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING mysql_time(c3 + '1 12:59:10') > '06:05:04.030201'::time;
 id | mysql_time |         c3          
----+------------+---------------------
  1 | 12:11:23   | 2021-01-04 23:12:13
  4 | 13:59:09   | 2021-01-07 00:59:59
(2 rows)

-- select mysql_time with group by index having (result)
--Testcase 2687:
SELECT id, mysql_time(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING mysql_time(c3 + '1 12:59:10') > '06:05:04.030201'::time;
 id | mysql_time |         c3          
----+------------+---------------------
  1 | 12:11:23   | 2021-01-04 23:12:13
  4 | 13:59:09   | 2021-01-07 00:59:59
(2 rows)

-- select mysql_time and as
--Testcase 2688:
SELECT mysql_time(date_sub(c3, '1 12:59:10')) as mysql_time1 FROM time_tbl;
 mysql_time1 
-------------
 23:11:20
 10:13:03
 22:13:02
 03:00:50
 12:00:49
(5 rows)

-- SYSDATE()
-- select sysdate (stub function, explain)
--Testcase 2689:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()) FROM time_tbl;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=4)
   Output: (datediff(sysdate(), sysdate()))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()) FROM public.time_tblmysql
(4 rows)

-- select sysdate (stub function, result)
--Testcase 2690:
SELECT datediff(sysdate(), sysdate()) FROM time_tbl;
 datediff 
----------
        0
        0
        0
        0
        0
(5 rows)

-- select sysdate (stub function, not pushdown constraints, explain)
--Testcase 2691:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()) FROM time_tbl WHERE to_hex(id) > '0';
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1082.95 rows=1138 width=4)
   Output: (datediff(sysdate(), sysdate()))
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()), id FROM public.time_tblmysql
(5 rows)

-- select sysdate (stub function, not pushdown constraints, result)
--Testcase 2692:
SELECT datediff(sysdate(), sysdate()) FROM time_tbl WHERE to_hex(id) > '0';
 datediff 
----------
        0
        0
        0
        0
(4 rows)

-- select sysdate (stub function, pushdown constraints, explain)
--Testcase 2693:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()) FROM time_tbl WHERE id = 1;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..165.75 rows=17 width=4)
   Output: (datediff(sysdate(), sysdate()))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()) FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select sysdate (stub function, pushdown constraints, result)
--Testcase 2694:
SELECT datediff(sysdate(), sysdate()) FROM time_tbl WHERE id = 1;
 datediff 
----------
        0
(1 row)

-- select sysdate (stub function, sysdate in constraints, explain)
--Testcase 2695:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()) FROM time_tbl WHERE sysdate() > '1997-10-14 00:00:00'::timestamp;
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1882.17 rows=1138 width=4)
   Output: (datediff(sysdate(), sysdate()))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()) FROM public.time_tblmysql WHERE ((public.sysdate() > '1997-10-14 00:00:00'::timestamp without time zone))
(4 rows)

-- select sysdate (stub function, sysdate in constraints, result)
--Testcase 2696:
SELECT datediff(sysdate(), sysdate()) FROM time_tbl WHERE sysdate() > '1997-10-14 00:00:00'::timestamp;
 datediff 
----------
        0
        0
        0
        0
        0
(5 rows)

-- sysdate in constrains (stub function, explain)
--Testcase 2697:
EXPLAIN VERBOSE
SELECT id, c1 FROM time_tbl WHERE sysdate() > '1997-10-14 00:00:00'::timestamp;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=12)
   Output: id, c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, c1 FROM public.time_tblmysql WHERE ((public.sysdate() > '1997-10-14 00:00:00'::timestamp without time zone))
(4 rows)

-- sysdate in constrains (stub function, result)
--Testcase 2698:
SELECT id, c1 FROM time_tbl WHERE sysdate() > '1997-10-14 00:00:00'::timestamp;
 id |    c1    
----+----------
  0 | 12:10:30
  1 | 23:12:13
  2 | 11:12:12
  3 | 16:00:00
  4 | 00:59:59
(5 rows)

-- sysdate as parameter of addtime(stub function, explain)
--Testcase 2699:
EXPLAIN VERBOSE
SELECT id, c1 FROM time_tbl WHERE addtime(sysdate(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp;
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=12)
   Output: id, c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, c1 FROM public.time_tblmysql WHERE ((public.addtime(public.sysdate(), '1 day 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp without time zone))
(4 rows)

-- sysdate as parameter of addtime(stub function, result)
--Testcase 2700:
SELECT id, c1 FROM time_tbl WHERE addtime(sysdate(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp;
 id |    c1    
----+----------
  0 | 12:10:30
  1 | 23:12:13
  2 | 11:12:12
  3 | 16:00:00
  4 | 00:59:59
(5 rows)

-- select sysdate and agg (pushdown, explain)
--Testcase 2701:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()), sum(id) FROM time_tbl;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (datediff(sysdate(), sysdate())), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()), sum(id) FROM public.time_tblmysql
(6 rows)

-- select sysdate and agg (pushdown, result)
--Testcase 2702:
SELECT datediff(sysdate(), sysdate()), sum(id) FROM time_tbl;
 datediff | sum 
----------+-----
        0 |  10
(1 row)

-- select sysdate and log2 (pushdown, explain)
--Testcase 2703:
EXPLAIN VERBOSE
SELECT id, datediff(sysdate(), sysdate()), log2(id) FROM time_tbl;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3633.92 rows=3413 width=16)
   Output: id, (datediff(sysdate(), sysdate())), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.datediff(public.sysdate(), public.sysdate()), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select sysdate and log2 (pushdown, result)
--Testcase 2704:
SELECT id, datediff(sysdate(), sysdate()), log2(id) FROM time_tbl;
 id | datediff |       log2        
----+----------+-------------------
  0 |        0 |                  
  1 |        0 |                 0
  2 |        0 |                 1
  3 |        0 | 1.584962500721156
  4 |        0 |                 2
(5 rows)

-- select sysdate with non pushdown func and explicit constant (explain)
--Testcase 2705:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()), to_hex(id), 4 FROM time_tbl;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=40)
   Output: (datediff(sysdate(), sysdate())), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select sysdate with non pushdown func and explicit constant (result)
--Testcase 2706:
SELECT datediff(sysdate(), sysdate()), to_hex(id), 4 FROM time_tbl;
ERROR:  stub sysdate() is called
CONTEXT:  PL/pgSQL function public.sysdate() line 3 at RAISE
remote SQL command: SELECT public.datediff(public.sysdate(), public.sysdate()), to_hex(id), 4 FROM public.time_tblmysql
ERROR:  PGSpider can not get data from child node : pgspider_svr
-- select sysdate with order by (explain)
--Testcase 2707:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()), c1 FROM time_tbl ORDER BY datediff(sysdate(), sysdate()),c1;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort  (cost=2972.43..2980.96 rows=3413 width=12)
   Output: (datediff(sysdate(), sysdate())), c1
   Sort Key: (datediff(sysdate(), sysdate())), time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=12)
         Output: (datediff(sysdate(), sysdate())), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()), c1 FROM public.time_tblmysql
(7 rows)

-- select sysdate with order by (result)
--Testcase 2708:
SELECT datediff(sysdate(), sysdate()), c1 FROM time_tbl ORDER BY datediff(sysdate(), sysdate()),c1;
 datediff |    c1    
----------+----------
        0 | 00:59:59
        0 | 11:12:12
        0 | 12:10:30
        0 | 16:00:00
        0 | 23:12:13
(5 rows)

-- select sysdate with order by index (explain)
--Testcase 2709:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()), c1 FROM time_tbl ORDER BY 1,2;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Sort  (cost=2972.43..2980.96 rows=3413 width=12)
   Output: (datediff(sysdate(), sysdate())), c1
   Sort Key: (datediff(sysdate(), sysdate())), time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=12)
         Output: (datediff(sysdate(), sysdate())), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()), c1 FROM public.time_tblmysql
(7 rows)

-- select sysdate with order by index (result)
--Testcase 2710:
SELECT datediff(sysdate(), sysdate()), c1 FROM time_tbl ORDER BY 1,2;
 datediff |    c1    
----------+----------
        0 | 00:59:59
        0 | 11:12:12
        0 | 12:10:30
        0 | 16:00:00
        0 | 23:12:13
(5 rows)

-- sysdate constraints with order by (explain)
--Testcase 2711:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(sysdate(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp ORDER BY c1;
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.sysdate(), '1 day 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp without time zone))
(7 rows)

-- sysdate constraints with order by (result)
--Testcase 2712:
SELECT c1 FROM time_tbl WHERE addtime(sysdate(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select sysdate with group by (explain)
--Testcase 2713:
EXPLAIN VERBOSE
SELECT id, datediff(sysdate(), sysdate()), c1 FROM time_tbl GROUP BY id,datediff(sysdate(), sysdate()),c1;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: id, (datediff(sysdate(), sysdate())), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT id, public.datediff(public.sysdate(), public.sysdate()), c1 FROM public.time_tblmysql GROUP BY 1, 2, 3
(6 rows)

-- select sysdate with group by (result)
--Testcase 2714:
SELECT id, datediff(sysdate(), sysdate()), c1 FROM time_tbl GROUP BY id,datediff(sysdate(), sysdate()),c1;
 id | datediff |    c1    
----+----------+----------
  0 |        0 | 12:10:30
  1 |        0 | 23:12:13
  2 |        0 | 11:12:12
  3 |        0 | 16:00:00
  4 |        0 | 00:59:59
(5 rows)

-- select sysdate with group by index (explain)
--Testcase 2715:
EXPLAIN VERBOSE
SELECT id, datediff(sysdate(), sysdate()), c1 FROM time_tbl GROUP BY 1,2,3;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: id, (datediff(sysdate(), sysdate())), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT id, public.datediff(public.sysdate(), public.sysdate()), c1 FROM public.time_tblmysql GROUP BY 1, 2, 3
(6 rows)

-- select sysdate with group by index (result)
--Testcase 2716:
SELECT id, datediff(sysdate(), sysdate()), c1 FROM time_tbl GROUP BY 1,2,3;
 id | datediff |    c1    
----+----------+----------
  0 |        0 | 12:10:30
  1 |        0 | 23:12:13
  2 |        0 | 11:12:12
  3 |        0 | 16:00:00
  4 |        0 | 00:59:59
(5 rows)

-- select sysdate with group by having (explain)
--Testcase 2717:
EXPLAIN VERBOSE
SELECT id, datediff(sysdate(), sysdate()), c1 FROM time_tbl GROUP BY datediff(sysdate(), sysdate()),c1,id HAVING datediff(sysdate(), sysdate()) >= 0;
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: id, (datediff(sysdate(), sysdate())), c1
   Filter: ((datediff(sysdate(), sysdate())) >= 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT id, public.datediff(public.sysdate(), public.sysdate()), c1 FROM public.time_tblmysql GROUP BY 2, 3, 1 HAVING ((public.datediff(public.sysdate(), public.sysdate()) >= 0))
(7 rows)

-- select sysdate with group by having (result)
--Testcase 2718:
SELECT id, datediff(sysdate(), sysdate()), c1 FROM time_tbl GROUP BY datediff(sysdate(), sysdate()),c1,id HAVING datediff(sysdate(), sysdate()) >= 0;
 id | datediff |    c1    
----+----------+----------
  0 |        0 | 12:10:30
  1 |        0 | 23:12:13
  2 |        0 | 11:12:12
  3 |        0 | 16:00:00
  4 |        0 | 00:59:59
(5 rows)

-- select sysdate with group by index having (explain)
--Testcase 2719:
EXPLAIN VERBOSE
SELECT id, datediff(sysdate(), sysdate()), c1 FROM time_tbl GROUP BY 3,2,1 HAVING datediff(sysdate(), sysdate()) >= 0;
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: id, (datediff(sysdate(), sysdate())), c1
   Filter: ((datediff(sysdate(), sysdate())) >= 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT id, public.datediff(public.sysdate(), public.sysdate()), c1 FROM public.time_tblmysql GROUP BY 3, 2, 1 HAVING ((public.datediff(public.sysdate(), public.sysdate()) >= 0))
(7 rows)

-- select sysdate with group by index having (result)
--Testcase 2720:
SELECT id, datediff(sysdate(), sysdate()), c1 FROM time_tbl GROUP BY 3,2,1 HAVING datediff(sysdate(), sysdate()) >= 0;
 id | datediff |    c1    
----+----------+----------
  0 |        0 | 12:10:30
  1 |        0 | 23:12:13
  2 |        0 | 11:12:12
  3 |        0 | 16:00:00
  4 |        0 | 00:59:59
(5 rows)

-- sysdate constraints with group by (explain)
--Testcase 2721:
EXPLAIN VERBOSE
SELECT id, c1 FROM time_tbl WHERE addtime(sysdate(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp GROUP BY id,c1;
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=12)
   Output: id, c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT id, c1 FROM public.time_tblmysql WHERE ((public.addtime(public.sysdate(), '1 day 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp without time zone)) GROUP BY 1, 2
(6 rows)

-- sysdate constraints with group by (result)
--Testcase 2722:
SELECT id, c1 FROM time_tbl WHERE addtime(sysdate(), '1 12:59:10'::interval) > '1997-10-14 00:00:00'::timestamp GROUP BY id,c1;
 id |    c1    
----+----------
  0 | 12:10:30
  1 | 23:12:13
  2 | 11:12:12
  3 | 16:00:00
  4 | 00:59:59
(5 rows)

-- select sysdate and as (explain)
--Testcase 2723:
EXPLAIN VERBOSE
SELECT datediff(sysdate(), sysdate()) as sysdate1 FROM time_tbl;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=4)
   Output: (datediff(sysdate(), sysdate()))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.datediff(public.sysdate(), public.sysdate()) FROM public.time_tblmysql
(4 rows)

-- select sysdate and as (result)
--Testcase 2724:
SELECT datediff(sysdate(), sysdate()) as sysdate1 FROM time_tbl;
 sysdate1 
----------
        0
        0
        0
        0
        0
(5 rows)

-- SUBTIME()
-- select subtime (stub function, explain)
--Testcase 2725:
EXPLAIN VERBOSE
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl;
                                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4478.64 rows=3413 width=48)
   Output: (subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (subtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.subtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql
(4 rows)

-- select subtime (stub function, result)
--Testcase 2726:
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl;
       subtime       |       subtime       | subtime |         subtime         
---------------------+---------------------+---------+-------------------------
 2021-01-01 23:11:20 | 2020-11-29 13:10:31 | @ 0     | @ 802 hours 49 secs ago
 2021-01-03 10:13:03 | 2020-12-01 00:12:14 | @ 0     | @ 802 hours 49 secs ago
 2021-01-03 22:13:02 | 2020-12-01 12:12:13 | @ 0     | @ 802 hours 49 secs ago
 2021-01-05 03:00:50 | 2020-12-02 17:00:01 | @ 0     | @ 802 hours 49 secs ago
 2021-01-05 12:00:49 | 2020-12-03 02:00:00 | @ 0     | @ 802 hours 49 secs ago
(5 rows)

-- select subtime (stub function, not pushdown constraints, explain)
--Testcase 2727:
EXPLAIN VERBOSE
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.44 rows=17 width=48)
   Output: (subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (subtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.subtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval), id FROM public.time_tblmysql
(5 rows)

-- select subtime (stub function, not pushdown constraints, result)
--Testcase 2728:
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE to_hex(id) = '1';
       subtime       |       subtime       | subtime |         subtime         
---------------------+---------------------+---------+-------------------------
 2021-01-03 10:13:03 | 2020-12-01 00:12:14 | @ 0     | @ 802 hours 49 secs ago
(1 row)

-- select subtime (stub function, pushdown constraints, explain)
--Testcase 2729:
EXPLAIN VERBOSE
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE id != 0;
                                                                                                                                                                                                               QUERY PLAN                                                                                                                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4465.58 rows=3396 width=48)
   Output: (subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (subtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.subtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select subtime (stub function, pushdown constraints, result)
--Testcase 2730:
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE id != 0;
       subtime       |       subtime       | subtime |         subtime         
---------------------+---------------------+---------+-------------------------
 2021-01-03 10:13:03 | 2020-12-01 00:12:14 | @ 0     | @ 802 hours 49 secs ago
 2021-01-03 22:13:02 | 2020-12-01 12:12:13 | @ 0     | @ 802 hours 49 secs ago
 2021-01-05 03:00:50 | 2020-12-02 17:00:01 | @ 0     | @ 802 hours 49 secs ago
 2021-01-05 12:00:49 | 2020-12-03 02:00:00 | @ 0     | @ 802 hours 49 secs ago
(4 rows)

-- select subtime (stub function, subtime in constraints, explain)
--Testcase 2731:
EXPLAIN VERBOSE
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE subtime(c3, '1 12:59:10') != '2000-01-01';
                                                                                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5318.83 rows=3396 width=48)
   Output: (subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (subtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.subtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((public.subtime(c3, '1 day 12:59:10'::interval) <> '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- select subtime (stub function, subtime in constraints, result)
--Testcase 2732:
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE subtime(c3, '1 12:59:10') != '2000-01-01';
       subtime       |       subtime       | subtime |         subtime         
---------------------+---------------------+---------+-------------------------
 2021-01-01 23:11:20 | 2020-11-29 13:10:31 | @ 0     | @ 802 hours 49 secs ago
 2021-01-03 10:13:03 | 2020-12-01 00:12:14 | @ 0     | @ 802 hours 49 secs ago
 2021-01-03 22:13:02 | 2020-12-01 12:12:13 | @ 0     | @ 802 hours 49 secs ago
 2021-01-05 03:00:50 | 2020-12-02 17:00:01 | @ 0     | @ 802 hours 49 secs ago
 2021-01-05 12:00:49 | 2020-12-03 02:00:00 | @ 0     | @ 802 hours 49 secs ago
(5 rows)

-- select subtime (stub function, subtime in constraints, explain)
--Testcase 2733:
EXPLAIN VERBOSE
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') > '-902:00:49'::interval;
                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2451.17 rows=1138 width=48)
   Output: (subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subtime(c3, '@ 6 mons 2 hours 30 mins'::interval)), (subtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), (subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subtime(c3, '@ 6 mons 2 hours 30 mins'::interval), public.subtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), public.subtime('@ 1 day 12 hours 59 mins 10 secs'::interval, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((public.subtime('1 day 12:59:10'::interval, '6 mons 02:30:00'::interval) > '-902:00:49'::interval))
(4 rows)

-- select subtime (stub function, subtime in constraints, result)
--Testcase 2734:
SELECT subtime(c3, '1 12:59:10'), subtime(c3, INTERVAL '6 months 2 hours 30 minutes'), subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') > '-902:00:49'::interval;
 subtime | subtime | subtime | subtime 
---------+---------+---------+---------
(0 rows)

-- select subtime with agg (pushdown, explain)
--Testcase 2735:
EXPLAIN VERBOSE
SELECT max(c1), subtime(max(c1), '1 12:59:10'::interval) FROM time_tbl;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c1)), (subtime((max(c1))::interval, '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c1), public.subtime(max(c1), '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql
(6 rows)

-- select subtime as nest function with agg (pushdown, result)
--Testcase 2736:
SELECT max(c1), subtime(max(c1), '1 12:59:10'::interval) FROM time_tbl;
   max    |            subtime             
----------+--------------------------------
 23:12:13 | @ 13 hours 46 mins 57 secs ago
(1 row)

-- select subtime as nest with stub (pushdown, explain)
--Testcase 2737:
EXPLAIN VERBOSE
SELECT subtime(mysql_timestamp(c2), '1 12:59:10'::interval) FROM time_tbl;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=8)
   Output: (subtime(mysql_timestamp((c2)::timestamp without time zone), '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subtime(public.mysql_timestamp(c2), '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql
(4 rows)

-- select subtime as nest with stub (pushdown, result)
--Testcase 2738:
SELECT subtime(mysql_timestamp(c2), '1 12:59:10'::interval) FROM time_tbl;
       subtime       
---------------------
 2020-12-31 11:00:50
 2020-12-30 11:00:50
 2021-01-08 11:00:50
 2021-01-13 11:00:50
 2021-01-27 11:00:50
(5 rows)

-- select subtime with non pushdown func and explicit constant (explain)
--Testcase 2739:
EXPLAIN VERBOSE
SELECT subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), pi(), 4.1 FROM time_tbl;
                                                                                                           QUERY PLAN                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=56)
   Output: (subtime(timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subtime(public.timediff(c3, '2008-01-01 00:00:00.000001'::timestamp without time zone), '@ 6 mons 2 hours 30 mins'::interval), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select subtime with non pushdown func and explicit constant (result)
--Testcase 2740:
SELECT subtime(timediff(c3, '2008-01-01 00:00:00.000001'), INTERVAL '6 months 2 hours 30 minutes'), pi(), 4.1 FROM time_tbl;
 subtime |        pi         | ?column? 
---------+-------------------+----------
 @ 0     | 3.141592653589793 |      4.1
 @ 0     | 3.141592653589793 |      4.1
 @ 0     | 3.141592653589793 |      4.1
 @ 0     | 3.141592653589793 |      4.1
 @ 0     | 3.141592653589793 |      4.1
(5 rows)

-- select subtime with order by (explain)
--Testcase 2741:
EXPLAIN VERBOSE
SELECT id, subtime(c1, c1 + '1 12:59:10') FROM time_tbl order by subtime(c1, c1 + '1 12:59:10');
                                                             QUERY PLAN                                                             
------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=20)
   Output: id, (subtime(c1, (c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (subtime(time_tbl.c1, (time_tbl.c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=20)
         Output: id, (subtime(c1, (c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.subtime(c1, (c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select subtime with order by (result)
--Testcase 2742:
SELECT id, subtime(c1, c1 + '1 12:59:10') FROM time_tbl order by subtime(c1, c1 + '1 12:59:10');
 id |   subtime   
----+-------------
  0 | @ 1 sec ago
  1 | @ 1 sec ago
  2 | @ 1 sec ago
  3 | @ 1 sec ago
  4 | 
(5 rows)

-- select subtime with order by index (result)
--Testcase 2743:
SELECT id, subtime(c1, c1 + '1 12:59:10') FROM time_tbl order by 2,1;
 id |   subtime   
----+-------------
  0 | @ 1 sec ago
  1 | @ 1 sec ago
  2 | @ 1 sec ago
  3 | @ 1 sec ago
  4 | 
(5 rows)

-- select subtime with order by index (result)
--Testcase 2744:
SELECT id, subtime(c1, c1 + '1 12:59:10') FROM time_tbl order by 1,2;
 id |   subtime   
----+-------------
  0 | @ 1 sec ago
  1 | @ 1 sec ago
  2 | @ 1 sec ago
  3 | @ 1 sec ago
  4 | 
(5 rows)

-- select subtime with group by (explain)
--Testcase 2745:
EXPLAIN VERBOSE
SELECT count(id), subtime(c1, c1 + '1 12:59:10') FROM time_tbl group by subtime(c1, c1 + '1 12:59:10');
                                                                   QUERY PLAN                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (count(id)), (subtime(c1, (c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.subtime(c1, (c1 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select subtime with group by (result)
--Testcase 2746:
SELECT count(id), subtime(c1, c1 + '1 12:59:10') FROM time_tbl group by subtime(c1, c1 + '1 12:59:10');
 count |   subtime   
-------+-------------
     4 | @ 1 sec ago
     1 | 
(2 rows)

-- select subtime with group by index (result)
--Testcase 2747:
SELECT id, subtime(c1, c1 + '1 12:59:10') FROM time_tbl group by 2,1;
 id |   subtime   
----+-------------
  0 | @ 1 sec ago
  1 | @ 1 sec ago
  2 | @ 1 sec ago
  3 | @ 1 sec ago
  4 | 
(5 rows)

-- select subtime with group by index (result)
--Testcase 2748:
SELECT id, subtime(c1, c1 + '1 12:59:10') FROM time_tbl group by 1,2;
 id |   subtime   
----+-------------
  0 | @ 1 sec ago
  1 | @ 1 sec ago
  2 | @ 1 sec ago
  3 | @ 1 sec ago
  4 | 
(5 rows)

-- select subtime with group by having (explain)
--Testcase 2749:
EXPLAIN VERBOSE
SELECT count(id), subtime(c3, '1 12:59:10') FROM time_tbl group by subtime(c3, '1 12:59:10'), c3 HAVING subtime(c3, '1 12:59:10') < '2080-01-01'::timestamp;
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (count(id)), (subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3
   Filter: ((subtime(time_tbl.c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)) < '2080-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.subtime(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), c3 FROM public.time_tblmysql GROUP BY 2, 3 HAVING ((public.subtime(c3, '1 day 12:59:10'::interval) < '2080-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- select subtime with group by having (result)
--Testcase 2750:
SELECT count(id), subtime(c3, '1 12:59:10') FROM time_tbl group by subtime(c3, '1 12:59:10'), c3 HAVING subtime(c3, '1 12:59:10') < '2080-01-01'::timestamp;
 count |       subtime       
-------+---------------------
     1 | 2021-01-01 23:11:20
     1 | 2021-01-03 10:13:03
     1 | 2021-01-03 22:13:02
     1 | 2021-01-05 03:00:50
     1 | 2021-01-05 12:00:49
(5 rows)

-- select subtime and as
--Testcase 2751:
SELECT subtime(c3, '1 12:59:10') as subtime1, subtime(c3, INTERVAL '6 months 2 hours 30 minutes') as subtime2, subtime(timediff(c3, '2008-01-01 00:00:00.000001') , INTERVAL '6 months 2 hours 30 minutes') as subtime3, subtime('1 12:59:10', INTERVAL '6 months 2 hours 30 minutes') as subtime4 FROM time_tbl;
      subtime1       |      subtime2       | subtime3 |        subtime4         
---------------------+---------------------+----------+-------------------------
 2021-01-01 23:11:20 | 2020-11-29 13:10:31 | @ 0      | @ 802 hours 49 secs ago
 2021-01-03 10:13:03 | 2020-12-01 00:12:14 | @ 0      | @ 802 hours 49 secs ago
 2021-01-03 22:13:02 | 2020-12-01 12:12:13 | @ 0      | @ 802 hours 49 secs ago
 2021-01-05 03:00:50 | 2020-12-02 17:00:01 | @ 0      | @ 802 hours 49 secs ago
 2021-01-05 12:00:49 | 2020-12-03 02:00:00 | @ 0      | @ 802 hours 49 secs ago
(5 rows)

-- SUBDATE()
-- select subdate (stub function, explain)
--Testcase 2752:
EXPLAIN VERBOSE
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (subdate((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subdate(c3, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subdate(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subdate(c3, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql
(4 rows)

-- select subdate (stub function, result)
--Testcase 2753:
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl;
       subdate       |       subdate       
---------------------+---------------------
 2020-12-31 11:00:50 | 2020-07-07 09:40:30
 2020-12-30 11:00:50 | 2020-07-08 20:42:13
 2021-01-08 11:00:50 | 2020-07-09 08:42:12
 2021-01-13 11:00:50 | 2020-07-10 13:30:00
 2021-01-27 11:00:50 | 2020-07-10 22:29:59
(5 rows)

-- select subdate (stub function, not pushdown constraints, explain)
--Testcase 2754:
EXPLAIN VERBOSE
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE to_hex(id) = '1';
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.74 rows=17 width=16)
   Output: (subdate((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subdate(c3, '@ 6 mons 2 hours 30 mins'::interval))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subdate(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subdate(c3, '@ 6 mons 2 hours 30 mins'::interval), id FROM public.time_tblmysql
(5 rows)

-- select subdate (stub function, not pushdown constraints, result)
--Testcase 2755:
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE to_hex(id) = '1';
       subdate       |       subdate       
---------------------+---------------------
 2020-12-30 11:00:50 | 2020-07-08 20:42:13
(1 row)

-- select subdate (stub function, pushdown constraints, explain)
--Testcase 2756:
EXPLAIN VERBOSE
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE id != 0;
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.07 rows=3396 width=16)
   Output: (subdate((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subdate(c3, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subdate(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subdate(c3, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select subdate (stub function, pushdown constraints, result)
--Testcase 2757:
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE id != 0;
       subdate       |       subdate       
---------------------+---------------------
 2020-12-30 11:00:50 | 2020-07-08 20:42:13
 2021-01-08 11:00:50 | 2020-07-09 08:42:12
 2021-01-13 11:00:50 | 2020-07-10 13:30:00
 2021-01-27 11:00:50 | 2020-07-10 22:29:59
(4 rows)

-- select subdate (stub function, subdate in constraints, explain)
--Testcase 2758:
EXPLAIN VERBOSE
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE subdate(c3, '1 12:59:10') != '2000-01-01';
                                                                                                                                         QUERY PLAN                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.32 rows=3396 width=16)
   Output: (subdate((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subdate(c3, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subdate(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subdate(c3, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((public.subdate(c3, '1 day 12:59:10'::interval) <> '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- select subdate (stub function, subdate in constraints, result)
--Testcase 2759:
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE subdate(c3, '1 12:59:10') != '2000-01-01';
       subdate       |       subdate       
---------------------+---------------------
 2020-12-31 11:00:50 | 2020-07-07 09:40:30
 2020-12-30 11:00:50 | 2020-07-08 20:42:13
 2021-01-08 11:00:50 | 2020-07-09 08:42:12
 2021-01-13 11:00:50 | 2020-07-10 13:30:00
 2021-01-27 11:00:50 | 2020-07-10 22:29:59
(5 rows)

-- select subdate (stub function, subdate in constraints, explain)
--Testcase 2760:
EXPLAIN VERBOSE
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE subdate(c2, INTERVAL '6 months 2 hours 30 minutes') > '2008-01-01 00:00:00.000001'::timestamp;
                                                                                                                                            QUERY PLAN                                                                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1609.05 rows=1138 width=16)
   Output: (subdate((c2)::timestamp without time zone, '@ 1 day 12 hours 59 mins 10 secs'::interval)), (subdate(c3, '@ 6 mons 2 hours 30 mins'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subdate(c2, '@ 1 day 12 hours 59 mins 10 secs'::interval), public.subdate(c3, '@ 6 mons 2 hours 30 mins'::interval) FROM public.time_tblmysql WHERE ((public.subdate(c2, '6 mons 02:30:00'::interval) > '2008-01-01 00:00:00.000001'::timestamp without time zone))
(4 rows)

-- select subdate (stub function, subdate in constraints, result)
--Testcase 2761:
SELECT subdate(c2, '1 12:59:10'), subdate(c3, INTERVAL '6 months 2 hours 30 minutes') FROM time_tbl WHERE subdate(c2, INTERVAL '6 months 2 hours 30 minutes') > '2008-01-01 00:00:00.000001'::timestamp;
       subdate       |       subdate       
---------------------+---------------------
 2020-12-31 11:00:50 | 2020-07-07 09:40:30
 2020-12-30 11:00:50 | 2020-07-08 20:42:13
 2021-01-08 11:00:50 | 2020-07-09 08:42:12
 2021-01-13 11:00:50 | 2020-07-10 13:30:00
 2021-01-27 11:00:50 | 2020-07-10 22:29:59
(5 rows)

-- select subdate with agg (pushdown, explain)
--Testcase 2762:
EXPLAIN VERBOSE
SELECT max(c1), subdate(max(c3), '1 12:59:10'::interval) FROM time_tbl;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c1)), (subdate(max(c3), '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c1), public.subdate(max(c3), '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql
(6 rows)

-- select subdate as nest function with agg (pushdown, result)
--Testcase 2763:
SELECT max(c1), subdate(max(c3), '1 12:59:10'::interval) FROM time_tbl;
   max    |       subdate       
----------+---------------------
 23:12:13 | 2021-01-05 12:00:49
(1 row)

-- select subdate as nest with stub (pushdown, explain)
--Testcase 2764:
EXPLAIN VERBOSE
SELECT subdate(adddate(c3, INTERVAL '6 months 2 hours 30 minutes'), '1 12:59:10'::interval) FROM time_tbl;
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (subdate(adddate(c3, '@ 6 mons 2 hours 30 mins'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subdate(public.adddate(c3, '@ 6 mons 2 hours 30 mins'::interval), '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql
(4 rows)

-- select subdate as nest with stub (pushdown, result)
--Testcase 2765:
SELECT subdate(adddate(c3, INTERVAL '6 months 2 hours 30 minutes'), '1 12:59:10'::interval) FROM time_tbl;
       subdate       
---------------------
 2021-07-01 01:41:20
 2021-07-02 12:43:03
 2021-07-03 00:43:02
 2021-07-04 05:30:50
 2021-07-04 14:30:49
(5 rows)

-- select subdate with non pushdown func and explicit constant (explain)
--Testcase 2766:
EXPLAIN VERBOSE
SELECT subdate(adddate(c3, INTERVAL '6 months 2 hours 30 minutes'), INTERVAL '6 months 2 hours 30 minutes'), pi(), 4.1 FROM time_tbl;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (subdate(adddate(c3, '@ 6 mons 2 hours 30 mins'::interval), '@ 6 mons 2 hours 30 mins'::interval)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.subdate(public.adddate(c3, '@ 6 mons 2 hours 30 mins'::interval), '@ 6 mons 2 hours 30 mins'::interval), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select subdate with non pushdown func and explicit constant (result)
--Testcase 2767:
SELECT subdate(adddate(c3, INTERVAL '6 months 2 hours 30 minutes'), INTERVAL '6 months 2 hours 30 minutes'), pi(), 4.1 FROM time_tbl;
       subdate       |        pi         | ?column? 
---------------------+-------------------+----------
 2021-01-03 12:10:30 | 3.141592653589793 |      4.1
 2021-01-04 23:12:13 | 3.141592653589793 |      4.1
 2021-01-05 11:12:12 | 3.141592653589793 |      4.1
 2021-01-06 16:00:00 | 3.141592653589793 |      4.1
 2021-01-07 00:59:59 | 3.141592653589793 |      4.1
(5 rows)

-- select subdate with order by (explain)
--Testcase 2768:
EXPLAIN VERBOSE
SELECT id, subdate(c3, '1 12:59:10'::interval) FROM time_tbl order by subdate(c3, '1 12:59:10'::interval);
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=12)
   Output: id, (subdate(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Sort Key: (subdate(time_tbl.c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=12)
         Output: id, (subdate(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.subdate(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql
(7 rows)

-- select subdate with order by (result)
--Testcase 2769:
SELECT id, subdate(c3, '1 12:59:10'::interval) FROM time_tbl order by subdate(c3, '1 12:59:10'::interval);
 id |       subdate       
----+---------------------
  0 | 2021-01-01 23:11:20
  1 | 2021-01-03 10:13:03
  2 | 2021-01-03 22:13:02
  3 | 2021-01-05 03:00:50
  4 | 2021-01-05 12:00:49
(5 rows)

-- select subdate with order by index (result)
--Testcase 2770:
SELECT id, subdate(c3, '1 12:59:10'::interval) FROM time_tbl order by 2,1;
 id |       subdate       
----+---------------------
  0 | 2021-01-01 23:11:20
  1 | 2021-01-03 10:13:03
  2 | 2021-01-03 22:13:02
  3 | 2021-01-05 03:00:50
  4 | 2021-01-05 12:00:49
(5 rows)

-- select subdate with order by index (result)
--Testcase 2771:
SELECT id, subdate(c3, '1 12:59:10'::interval) FROM time_tbl order by 1,2;
 id |       subdate       
----+---------------------
  0 | 2021-01-01 23:11:20
  1 | 2021-01-03 10:13:03
  2 | 2021-01-03 22:13:02
  3 | 2021-01-05 03:00:50
  4 | 2021-01-05 12:00:49
(5 rows)

-- select subdate with group by (explain)
--Testcase 2772:
EXPLAIN VERBOSE
SELECT count(id), subdate(c3, '1 12:59:10'::interval) FROM time_tbl group by subdate(c3, '1 12:59:10'::interval);
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (count(id)), (subdate(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.subdate(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select subdate with group by (result)
--Testcase 2773:
SELECT count(id), subdate(c3, '1 12:59:10'::interval) FROM time_tbl group by subdate(c3, '1 12:59:10'::interval);
 count |       subdate       
-------+---------------------
     1 | 2021-01-01 23:11:20
     1 | 2021-01-03 10:13:03
     1 | 2021-01-03 22:13:02
     1 | 2021-01-05 03:00:50
     1 | 2021-01-05 12:00:49
(5 rows)

-- select subdate with group by index (result)
--Testcase 2774:
SELECT id, subdate(c3, '1 12:59:10'::interval) FROM time_tbl group by 2,1;
 id |       subdate       
----+---------------------
  0 | 2021-01-01 23:11:20
  1 | 2021-01-03 10:13:03
  2 | 2021-01-03 22:13:02
  3 | 2021-01-05 03:00:50
  4 | 2021-01-05 12:00:49
(5 rows)

-- select subdate with group by index (result)
--Testcase 2775:
SELECT id, subdate(c3, '1 12:59:10'::interval) FROM time_tbl group by 1,2;
 id |       subdate       
----+---------------------
  0 | 2021-01-01 23:11:20
  1 | 2021-01-03 10:13:03
  2 | 2021-01-03 22:13:02
  3 | 2021-01-05 03:00:50
  4 | 2021-01-05 12:00:49
(5 rows)

-- select subdate with group by having (explain)
--Testcase 2776:
EXPLAIN VERBOSE
SELECT count(id), subdate(c3, '1 12:59:10') FROM time_tbl group by subdate(c3, '1 12:59:10'), c3 HAVING subdate(c3, '1 12:59:10') < '2080-01-01'::timestamp;
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (count(id)), (subdate(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3
   Filter: ((subdate(time_tbl.c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)) < '2080-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.subdate(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval), c3 FROM public.time_tblmysql GROUP BY 2, 3 HAVING ((public.subdate(c3, '1 day 12:59:10'::interval) < '2080-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- select subdate with group by having (result)
--Testcase 2777:
SELECT count(id), subdate(c3, '1 12:59:10') FROM time_tbl group by subdate(c3, '1 12:59:10'), c3 HAVING subdate(c3, '1 12:59:10') < '2080-01-01'::timestamp;
 count |       subdate       
-------+---------------------
     1 | 2021-01-01 23:11:20
     1 | 2021-01-03 10:13:03
     1 | 2021-01-03 22:13:02
     1 | 2021-01-05 03:00:50
     1 | 2021-01-05 12:00:49
(5 rows)

-- select subdate and as
--Testcase 2778:
SELECT subdate(c3, '1 12:59:10') as subdate1, subdate(c3, INTERVAL '6 months 2 hours 30 minutes') as subdate2 FROM time_tbl;
      subdate1       |      subdate2       
---------------------+---------------------
 2021-01-01 23:11:20 | 2020-07-07 09:40:30
 2021-01-03 10:13:03 | 2020-07-08 20:42:13
 2021-01-03 22:13:02 | 2020-07-09 08:42:12
 2021-01-05 03:00:50 | 2020-07-10 13:30:00
 2021-01-05 12:00:49 | 2020-07-10 22:29:59
(5 rows)

-- STR_TO_DATE()
-- select str_to_date (stub function, explain)
--Testcase 2779:
EXPLAIN VERBOSE
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl;
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=24)
   Output: (str_to_date(c1, '%H:%i:%s'::text)), (str_to_date((c2)::timestamp without time zone, '%Y-%m-%d'::text)), (str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.str_to_date(c1, '%H:%i:%s'::text), public.str_to_date(c2, '%Y-%m-%d'::text), public.str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text) FROM public.time_tblmysql
(4 rows)

-- select str_to_date (stub function, explain)
--Testcase 2780:
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl;
 str_to_date |     str_to_date     |     str_to_date     
-------------+---------------------+---------------------
 12:10:30    | 2021-01-02 00:00:00 | 2021-01-03 12:10:30
 23:12:13    | 2021-01-01 00:00:00 | 2021-01-04 23:12:13
 11:12:12    | 2021-01-10 00:00:00 | 2021-01-05 11:12:12
 16:00:00    | 2021-01-15 00:00:00 | 2021-01-06 16:00:00
 00:59:59    | 2021-01-29 00:00:00 | 2021-01-07 00:59:59
(5 rows)

-- select str_to_date (stub function, not pushdown constraints, explain)
--Testcase 2781:
EXPLAIN VERBOSE
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl WHERE to_hex(id) = '1';
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..241.99 rows=17 width=24)
   Output: (str_to_date(c1, '%H:%i:%s'::text)), (str_to_date((c2)::timestamp without time zone, '%Y-%m-%d'::text)), (str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.str_to_date(c1, '%H:%i:%s'::text), public.str_to_date(c2, '%Y-%m-%d'::text), public.str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text), id FROM public.time_tblmysql
(5 rows)

-- select str_to_date (stub function, not pushdown constraints, result)
--Testcase 2782:
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl WHERE to_hex(id) = '1';
 str_to_date |     str_to_date     |     str_to_date     
-------------+---------------------+---------------------
 23:12:13    | 2021-01-01 00:00:00 | 2021-01-04 23:12:13
(1 row)

-- select str_to_date (stub function, pushdown constraints, explain)
--Testcase 2783:
EXPLAIN VERBOSE
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl WHERE id != 200;
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2776.07 rows=3396 width=24)
   Output: (str_to_date(c1, '%H:%i:%s'::text)), (str_to_date((c2)::timestamp without time zone, '%Y-%m-%d'::text)), (str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.str_to_date(c1, '%H:%i:%s'::text), public.str_to_date(c2, '%Y-%m-%d'::text), public.str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select str_to_date (stub function, pushdown constraints, result)
--Testcase 2784:
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl WHERE id != 200;
 str_to_date |     str_to_date     |     str_to_date     
-------------+---------------------+---------------------
 12:10:30    | 2021-01-02 00:00:00 | 2021-01-03 12:10:30
 23:12:13    | 2021-01-01 00:00:00 | 2021-01-04 23:12:13
 11:12:12    | 2021-01-10 00:00:00 | 2021-01-05 11:12:12
 16:00:00    | 2021-01-15 00:00:00 | 2021-01-06 16:00:00
 00:59:59    | 2021-01-29 00:00:00 | 2021-01-07 00:59:59
(5 rows)

-- select str_to_date (stub function, year in constraints, explain)
--Testcase 2785:
EXPLAIN VERBOSE
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl WHERE str_to_date(c1, '%H:%i:%s') > '02:00:00'::time;
                                                                                                                                   QUERY PLAN                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1885.02 rows=1138 width=24)
   Output: (str_to_date(c1, '%H:%i:%s'::text)), (str_to_date((c2)::timestamp without time zone, '%Y-%m-%d'::text)), (str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.str_to_date(c1, '%H:%i:%s'::text), public.str_to_date(c2, '%Y-%m-%d'::text), public.str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text) FROM public.time_tblmysql WHERE ((public.str_to_date(c1, '%H:%i:%s'::text) > '02:00:00'::time without time zone))
(4 rows)

-- select str_to_date (stub function, year in constraints, result)
--Testcase 2786:
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl WHERE str_to_date(c1, '%H:%i:%s') > '02:00:00'::time;
 str_to_date |     str_to_date     |     str_to_date     
-------------+---------------------+---------------------
 12:10:30    | 2021-01-02 00:00:00 | 2021-01-03 12:10:30
 23:12:13    | 2021-01-01 00:00:00 | 2021-01-04 23:12:13
 11:12:12    | 2021-01-10 00:00:00 | 2021-01-05 11:12:12
 16:00:00    | 2021-01-15 00:00:00 | 2021-01-06 16:00:00
(4 rows)

-- select str_to_date with agg (pushdown, explain)
--Testcase 2787:
EXPLAIN VERBOSE
SELECT max(c3), str_to_date(max(c1), '%H:%i:%s') FROM time_tbl;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (str_to_date(max(c1), '%H:%i:%s'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.str_to_date(max(c1), '%H:%i:%s'::text) FROM public.time_tblmysql
(6 rows)

-- select str_to_date as nest function with agg (pushdown, result)
--Testcase 2788:
SELECT max(c3), str_to_date(max(c1), '%H:%i:%s') FROM time_tbl;
         max         | str_to_date 
---------------------+-------------
 2021-01-07 00:59:59 | 23:12:13
(1 row)

-- select str_to_date with non pushdown func and explicit constant (explain)
--Testcase 2789:
EXPLAIN VERBOSE
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s'), pi(), 4.1 FROM time_tbl;
                                                                                                            QUERY PLAN                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=64)
   Output: (str_to_date(c1, '%H:%i:%s'::text)), (str_to_date((c2)::timestamp without time zone, '%Y-%m-%d'::text)), (str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.str_to_date(c1, '%H:%i:%s'::text), public.str_to_date(c2, '%Y-%m-%d'::text), public.str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- -- select str_to_date with non pushdown func and explicit constant (result)
--Testcase 2790:
SELECT str_to_date(c1, '%H:%i:%s'), str_to_date(c2, '%Y-%m-%d'), str_to_date(c3, '%Y-%m-%d %H:%i:%s'), pi(), 4.1 FROM time_tbl;
 str_to_date |     str_to_date     |     str_to_date     |        pi         | ?column? 
-------------+---------------------+---------------------+-------------------+----------
 12:10:30    | 2021-01-02 00:00:00 | 2021-01-03 12:10:30 | 3.141592653589793 |      4.1
 23:12:13    | 2021-01-01 00:00:00 | 2021-01-04 23:12:13 | 3.141592653589793 |      4.1
 11:12:12    | 2021-01-10 00:00:00 | 2021-01-05 11:12:12 | 3.141592653589793 |      4.1
 16:00:00    | 2021-01-15 00:00:00 | 2021-01-06 16:00:00 | 3.141592653589793 |      4.1
 00:59:59    | 2021-01-29 00:00:00 | 2021-01-07 00:59:59 | 3.141592653589793 |      4.1
(5 rows)

-- select str_to_date with order by (explain)
--Testcase 2791:
EXPLAIN VERBOSE
SELECT id, str_to_date(c1, '%H:%i:%s'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl order by str_to_date(c1, '%H:%i:%s'), str_to_date(c3, '%Y-%m-%d %H:%i:%s');
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=20)
   Output: id, (str_to_date(c1, '%H:%i:%s'::text)), (str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text))
   Sort Key: (str_to_date(time_tbl.c1, '%H:%i:%s'::text)), (str_to_date(time_tbl.c3, '%Y-%m-%d %H:%i:%s'::text))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=20)
         Output: id, (str_to_date(c1, '%H:%i:%s'::text)), (str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.str_to_date(c1, '%H:%i:%s'::text), public.str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text) FROM public.time_tblmysql
(7 rows)

-- select str_to_date with order by (result)
--Testcase 2792:
SELECT id, str_to_date(c1, '%H:%i:%s'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl order by str_to_date(c1, '%H:%i:%s'), str_to_date(c3, '%Y-%m-%d %H:%i:%s');
 id | str_to_date |     str_to_date     
----+-------------+---------------------
  4 | 00:59:59    | 2021-01-07 00:59:59
  2 | 11:12:12    | 2021-01-05 11:12:12
  0 | 12:10:30    | 2021-01-03 12:10:30
  3 | 16:00:00    | 2021-01-06 16:00:00
  1 | 23:12:13    | 2021-01-04 23:12:13
(5 rows)

-- select str_to_date with order by index (result)
--Testcase 2793:
SELECT id, str_to_date(c1, '%H:%i:%s'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl order by 3,2,1;
 id | str_to_date |     str_to_date     
----+-------------+---------------------
  0 | 12:10:30    | 2021-01-03 12:10:30
  1 | 23:12:13    | 2021-01-04 23:12:13
  2 | 11:12:12    | 2021-01-05 11:12:12
  3 | 16:00:00    | 2021-01-06 16:00:00
  4 | 00:59:59    | 2021-01-07 00:59:59
(5 rows)

-- select str_to_date with order by index (result)
--Testcase 2794:
SELECT id, str_to_date(c1, '%H:%i:%s'), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl order by 1,2,3;
 id | str_to_date |     str_to_date     
----+-------------+---------------------
  0 | 12:10:30    | 2021-01-03 12:10:30
  1 | 23:12:13    | 2021-01-04 23:12:13
  2 | 11:12:12    | 2021-01-05 11:12:12
  3 | 16:00:00    | 2021-01-06 16:00:00
  4 | 00:59:59    | 2021-01-07 00:59:59
(5 rows)

-- select str_to_date with group by (explain)
--Testcase 2795:
EXPLAIN VERBOSE
SELECT max(c1), str_to_date(c1, '%H:%i:%s') FROM time_tbl group by str_to_date(c1, '%H:%i:%s');
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c1)), (str_to_date(c1, '%H:%i:%s'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c1), public.str_to_date(c1, '%H:%i:%s'::text) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select str_to_date with group by (result)
--Testcase 2796:
SELECT max(c3), str_to_date(c1, '%H:%i:%s') FROM time_tbl group by str_to_date(c1, '%H:%i:%s');
         max         | str_to_date 
---------------------+-------------
 2021-01-03 12:10:30 | 12:10:30
 2021-01-04 23:12:13 | 23:12:13
 2021-01-05 11:12:12 | 11:12:12
 2021-01-06 16:00:00 | 16:00:00
 2021-01-07 00:59:59 | 00:59:59
(5 rows)

-- select str_to_date with group by index (result)
--Testcase 2797:
SELECT id, str_to_date(c1, '%H:%i:%s') FROM time_tbl group by 2,1;
 id | str_to_date 
----+-------------
  0 | 12:10:30
  1 | 23:12:13
  2 | 11:12:12
  3 | 16:00:00
  4 | 00:59:59
(5 rows)

-- select str_to_date with group by index (result)
--Testcase 2798:
SELECT id, str_to_date(c1, '%H:%i:%s') FROM time_tbl group by 1,2;
 id | str_to_date 
----+-------------
  0 | 12:10:30
  1 | 23:12:13
  2 | 11:12:12
  3 | 16:00:00
  4 | 00:59:59
(5 rows)

-- select str_to_date with group by having (explain)
--Testcase 2799:
EXPLAIN VERBOSE
SELECT max(c3), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl group by str_to_date(c3, '%Y-%m-%d %H:%i:%s'),c3 HAVING str_to_date(c3, '%Y-%m-%d %H:%i:%s') < '2021-01-03 13:00:00'::timestamp;
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text)), c3
   Filter: ((str_to_date(time_tbl.c3, '%Y-%m-%d %H:%i:%s'::text)) < '2021-01-03 13:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text), c3 FROM public.time_tblmysql GROUP BY 2, 3 HAVING ((public.str_to_date(c3, '%Y-%m-%d %H:%i:%s'::text) < '2021-01-03 13:00:00'::timestamp without time zone))
(7 rows)

-- select str_to_date with group by having (result)
--Testcase 2800:
SELECT max(c3), str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl group by str_to_date(c3, '%Y-%m-%d %H:%i:%s'),c3 HAVING str_to_date(c3, '%Y-%m-%d %H:%i:%s') < '2021-01-03 13:00:00'::timestamp;
         max         |     str_to_date     
---------------------+---------------------
 2021-01-03 12:10:30 | 2021-01-03 12:10:30
(1 row)

-- select str_to_date with group by index having (result)
--Testcase 2801:
SELECT id, str_to_date(c3, '%Y-%m-%d %H:%i:%s') FROM time_tbl group by 1, 2 HAVING id > 1;
 id |     str_to_date     
----+---------------------
  2 | 2021-01-05 11:12:12
  3 | 2021-01-06 16:00:00
  4 | 2021-01-07 00:59:59
(3 rows)

-- SECOND()
-- select second (stub function, explain)
--Testcase 2802:
EXPLAIN VERBOSE
SELECT second(c1), second(c3) FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (second(c1)), (second(c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.second(c1), public.second(c3) FROM public.time_tblmysql
(4 rows)

--Testcase 2803:
SELECT second(c1), second(c3) FROM time_tbl;
 second | second 
--------+--------
     30 |     30
     13 |     13
     12 |     12
      0 |      0
     59 |     59
(5 rows)

-- select second (stub function, not pushdown constraints, explain)
--Testcase 2804:
EXPLAIN VERBOSE
SELECT second(c1), second(c3) FROM time_tbl WHERE to_hex(id) > '0';
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..798.45 rows=1138 width=8)
   Output: (second(c1)), (second(c3))
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.second(c1), public.second(c3), id FROM public.time_tblmysql
(5 rows)

--Testcase 2805:
SELECT second(c1), second(c3) FROM time_tbl WHERE to_hex(id) > '0';
 second | second 
--------+--------
     13 |     13
     12 |     12
      0 |      0
     59 |     59
(4 rows)

-- select second (stub function, pushdown constraints, explain)
--Testcase 2806:
EXPLAIN VERBOSE
SELECT second(c1), second(c3) FROM time_tbl WHERE id = 1;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..161.50 rows=17 width=8)
   Output: (second(c1)), (second(c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.second(c1), public.second(c3) FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

--Testcase 2807:
SELECT second(c1), second(c3) FROM time_tbl WHERE id = 1;
 second | second 
--------+--------
     13 |     13
(1 row)

-- select second (stub function, second in constraints, explain)
--Testcase 2808:
EXPLAIN VERBOSE
SELECT second(c1), second(c3) FROM time_tbl WHERE second(c2) < second(c3);
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2459.45 rows=1138 width=8)
   Output: (second(c1)), (second(c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.second(c1), public.second(c3) FROM public.time_tblmysql WHERE ((public.second(c2) < public.second(c3)))
(4 rows)

--Testcase 2809:
SELECT second(c1), second(c3) FROM time_tbl WHERE second(c2) < second(c3);
 second | second 
--------+--------
     30 |     30
     13 |     13
     12 |     12
     59 |     59
(4 rows)

-- second in constrains (stub function, explain)
--Testcase 2810:
EXPLAIN VERBOSE
SELECT second(c1), second(c3) FROM time_tbl WHERE second(c2) < id;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1606.21 rows=1138 width=8)
   Output: (second(c1)), (second(c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.second(c1), public.second(c3) FROM public.time_tblmysql WHERE ((public.second(c2) < id))
(4 rows)

-- second in constrains (stub function, result)
--Testcase 2811:
SELECT second(c1), second(c3) FROM time_tbl WHERE second(c2) < id;
 second | second 
--------+--------
     13 |     13
     12 |     12
      0 |      0
     59 |     59
(4 rows)

-- select second as nest function with agg (pushdown, explain)
--Testcase 2812:
EXPLAIN VERBOSE
SELECT max(c1), second(max(c3)) FROM time_tbl;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c1)), (second(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c1), public.second(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select second as nest function with agg (pushdown, result)
--Testcase 2813:
SELECT max(c1), second(max(c3)) FROM time_tbl;
   max    | second 
----------+--------
 23:12:13 |     59
(1 row)

-- select second and agg (pushdown, explain)
--Testcase 2814:
EXPLAIN VERBOSE
SELECT second('1997-10-14 00:01:01'::timestamp), second('00:01:59'::time), sum(id) FROM time_tbl;
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (second('1997-10-14 00:01:01'::timestamp without time zone)), (second('00:01:59'::time without time zone)), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.second('1997-10-14 00:01:01'::timestamp without time zone), public.second('00:01:59'::time without time zone), sum(id) FROM public.time_tblmysql
(6 rows)

-- select second and log2 (pushdown, explain)
--Testcase 2815:
EXPLAIN VERBOSE
SELECT second('1997-10-14 00:01:01'::timestamp), second('00:01:59'::time), log2(id) FROM time_tbl;
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=16)
   Output: (second('1997-10-14 00:01:01'::timestamp without time zone)), (second('00:01:59'::time without time zone)), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.second('1997-10-14 00:01:01'::timestamp without time zone), public.second('00:01:59'::time without time zone), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select second with non pushdown func and explicit constant (explain)
--Testcase 2816:
EXPLAIN VERBOSE
SELECT second('1997-10-14 00:00:00'::timestamp), second('00:01:59'::time), to_hex(id), 4 FROM time_tbl;
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=44)
   Output: (second('1997-10-14 00:00:00'::timestamp without time zone)), (second('00:01:59'::time without time zone)), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.second('1997-10-14 00:00:00'::timestamp without time zone), public.second('00:01:59'::time without time zone), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select second with order by (explain)
--Testcase 2817:
EXPLAIN VERBOSE
SELECT second(c1), second(c3), c1 FROM time_tbl ORDER BY c1;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Result  (cost=412.68..2161.84 rows=3413 width=16)
   Output: second(c1), second(c3), c1
   ->  Sort  (cost=412.68..421.21 rows=3413 width=16)
         Output: c1, c3
         Sort Key: time_tbl.c1
         ->  Foreign Scan on public.time_tbl  (cost=100.00..212.39 rows=3413 width=16)
               Output: c1, c3
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT c1, c3 FROM public.time_tblmysql
(9 rows)

-- select second with order by index (result)
--Testcase 2818:
SELECT second(c1), second(c3), c1 FROM time_tbl ORDER BY 1,2;
 second | second |    c1    
--------+--------+----------
      0 |      0 | 16:00:00
     12 |     12 | 11:12:12
     13 |     13 | 23:12:13
     30 |     30 | 12:10:30
     59 |     59 | 00:59:59
(5 rows)

-- second constraints with order by (explain)
--Testcase 2819:
EXPLAIN VERBOSE
SELECT second(c1), second(c3) FROM time_tbl WHERE second('2020-10-14 00:39:05'::timestamp) > second('1997-10-14 00:00:00'::timestamp) ORDER BY second(c1), second(c3);
                                                                                                                 QUERY PLAN                                                                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2508.69..2511.53 rows=1138 width=8)
   Output: (second(c1)), (second(c3))
   Sort Key: (second(time_tbl.c1)), (second(time_tbl.c3))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..2450.92 rows=1138 width=8)
         Output: (second(c1)), (second(c3))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.second(c1), public.second(c3) FROM public.time_tblmysql WHERE ((public.second('2020-10-14 00:39:05'::timestamp without time zone) > public.second('1997-10-14 00:00:00'::timestamp without time zone)))
(7 rows)

-- second constraints with order by (result)
--Testcase 2820:
SELECT second(c1), second(c3) FROM time_tbl WHERE second('2020-10-14 00:39:05'::timestamp) > second('1997-10-14 00:00:00'::timestamp) ORDER BY second(c1), second(c3);
 second | second 
--------+--------
      0 |      0
     12 |     12
     13 |     13
     30 |     30
     59 |     59
(5 rows)

-- select second with group by (explain)
--Testcase 2821:
EXPLAIN VERBOSE
SELECT second(c1), second(c3), c1 FROM time_tbl GROUP BY c1,c3;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=24)
   Output: (second(c1)), (second(c3)), c1, c3
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.second(c1), public.second(c3), c1, c3 FROM public.time_tblmysql GROUP BY 3, 4
(6 rows)

-- select second with group by index (explain)
--Testcase 2822:
EXPLAIN VERBOSE
SELECT second(c1), second(c3), c1 FROM time_tbl GROUP BY 1,2,3;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (second(c1)), (second(c3)), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.second(c1), public.second(c3), c1 FROM public.time_tblmysql GROUP BY 1, 2, 3
(6 rows)

-- select second with group by having (explain)
--Testcase 2823:
EXPLAIN VERBOSE
SELECT second(c1), c1 FROM time_tbl GROUP BY second(c1),c1 HAVING second(c1) > 1;
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (second(c1)), c1
   Filter: ((second(time_tbl.c1)) > 1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.second(c1), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.second(c1) > 1))
(7 rows)

-- select second with group by index having (result)
--Testcase 2824:
SELECT second(c1), c1 FROM time_tbl GROUP BY second(c1),c1 HAVING second(c1) > 1;
 second |    c1    
--------+----------
     30 | 12:10:30
     13 | 23:12:13
     12 | 11:12:12
     59 | 00:59:59
(4 rows)

-- select second and as
--Testcase 2825:
EXPLAIN VERBOSE
SELECT second(c1) as second1, second(c3) as second2 FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (second(c1)), (second(c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.second(c1), public.second(c3) FROM public.time_tblmysql
(4 rows)

-- SEC_TO_TIME()
-- select sec_to_time (stub function, explain)
--Testcase 2826:
EXPLAIN VERBOSE
SELECT sec_to_time(id) FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (sec_to_time(id))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.sec_to_time(id) FROM public.time_tblmysql
(4 rows)

--Testcase 2827:
SELECT sec_to_time(id) FROM time_tbl;
 sec_to_time 
-------------
 00:00:00
 00:00:01
 00:00:02
 00:00:03
 00:00:04
(5 rows)

-- select sec_to_time (stub function, not pushdown constraints, explain)
--Testcase 2828:
EXPLAIN VERBOSE
SELECT sec_to_time(id) FROM time_tbl WHERE to_hex(id) > '0';
                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (sec_to_time(id))
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.sec_to_time(id), id FROM public.time_tblmysql
(5 rows)

--Testcase 2829:
SELECT sec_to_time(id) FROM time_tbl WHERE to_hex(id) > '0';
 sec_to_time 
-------------
 00:00:01
 00:00:02
 00:00:03
 00:00:04
(4 rows)

-- select sec_to_time (stub function, pushdown constraints, explain)
--Testcase 2830:
EXPLAIN VERBOSE
SELECT sec_to_time(id) FROM time_tbl WHERE id = 1;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (sec_to_time(id))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.sec_to_time(id) FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

--Testcase 2831:
SELECT sec_to_time(id) FROM time_tbl WHERE id = 1;
 sec_to_time 
-------------
 00:00:01
(1 row)

-- select sec_to_time (stub function, sec_to_time in constraints, explain)
--Testcase 2832:
EXPLAIN VERBOSE
SELECT sec_to_time(id) FROM time_tbl WHERE sec_to_time(id) < c1;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (sec_to_time(id))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.sec_to_time(id) FROM public.time_tblmysql WHERE ((public.sec_to_time(id) < c1))
(4 rows)

--Testcase 2833:
SELECT sec_to_time(id) FROM time_tbl WHERE sec_to_time(id) < c1;
 sec_to_time 
-------------
 00:00:00
 00:00:01
 00:00:02
 00:00:03
 00:00:04
(5 rows)

-- sec_to_time in constrains (stub function, explain)
--Testcase 2834:
EXPLAIN VERBOSE
SELECT sec_to_time(id) FROM time_tbl WHERE sec_to_time(id) < c1;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (sec_to_time(id))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.sec_to_time(id) FROM public.time_tblmysql WHERE ((public.sec_to_time(id) < c1))
(4 rows)

-- sec_to_time in constrains (stub function, result)
--Testcase 2835:
SELECT sec_to_time(id) FROM time_tbl WHERE sec_to_time(id) < c1;
 sec_to_time 
-------------
 00:00:00
 00:00:01
 00:00:02
 00:00:03
 00:00:04
(5 rows)

-- select sec_to_time as nest function with agg (pushdown, explain)
--Testcase 2836:
EXPLAIN VERBOSE
SELECT max(c1), sec_to_time(max(id)) FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c1)), (sec_to_time(max(id)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c1), public.sec_to_time(max(id)) FROM public.time_tblmysql
(6 rows)

-- select sec_to_time as nest function with agg (pushdown, result)
--Testcase 2837:
SELECT max(c1), sec_to_time(max(id)) FROM time_tbl;
   max    | sec_to_time 
----------+-------------
 23:12:13 | 00:00:04
(1 row)

-- select sec_to_time and agg (pushdown, explain)
--Testcase 2838:
EXPLAIN VERBOSE
SELECT max(id), sec_to_time(max(id)) FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(id)), (sec_to_time(max(id)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(id), public.sec_to_time(max(id)) FROM public.time_tblmysql
(6 rows)

-- select sec_to_time and log2 (pushdown, explain)
--Testcase 2839:
EXPLAIN VERBOSE
SELECT sec_to_time(id), log2(id) FROM time_tbl;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (sec_to_time(id)), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.sec_to_time(id), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select sec_to_time with non pushdown func and explicit constant (explain)
--Testcase 2840:
EXPLAIN VERBOSE
SELECT sec_to_time(id), to_hex(id), 4 FROM time_tbl;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (sec_to_time(id)), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.sec_to_time(id), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select sec_to_time with order by (explain)
--Testcase 2841:
EXPLAIN VERBOSE
SELECT sec_to_time(id), c1 FROM time_tbl ORDER BY sec_to_time(id);
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (sec_to_time(id)), c1
   Sort Key: (sec_to_time(time_tbl.id))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (sec_to_time(id)), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.sec_to_time(id), c1 FROM public.time_tblmysql
(7 rows)

-- select sec_to_time with order by index (result)
--Testcase 2842:
SELECT sec_to_time(id), c1 FROM time_tbl ORDER BY 1;
 sec_to_time |    c1    
-------------+----------
 00:00:00    | 12:10:30
 00:00:01    | 23:12:13
 00:00:02    | 11:12:12
 00:00:03    | 16:00:00
 00:00:04    | 00:59:59
(5 rows)

-- sec_to_time constraints with order by (explain)
--Testcase 2843:
EXPLAIN VERBOSE
SELECT sec_to_time(id) FROM time_tbl WHERE sec_to_time(id) < c1 ORDER BY 1;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1370.94..1373.78 rows=1138 width=8)
   Output: (sec_to_time(id))
   Sort Key: (sec_to_time(time_tbl.id))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
         Output: (sec_to_time(id))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.sec_to_time(id) FROM public.time_tblmysql WHERE ((public.sec_to_time(id) < c1))
(7 rows)

-- sec_to_time constraints with order by (result)
--Testcase 2844:
SELECT sec_to_time(id) FROM time_tbl WHERE sec_to_time(id) < c1 ORDER BY sec_to_time(id);
 sec_to_time 
-------------
 00:00:00
 00:00:01
 00:00:02
 00:00:03
 00:00:04
(5 rows)

-- select sec_to_time with group by (explain)
--Testcase 2845:
EXPLAIN VERBOSE
SELECT sec_to_time(id), c1 FROM time_tbl GROUP BY id,c1;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=20)
   Output: (sec_to_time(id)), c1, id
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.sec_to_time(id), c1, id FROM public.time_tblmysql GROUP BY 3, 2
(6 rows)

-- select sec_to_time with group by index (explain)
--Testcase 2846:
EXPLAIN VERBOSE
SELECT sec_to_time(id), c1 FROM time_tbl GROUP BY 1,2;
                                        QUERY PLAN                                         
-------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (sec_to_time(id)), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.sec_to_time(id), c1 FROM public.time_tblmysql GROUP BY 1, 2
(6 rows)

-- select sec_to_time with group by having (explain)
--Testcase 2847:
EXPLAIN VERBOSE
SELECT sec_to_time(id), c1 FROM time_tbl GROUP BY sec_to_time(id), id, c1 HAVING sec_to_time(id) < c1;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (sec_to_time(id)), c1, id
   Filter: ((sec_to_time(time_tbl.id)) < time_tbl.c1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.sec_to_time(id), c1, id FROM public.time_tblmysql GROUP BY 1, 3, 2 HAVING ((public.sec_to_time(id) < c1))
(7 rows)

-- select sec_to_time with group by index having (result)
--Testcase 2848:
SELECT sec_to_time(id), c1 FROM time_tbl GROUP BY sec_to_time(id), id, c1 HAVING sec_to_time(id) < c1;
 sec_to_time |    c1    
-------------+----------
 00:00:00    | 12:10:30
 00:00:01    | 23:12:13
 00:00:02    | 11:12:12
 00:00:03    | 16:00:00
 00:00:04    | 00:59:59
(5 rows)

-- select sec_to_time and as
--Testcase 2849:
EXPLAIN VERBOSE
SELECT sec_to_time(id) as sec_to_time1 FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (sec_to_time(id))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.sec_to_time(id) FROM public.time_tblmysql
(4 rows)

-- QUARTER()
-- select quarter (stub function, explain)
--Testcase 2850:
EXPLAIN VERBOSE
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=128)
   Output: (quarter(c3)), (quarter((c2)::timestamp without time zone)), (quarter(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (quarter('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.quarter(c3), public.quarter(c2), public.quarter(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.quarter('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select quarter (stub function, result)
--Testcase 2851:
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
 quarter | quarter | quarter | quarter 
---------+---------+---------+---------
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
(5 rows)

-- select quarter (stub function, not pushdown constraints, explain)
--Testcase 2852:
EXPLAIN VERBOSE
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=128)
   Output: (quarter(c3)), (quarter((c2)::timestamp without time zone)), (quarter(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (quarter('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.quarter(c3), public.quarter(c2), public.quarter(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.quarter('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select quarter (stub function, not pushdown constraints, result)
--Testcase 2853:
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 quarter | quarter | quarter | quarter 
---------+---------+---------+---------
 1       | 1       | 1       | 1
(1 row)

-- select quarter (stub function, pushdown constraints, explain)
--Testcase 2854:
EXPLAIN VERBOSE
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=128)
   Output: (quarter(c3)), (quarter((c2)::timestamp without time zone)), (quarter(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (quarter('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.quarter(c3), public.quarter(c2), public.quarter(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.quarter('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select quarter (stub function, pushdown constraints, result)
--Testcase 2855:
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 quarter | quarter | quarter | quarter 
---------+---------+---------+---------
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
(5 rows)

-- select quarter (stub function, quarter in constraints, explain)
--Testcase 2856:
EXPLAIN VERBOSE
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE quarter(c3) = quarter('2000-01-01'::timestamp);
                                                                                                                                                                    QUERY PLAN                                                                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1880.80 rows=17 width=128)
   Output: (quarter(c3)), (quarter((c2)::timestamp without time zone)), (quarter(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (quarter('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.quarter(c3), public.quarter(c2), public.quarter(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.quarter('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.quarter(c3) = public.quarter('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select quarter (stub function, quarter in constraints, result)
--Testcase 2857:
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE quarter(c3) = quarter('2000-01-01'::timestamp);
 quarter | quarter | quarter | quarter 
---------+---------+---------+---------
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
(5 rows)

-- select quarter (stub function, quarter in constraints, explain)
--Testcase 2858:
EXPLAIN VERBOSE
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE quarter('2021-01-01 12:00:00'::timestamp) = '1';
                                                                                                                                                               QUERY PLAN                                                                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1027.54 rows=17 width=128)
   Output: (quarter(c3)), (quarter((c2)::timestamp without time zone)), (quarter(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (quarter('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.quarter(c3), public.quarter(c2), public.quarter(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.quarter('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.quarter('2021-01-01 12:00:00'::timestamp without time zone) = '1'::text))
(4 rows)

-- select quarter (stub function, quarter in constraints, result)
--Testcase 2859:
SELECT quarter(c3), quarter(c2), quarter(date_sub(c3, '1 12:59:10')), quarter('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE quarter('2021-01-01 12:00:00'::timestamp) = '1';
 quarter | quarter | quarter | quarter 
---------+---------+---------+---------
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
 1       | 1       | 1       | 1
(5 rows)

-- select quarter with agg (pushdown, explain)
--Testcase 2860:
EXPLAIN VERBOSE
SELECT max(c3), quarter(max(c3)) FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (quarter(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.quarter(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select quarter as nest function with agg (pushdown, result)
--Testcase 2861:
SELECT max(c3), quarter(max(c3)) FROM time_tbl;
         max         | quarter 
---------------------+---------
 2021-01-07 00:59:59 | 1
(1 row)

-- select quarter with non pushdown func and explicit constant (explain)
--Testcase 2862:
EXPLAIN VERBOSE
SELECT quarter(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=72)
   Output: (quarter(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.quarter(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select quarter with non pushdown func and explicit constant (result)
--Testcase 2863:
SELECT quarter(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 quarter |        pi         | ?column? 
---------+-------------------+----------
 1       | 3.141592653589793 |      4.1
 1       | 3.141592653589793 |      4.1
 1       | 3.141592653589793 |      4.1
 1       | 3.141592653589793 |      4.1
 1       | 3.141592653589793 |      4.1
(5 rows)

-- select quarter with order by (explain)
--Testcase 2864:
EXPLAIN VERBOSE
SELECT id, quarter(c3 + '1 12:59:10') FROM time_tbl order by quarter(c3 + '1 12:59:10');
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=36)
   Output: id, (quarter((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (quarter((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=36)
         Output: id, (quarter((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.quarter((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select quarter with order by (result)
--Testcase 2865:
SELECT id, quarter(c3 + '1 12:59:10') FROM time_tbl order by quarter(c3 + '1 12:59:10');
 id | quarter 
----+---------
  0 | 1
  1 | 1
  2 | 1
  3 | 1
  4 | 1
(5 rows)

-- select quarter with order by index (result)
--Testcase 2866:
SELECT id, quarter(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | quarter 
----+---------
  0 | 1
  1 | 1
  2 | 1
  3 | 1
  4 | 1
(5 rows)

-- select quarter with order by index (result)
--Testcase 2867:
SELECT id, quarter(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | quarter 
----+---------
  0 | 1
  1 | 1
  2 | 1
  3 | 1
  4 | 1
(5 rows)

-- select quarter with group by (explain)
--Testcase 2868:
EXPLAIN VERBOSE
SELECT max(c3), quarter(c3 + '1 12:59:10') FROM time_tbl group by quarter(c3 + '1 12:59:10');
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (quarter((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.quarter((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select quarter with group by (result)
--Testcase 2869:
SELECT max(c3), quarter(c3 + '1 12:59:10') FROM time_tbl group by quarter(c3 + '1 12:59:10');
         max         | quarter 
---------------------+---------
 2021-01-07 00:59:59 | 1
(1 row)

-- select quarter with group by index (result)
--Testcase 2870:
SELECT id, quarter(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | quarter 
----+---------
  0 | 1
  1 | 1
  2 | 1
  3 | 1
  4 | 1
(5 rows)

-- select quarter with group by index (result)
--Testcase 2871:
SELECT id, quarter(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | quarter 
----+---------
  0 | 1
  1 | 1
  2 | 1
  3 | 1
  4 | 1
(5 rows)

-- select quarter with group by having (explain)
--Testcase 2872:
EXPLAIN VERBOSE
SELECT max(c3), quarter(c3 + '1 12:59:10') FROM time_tbl group by quarter(c3 + '1 12:59:10'), c3 HAVING quarter(c3 + '1 12:59:10') > '0';
                                                                   QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=48)
   Output: (max(c3)), (quarter((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((quarter((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.quarter((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select quarter with group by having (result)
--Testcase 2873:
SELECT max(c3), quarter(c3 + '1 12:59:10') FROM time_tbl group by quarter(c3 + '1 12:59:10'), c3 HAVING quarter(c3 + '1 12:59:10') > '0';
         max         | quarter 
---------------------+---------
 2021-01-03 12:10:30 | 1
 2021-01-04 23:12:13 | 1
 2021-01-05 11:12:12 | 1
 2021-01-06 16:00:00 | 1
 2021-01-07 00:59:59 | 1
(5 rows)

-- select quarter with group by index having (result)
--Testcase 2874:
SELECT id, quarter(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING quarter(c3 + '1 12:59:10') > '0';
 id | quarter |         c3          
----+---------+---------------------
  0 | 1       | 2021-01-03 12:10:30
  1 | 1       | 2021-01-04 23:12:13
  2 | 1       | 2021-01-05 11:12:12
  3 | 1       | 2021-01-06 16:00:00
  4 | 1       | 2021-01-07 00:59:59
(5 rows)

-- select quarter with group by index having (result)
--Testcase 2875:
SELECT id, quarter(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING quarter(c3 + '1 12:59:10') > '0';
 id | quarter |         c3          
----+---------+---------------------
  0 | 1       | 2021-01-03 12:10:30
  1 | 1       | 2021-01-04 23:12:13
  2 | 1       | 2021-01-05 11:12:12
  3 | 1       | 2021-01-06 16:00:00
  4 | 1       | 2021-01-07 00:59:59
(5 rows)

-- select quarter and as
--Testcase 2876:
SELECT quarter(date_sub(c3, '1 12:59:10')) as quarter1 FROM time_tbl;
 quarter1 
----------
 1
 1
 1
 1
 1
(5 rows)

-- PERIOD_DIFF()
-- select period_diff (stub function, explain)
--Testcase 2877:
EXPLAIN VERBOSE
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=4)
   Output: (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) FROM public.time_tblmysql
(4 rows)

-- select period_diff (stub function, result)
--Testcase 2878:
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl;
 period_diff 
-------------
          18
          18
          18
          18
          18
(5 rows)

-- select period_diff (stub function, not pushdown constraints, explain)
--Testcase 2879:
EXPLAIN VERBOSE
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE to_hex(id) = '1';
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.69 rows=17 width=4)
   Output: (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), id FROM public.time_tblmysql
(5 rows)

-- select period_diff (stub function, not pushdown constraints, result)
--Testcase 2880:
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE to_hex(id) = '1';
 period_diff 
-------------
          18
(1 row)

-- select period_diff (stub function, pushdown constraints, explain)
--Testcase 2881:
EXPLAIN VERBOSE
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE id != 200;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.58 rows=3396 width=4)
   Output: (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select period_diff (stub function, pushdown constraints, result)
--Testcase 2882:
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE id != 200;
 period_diff 
-------------
          18
          18
          18
          18
          18
(5 rows)

-- select period_diff (stub function, period_diff in constraints, explain)
--Testcase 2883:
EXPLAIN VERBOSE
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE period_diff(mysql_extract('YEAR_MONTH', c3 ), 199710) > id;
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2450.92 rows=1138 width=4)
   Output: (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) FROM public.time_tblmysql WHERE ((public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 199710) > id))
(4 rows)

-- select period_diff (stub function, period_diff in constraints, result)
--Testcase 2884:
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE period_diff(mysql_extract('YEAR_MONTH', c3 ), 199710) > id;
 period_diff 
-------------
          18
          18
          18
          18
          18
(5 rows)

-- select period_diff with agg (pushdown, explain)
--Testcase 2885:
EXPLAIN VERBOSE
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=4)
   Output: (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) FROM public.time_tblmysql
(4 rows)

-- select period_diff as nest function with agg (pushdown, result)
--Testcase 2886:
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl;
 period_diff 
-------------
          18
          18
          18
          18
          18
(5 rows)

-- select period_diff with non pushdown func and explicit constant (explain)
--Testcase 2887:
EXPLAIN VERBOSE
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), pi(), 4.1 FROM time_tbl;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select period_diff with non pushdown func and explicit constant (result)
--Testcase 2888:
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), pi(), 4.1 FROM time_tbl;
 period_diff |        pi         | ?column? 
-------------+-------------------+----------
          18 | 3.141592653589793 |      4.1
          18 | 3.141592653589793 |      4.1
          18 | 3.141592653589793 |      4.1
          18 | 3.141592653589793 |      4.1
          18 | 3.141592653589793 |      4.1
(5 rows)

-- select period_diff with order by (explain)
--Testcase 2889:
EXPLAIN VERBOSE
SELECT id, period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl order by period_diff(mysql_extract('YEAR_MONTH', c3 ), 199710);
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Result  (cost=2119.18..5574.84 rows=3413 width=12)
   Output: id, period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 199710))
   ->  Sort  (cost=2119.18..2127.71 rows=3413 width=16)
         Output: id, (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 199710)), c3
         Sort Key: (period_diff(mysql_extract('YEAR_MONTH'::text, time_tbl.c3), 199710))
         ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=16)
               Output: id, (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 199710)), c3
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT id, public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 199710), c3 FROM public.time_tblmysql
(9 rows)

-- select period_diff with order by (result)
--Testcase 2890:
SELECT id, period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl order by period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907);
 id | period_diff 
----+-------------
  0 |          18
  1 |          18
  2 |          18
  3 |          18
  4 |          18
(5 rows)

-- select period_diff with order by index (result)
--Testcase 2891:
SELECT id, period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl order by 2,1;
 id | period_diff 
----+-------------
  0 |          18
  1 |          18
  2 |          18
  3 |          18
  4 |          18
(5 rows)

-- select period_diff with order by index (result)
--Testcase 2892:
SELECT id, period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl order by 1,2;
 id | period_diff 
----+-------------
  0 |          18
  1 |          18
  2 |          18
  3 |          18
  4 |          18
(5 rows)

-- select period_diff with group by index (result)
--Testcase 2893:
SELECT id, period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by 2,1;
 id | period_diff 
----+-------------
  0 |          18
  1 |          18
  2 |          18
  3 |          18
  4 |          18
(5 rows)

-- select period_diff with group by index (result)
--Testcase 2894:
SELECT id, period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by 1,2;
 id | period_diff 
----+-------------
  0 |          18
  1 |          18
  2 |          18
  3 |          18
  4 |          18
(5 rows)

-- select period_diff with group by having (explain)
--Testcase 2895:
EXPLAIN VERBOSE
SELECT max(c3), period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by  period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907),c3 HAVING period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) > 0;
                                                                                                                  QUERY PLAN                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907)), c3
   Filter: ((period_diff(mysql_extract('YEAR_MONTH'::text, time_tbl.c3), 201907)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), c3 FROM public.time_tblmysql GROUP BY 2, 3 HAVING ((public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) > 0))
(7 rows)

-- select period_diff with group by having (result)
--Testcase 2896:
SELECT max(c3), period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by  period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907),c3 HAVING period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) > 0;
         max         | period_diff 
---------------------+-------------
 2021-01-03 12:10:30 |          18
 2021-01-04 23:12:13 |          18
 2021-01-05 11:12:12 |          18
 2021-01-06 16:00:00 |          18
 2021-01-07 00:59:59 |          18
(5 rows)

-- select period_diff with group by index having (result)
--Testcase 2897:
SELECT id, c3, period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by 3, 2, 1 HAVING period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) > 0;
 id |         c3          | period_diff 
----+---------------------+-------------
  0 | 2021-01-03 12:10:30 |          18
  1 | 2021-01-04 23:12:13 |          18
  2 | 2021-01-05 11:12:12 |          18
  3 | 2021-01-06 16:00:00 |          18
  4 | 2021-01-07 00:59:59 |          18
(5 rows)

-- select period_diff with group by index having (result)
--Testcase 2898:
SELECT id, c3, period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by 1, 2, 3 HAVING period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) > 0;
 id |         c3          | period_diff 
----+---------------------+-------------
  0 | 2021-01-03 12:10:30 |          18
  1 | 2021-01-04 23:12:13 |          18
  2 | 2021-01-05 11:12:12 |          18
  3 | 2021-01-06 16:00:00 |          18
  4 | 2021-01-07 00:59:59 |          18
(5 rows)

-- select period_diff and as
--Testcase 2899:
SELECT period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907) as period_diff1 FROM time_tbl;
 period_diff1 
--------------
           18
           18
           18
           18
           18
(5 rows)

-- PERIOD_ADD()
-- select period_add (stub function, explain)
--Testcase 2900:
EXPLAIN VERBOSE
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=4)
   Output: (period_add(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) FROM public.time_tblmysql
(4 rows)

-- select period_add (stub function, result)
--Testcase 2901:
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl;
 period_add 
------------
    1884608
    1884608
    1884608
    1884608
    1884608
(5 rows)

-- select period_add (stub function, not pushdown constraints, explain)
--Testcase 2902:
EXPLAIN VERBOSE
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE to_hex(id) = '1';
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.69 rows=17 width=4)
   Output: (period_add(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), id FROM public.time_tblmysql
(5 rows)

-- select period_add (stub function, not pushdown constraints, result)
--Testcase 2903:
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE to_hex(id) = '1';
 period_add 
------------
    1884608
(1 row)

-- select period_add (stub function, pushdown constraints, explain)
--Testcase 2904:
EXPLAIN VERBOSE
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE id != 200;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.58 rows=3396 width=4)
   Output: (period_add(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select period_add (stub function, pushdown constraints, result)
--Testcase 2905:
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE id != 200;
 period_add 
------------
    1884608
    1884608
    1884608
    1884608
    1884608
(5 rows)

-- select period_add (stub function, period_add in constraints, explain)
--Testcase 2906:
EXPLAIN VERBOSE
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE period_add(mysql_extract('YEAR_MONTH', c3 ), 199710) > id;
                                                                                                   QUERY PLAN                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2450.92 rows=1138 width=4)
   Output: (period_add(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) FROM public.time_tblmysql WHERE ((public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 199710) > id))
(4 rows)

-- select period_add (stub function, period_add in constraints, result)
--Testcase 2907:
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl WHERE period_add(mysql_extract('YEAR_MONTH', c3 ), 199710) > id;
 period_add 
------------
    1884608
    1884608
    1884608
    1884608
    1884608
(5 rows)

-- select period_add with agg (pushdown, explain)
--Testcase 2908:
EXPLAIN VERBOSE
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=4)
   Output: (period_add(mysql_extract('YEAR_MONTH'::text, c3), 201907))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) FROM public.time_tblmysql
(4 rows)

-- select period_add as nest function with agg (pushdown, result)
--Testcase 2909:
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl;
 period_add 
------------
    1884608
    1884608
    1884608
    1884608
    1884608
(5 rows)

-- select period_add with non pushdown func and explicit constant (explain)
--Testcase 2910:
EXPLAIN VERBOSE
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907), pi(), 4.1 FROM time_tbl;
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (period_add(mysql_extract('YEAR_MONTH'::text, c3), 201907)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select period_add with non pushdown func and explicit constant (result)
--Testcase 2911:
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907), pi(), 4.1 FROM time_tbl;
 period_add |        pi         | ?column? 
------------+-------------------+----------
    1884608 | 3.141592653589793 |      4.1
    1884608 | 3.141592653589793 |      4.1
    1884608 | 3.141592653589793 |      4.1
    1884608 | 3.141592653589793 |      4.1
    1884608 | 3.141592653589793 |      4.1
(5 rows)

-- select period_add with order by (explain)
--Testcase 2912:
EXPLAIN VERBOSE
SELECT id, period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl order by period_add(mysql_extract('YEAR_MONTH', c3 ), 199710);
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Result  (cost=2119.18..5574.84 rows=3413 width=12)
   Output: id, period_add(mysql_extract('YEAR_MONTH'::text, c3), 201907), (period_add(mysql_extract('YEAR_MONTH'::text, c3), 199710))
   ->  Sort  (cost=2119.18..2127.71 rows=3413 width=16)
         Output: id, (period_add(mysql_extract('YEAR_MONTH'::text, c3), 199710)), c3
         Sort Key: (period_add(mysql_extract('YEAR_MONTH'::text, time_tbl.c3), 199710))
         ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=16)
               Output: id, (period_add(mysql_extract('YEAR_MONTH'::text, c3), 199710)), c3
               Node: pgspider_svr / Status: Alive
                 Remote SQL: SELECT id, public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 199710), c3 FROM public.time_tblmysql
(9 rows)

-- select period_add with order by (result)
--Testcase 2913:
SELECT id, period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl order by period_add(mysql_extract('YEAR_MONTH', c3 ), 201907);
 id | period_add 
----+------------
  0 |    1884608
  1 |    1884608
  2 |    1884608
  3 |    1884608
  4 |    1884608
(5 rows)

-- select period_add with order by index (result)
--Testcase 2914:
SELECT id, period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl order by 2,1;
 id | period_add 
----+------------
  0 |    1884608
  1 |    1884608
  2 |    1884608
  3 |    1884608
  4 |    1884608
(5 rows)

-- select period_add with order by index (result)
--Testcase 2915:
SELECT id, period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl order by 1,2;
 id | period_add 
----+------------
  0 |    1884608
  1 |    1884608
  2 |    1884608
  3 |    1884608
  4 |    1884608
(5 rows)

-- select period_add with group by index (result)
--Testcase 2916:
SELECT id, period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by 2,1;
 id | period_add 
----+------------
  0 |    1884608
  1 |    1884608
  2 |    1884608
  3 |    1884608
  4 |    1884608
(5 rows)

-- select period_add with group by index (result)
--Testcase 2917:
SELECT id, period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by 1,2;
 id | period_add 
----+------------
  0 |    1884608
  1 |    1884608
  2 |    1884608
  3 |    1884608
  4 |    1884608
(5 rows)

-- select period_add with group by having (explain)
--Testcase 2918:
EXPLAIN VERBOSE
SELECT max(c3), period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by period_add(mysql_extract('YEAR_MONTH', c3 ), 201907),c3 HAVING period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) > 0;
                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (period_add(mysql_extract('YEAR_MONTH'::text, c3), 201907)), c3
   Filter: ((period_add(mysql_extract('YEAR_MONTH'::text, time_tbl.c3), 201907)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), c3 FROM public.time_tblmysql GROUP BY 2, 3 HAVING ((public.period_add(public.mysql_extract('YEAR_MONTH'::text, c3), 201907) > 0))
(7 rows)

-- select period_add with group by having (result)
--Testcase 2919:
SELECT max(c3), period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by period_add(mysql_extract('YEAR_MONTH', c3 ), 201907),c3 HAVING period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) > 0;
         max         | period_add 
---------------------+------------
 2021-01-03 12:10:30 |    1884608
 2021-01-04 23:12:13 |    1884608
 2021-01-05 11:12:12 |    1884608
 2021-01-06 16:00:00 |    1884608
 2021-01-07 00:59:59 |    1884608
(5 rows)

-- select period_add with group by index having (result)
--Testcase 2920:
SELECT id, c3, period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by 3, 2, 1 HAVING period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) > 0;
 id |         c3          | period_add 
----+---------------------+------------
  0 | 2021-01-03 12:10:30 |    1884608
  1 | 2021-01-04 23:12:13 |    1884608
  2 | 2021-01-05 11:12:12 |    1884608
  3 | 2021-01-06 16:00:00 |    1884608
  4 | 2021-01-07 00:59:59 |    1884608
(5 rows)

-- select period_add with group by index having (result)
--Testcase 2921:
SELECT id, c3, period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) FROM time_tbl group by 1, 2, 3 HAVING period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) > 0;
 id |         c3          | period_add 
----+---------------------+------------
  0 | 2021-01-03 12:10:30 |    1884608
  1 | 2021-01-04 23:12:13 |    1884608
  2 | 2021-01-05 11:12:12 |    1884608
  3 | 2021-01-06 16:00:00 |    1884608
  4 | 2021-01-07 00:59:59 |    1884608
(5 rows)

-- select period_add and as
--Testcase 2922:
SELECT period_add(mysql_extract('YEAR_MONTH', c3 ), 201907) as period_add1 FROM time_tbl;
 period_add1 
-------------
     1884608
     1884608
     1884608
     1884608
     1884608
(5 rows)

-- NOW()
-- mysql_now is mutable function, some executes will return different result
-- select mysql_now (stub function, explain)
--Testcase 2923:
EXPLAIN VERBOSE
SELECT mysql_now() FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_now())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_now() FROM public.time_tblmysql
(4 rows)

-- select mysql_now (stub function, not pushdown constraints, explain)
--Testcase 2924:
EXPLAIN VERBOSE
SELECT mysql_now() FROM time_tbl WHERE to_hex(id) > '0';
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (mysql_now())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_now(), id FROM public.time_tblmysql
(5 rows)

-- select mysql_now (stub function, pushdown constraints, explain)
--Testcase 2925:
EXPLAIN VERBOSE
SELECT mysql_now() FROM time_tbl WHERE id = 1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (mysql_now())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_now() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select mysql_now (stub function, mysql_now in constraints, explain)
--Testcase 2926:
EXPLAIN VERBOSE
SELECT mysql_now() FROM time_tbl WHERE mysql_now() > '2000-01-01 00:00:00'::timestamp;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (mysql_now())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_now() FROM public.time_tblmysql WHERE ((public.mysql_now() > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_now in constrains (stub function, explain)
--Testcase 2927:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE mysql_now() > '2000-01-01 00:00:00'::timestamp;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.mysql_now() > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_now in constrains (stub function, result)
--Testcase 2928:
SELECT c1 FROM time_tbl WHERE mysql_now() > '2000-01-01 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- mysql_now as parameter of addtime(stub function, explain)
--Testcase 2929:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_now(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp;
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_now(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_now as parameter of addtime(stub function, result)
--Testcase 2930:
SELECT c1 FROM time_tbl WHERE addtime(mysql_now(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_now and agg (pushdown, explain)
--Testcase 2931:
EXPLAIN VERBOSE
SELECT mysql_now(), sum(id) FROM time_tbl;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_now()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_now(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select mysql_now and log2 (pushdown, explain)
--Testcase 2932:
EXPLAIN VERBOSE
SELECT mysql_now(), log2(id) FROM time_tbl;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (mysql_now()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_now(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select mysql_now with non pushdown func and explicit constant (explain)
--Testcase 2933:
EXPLAIN VERBOSE
SELECT mysql_now(), to_hex(id), 4 FROM time_tbl;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (mysql_now()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_now(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select mysql_now with order by (explain)
--Testcase 2934:
EXPLAIN VERBOSE
SELECT mysql_now(), c1 FROM time_tbl ORDER BY mysql_now();
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (mysql_now()), c1
   Sort Key: (mysql_now())
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (mysql_now()), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_now(), c1 FROM public.time_tblmysql
(7 rows)

-- select mysql_now with order by index (explain)
--Testcase 2935:
EXPLAIN VERBOSE
SELECT mysql_now(), c1 FROM time_tbl ORDER BY 1;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (mysql_now()), c1
   Sort Key: (mysql_now())
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (mysql_now()), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_now(), c1 FROM public.time_tblmysql
(7 rows)

-- mysql_now constraints with order by (explain)
--Testcase 2936:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_now(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp ORDER BY c1;
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_now(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- mysql_now constraints with order by (result)
--Testcase 2937:
SELECT c1 FROM time_tbl WHERE addtime(mysql_now(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select mysql_now with group by (explain)
--Testcase 2938:
EXPLAIN VERBOSE
SELECT mysql_now(), c1 FROM time_tbl GROUP BY c1;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_now()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_now(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_now with group by index (explain)
--Testcase 2939:
EXPLAIN VERBOSE
SELECT mysql_now(), c1 FROM time_tbl GROUP BY 2;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_now()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_now(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_now with group by having (explain)
--Testcase 2940:
EXPLAIN VERBOSE
SELECT mysql_now(), c1 FROM time_tbl GROUP BY mysql_now(),c1 HAVING mysql_now() > '2000-01-01 00:00:00'::timestamp;
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_now()), c1
   Filter: ((mysql_now()) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_now(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.mysql_now() > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- select mysql_now with group by index having (explain)
--Testcase 2941:
EXPLAIN VERBOSE
SELECT mysql_now(), c1 FROM time_tbl GROUP BY 2,1 HAVING mysql_now() > '2000-01-01 00:00:00'::timestamp;
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_now()), c1
   Filter: ((mysql_now()) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_now(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.mysql_now() > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- mysql_now constraints with group by (explain)
--Testcase 2942:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_now(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp GROUP BY c1;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_now(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone)) GROUP BY 1
(6 rows)

-- mysql_now constraints with group by (result)
--Testcase 2943:
SELECT c1 FROM time_tbl WHERE addtime(mysql_now(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_now and as
--Testcase 2944:
EXPLAIN VERBOSE
SELECT mysql_now() as mysql_now1 FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_now())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_now() FROM public.time_tblmysql
(4 rows)

-- MONTHNAME()
-- select monthname (stub function, explain)
--Testcase 2945:
EXPLAIN VERBOSE
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                                       QUERY PLAN                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=128)
   Output: (monthname(c3)), (monthname((c2)::timestamp without time zone)), (monthname(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (monthname('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.monthname(c3), public.monthname(c2), public.monthname(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.monthname('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select monthname (stub function, result)
--Testcase 2946:
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
 monthname | monthname | monthname | monthname 
-----------+-----------+-----------+-----------
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
(5 rows)

-- select monthname (stub function, not pushdown constraints, explain)
--Testcase 2947:
EXPLAIN VERBOSE
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=128)
   Output: (monthname(c3)), (monthname((c2)::timestamp without time zone)), (monthname(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (monthname('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.monthname(c3), public.monthname(c2), public.monthname(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.monthname('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select monthname (stub function, not pushdown constraints, result)
--Testcase 2948:
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 monthname | monthname | monthname | monthname 
-----------+-----------+-----------+-----------
 January   | January   | January   | January
(1 row)

-- select monthname (stub function, pushdown constraints, explain)
--Testcase 2949:
EXPLAIN VERBOSE
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                                 QUERY PLAN                                                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=128)
   Output: (monthname(c3)), (monthname((c2)::timestamp without time zone)), (monthname(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (monthname('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.monthname(c3), public.monthname(c2), public.monthname(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.monthname('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select monthname (stub function, pushdown constraints, result)
--Testcase 2950:
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 monthname | monthname | monthname | monthname 
-----------+-----------+-----------+-----------
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
(5 rows)

-- select monthname (stub function, monthname in constraints, explain)
--Testcase 2951:
EXPLAIN VERBOSE
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE monthname(c3) = monthname('2000-01-01'::timestamp);
                                                                                                                                                                          QUERY PLAN                                                                                                                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1880.80 rows=17 width=128)
   Output: (monthname(c3)), (monthname((c2)::timestamp without time zone)), (monthname(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (monthname('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.monthname(c3), public.monthname(c2), public.monthname(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.monthname('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.monthname(c3) = public.monthname('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select monthname (stub function, monthname in constraints, result)
--Testcase 2952:
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE monthname(c3) = monthname('2000-01-01'::timestamp);
 monthname | monthname | monthname | monthname 
-----------+-----------+-----------+-----------
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
(5 rows)

-- select monthname (stub function, monthname in constraints, explain)
--Testcase 2953:
EXPLAIN VERBOSE
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE monthname('2021-01-01 12:00:00'::timestamp) = 'January';
                                                                                                                                                                       QUERY PLAN                                                                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1027.54 rows=17 width=128)
   Output: (monthname(c3)), (monthname((c2)::timestamp without time zone)), (monthname(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (monthname('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.monthname(c3), public.monthname(c2), public.monthname(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.monthname('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.monthname('2021-01-01 12:00:00'::timestamp without time zone) = 'January'::text))
(4 rows)

-- select monthname (stub function, monthname in constraints, result)
--Testcase 2954:
SELECT monthname(c3), monthname(c2), monthname(date_sub(c3, '1 12:59:10')), monthname('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE monthname('2021-01-01 12:00:00'::timestamp) = 'January';
 monthname | monthname | monthname | monthname 
-----------+-----------+-----------+-----------
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
 January   | January   | January   | January
(5 rows)

-- select monthname with agg (pushdown, explain)
--Testcase 2955:
EXPLAIN VERBOSE
SELECT max(c3), monthname(max(c3)) FROM time_tbl;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (monthname(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.monthname(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select monthname as nest function with agg (pushdown, result)
--Testcase 2956:
SELECT max(c3), monthname(max(c3)) FROM time_tbl;
         max         | monthname 
---------------------+-----------
 2021-01-07 00:59:59 | January
(1 row)

-- select monthname with non pushdown func and explicit constant (explain)
--Testcase 2957:
EXPLAIN VERBOSE
SELECT monthname(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=72)
   Output: (monthname(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.monthname(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select monthname with non pushdown func and explicit constant (result)
--Testcase 2958:
SELECT monthname(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 monthname |        pi         | ?column? 
-----------+-------------------+----------
 January   | 3.141592653589793 |      4.1
 January   | 3.141592653589793 |      4.1
 January   | 3.141592653589793 |      4.1
 January   | 3.141592653589793 |      4.1
 January   | 3.141592653589793 |      4.1
(5 rows)

-- select monthname with order by (explain)
--Testcase 2959:
EXPLAIN VERBOSE
SELECT id, monthname(c3 + '1 12:59:10') FROM time_tbl order by monthname(c3 + '1 12:59:10');
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=36)
   Output: id, (monthname((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (monthname((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=36)
         Output: id, (monthname((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.monthname((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select monthname with order by (result)
--Testcase 2960:
SELECT id, monthname(c3 + '1 12:59:10') FROM time_tbl order by monthname(c3 + '1 12:59:10');
 id | monthname 
----+-----------
  0 | January
  1 | January
  2 | January
  3 | January
  4 | January
(5 rows)

-- select monthname with order by index (result)
--Testcase 2961:
SELECT id, monthname(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | monthname 
----+-----------
  0 | January
  1 | January
  2 | January
  3 | January
  4 | January
(5 rows)

-- select monthname with order by index (result)
--Testcase 2962:
SELECT id, monthname(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | monthname 
----+-----------
  0 | January
  1 | January
  2 | January
  3 | January
  4 | January
(5 rows)

-- select monthname with group by (explain)
--Testcase 2963:
EXPLAIN VERBOSE
SELECT max(c3), monthname(c3 + '1 12:59:10') FROM time_tbl group by monthname(c3 + '1 12:59:10');
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (max(c3)), (monthname((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.monthname((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select monthname with group by (result)
--Testcase 2964:
SELECT max(c3), monthname(c3 + '1 12:59:10') FROM time_tbl group by monthname(c3 + '1 12:59:10');
         max         | monthname 
---------------------+-----------
 2021-01-07 00:59:59 | January
(1 row)

-- select monthname with group by index (result)
--Testcase 2965:
SELECT id, monthname(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | monthname 
----+-----------
  0 | January
  1 | January
  2 | January
  3 | January
  4 | January
(5 rows)

-- select monthname with group by index (result)
--Testcase 2966:
SELECT id, monthname(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | monthname 
----+-----------
  0 | January
  1 | January
  2 | January
  3 | January
  4 | January
(5 rows)

-- select monthname with group by having (explain)
--Testcase 2967:
EXPLAIN VERBOSE
SELECT max(c3), monthname(c3 + '1 12:59:10') FROM time_tbl group by monthname(c3 + '1 12:59:10'), c3 HAVING monthname(c3 + '1 12:59:10') = 'January';
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=48)
   Output: (max(c3)), (monthname((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((monthname((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) = 'January'::text)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.monthname((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select monthname with group by having (result)
--Testcase 2968:
SELECT max(c3), monthname(c3 + '1 12:59:10') FROM time_tbl group by monthname(c3 + '1 12:59:10'), c3 HAVING monthname(c3 + '1 12:59:10') = 'January';
         max         | monthname 
---------------------+-----------
 2021-01-03 12:10:30 | January
 2021-01-04 23:12:13 | January
 2021-01-05 11:12:12 | January
 2021-01-06 16:00:00 | January
 2021-01-07 00:59:59 | January
(5 rows)

-- select monthname with group by index having (result)
--Testcase 2969:
SELECT id, monthname(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING monthname(c3 + '1 12:59:10') = 'January';
 id | monthname |         c3          
----+-----------+---------------------
  0 | January   | 2021-01-03 12:10:30
  1 | January   | 2021-01-04 23:12:13
  2 | January   | 2021-01-05 11:12:12
  3 | January   | 2021-01-06 16:00:00
  4 | January   | 2021-01-07 00:59:59
(5 rows)

-- select monthname with group by index having (result)
--Testcase 2970:
SELECT id, monthname(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING monthname(c3 + '1 12:59:10') = 'January';
 id | monthname |         c3          
----+-----------+---------------------
  0 | January   | 2021-01-03 12:10:30
  1 | January   | 2021-01-04 23:12:13
  2 | January   | 2021-01-05 11:12:12
  3 | January   | 2021-01-06 16:00:00
  4 | January   | 2021-01-07 00:59:59
(5 rows)

-- select monthname and as
--Testcase 2971:
SELECT monthname(date_sub(c3, '1 12:59:10')) as monthname1 FROM time_tbl;
 monthname1 
------------
 January
 January
 January
 January
 January
(5 rows)

-- MONTH()
-- select month (stub function, explain)
--Testcase 2972:
EXPLAIN VERBOSE
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                               QUERY PLAN                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=16)
   Output: (month(c3)), (month((c2)::timestamp without time zone)), (month(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (month('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.month(c3), public.month(c2), public.month(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.month('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select month (stub function, result)
--Testcase 2973:
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
 month | month | month | month 
-------+-------+-------+-------
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
(5 rows)

-- select month (stub function, not pushdown constraints, explain)
--Testcase 2974:
EXPLAIN VERBOSE
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=16)
   Output: (month(c3)), (month((c2)::timestamp without time zone)), (month(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (month('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.month(c3), public.month(c2), public.month(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.month('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select month (stub function, not pushdown constraints, result)
--Testcase 2975:
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 month | month | month | month 
-------+-------+-------+-------
     1 |     1 |     1 |     1
(1 row)

-- select month (stub function, pushdown constraints, explain)
--Testcase 2976:
EXPLAIN VERBOSE
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=16)
   Output: (month(c3)), (month((c2)::timestamp without time zone)), (month(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (month('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.month(c3), public.month(c2), public.month(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.month('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select month (stub function, pushdown constraints, result)
--Testcase 2977:
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 month | month | month | month 
-------+-------+-------+-------
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
(5 rows)

-- select month (stub function, month in constraints, explain)
--Testcase 2978:
EXPLAIN VERBOSE
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE month(c3) = month('2000-01-01'::timestamp);
                                                                                                                                                              QUERY PLAN                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1880.80 rows=17 width=16)
   Output: (month(c3)), (month((c2)::timestamp without time zone)), (month(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (month('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.month(c3), public.month(c2), public.month(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.month('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.month(c3) = public.month('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select month (stub function, month in constraints, result)
--Testcase 2979:
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE month(c3) = month('2000-01-01'::timestamp);
 month | month | month | month 
-------+-------+-------+-------
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
(5 rows)

-- select month (stub function, month in constraints, explain)
--Testcase 2980:
EXPLAIN VERBOSE
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE month('2021-01-01 12:00:00'::timestamp) = '1';
                                                                                                                                                      QUERY PLAN                                                                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1027.54 rows=17 width=16)
   Output: (month(c3)), (month((c2)::timestamp without time zone)), (month(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (month('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.month(c3), public.month(c2), public.month(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.month('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.month('2021-01-01 12:00:00'::timestamp without time zone) = 1))
(4 rows)

-- select month (stub function, month in constraints, result)
--Testcase 2981:
SELECT month(c3), month(c2), month(date_sub(c3, '1 12:59:10')), month('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE month('2021-01-01 12:00:00'::timestamp) = '1';
 month | month | month | month 
-------+-------+-------+-------
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
     1 |     1 |     1 |     1
(5 rows)

-- select month with agg (pushdown, explain)
--Testcase 2982:
EXPLAIN VERBOSE
SELECT max(c3), month(max(c3)) FROM time_tbl;
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (month(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.month(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select month as nest function with agg (pushdown, result)
--Testcase 2983:
SELECT max(c3), month(max(c3)) FROM time_tbl;
         max         | month 
---------------------+-------
 2021-01-07 00:59:59 |     1
(1 row)

-- select month with non pushdown func and explicit constant (explain)
--Testcase 2984:
EXPLAIN VERBOSE
SELECT month(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (month(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.month(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select month with non pushdown func and explicit constant (result)
--Testcase 2985:
SELECT month(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 month |        pi         | ?column? 
-------+-------------------+----------
     1 | 3.141592653589793 |      4.1
     1 | 3.141592653589793 |      4.1
     1 | 3.141592653589793 |      4.1
     1 | 3.141592653589793 |      4.1
     1 | 3.141592653589793 |      4.1
(5 rows)

-- select month with order by (explain)
--Testcase 2986:
EXPLAIN VERBOSE
SELECT id, month(c3 + '1 12:59:10') FROM time_tbl order by month(c3 + '1 12:59:10');
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=8)
   Output: id, (month((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (month((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=8)
         Output: id, (month((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.month((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select month with order by (result)
--Testcase 2987:
SELECT id, month(c3 + '1 12:59:10') FROM time_tbl order by month(c3 + '1 12:59:10');
 id | month 
----+-------
  0 |     1
  1 |     1
  2 |     1
  3 |     1
  4 |     1
(5 rows)

-- select month with order by index (result)
--Testcase 2988:
SELECT id, month(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | month 
----+-------
  0 |     1
  1 |     1
  2 |     1
  3 |     1
  4 |     1
(5 rows)

-- select month with order by index (result)
--Testcase 2989:
SELECT id, month(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | month 
----+-------
  0 |     1
  1 |     1
  2 |     1
  3 |     1
  4 |     1
(5 rows)

-- select month with group by (explain)
--Testcase 2990:
EXPLAIN VERBOSE
SELECT max(c3), month(c3 + '1 12:59:10') FROM time_tbl group by month(c3 + '1 12:59:10');
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (month((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.month((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select month with group by (result)
--Testcase 2991:
SELECT max(c3), month(c3 + '1 12:59:10') FROM time_tbl group by month(c3 + '1 12:59:10');
         max         | month 
---------------------+-------
 2021-01-07 00:59:59 |     1
(1 row)

-- select month with group by index (result)
--Testcase 2992:
SELECT id, month(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | month 
----+-------
  0 |     1
  1 |     1
  2 |     1
  3 |     1
  4 |     1
(5 rows)

-- select month with group by index (result)
--Testcase 2993:
SELECT id, month(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | month 
----+-------
  0 |     1
  1 |     1
  2 |     1
  3 |     1
  4 |     1
(5 rows)

-- select month with group by having (explain)
--Testcase 2994:
EXPLAIN VERBOSE
SELECT max(c3), month(c3 + '1 12:59:10') FROM time_tbl group by month(c3 + '1 12:59:10'), c3 HAVING month(c3 + '1 12:59:10') < 12;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (month((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((month((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) < 12)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.month((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select month with group by having (result)
--Testcase 2995:
SELECT max(c3), month(c3 + '1 12:59:10') FROM time_tbl group by month(c3 + '1 12:59:10'), c3 HAVING month(c3 + '1 12:59:10') < 12;
         max         | month 
---------------------+-------
 2021-01-03 12:10:30 |     1
 2021-01-04 23:12:13 |     1
 2021-01-05 11:12:12 |     1
 2021-01-06 16:00:00 |     1
 2021-01-07 00:59:59 |     1
(5 rows)

-- select month with group by index having (result)
--Testcase 2996:
SELECT id, month(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING month(c3 + '1 12:59:10') < 12;
 id | month |         c3          
----+-------+---------------------
  0 |     1 | 2021-01-03 12:10:30
  1 |     1 | 2021-01-04 23:12:13
  2 |     1 | 2021-01-05 11:12:12
  3 |     1 | 2021-01-06 16:00:00
  4 |     1 | 2021-01-07 00:59:59
(5 rows)

-- select month with group by index having (result)
--Testcase 2997:
SELECT id, month(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING month(c3 + '1 12:59:10') < 12;
 id | month |         c3          
----+-------+---------------------
  0 |     1 | 2021-01-03 12:10:30
  1 |     1 | 2021-01-04 23:12:13
  2 |     1 | 2021-01-05 11:12:12
  3 |     1 | 2021-01-06 16:00:00
  4 |     1 | 2021-01-07 00:59:59
(5 rows)

-- select month and as
--Testcase 2998:
SELECT month(date_sub(c3, '1 12:59:10')) as month1 FROM time_tbl;
 month1 
--------
      1
      1
      1
      1
      1
(5 rows)

-- MINUTE()
-- select minute (stub function, explain)
--Testcase 2999:
EXPLAIN VERBOSE
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=16)
   Output: (minute(c3)), (minute((c2)::timestamp without time zone)), (minute(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (minute('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.minute(c3), public.minute(c2), public.minute(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.minute('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select minute (stub function, result)
--Testcase 3000:
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
 minute | minute | minute | minute 
--------+--------+--------+--------
     10 |      0 |     11 |      0
     12 |      0 |     13 |      0
     12 |      0 |     13 |      0
      0 |      0 |      0 |      0
     59 |      0 |      0 |      0
(5 rows)

-- select minute (stub function, not pushdown constraints, explain)
--Testcase 3001:
EXPLAIN VERBOSE
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=16)
   Output: (minute(c3)), (minute((c2)::timestamp without time zone)), (minute(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (minute('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.minute(c3), public.minute(c2), public.minute(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.minute('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select minute (stub function, not pushdown constraints, result)
--Testcase 3002:
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 minute | minute | minute | minute 
--------+--------+--------+--------
     12 |      0 |     13 |      0
(1 row)

-- select minute (stub function, pushdown constraints, explain)
--Testcase 3003:
EXPLAIN VERBOSE
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=16)
   Output: (minute(c3)), (minute((c2)::timestamp without time zone)), (minute(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (minute('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.minute(c3), public.minute(c2), public.minute(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.minute('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select minute (stub function, pushdown constraints, result)
--Testcase 3004:
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 minute | minute | minute | minute 
--------+--------+--------+--------
     10 |      0 |     11 |      0
     12 |      0 |     13 |      0
     12 |      0 |     13 |      0
      0 |      0 |      0 |      0
     59 |      0 |      0 |      0
(5 rows)

-- select minute (stub function, minute in constraints, explain)
--Testcase 3005:
EXPLAIN VERBOSE
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE minute(c3) > minute('2000-01-01'::timestamp);
                                                                                                                                                                 QUERY PLAN                                                                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3307.27 rows=1138 width=16)
   Output: (minute(c3)), (minute((c2)::timestamp without time zone)), (minute(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (minute('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.minute(c3), public.minute(c2), public.minute(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.minute('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.minute(c3) > public.minute('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select minute (stub function, minute in constraints, result)
--Testcase 3006:
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE minute(c3) > minute('2000-01-01'::timestamp);
 minute | minute | minute | minute 
--------+--------+--------+--------
     10 |      0 |     11 |      0
     12 |      0 |     13 |      0
     12 |      0 |     13 |      0
     59 |      0 |      0 |      0
(4 rows)

-- select minute (stub function, minute in constraints, explain)
--Testcase 3007:
EXPLAIN VERBOSE
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE minute('2021-01-01 12:00:00'::timestamp) < 1;
                                                                                                                                                         QUERY PLAN                                                                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2454.02 rows=1138 width=16)
   Output: (minute(c3)), (minute((c2)::timestamp without time zone)), (minute(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (minute('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.minute(c3), public.minute(c2), public.minute(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.minute('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.minute('2021-01-01 12:00:00'::timestamp without time zone) < 1))
(4 rows)

-- select minute (stub function, minute in constraints, result)
--Testcase 3008:
SELECT minute(c3), minute(c2), minute(date_sub(c3, '1 12:59:10')), minute('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE minute('2021-01-01 12:00:00'::timestamp) < 1;
 minute | minute | minute | minute 
--------+--------+--------+--------
     10 |      0 |     11 |      0
     12 |      0 |     13 |      0
     12 |      0 |     13 |      0
      0 |      0 |      0 |      0
     59 |      0 |      0 |      0
(5 rows)

-- select minute with agg (pushdown, explain)
--Testcase 3009:
EXPLAIN VERBOSE
SELECT max(c3), minute(max(c3)) FROM time_tbl;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (minute(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.minute(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select minute as nest function with agg (pushdown, result)
--Testcase 3010:
SELECT max(c3), minute(max(c3)) FROM time_tbl;
         max         | minute 
---------------------+--------
 2021-01-07 00:59:59 |     59
(1 row)

-- select minute with non pushdown func and explicit constant (explain)
--Testcase 3011:
EXPLAIN VERBOSE
SELECT minute(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (minute(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.minute(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select minute with non pushdown func and explicit constant (result)
--Testcase 3012:
SELECT minute(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 minute |        pi         | ?column? 
--------+-------------------+----------
     11 | 3.141592653589793 |      4.1
     13 | 3.141592653589793 |      4.1
     13 | 3.141592653589793 |      4.1
      0 | 3.141592653589793 |      4.1
      0 | 3.141592653589793 |      4.1
(5 rows)

-- select minute with order by (explain)
--Testcase 3013:
EXPLAIN VERBOSE
SELECT id, minute(c3 + '1 12:59:10') FROM time_tbl order by minute(c3 + '1 12:59:10');
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=8)
   Output: id, (minute((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (minute((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=8)
         Output: id, (minute((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.minute((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select minute with order by (result)
--Testcase 3014:
SELECT id, minute(c3 + '1 12:59:10') FROM time_tbl order by minute(c3 + '1 12:59:10');
 id | minute 
----+--------
  0 |      9
  1 |     11
  2 |     11
  3 |     59
  4 |     59
(5 rows)

-- select minute with order by index (result)
--Testcase 3015:
SELECT id, minute(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id | minute 
----+--------
  0 |      9
  1 |     11
  2 |     11
  3 |     59
  4 |     59
(5 rows)

-- select minute with order by index (result)
--Testcase 3016:
SELECT id, minute(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id | minute 
----+--------
  0 |      9
  1 |     11
  2 |     11
  3 |     59
  4 |     59
(5 rows)

-- select minute with group by (explain)
--Testcase 3017:
EXPLAIN VERBOSE
SELECT max(c3), minute(c3 + '1 12:59:10') FROM time_tbl group by minute(c3 + '1 12:59:10');
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (minute((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.minute((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select minute with group by (result)
--Testcase 3018:
SELECT max(c3), minute(c3 + '1 12:59:10') FROM time_tbl group by minute(c3 + '1 12:59:10');
         max         | minute 
---------------------+--------
 2021-01-03 12:10:30 |      9
 2021-01-05 11:12:12 |     11
 2021-01-07 00:59:59 |     59
(3 rows)

-- select minute with group by index (result)
--Testcase 3019:
SELECT id, minute(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id | minute 
----+--------
  0 |      9
  1 |     11
  2 |     11
  3 |     59
  4 |     59
(5 rows)

-- select minute with group by index (result)
--Testcase 3020:
SELECT id, minute(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id | minute 
----+--------
  0 |      9
  1 |     11
  2 |     11
  3 |     59
  4 |     59
(5 rows)

-- select minute with group by having (explain)
--Testcase 3021:
EXPLAIN VERBOSE
SELECT max(c3), minute(c3 + '1 12:59:10') FROM time_tbl group by minute(c3 + '1 12:59:10'), c3 HAVING minute(c3 + '1 12:59:10') < 60;
                                                                   QUERY PLAN                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (minute((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((minute((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) < 60)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.minute((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select minute with group by having (result)
--Testcase 3022:
SELECT max(c3), minute(c3 + '1 12:59:10') FROM time_tbl group by minute(c3 + '1 12:59:10'), c3 HAVING minute(c3 + '1 12:59:10') < 60;
         max         | minute 
---------------------+--------
 2021-01-03 12:10:30 |      9
 2021-01-04 23:12:13 |     11
 2021-01-05 11:12:12 |     11
 2021-01-06 16:00:00 |     59
 2021-01-07 00:59:59 |     59
(5 rows)

-- select minute with group by index having (result)
--Testcase 3023:
SELECT id, minute(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING minute(c3 + '1 12:59:10') < 60;
 id | minute |         c3          
----+--------+---------------------
  0 |      9 | 2021-01-03 12:10:30
  1 |     11 | 2021-01-04 23:12:13
  2 |     11 | 2021-01-05 11:12:12
  3 |     59 | 2021-01-06 16:00:00
  4 |     59 | 2021-01-07 00:59:59
(5 rows)

-- select minute with group by index having (result)
--Testcase 3024:
SELECT id, minute(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING minute(c3 + '1 12:59:10') < 60;
 id | minute |         c3          
----+--------+---------------------
  0 |      9 | 2021-01-03 12:10:30
  1 |     11 | 2021-01-04 23:12:13
  2 |     11 | 2021-01-05 11:12:12
  3 |     59 | 2021-01-06 16:00:00
  4 |     59 | 2021-01-07 00:59:59
(5 rows)

-- select minute and as
--Testcase 3025:
SELECT minute(date_sub(c3, '1 12:59:10')) as minute1 FROM time_tbl;
 minute1 
---------
      11
      13
      13
       0
       0
(5 rows)

-- MICROSECOND()
-- select microsecond (stub function, explain)
--Testcase 3026:
EXPLAIN VERBOSE
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl;
                                                                                                                               QUERY PLAN                                                                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=16)
   Output: (microsecond(c3)), (microsecond((c2)::timestamp without time zone)), (microsecond(date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval))), (microsecond('2021-01-01 12:00:00.986'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.microsecond(c3), public.microsecond(c2), public.microsecond(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval)), public.microsecond('2021-01-01 12:00:00.986'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select microsecond (stub function, result)
--Testcase 3027:
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl;
 microsecond | microsecond | microsecond | microsecond 
-------------+-------------+-------------+-------------
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
(5 rows)

-- select microsecond (stub function, not pushdown constraints, explain)
--Testcase 3028:
EXPLAIN VERBOSE
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                 QUERY PLAN                                                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=16)
   Output: (microsecond(c3)), (microsecond((c2)::timestamp without time zone)), (microsecond(date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval))), (microsecond('2021-01-01 12:00:00.986'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.microsecond(c3), public.microsecond(c2), public.microsecond(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval)), public.microsecond('2021-01-01 12:00:00.986'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select microsecond (stub function, not pushdown constraints, result)
--Testcase 3029:
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 microsecond | microsecond | microsecond | microsecond 
-------------+-------------+-------------+-------------
           0 |           0 |      846000 |      986000
(1 row)

-- select microsecond (stub function, pushdown constraints, explain)
--Testcase 3030:
EXPLAIN VERBOSE
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                                         QUERY PLAN                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=16)
   Output: (microsecond(c3)), (microsecond((c2)::timestamp without time zone)), (microsecond(date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval))), (microsecond('2021-01-01 12:00:00.986'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.microsecond(c3), public.microsecond(c2), public.microsecond(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval)), public.microsecond('2021-01-01 12:00:00.986'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select microsecond (stub function, pushdown constraints, result)
--Testcase 3031:
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl WHERE id != 200;
 microsecond | microsecond | microsecond | microsecond 
-------------+-------------+-------------+-------------
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
(5 rows)

-- select microsecond (stub function, microsecond in constraints, explain)
--Testcase 3032:
EXPLAIN VERBOSE
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl WHERE microsecond(c3) = microsecond('2000-01-01'::timestamp);
                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1880.80 rows=17 width=16)
   Output: (microsecond(c3)), (microsecond((c2)::timestamp without time zone)), (microsecond(date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval))), (microsecond('2021-01-01 12:00:00.986'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.microsecond(c3), public.microsecond(c2), public.microsecond(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval)), public.microsecond('2021-01-01 12:00:00.986'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.microsecond(c3) = public.microsecond('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select microsecond (stub function, microsecond in constraints, result)
--Testcase 3033:
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl WHERE microsecond(c3) = microsecond('2000-01-01'::timestamp);
 microsecond | microsecond | microsecond | microsecond 
-------------+-------------+-------------+-------------
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
(5 rows)

-- select microsecond (stub function, microsecond in constraints, explain)
--Testcase 3034:
EXPLAIN VERBOSE
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl WHERE microsecond('2021-01-01 12:00:00'::timestamp) = '0';
                                                                                                                                                                         QUERY PLAN                                                                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1027.54 rows=17 width=16)
   Output: (microsecond(c3)), (microsecond((c2)::timestamp without time zone)), (microsecond(date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval))), (microsecond('2021-01-01 12:00:00.986'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.microsecond(c3), public.microsecond(c2), public.microsecond(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10.154 secs'::interval)), public.microsecond('2021-01-01 12:00:00.986'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.microsecond('2021-01-01 12:00:00'::timestamp without time zone) = 0))
(4 rows)

-- select microsecond (stub function, microsecond in constraints, result)
--Testcase 3035:
SELECT microsecond(c3), microsecond(c2), microsecond(date_sub(c3, '1 12:59:10.154')), microsecond('2021-01-01 12:00:00.986'::timestamp) FROM time_tbl WHERE microsecond('2021-01-01 12:00:00'::timestamp) = '0';
 microsecond | microsecond | microsecond | microsecond 
-------------+-------------+-------------+-------------
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
           0 |           0 |      846000 |      986000
(5 rows)

-- select microsecond with agg (pushdown, explain)
--Testcase 3036:
EXPLAIN VERBOSE
SELECT max(c3), microsecond(max(c3)) FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (microsecond(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.microsecond(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select microsecond as nest function with agg (pushdown, result)
--Testcase 3037:
SELECT max(c3), microsecond(max(c3)) FROM time_tbl;
         max         | microsecond 
---------------------+-------------
 2021-01-07 00:59:59 |           0
(1 row)

-- select microsecond with non pushdown func and explicit constant (explain)
--Testcase 3038:
EXPLAIN VERBOSE
SELECT microsecond(date_sub(c3, '1 12:59:10.999')), pi(), 4.1 FROM time_tbl;
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (microsecond(date_sub(c3, '@ 1 day 12 hours 59 mins 10.999 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.microsecond(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10.999 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select microsecond with non pushdown func and explicit constant (result)
--Testcase 3039:
SELECT microsecond(date_sub(c3, '1 12:59:10.999')), pi(), 4.1 FROM time_tbl;
 microsecond |        pi         | ?column? 
-------------+-------------------+----------
        1000 | 3.141592653589793 |      4.1
        1000 | 3.141592653589793 |      4.1
        1000 | 3.141592653589793 |      4.1
        1000 | 3.141592653589793 |      4.1
        1000 | 3.141592653589793 |      4.1
(5 rows)

-- select microsecond with order by (explain)
--Testcase 3040:
EXPLAIN VERBOSE
SELECT id, microsecond(c3 + '1 12:59:10.999') FROM time_tbl order by microsecond(c3 + '1 12:59:10.999');
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=8)
   Output: id, (microsecond((c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval)))
   Sort Key: (microsecond((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=8)
         Output: id, (microsecond((c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.microsecond((c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select microsecond with order by (result)
--Testcase 3041:
SELECT id, microsecond(c3 + '1 12:59:10.999') FROM time_tbl order by microsecond(c3 + '1 12:59:10.999');
 id | microsecond 
----+-------------
  0 |      999000
  1 |      999000
  2 |      999000
  3 |      999000
  4 |      999000
(5 rows)

-- select microsecond with order by index (result)
--Testcase 3042:
SELECT id, microsecond(c3 + '1 12:59:10.999') FROM time_tbl order by 2,1;
 id | microsecond 
----+-------------
  0 |      999000
  1 |      999000
  2 |      999000
  3 |      999000
  4 |      999000
(5 rows)

-- select microsecond with order by index (result)
--Testcase 3043:
SELECT id, microsecond(c3 + '1 12:59:10.999') FROM time_tbl order by 1,2;
 id | microsecond 
----+-------------
  0 |      999000
  1 |      999000
  2 |      999000
  3 |      999000
  4 |      999000
(5 rows)

-- select microsecond with group by (explain)
--Testcase 3044:
EXPLAIN VERBOSE
SELECT max(c3), microsecond(c3 + '1 12:59:10.999') FROM time_tbl group by microsecond(c3 + '1 12:59:10.999');
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (microsecond((c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.microsecond((c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select microsecond with group by (result)
--Testcase 3045:
SELECT max(c3), microsecond(c3 + '1 12:59:10.999') FROM time_tbl group by microsecond(c3 + '1 12:59:10.999');
         max         | microsecond 
---------------------+-------------
 2021-01-07 00:59:59 |      999000
(1 row)

-- select microsecond with group by index (result)
--Testcase 3046:
SELECT id, microsecond(c3 + '1 12:59:10.999') FROM time_tbl group by 2,1;
 id | microsecond 
----+-------------
  0 |      999000
  1 |      999000
  2 |      999000
  3 |      999000
  4 |      999000
(5 rows)

-- select microsecond with group by index (result)
--Testcase 3047:
SELECT id, microsecond(c3 + '1 12:59:10.999') FROM time_tbl group by 1,2;
 id | microsecond 
----+-------------
  0 |      999000
  1 |      999000
  2 |      999000
  3 |      999000
  4 |      999000
(5 rows)

-- select microsecond with group by having (explain)
--Testcase 3048:
EXPLAIN VERBOSE
SELECT max(c3), microsecond(c3 + '1 12:59:10.999') FROM time_tbl group by microsecond(c3 + '1 12:59:10.999'), c3 HAVING microsecond(c3 + '1 12:59:10.999') > 1000;
                                                                       QUERY PLAN                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (microsecond((c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval))), c3
   Filter: ((microsecond((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval))) > 1000)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.microsecond((c3 + '@ 1 day 12 hours 59 mins 10.999 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select microsecond with group by having (result)
--Testcase 3049:
SELECT max(c3), microsecond(c3 + '1 12:59:10.999') FROM time_tbl group by microsecond(c3 + '1 12:59:10.999'), c3 HAVING microsecond(c3 + '1 12:59:10.999') > 1000;
         max         | microsecond 
---------------------+-------------
 2021-01-03 12:10:30 |      999000
 2021-01-04 23:12:13 |      999000
 2021-01-05 11:12:12 |      999000
 2021-01-06 16:00:00 |      999000
 2021-01-07 00:59:59 |      999000
(5 rows)

-- select microsecond with group by index having (result)
--Testcase 3050:
SELECT id, microsecond(c3 + '1 12:59:10.999'), c3 FROM time_tbl group by 3, 2, 1 HAVING microsecond(c3 + '1 12:59:10.999') > 1000;
 id | microsecond |         c3          
----+-------------+---------------------
  0 |      999000 | 2021-01-03 12:10:30
  1 |      999000 | 2021-01-04 23:12:13
  2 |      999000 | 2021-01-05 11:12:12
  3 |      999000 | 2021-01-06 16:00:00
  4 |      999000 | 2021-01-07 00:59:59
(5 rows)

-- select microsecond with group by index having (result)
--Testcase 3051:
SELECT id, microsecond(c3 + '1 12:59:10.999'), c3 FROM time_tbl group by 1, 2, 3 HAVING microsecond(c3 + '1 12:59:10.999') > 1000;
 id | microsecond |         c3          
----+-------------+---------------------
  0 |      999000 | 2021-01-03 12:10:30
  1 |      999000 | 2021-01-04 23:12:13
  2 |      999000 | 2021-01-05 11:12:12
  3 |      999000 | 2021-01-06 16:00:00
  4 |      999000 | 2021-01-07 00:59:59
(5 rows)

-- select microsecond and as
--Testcase 3052:
SELECT microsecond(date_sub(c3, '1 12:59:10.999')) as microsecond1 FROM time_tbl;
 microsecond1 
--------------
         1000
         1000
         1000
         1000
         1000
(5 rows)

-- MAKETIME()
-- select maketime (stub function, explain)
--Testcase 3053:
EXPLAIN VERBOSE
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=8)
   Output: (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.maketime(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30) FROM public.time_tblmysql
(4 rows)

-- select maketime (stub function, result)
--Testcase 3054:
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl;
 maketime 
----------
 18:15:30
 18:15:30
 18:15:30
 18:15:30
 18:15:30
(5 rows)

-- select maketime (stub function, not pushdown constraints, explain)
--Testcase 3055:
EXPLAIN VERBOSE
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl WHERE to_hex(id) = '1';
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..241.94 rows=17 width=8)
   Output: (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.maketime(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30), id FROM public.time_tblmysql
(5 rows)

-- select maketime (stub function, not pushdown constraints, result)
--Testcase 3056:
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl WHERE to_hex(id) = '1';
 maketime 
----------
 18:15:30
(1 row)

-- select maketime (stub function, pushdown constraints, explain)
--Testcase 3057:
EXPLAIN VERBOSE
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl WHERE id != 200;
                                                                               QUERY PLAN                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2767.58 rows=3396 width=8)
   Output: (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.maketime(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select maketime (stub function, pushdown constraints, result)
--Testcase 3058:
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl WHERE id != 200;
 maketime 
----------
 18:15:30
 18:15:30
 18:15:30
 18:15:30
 18:15:30
(5 rows)

-- select maketime (stub function, maketime in constraints, explain)
--Testcase 3059:
EXPLAIN VERBOSE
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl WHERE maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) > '12:59:10'::time;
                                                                                                                                             QUERY PLAN                                                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3588.67 rows=1138 width=8)
   Output: (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.maketime(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30) FROM public.time_tblmysql WHERE ((public.maketime(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30) > '12:59:10'::time without time zone))
(4 rows)

-- select maketime (stub function, maketime in constraints, result)
--Testcase 3060:
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl WHERE maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) > '12:59:10'::time;
 maketime 
----------
 18:15:30
 18:15:30
 18:15:30
 18:15:30
 18:15:30
(5 rows)

-- select maketime with agg (pushdown, explain)
--Testcase 3061:
EXPLAIN VERBOSE
SELECT max(c3), maketime(18, 15, 30) FROM time_tbl;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (maketime(18, 15, 30))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.maketime(18, 15, 30) FROM public.time_tblmysql
(6 rows)

-- select maketime as nest function with agg (pushdown, result)
--Testcase 3062:
SELECT max(c3), maketime(18, 15, 30) FROM time_tbl;
         max         | maketime 
---------------------+----------
 2021-01-07 00:59:59 | 18:15:30
(1 row)

-- select maketime with non pushdown func and explicit constant (explain)
--Testcase 3063:
EXPLAIN VERBOSE
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30), pi(), 4.1 FROM time_tbl;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=48)
   Output: (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.maketime(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select maketime with non pushdown func and explicit constant (result)
--Testcase 3064:
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30), pi(), 4.1 FROM time_tbl;
 maketime |        pi         | ?column? 
----------+-------------------+----------
 18:15:30 | 3.141592653589793 |      4.1
 18:15:30 | 3.141592653589793 |      4.1
 18:15:30 | 3.141592653589793 |      4.1
 18:15:30 | 3.141592653589793 |      4.1
 18:15:30 | 3.141592653589793 |      4.1
(5 rows)

-- select maketime with order by (explain)
--Testcase 3065:
EXPLAIN VERBOSE
SELECT id, maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl order by maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30);
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2972.43..2980.96 rows=3413 width=12)
   Output: id, (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30))
   Sort Key: (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, time_tbl.c3), 201907), 15, 30))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=12)
         Output: id, (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.maketime(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30) FROM public.time_tblmysql
(7 rows)

-- select maketime with order by (result)
--Testcase 3066:
SELECT id, maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl order by maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30);
 id | maketime 
----+----------
  0 | 18:15:30
  1 | 18:15:30
  2 | 18:15:30
  3 | 18:15:30
  4 | 18:15:30
(5 rows)

-- select maketime with order by index (result)
--Testcase 3067:
SELECT id, maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl order by 2,1;
 id | maketime 
----+----------
  0 | 18:15:30
  1 | 18:15:30
  2 | 18:15:30
  3 | 18:15:30
  4 | 18:15:30
(5 rows)

-- select maketime with order by index (result)
--Testcase 3068:
SELECT id, maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl order by 1,2;
 id | maketime 
----+----------
  0 | 18:15:30
  1 | 18:15:30
  2 | 18:15:30
  3 | 18:15:30
  4 | 18:15:30
(5 rows)

-- select maketime with group by (explain)
--Testcase 3069:
EXPLAIN VERBOSE
SELECT max(c3), maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl group by maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30), c3;
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (maketime(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30)), c3
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.maketime(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 15, 30), c3 FROM public.time_tblmysql GROUP BY 2, 3
(6 rows)

-- select maketime with group by (result)
--Testcase 3070:
SELECT max(c3), maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl group by maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30), c3;
         max         | maketime 
---------------------+----------
 2021-01-03 12:10:30 | 18:15:30
 2021-01-04 23:12:13 | 18:15:30
 2021-01-05 11:12:12 | 18:15:30
 2021-01-06 16:00:00 | 18:15:30
 2021-01-07 00:59:59 | 18:15:30
(5 rows)

-- select maketime with group by index (result)
--Testcase 3071:
SELECT id, maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl group by 2,1;
 id | maketime 
----+----------
  0 | 18:15:30
  1 | 18:15:30
  2 | 18:15:30
  3 | 18:15:30
  4 | 18:15:30
(5 rows)

-- select maketime with group by index (result)
--Testcase 3072:
SELECT id, maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl group by 1,2;
 id | maketime 
----+----------
  0 | 18:15:30
  1 | 18:15:30
  2 | 18:15:30
  3 | 18:15:30
  4 | 18:15:30
(5 rows)

-- select maketime with group by index having (result)
--Testcase 3073:
SELECT id, c3, maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl group by 3, 2, 1 HAVING maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) > '12:00:00'::time;
 id |         c3          | maketime 
----+---------------------+----------
  0 | 2021-01-03 12:10:30 | 18:15:30
  1 | 2021-01-04 23:12:13 | 18:15:30
  2 | 2021-01-05 11:12:12 | 18:15:30
  3 | 2021-01-06 16:00:00 | 18:15:30
  4 | 2021-01-07 00:59:59 | 18:15:30
(5 rows)

-- select maketime with group by index having (result)
--Testcase 3074:
SELECT id, c3, maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) FROM time_tbl group by 1, 2, 3 HAVING maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) > '12:00:00'::time;
 id |         c3          | maketime 
----+---------------------+----------
  0 | 2021-01-03 12:10:30 | 18:15:30
  1 | 2021-01-04 23:12:13 | 18:15:30
  2 | 2021-01-05 11:12:12 | 18:15:30
  3 | 2021-01-06 16:00:00 | 18:15:30
  4 | 2021-01-07 00:59:59 | 18:15:30
(5 rows)

-- select maketime and as
--Testcase 3075:
SELECT maketime(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 15, 30) as maketime1 FROM time_tbl;
 maketime1 
-----------
 18:15:30
 18:15:30
 18:15:30
 18:15:30
 18:15:30
(5 rows)

-- MAKEDATE()
-- select makedate (stub function, explain)
--Testcase 3076:
EXPLAIN VERBOSE
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl;
                                                                   QUERY PLAN                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=4)
   Output: (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 90))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.makedate(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 90) FROM public.time_tblmysql
(4 rows)

-- select makedate (stub function, result)
--Testcase 3077:
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl;
  makedate  
------------
 2018-03-31
 2018-03-31
 2018-03-31
 2018-03-31
 2018-03-31
(5 rows)

-- select makedate (stub function, not pushdown constraints, explain)
--Testcase 3078:
EXPLAIN VERBOSE
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl WHERE to_hex(id) = '1';
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..241.94 rows=17 width=4)
   Output: (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 90))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.makedate(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 90), id FROM public.time_tblmysql
(5 rows)

-- select makedate (stub function, not pushdown constraints, result)
--Testcase 3079:
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl WHERE to_hex(id) = '1';
  makedate  
------------
 2018-03-31
(1 row)

-- select makedate (stub function, pushdown constraints, explain)
--Testcase 3080:
EXPLAIN VERBOSE
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl WHERE id != 200;
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2767.58 rows=3396 width=4)
   Output: (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 90))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.makedate(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 90) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select makedate (stub function, pushdown constraints, result)
--Testcase 3081:
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl WHERE id != 200;
  makedate  
------------
 2018-03-31
 2018-03-31
 2018-03-31
 2018-03-31
 2018-03-31
(5 rows)

-- select makedate (stub function, makedate in constraints, explain)
--Testcase 3082:
EXPLAIN VERBOSE
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl WHERE makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) < '2021-01-02'::date;
                                                                                                                                 QUERY PLAN                                                                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3588.67 rows=1138 width=4)
   Output: (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 90))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.makedate(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 90) FROM public.time_tblmysql WHERE ((public.makedate(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 90) < '2021-01-02'::date))
(4 rows)

-- select makedate (stub function, makedate in constraints, result)
--Testcase 3083:
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl WHERE makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) < '2021-01-02'::date;
  makedate  
------------
 2018-03-31
 2018-03-31
 2018-03-31
 2018-03-31
 2018-03-31
(5 rows)

-- select makedate with agg (pushdown, explain)
--Testcase 3084:
EXPLAIN VERBOSE
SELECT max(c3), makedate(18, 90) FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (makedate(18, 90))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.makedate(18, 90) FROM public.time_tblmysql
(6 rows)

-- select makedate as nest function with agg (pushdown, result)
--Testcase 3085:
SELECT max(c3), makedate(18, 90) FROM time_tbl;
         max         |  makedate  
---------------------+------------
 2021-01-07 00:59:59 | 2018-03-31
(1 row)

-- select makedate with non pushdown func and explicit constant (explain)
--Testcase 3086:
EXPLAIN VERBOSE
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90), pi(), 4.1 FROM time_tbl;
                                                                                        QUERY PLAN                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=44)
   Output: (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 90)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.makedate(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 90), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select makedate with non pushdown func and explicit constant (result)
--Testcase 3087:
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90), pi(), 4.1 FROM time_tbl;
  makedate  |        pi         | ?column? 
------------+-------------------+----------
 2018-03-31 | 3.141592653589793 |      4.1
 2018-03-31 | 3.141592653589793 |      4.1
 2018-03-31 | 3.141592653589793 |      4.1
 2018-03-31 | 3.141592653589793 |      4.1
 2018-03-31 | 3.141592653589793 |      4.1
(5 rows)

-- select makedate with order by (explain)
--Testcase 3088:
EXPLAIN VERBOSE
SELECT id, makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl order by makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90);
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2972.43..2980.96 rows=3413 width=8)
   Output: id, (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 90))
   Sort Key: (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, time_tbl.c3), 201907), 90))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..2772.14 rows=3413 width=8)
         Output: id, (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 90))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.makedate(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 90) FROM public.time_tblmysql
(7 rows)

-- select makedate with order by (result)
--Testcase 3089:
SELECT id, makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl order by makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90);
 id |  makedate  
----+------------
  0 | 2018-03-31
  1 | 2018-03-31
  2 | 2018-03-31
  3 | 2018-03-31
  4 | 2018-03-31
(5 rows)

-- select makedate with order by index (result)
--Testcase 3090:
SELECT id, makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl order by 2,1;
 id |  makedate  
----+------------
  0 | 2018-03-31
  1 | 2018-03-31
  2 | 2018-03-31
  3 | 2018-03-31
  4 | 2018-03-31
(5 rows)

-- select makedate with order by index (result)
--Testcase 3091:
SELECT id, makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl order by 1,2;
 id |  makedate  
----+------------
  0 | 2018-03-31
  1 | 2018-03-31
  2 | 2018-03-31
  3 | 2018-03-31
  4 | 2018-03-31
(5 rows)

-- select makedate with group by (explain)
--Testcase 3092:
EXPLAIN VERBOSE
SELECT max(c3), makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl group by makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90), c3;
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (makedate(period_diff(mysql_extract('YEAR_MONTH'::text, c3), 201907), 90)), c3
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.makedate(public.period_diff(public.mysql_extract('YEAR_MONTH'::text, c3), 201907), 90), c3 FROM public.time_tblmysql GROUP BY 2, 3
(6 rows)

-- select makedate with group by (result)
--Testcase 3093:
SELECT max(c3), makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl group by makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90), c3;
         max         |  makedate  
---------------------+------------
 2021-01-03 12:10:30 | 2018-03-31
 2021-01-04 23:12:13 | 2018-03-31
 2021-01-05 11:12:12 | 2018-03-31
 2021-01-06 16:00:00 | 2018-03-31
 2021-01-07 00:59:59 | 2018-03-31
(5 rows)

-- select makedate with group by index (result)
--Testcase 3094:
SELECT id, makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl group by 2,1;
 id |  makedate  
----+------------
  0 | 2018-03-31
  1 | 2018-03-31
  2 | 2018-03-31
  3 | 2018-03-31
  4 | 2018-03-31
(5 rows)

-- select makedate with group by index (result)
--Testcase 3095:
SELECT id, makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl group by 1,2;
 id |  makedate  
----+------------
  0 | 2018-03-31
  1 | 2018-03-31
  2 | 2018-03-31
  3 | 2018-03-31
  4 | 2018-03-31
(5 rows)

-- select makedate with group by index having (result)
--Testcase 3096:
SELECT id, c3, makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl group by 3, 2, 1 HAVING makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) > '2008-03-31'::date;
 id |         c3          |  makedate  
----+---------------------+------------
  0 | 2021-01-03 12:10:30 | 2018-03-31
  1 | 2021-01-04 23:12:13 | 2018-03-31
  2 | 2021-01-05 11:12:12 | 2018-03-31
  3 | 2021-01-06 16:00:00 | 2018-03-31
  4 | 2021-01-07 00:59:59 | 2018-03-31
(5 rows)

-- select makedate with group by index having (result)
--Testcase 3097:
SELECT id, c3, makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) FROM time_tbl group by 1, 2, 3 HAVING makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) > '2008-03-31'::date;
 id |         c3          |  makedate  
----+---------------------+------------
  0 | 2021-01-03 12:10:30 | 2018-03-31
  1 | 2021-01-04 23:12:13 | 2018-03-31
  2 | 2021-01-05 11:12:12 | 2018-03-31
  3 | 2021-01-06 16:00:00 | 2018-03-31
  4 | 2021-01-07 00:59:59 | 2018-03-31
(5 rows)

-- select makedate and as
--Testcase 3098:
SELECT makedate(period_diff(mysql_extract('YEAR_MONTH', c3 ), 201907), 90) as makedate1 FROM time_tbl;
 makedate1  
------------
 2018-03-31
 2018-03-31
 2018-03-31
 2018-03-31
 2018-03-31
(5 rows)

-- LOCALTIMESTAMP, LOCALTIMESTAMP()
-- mysql_localtimestamp is mutable function, some executes will return different result
-- select mysql_localtimestamp (stub function, explain)
--Testcase 3099:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp() FROM time_tbl;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_localtimestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtimestamp() FROM public.time_tblmysql
(4 rows)

-- select mysql_localtimestamp (stub function, not pushdown constraints, explain)
--Testcase 3100:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp() FROM time_tbl WHERE to_hex(id) > '0';
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (mysql_localtimestamp())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtimestamp(), id FROM public.time_tblmysql
(5 rows)

-- select mysql_localtimestamp (stub function, pushdown constraints, explain)
--Testcase 3101:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp() FROM time_tbl WHERE id = 1;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (mysql_localtimestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtimestamp() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select mysql_localtimestamp (stub function, mysql_localtimestamp in constraints, explain)
--Testcase 3102:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp() FROM time_tbl WHERE mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (mysql_localtimestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtimestamp() FROM public.time_tblmysql WHERE ((public.mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_localtimestamp in constrains (stub function, explain)
--Testcase 3103:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_localtimestamp in constrains (stub function, result)
--Testcase 3104:
SELECT c1 FROM time_tbl WHERE mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- mysql_localtimestamp as parameter of addtime(stub function, explain)
--Testcase 3105:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtimestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_localtimestamp(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_localtimestamp as parameter of addtime(stub function, result)
--Testcase 3106:
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtimestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_localtimestamp and agg (pushdown, explain)
--Testcase 3107:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), sum(id) FROM time_tbl;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_localtimestamp()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtimestamp(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select mysql_localtimestamp and log2 (pushdown, explain)
--Testcase 3108:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), log2(id) FROM time_tbl;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (mysql_localtimestamp()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtimestamp(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select mysql_localtimestamp with non pushdown func and explicit constant (explain)
--Testcase 3109:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), to_hex(id), 4 FROM time_tbl;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (mysql_localtimestamp()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtimestamp(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select mysql_localtimestamp with order by (explain)
--Testcase 3110:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), c1 FROM time_tbl ORDER BY mysql_localtimestamp();
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (mysql_localtimestamp()), c1
   Sort Key: (mysql_localtimestamp())
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (mysql_localtimestamp()), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_localtimestamp(), c1 FROM public.time_tblmysql
(7 rows)

-- select mysql_localtimestamp with order by index (explain)
--Testcase 3111:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), c1 FROM time_tbl ORDER BY 1;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (mysql_localtimestamp()), c1
   Sort Key: (mysql_localtimestamp())
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (mysql_localtimestamp()), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_localtimestamp(), c1 FROM public.time_tblmysql
(7 rows)

-- mysql_localtimestamp constraints with order by (explain)
--Testcase 3112:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtimestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp ORDER BY c1;
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_localtimestamp(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- mysql_localtimestamp constraints with order by (result)
--Testcase 3113:
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtimestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select mysql_localtimestamp with group by (explain)
--Testcase 3114:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), c1 FROM time_tbl GROUP BY c1;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_localtimestamp()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtimestamp(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_localtimestamp with group by index (explain)
--Testcase 3115:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), c1 FROM time_tbl GROUP BY 2;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_localtimestamp()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtimestamp(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_localtimestamp with group by having (explain)
--Testcase 3116:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), c1 FROM time_tbl GROUP BY mysql_localtimestamp(),c1 HAVING mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp;
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_localtimestamp()), c1
   Filter: ((mysql_localtimestamp()) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtimestamp(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- select mysql_localtimestamp with group by index having (explain)
--Testcase 3117:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp(), c1 FROM time_tbl GROUP BY 2,1 HAVING mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp;
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_localtimestamp()), c1
   Filter: ((mysql_localtimestamp()) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtimestamp(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.mysql_localtimestamp() > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- mysql_localtimestamp constraints with group by (explain)
--Testcase 3118:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtimestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp GROUP BY c1;
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_localtimestamp(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone)) GROUP BY 1
(6 rows)

-- mysql_localtimestamp constraints with group by (result)
--Testcase 3119:
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtimestamp(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_localtimestamp and as
--Testcase 3120:
EXPLAIN VERBOSE
SELECT mysql_localtimestamp() as mysql_localtimestamp1 FROM time_tbl;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_localtimestamp())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtimestamp() FROM public.time_tblmysql
(4 rows)

-- LOCALTIME(), LOCALTIME
-- mysql_localtime is mutable function, some executes will return different result
-- select mysql_localtime (stub function, explain)
--Testcase 3121:
EXPLAIN VERBOSE
SELECT mysql_localtime() FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_localtime())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtime() FROM public.time_tblmysql
(4 rows)

-- select mysql_localtime (stub function, not pushdown constraints, explain)
--Testcase 3122:
EXPLAIN VERBOSE
SELECT mysql_localtime() FROM time_tbl WHERE to_hex(id) > '0';
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..513.95 rows=1138 width=8)
   Output: (mysql_localtime())
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtime(), id FROM public.time_tblmysql
(5 rows)

-- select mysql_localtime (stub function, pushdown constraints, explain)
--Testcase 3123:
EXPLAIN VERBOSE
SELECT mysql_localtime() FROM time_tbl WHERE id = 1;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.25 rows=17 width=8)
   Output: (mysql_localtime())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtime() FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select mysql_localtime (stub function, mysql_localtime in constraints, explain)
--Testcase 3124:
EXPLAIN VERBOSE
SELECT mysql_localtime() FROM time_tbl WHERE mysql_localtime() > '2000-01-01 00:00:00'::timestamp;
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1313.17 rows=1138 width=8)
   Output: (mysql_localtime())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtime() FROM public.time_tblmysql WHERE ((public.mysql_localtime() > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_localtime in constrains (stub function, explain)
--Testcase 3125:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE mysql_localtime() > '2000-01-01 00:00:00'::timestamp;
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1028.67 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.mysql_localtime() > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_localtime in constrains (stub function, result)
--Testcase 3126:
SELECT c1 FROM time_tbl WHERE mysql_localtime() > '2000-01-01 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- mysql_localtime as parameter of addtime(stub function, explain)
--Testcase 3127:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtime(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp;
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_localtime(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(4 rows)

-- mysql_localtime as parameter of addtime(stub function, result)
--Testcase 3128:
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtime(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_localtime and agg (pushdown, explain)
--Testcase 3129:
EXPLAIN VERBOSE
SELECT mysql_localtime(), sum(id) FROM time_tbl;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_localtime()), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtime(), sum(id) FROM public.time_tblmysql
(6 rows)

-- select mysql_localtime and log2 (pushdown, explain)
--Testcase 3130:
EXPLAIN VERBOSE
SELECT mysql_localtime(), log2(id) FROM time_tbl;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=16)
   Output: (mysql_localtime()), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtime(), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select mysql_localtime with non pushdown func and explicit constant (explain)
--Testcase 3131:
EXPLAIN VERBOSE
SELECT mysql_localtime(), to_hex(id), 4 FROM time_tbl;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (mysql_localtime()), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtime(), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select mysql_localtime with order by (explain)
--Testcase 3132:
EXPLAIN VERBOSE
SELECT mysql_localtime(), c1 FROM time_tbl ORDER BY mysql_localtime();
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (mysql_localtime()), c1
   Sort Key: (mysql_localtime())
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (mysql_localtime()), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_localtime(), c1 FROM public.time_tblmysql
(7 rows)

-- select mysql_localtime with order by index (explain)
--Testcase 3133:
EXPLAIN VERBOSE
SELECT mysql_localtime(), c1 FROM time_tbl ORDER BY 1;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=16)
   Output: (mysql_localtime()), c1
   Sort Key: (mysql_localtime())
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=16)
         Output: (mysql_localtime()), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.mysql_localtime(), c1 FROM public.time_tblmysql
(7 rows)

-- mysql_localtime constraints with order by (explain)
--Testcase 3134:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtime(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp ORDER BY c1;
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1939.69..1942.53 rows=1138 width=8)
   Output: c1
   Sort Key: time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1881.92 rows=1138 width=8)
         Output: c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_localtime(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- mysql_localtime constraints with order by (result)
--Testcase 3135:
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtime(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp ORDER BY c1;
    c1    
----------
 00:59:59
 11:12:12
 12:10:30
 16:00:00
 23:12:13
(5 rows)

-- select mysql_localtime with group by (explain)
--Testcase 3136:
EXPLAIN VERBOSE
SELECT mysql_localtime(), c1 FROM time_tbl GROUP BY c1;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_localtime()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtime(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_localtime with group by index (explain)
--Testcase 3137:
EXPLAIN VERBOSE
SELECT mysql_localtime(), c1 FROM time_tbl GROUP BY 2;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (mysql_localtime()), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtime(), c1 FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select mysql_localtime with group by having (explain)
--Testcase 3138:
EXPLAIN VERBOSE
SELECT mysql_localtime(), c1 FROM time_tbl GROUP BY mysql_localtime(),c1 HAVING mysql_localtime() > '2000-01-01 00:00:00'::timestamp;
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_localtime()), c1
   Filter: ((mysql_localtime()) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtime(), c1 FROM public.time_tblmysql GROUP BY 1, 2 HAVING ((public.mysql_localtime() > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- select mysql_localtime with group by index having (explain)
--Testcase 3139:
EXPLAIN VERBOSE
SELECT mysql_localtime(), c1 FROM time_tbl GROUP BY 2,1 HAVING mysql_localtime() > '2000-01-01 00:00:00'::timestamp;
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (mysql_localtime()), c1
   Filter: ((mysql_localtime()) > '2000-01-01 00:00:00'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.mysql_localtime(), c1 FROM public.time_tblmysql GROUP BY 2, 1 HAVING ((public.mysql_localtime() > '2000-01-01 00:00:00'::timestamp without time zone))
(7 rows)

-- mysql_localtime constraints with group by (explain)
--Testcase 3140:
EXPLAIN VERBOSE
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtime(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp GROUP BY c1;
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT c1 FROM public.time_tblmysql WHERE ((public.addtime(public.mysql_localtime(), '1 day 12:59:10'::interval) > '2000-01-01 00:00:00'::timestamp without time zone)) GROUP BY 1
(6 rows)

-- mysql_localtime constraints with group by (result)
--Testcase 3141:
SELECT c1 FROM time_tbl WHERE addtime(mysql_localtime(), '1 12:59:10') > '2000-01-01 00:00:00'::timestamp GROUP BY c1;
    c1    
----------
 12:10:30
 23:12:13
 11:12:12
 16:00:00
 00:59:59
(5 rows)

-- select mysql_localtime and as
--Testcase 3142:
EXPLAIN VERBOSE
SELECT mysql_localtime() as mysql_localtime1 FROM time_tbl;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=8)
   Output: (mysql_localtime())
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_localtime() FROM public.time_tblmysql
(4 rows)

-- LAST_DAY()
-- select last_day (stub function, explain)
--Testcase 3143:
EXPLAIN VERBOSE
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4487.17 rows=3413 width=16)
   Output: (last_day(c3)), (last_day((c2)::timestamp without time zone)), (last_day(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (last_day('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.last_day(c3), public.last_day(c2), public.last_day(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.last_day('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select last_day (stub function, result)
--Testcase 3144:
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl;
  last_day  |  last_day  |  last_day  |  last_day  
------------+------------+------------+------------
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
(5 rows)

-- select last_day (stub function, not pushdown constraints, explain)
--Testcase 3145:
EXPLAIN VERBOSE
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                       QUERY PLAN                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..250.49 rows=17 width=16)
   Output: (last_day(c3)), (last_day((c2)::timestamp without time zone)), (last_day(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (last_day('2021-01-01 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.last_day(c3), public.last_day(c2), public.last_day(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.last_day('2021-01-01 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select last_day (stub function, not pushdown constraints, result)
--Testcase 3146:
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
  last_day  |  last_day  |  last_day  |  last_day  
------------+------------+------------+------------
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
(1 row)

-- select last_day (stub function, pushdown constraints, explain)
--Testcase 3147:
EXPLAIN VERBOSE
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                                               QUERY PLAN                                                                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4474.07 rows=3396 width=16)
   Output: (last_day(c3)), (last_day((c2)::timestamp without time zone)), (last_day(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (last_day('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.last_day(c3), public.last_day(c2), public.last_day(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.last_day('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select last_day (stub function, pushdown constraints, result)
--Testcase 3148:
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
  last_day  |  last_day  |  last_day  |  last_day  
------------+------------+------------+------------
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
(5 rows)

-- select last_day (stub function, last_day in constraints, explain)
--Testcase 3149:
EXPLAIN VERBOSE
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE last_day(c3) > last_day('2000-01-01'::timestamp);
                                                                                                                                                                       QUERY PLAN                                                                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3307.27 rows=1138 width=16)
   Output: (last_day(c3)), (last_day((c2)::timestamp without time zone)), (last_day(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (last_day('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.last_day(c3), public.last_day(c2), public.last_day(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.last_day('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.last_day(c3) > public.last_day('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select last_day (stub function, last_day in constraints, result)
--Testcase 3150:
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE last_day(c3) > last_day('2000-01-01'::timestamp);
  last_day  |  last_day  |  last_day  |  last_day  
------------+------------+------------+------------
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
(5 rows)

-- select last_day (stub function, last_day in constraints, explain)
--Testcase 3151:
EXPLAIN VERBOSE
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE last_day('2021-01-01 12:00:00'::timestamp) = '2021-01-31';
                                                                                                                                                                      QUERY PLAN                                                                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1027.54 rows=17 width=16)
   Output: (last_day(c3)), (last_day((c2)::timestamp without time zone)), (last_day(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), (last_day('2021-01-01 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.last_day(c3), public.last_day(c2), public.last_day(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), public.last_day('2021-01-01 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.last_day('2021-01-01 12:00:00'::timestamp without time zone) = '2021-01-31'::date))
(4 rows)

-- select last_day (stub function, last_day in constraints, result)
--Testcase 3152:
SELECT last_day(c3), last_day(c2), last_day(date_sub(c3, '1 12:59:10')), last_day('2021-01-01 12:00:00'::timestamp) FROM time_tbl WHERE last_day('2021-01-01 12:00:00'::timestamp) = '2021-01-31';
  last_day  |  last_day  |  last_day  |  last_day  
------------+------------+------------+------------
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
 2021-01-31 | 2021-01-31 | 2021-01-31 | 2021-01-31
(5 rows)

-- select last_day with agg (pushdown, explain)
--Testcase 3153:
EXPLAIN VERBOSE
SELECT max(c3), last_day(max(c3)) FROM time_tbl;
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (last_day(max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.last_day(max(c3)) FROM public.time_tblmysql
(6 rows)

-- select last_day as nest function with agg (pushdown, result)
--Testcase 3154:
SELECT max(c3), last_day(max(c3)) FROM time_tbl;
         max         |  last_day  
---------------------+------------
 2021-01-07 00:59:59 | 2021-01-31
(1 row)

-- select last_day with non pushdown func and explicit constant (explain)
--Testcase 3155:
EXPLAIN VERBOSE
SELECT last_day(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (last_day(date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.last_day(public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select last_day with non pushdown func and explicit constant (result)
--Testcase 3156:
SELECT last_day(date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
  last_day  |        pi         | ?column? 
------------+-------------------+----------
 2021-01-31 | 3.141592653589793 |      4.1
 2021-01-31 | 3.141592653589793 |      4.1
 2021-01-31 | 3.141592653589793 |      4.1
 2021-01-31 | 3.141592653589793 |      4.1
 2021-01-31 | 3.141592653589793 |      4.1
(5 rows)

-- select last_day with order by (explain)
--Testcase 3157:
EXPLAIN VERBOSE
SELECT id, last_day(c3 + '1 12:59:10') FROM time_tbl order by last_day(c3 + '1 12:59:10');
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=8)
   Output: id, (last_day((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Sort Key: (last_day((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=8)
         Output: id, (last_day((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.last_day((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql
(7 rows)

-- select last_day with order by (result)
--Testcase 3158:
SELECT id, last_day(c3 + '1 12:59:10') FROM time_tbl order by last_day(c3 + '1 12:59:10');
 id |  last_day  
----+------------
  0 | 2021-01-31
  1 | 2021-01-31
  2 | 2021-01-31
  3 | 2021-01-31
  4 | 2021-01-31
(5 rows)

-- select last_day with order by index (result)
--Testcase 3159:
SELECT id, last_day(c3 + '1 12:59:10') FROM time_tbl order by 2,1;
 id |  last_day  
----+------------
  0 | 2021-01-31
  1 | 2021-01-31
  2 | 2021-01-31
  3 | 2021-01-31
  4 | 2021-01-31
(5 rows)

-- select last_day with order by index (result)
--Testcase 3160:
SELECT id, last_day(c3 + '1 12:59:10') FROM time_tbl order by 1,2;
 id |  last_day  
----+------------
  0 | 2021-01-31
  1 | 2021-01-31
  2 | 2021-01-31
  3 | 2021-01-31
  4 | 2021-01-31
(5 rows)

-- select last_day with group by (explain)
--Testcase 3161:
EXPLAIN VERBOSE
SELECT max(c3), last_day(c3 + '1 12:59:10') FROM time_tbl group by last_day(c3 + '1 12:59:10');
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (last_day((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.last_day((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select last_day with group by (result)
--Testcase 3162:
SELECT max(c3), last_day(c3 + '1 12:59:10') FROM time_tbl group by last_day(c3 + '1 12:59:10');
         max         |  last_day  
---------------------+------------
 2021-01-07 00:59:59 | 2021-01-31
(1 row)

-- select last_day with group by index (result)
--Testcase 3163:
SELECT id, last_day(c3 + '1 12:59:10') FROM time_tbl group by 2,1;
 id |  last_day  
----+------------
  0 | 2021-01-31
  1 | 2021-01-31
  2 | 2021-01-31
  3 | 2021-01-31
  4 | 2021-01-31
(5 rows)

-- select last_day with group by index (result)
--Testcase 3164:
SELECT id, last_day(c3 + '1 12:59:10') FROM time_tbl group by 1,2;
 id |  last_day  
----+------------
  0 | 2021-01-31
  1 | 2021-01-31
  2 | 2021-01-31
  3 | 2021-01-31
  4 | 2021-01-31
(5 rows)

-- select last_day with group by having (explain)
--Testcase 3165:
EXPLAIN VERBOSE
SELECT max(c3), last_day(c3 + '1 12:59:10') FROM time_tbl group by last_day(c3 + '1 12:59:10'), c3 HAVING last_day(c3 + '1 12:59:10') > '2001-01-31'::date;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (last_day((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))), c3
   Filter: ((last_day((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval))) > '2001-01-31'::date)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.last_day((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval)), c3 FROM public.time_tblmysql GROUP BY 2, 3
(7 rows)

-- select last_day with group by having (result)
--Testcase 3166:
SELECT max(c3), last_day(c3 + '1 12:59:10') FROM time_tbl group by last_day(c3 + '1 12:59:10'), c3 HAVING last_day(c3 + '1 12:59:10') > '2001-01-31'::date;
         max         |  last_day  
---------------------+------------
 2021-01-03 12:10:30 | 2021-01-31
 2021-01-04 23:12:13 | 2021-01-31
 2021-01-05 11:12:12 | 2021-01-31
 2021-01-06 16:00:00 | 2021-01-31
 2021-01-07 00:59:59 | 2021-01-31
(5 rows)

-- select last_day with group by index having (result)
--Testcase 3167:
SELECT id, last_day(c3 + '1 12:59:10'), c3 FROM time_tbl group by 3, 2, 1 HAVING last_day(c3 + '1 12:59:10') > '2001-01-31'::date;
 id |  last_day  |         c3          
----+------------+---------------------
  0 | 2021-01-31 | 2021-01-03 12:10:30
  1 | 2021-01-31 | 2021-01-04 23:12:13
  2 | 2021-01-31 | 2021-01-05 11:12:12
  3 | 2021-01-31 | 2021-01-06 16:00:00
  4 | 2021-01-31 | 2021-01-07 00:59:59
(5 rows)

-- select last_day with group by index having (result)
--Testcase 3168:
SELECT id, last_day(c3 + '1 12:59:10'), c3 FROM time_tbl group by 1, 2, 3 HAVING last_day(c3 + '1 12:59:10') > '2001-01-31'::date;
 id |  last_day  |         c3          
----+------------+---------------------
  0 | 2021-01-31 | 2021-01-03 12:10:30
  1 | 2021-01-31 | 2021-01-04 23:12:13
  2 | 2021-01-31 | 2021-01-05 11:12:12
  3 | 2021-01-31 | 2021-01-06 16:00:00
  4 | 2021-01-31 | 2021-01-07 00:59:59
(5 rows)

-- select last_day and as
--Testcase 3169:
SELECT last_day(date_sub(c3, '1 12:59:10')) as last_day1 FROM time_tbl;
 last_day1  
------------
 2021-01-31
 2021-01-31
 2021-01-31
 2021-01-31
 2021-01-31
(5 rows)

-- HOUR()
-- select hour (stub function, explain)
--Testcase 3170:
EXPLAIN VERBOSE
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (hour(c1)), (hour('23:00:00'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.hour(c1), public.hour('23:00:00'::time without time zone) FROM public.time_tblmysql
(4 rows)

-- select hour (stub function, result)
--Testcase 3171:
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl;
 hour | hour 
------+------
   12 |   23
   23 |   23
   11 |   23
   16 |   23
    0 |   23
(5 rows)

-- select hour (stub function, not pushdown constraints, explain)
--Testcase 3172:
EXPLAIN VERBOSE
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl WHERE to_hex(id) = '1';
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.69 rows=17 width=8)
   Output: (hour(c1)), (hour('23:00:00'::time without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.hour(c1), public.hour('23:00:00'::time without time zone), id FROM public.time_tblmysql
(5 rows)

-- select hour (stub function, not pushdown constraints, result)
--Testcase 3173:
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl WHERE to_hex(id) = '1';
 hour | hour 
------+------
   23 |   23
(1 row)

-- select hour (stub function, pushdown constraints, explain)
--Testcase 3174:
EXPLAIN VERBOSE
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl WHERE id != 200;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.58 rows=3396 width=8)
   Output: (hour(c1)), (hour('23:00:00'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.hour(c1), public.hour('23:00:00'::time without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select hour (stub function, pushdown constraints, result)
--Testcase 3175:
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl WHERE id != 200;
 hour | hour 
------+------
   12 |   23
   23 |   23
   11 |   23
   16 |   23
    0 |   23
(5 rows)

-- select hour (stub function, hour in constraints, explain)
--Testcase 3176:
EXPLAIN VERBOSE
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl WHERE hour(c1) = 12;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1014.75 rows=17 width=8)
   Output: (hour(c1)), (hour('23:00:00'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.hour(c1), public.hour('23:00:00'::time without time zone) FROM public.time_tblmysql WHERE ((public.hour(c1) = 12))
(4 rows)

-- select hour (stub function, hour in constraints, result)
--Testcase 3177:
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl WHERE hour(c1) = 12;
 hour | hour 
------+------
   12 |   23
(1 row)

-- select hour (stub function, hour in constraints, explain)
--Testcase 3178:
EXPLAIN VERBOSE
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl WHERE hour('22:00:00'::time) > '12';
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1597.67 rows=1138 width=8)
   Output: (hour(c1)), (hour('23:00:00'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.hour(c1), public.hour('23:00:00'::time without time zone) FROM public.time_tblmysql WHERE ((public.hour('22:00:00'::time without time zone) > 12))
(4 rows)

-- select hour (stub function, hour in constraints, result)
--Testcase 3179:
SELECT hour(c1), hour('23:00:00'::time) FROM time_tbl WHERE hour('22:00:00'::time) > '12';
 hour | hour 
------+------
   12 |   23
   23 |   23
   11 |   23
   16 |   23
    0 |   23
(5 rows)

-- select hour with agg (pushdown, explain)
--Testcase 3180:
EXPLAIN VERBOSE
SELECT max(c1), hour(max(c1)) FROM time_tbl;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c1)), (hour(max(c1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c1), public.hour(max(c1)) FROM public.time_tblmysql
(6 rows)

-- select hour as nest function with agg (pushdown, result)
--Testcase 3181:
SELECT max(c1), hour(max(c1)) FROM time_tbl;
   max    | hour 
----------+------
 23:12:13 |   23
(1 row)

-- select hour with non pushdown func and explicit constant (explain)
--Testcase 3182:
EXPLAIN VERBOSE
SELECT hour(maketime(18, 15, 30)), pi(), 4.1 FROM time_tbl;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (hour(maketime(18, 15, 30))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.hour(public.maketime(18, 15, 30)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select hour with non pushdown func and explicit constant (result)
--Testcase 3183:
SELECT hour(maketime(18, 15, 30)), pi(), 4.1 FROM time_tbl;
 hour |        pi         | ?column? 
------+-------------------+----------
   18 | 3.141592653589793 |      4.1
   18 | 3.141592653589793 |      4.1
   18 | 3.141592653589793 |      4.1
   18 | 3.141592653589793 |      4.1
   18 | 3.141592653589793 |      4.1
(5 rows)

-- select hour with order by (explain)
--Testcase 3184:
EXPLAIN VERBOSE
SELECT id, hour(c1), hour('23:00:00'::time) FROM time_tbl order by hour(c1), hour('23:00:00'::time);
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=12)
   Output: id, (hour(c1)), (hour('23:00:00'::time without time zone))
   Sort Key: (hour(time_tbl.c1)), (hour('23:00:00'::time without time zone))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=12)
         Output: id, (hour(c1)), (hour('23:00:00'::time without time zone))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.hour(c1), public.hour('23:00:00'::time without time zone) FROM public.time_tblmysql
(7 rows)

-- select hour with order by (result)
--Testcase 3185:
SELECT id, hour(c1), hour('23:00:00'::time) FROM time_tbl order by hour(c1), hour('23:00:00'::time);
 id | hour | hour 
----+------+------
  4 |    0 |   23
  2 |   11 |   23
  0 |   12 |   23
  3 |   16 |   23
  1 |   23 |   23
(5 rows)

-- select hour with order by index (result)
--Testcase 3186:
SELECT id, hour(c1), hour('23:00:00'::time) FROM time_tbl order by 3,2,1;
 id | hour | hour 
----+------+------
  4 |    0 |   23
  2 |   11 |   23
  0 |   12 |   23
  3 |   16 |   23
  1 |   23 |   23
(5 rows)

-- select hour with order by index (result)
--Testcase 3187:
SELECT id, hour(c1), hour('23:00:00'::time) FROM time_tbl order by 1,2,3;
 id | hour | hour 
----+------+------
  0 |   12 |   23
  1 |   23 |   23
  2 |   11 |   23
  3 |   16 |   23
  4 |    0 |   23
(5 rows)

-- select hour with group by (explain)
--Testcase 3188:
EXPLAIN VERBOSE
SELECT max(c3), hour('23:00:00'::time) FROM time_tbl group by hour('05:00:00'::time);
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (hour('23:00:00'::time without time zone)), (hour('05:00:00'::time without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.hour('23:00:00'::time without time zone), public.hour('05:00:00'::time without time zone) FROM public.time_tblmysql GROUP BY 3
(6 rows)

-- select hour with group by (result)
--Testcase 3189:
SELECT max(c3), hour('23:00:00'::time) FROM time_tbl group by hour('05:00:00'::time);
         max         | hour 
---------------------+------
 2021-01-07 00:59:59 |   23
(1 row)

-- select hour with group by index (result)
--Testcase 3190:
SELECT id, hour(c1), hour('23:00:00'::time) FROM time_tbl group by 3,2,1;
 id | hour | hour 
----+------+------
  0 |   12 |   23
  1 |   23 |   23
  2 |   11 |   23
  3 |   16 |   23
  4 |    0 |   23
(5 rows)

-- select hour with group by index (result)
--Testcase 3191:
SELECT id, hour(c1), hour('23:00:00'::time) FROM time_tbl group by 1,2,3;
 id | hour | hour 
----+------+------
  0 |   12 |   23
  1 |   23 |   23
  2 |   11 |   23
  3 |   16 |   23
  4 |    0 |   23
(5 rows)

-- select hour with group by having (explain)
--Testcase 3192:
EXPLAIN VERBOSE
SELECT max(c3), hour(c1), hour('23:00:00'::time) FROM time_tbl group by hour(c1),hour('23:00:00'::time), c1,c3 HAVING hour(c1) < 24;
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (max(c3)), (hour(c1)), (hour('23:00:00'::time without time zone)), c1, c3
   Filter: ((hour(time_tbl.c1)) < 24)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.hour(c1), public.hour('23:00:00'::time without time zone), c1, c3 FROM public.time_tblmysql GROUP BY 2, 3, 4, 5 HAVING ((public.hour(c1) < 24))
(7 rows)

-- select hour with group by having (result)
--Testcase 3193:
SELECT max(c3), hour(c1), hour('23:00:00'::time) FROM time_tbl group by hour(c1),hour('23:00:00'::time), c1,c3 HAVING hour(c1) < 24;
         max         | hour | hour 
---------------------+------+------
 2021-01-03 12:10:30 |   12 |   23
 2021-01-04 23:12:13 |   23 |   23
 2021-01-05 11:12:12 |   11 |   23
 2021-01-06 16:00:00 |   16 |   23
 2021-01-07 00:59:59 |    0 |   23
(5 rows)

-- select hour with group by index having (result)
--Testcase 3194:
SELECT id, c1, hour(c1), hour('23:00:00'::time) FROM time_tbl group by 4, 3, 2, 1 HAVING hour(c1) < 24;
 id |    c1    | hour | hour 
----+----------+------+------
  0 | 12:10:30 |   12 |   23
  1 | 23:12:13 |   23 |   23
  2 | 11:12:12 |   11 |   23
  3 | 16:00:00 |   16 |   23
  4 | 00:59:59 |    0 |   23
(5 rows)

-- select hour with group by index having (result)
--Testcase 3195:
SELECT id, c1, hour(c1), hour('23:00:00'::time) FROM time_tbl group by 1, 2, 3, 4 HAVING hour(c1) < 24;
 id |    c1    | hour | hour 
----+----------+------+------
  0 | 12:10:30 |   12 |   23
  1 | 23:12:13 |   23 |   23
  2 | 11:12:12 |   11 |   23
  3 | 16:00:00 |   16 |   23
  4 | 00:59:59 |    0 |   23
(5 rows)

-- select hour and as
--Testcase 3196:
SELECT hour(c1) as hour1, hour('23:00:00'::time) as hour2 FROM time_tbl;
 hour1 | hour2 
-------+-------
    12 |    23
    23 |    23
    11 |    23
    16 |    23
     0 |    23
(5 rows)

-- GET_FORMAT()
-- Returns a format string. This function is useful in combination with the DATE_FORMAT() and the STR_TO_DATE() functions.
-- select get_format (stub function, explain)
--Testcase 3197:
EXPLAIN VERBOSE
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl;
                                                                                                                                           QUERY PLAN                                                                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5340.42 rows=3413 width=128)
   Output: (get_format('date'::text, 'usa'::text)), (date_format((c2)::timestamp without time zone, get_format('date'::text, 'usa'::text))), (get_format('datetime'::text, 'jis'::text)), (date_format(c3, get_format('datetime'::text, 'jis'::text)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.get_format('date'::text, 'usa'::text), public.date_format(c2, public.get_format('date'::text, 'usa'::text)), public.get_format('datetime'::text, 'jis'::text), public.date_format(c3, public.get_format('datetime'::text, 'jis'::text)) FROM public.time_tblmysql
(4 rows)

-- select get_format (stub function, result)
--Testcase 3198:
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl;
 get_format | date_format |    get_format     |     date_format     
------------+-------------+-------------------+---------------------
 %m.%d.%Y   | 01.02.2021  | %Y-%m-%d %H:%i:%s | 2021-01-03 12:10:30
 %m.%d.%Y   | 01.01.2021  | %Y-%m-%d %H:%i:%s | 2021-01-04 23:12:13
 %m.%d.%Y   | 01.10.2021  | %Y-%m-%d %H:%i:%s | 2021-01-05 11:12:12
 %m.%d.%Y   | 01.15.2021  | %Y-%m-%d %H:%i:%s | 2021-01-06 16:00:00
 %m.%d.%Y   | 01.29.2021  | %Y-%m-%d %H:%i:%s | 2021-01-07 00:59:59
(5 rows)

-- select get_format (stub function, not pushdown constraints, explain)
--Testcase 3199:
EXPLAIN VERBOSE
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                                             QUERY PLAN                                                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..254.74 rows=17 width=128)
   Output: (get_format('date'::text, 'usa'::text)), (date_format((c2)::timestamp without time zone, get_format('date'::text, 'usa'::text))), (get_format('datetime'::text, 'jis'::text)), (date_format(c3, get_format('datetime'::text, 'jis'::text)))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.get_format('date'::text, 'usa'::text), public.date_format(c2, public.get_format('date'::text, 'usa'::text)), public.get_format('datetime'::text, 'jis'::text), public.date_format(c3, public.get_format('datetime'::text, 'jis'::text)), id FROM public.time_tblmysql
(5 rows)

-- select get_format (stub function, not pushdown constraints, result)
--Testcase 3200:
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl WHERE to_hex(id) = '1';
 get_format | date_format |    get_format     |     date_format     
------------+-------------+-------------------+---------------------
 %m.%d.%Y   | 01.01.2021  | %Y-%m-%d %H:%i:%s | 2021-01-04 23:12:13
(1 row)

-- select get_format (stub function, pushdown constraints, explain)
--Testcase 3201:
EXPLAIN VERBOSE
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl WHERE id != 0;
                                                                                                                                                    QUERY PLAN                                                                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5323.07 rows=3396 width=128)
   Output: (get_format('date'::text, 'usa'::text)), (date_format((c2)::timestamp without time zone, get_format('date'::text, 'usa'::text))), (get_format('datetime'::text, 'jis'::text)), (date_format(c3, get_format('datetime'::text, 'jis'::text)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.get_format('date'::text, 'usa'::text), public.date_format(c2, public.get_format('date'::text, 'usa'::text)), public.get_format('datetime'::text, 'jis'::text), public.date_format(c3, public.get_format('datetime'::text, 'jis'::text)) FROM public.time_tblmysql WHERE ((id <> 0))
(4 rows)

-- select get_format (stub function, pushdown constraints, result)
--Testcase 3202:
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl WHERE id != 0;
 get_format | date_format |    get_format     |     date_format     
------------+-------------+-------------------+---------------------
 %m.%d.%Y   | 01.01.2021  | %Y-%m-%d %H:%i:%s | 2021-01-04 23:12:13
 %m.%d.%Y   | 01.10.2021  | %Y-%m-%d %H:%i:%s | 2021-01-05 11:12:12
 %m.%d.%Y   | 01.15.2021  | %Y-%m-%d %H:%i:%s | 2021-01-06 16:00:00
 %m.%d.%Y   | 01.29.2021  | %Y-%m-%d %H:%i:%s | 2021-01-07 00:59:59
(4 rows)

-- select get_format (stub function, get_format in constraints, explain)
--Testcase 3203:
EXPLAIN VERBOSE
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl WHERE get_format('date', 'usa') IS NOT NULL;
                                                                                                                                                                             QUERY PLAN                                                                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..6167.79 rows=3396 width=128)
   Output: (get_format('date'::text, 'usa'::text)), (date_format((c2)::timestamp without time zone, get_format('date'::text, 'usa'::text))), (get_format('datetime'::text, 'jis'::text)), (date_format(c3, get_format('datetime'::text, 'jis'::text)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.get_format('date'::text, 'usa'::text), public.date_format(c2, public.get_format('date'::text, 'usa'::text)), public.get_format('datetime'::text, 'jis'::text), public.date_format(c3, public.get_format('datetime'::text, 'jis'::text)) FROM public.time_tblmysql WHERE ((public.get_format('date'::text, 'usa'::text) IS NOT NULL))
(4 rows)

-- select get_format (stub function, get_format in constraints, result)
--Testcase 3204:
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl WHERE get_format('date', 'usa') IS NOT NULL;
 get_format | date_format |    get_format     |     date_format     
------------+-------------+-------------------+---------------------
 %m.%d.%Y   | 01.02.2021  | %Y-%m-%d %H:%i:%s | 2021-01-03 12:10:30
 %m.%d.%Y   | 01.01.2021  | %Y-%m-%d %H:%i:%s | 2021-01-04 23:12:13
 %m.%d.%Y   | 01.10.2021  | %Y-%m-%d %H:%i:%s | 2021-01-05 11:12:12
 %m.%d.%Y   | 01.15.2021  | %Y-%m-%d %H:%i:%s | 2021-01-06 16:00:00
 %m.%d.%Y   | 01.29.2021  | %Y-%m-%d %H:%i:%s | 2021-01-07 00:59:59
(5 rows)

-- select get_format (stub function, get_format in constraints, explain)
--Testcase 3205:
EXPLAIN VERBOSE
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl WHERE date_format(c3, get_format('datetime', 'jis')) IS NOT NULL;
                                                                                                                                                                                           QUERY PLAN                                                                                                                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..7021.04 rows=3396 width=128)
   Output: (get_format('date'::text, 'usa'::text)), (date_format((c2)::timestamp without time zone, get_format('date'::text, 'usa'::text))), (get_format('datetime'::text, 'jis'::text)), (date_format(c3, get_format('datetime'::text, 'jis'::text)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.get_format('date'::text, 'usa'::text), public.date_format(c2, public.get_format('date'::text, 'usa'::text)), public.get_format('datetime'::text, 'jis'::text), public.date_format(c3, public.get_format('datetime'::text, 'jis'::text)) FROM public.time_tblmysql WHERE ((public.date_format(c3, public.get_format('datetime'::text, 'jis'::text)) IS NOT NULL))
(4 rows)

-- select get_format (stub function, get_format in constraints, result)
--Testcase 3206:
SELECT get_format('date', 'usa'), date_format(c2, get_format('date', 'usa')), get_format('datetime', 'jis'), date_format(c3, get_format('datetime', 'jis')) FROM time_tbl WHERE date_format(c3, get_format('datetime', 'jis')) IS NOT NULL;
 get_format | date_format |    get_format     |     date_format     
------------+-------------+-------------------+---------------------
 %m.%d.%Y   | 01.02.2021  | %Y-%m-%d %H:%i:%s | 2021-01-03 12:10:30
 %m.%d.%Y   | 01.01.2021  | %Y-%m-%d %H:%i:%s | 2021-01-04 23:12:13
 %m.%d.%Y   | 01.10.2021  | %Y-%m-%d %H:%i:%s | 2021-01-05 11:12:12
 %m.%d.%Y   | 01.15.2021  | %Y-%m-%d %H:%i:%s | 2021-01-06 16:00:00
 %m.%d.%Y   | 01.29.2021  | %Y-%m-%d %H:%i:%s | 2021-01-07 00:59:59
(5 rows)

-- select get_format as nest function with agg (pushdown, explain)
--Testcase 3207:
EXPLAIN VERBOSE
SELECT max(c2), date_format(max(c3), get_format('datetime', 'jis')) FROM time_tbl;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=36)
   Output: (max(c2)), (date_format(max(c3), get_format('datetime'::text, 'jis'::text)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c2), public.date_format(max(c3), public.get_format('datetime'::text, 'jis'::text)) FROM public.time_tblmysql
(6 rows)

-- select get_format as nest function with agg (pushdown, result)
--Testcase 3208:
SELECT max(c2), date_format(max(c3), get_format('datetime', 'jis')) FROM time_tbl;
    max     |     date_format     
------------+---------------------
 2021-01-29 | 2021-01-07 00:59:59
(1 row)

-- select get_format with non pushdown func and explicit constant (explain)
--Testcase 3209:
EXPLAIN VERBOSE
SELECT get_format('datetime', 'jis'), pi(), 4.1 FROM time_tbl;
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (get_format('datetime'::text, 'jis'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.get_format('datetime'::text, 'jis'::text), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select get_format with non pushdown func and explicit constant (result)
--Testcase 3210:
SELECT get_format('datetime', 'jis'), pi(), 4.1 FROM time_tbl;
    get_format     |        pi         | ?column? 
-------------------+-------------------+----------
 %Y-%m-%d %H:%i:%s | 3.141592653589793 |      4.1
 %Y-%m-%d %H:%i:%s | 3.141592653589793 |      4.1
 %Y-%m-%d %H:%i:%s | 3.141592653589793 |      4.1
 %Y-%m-%d %H:%i:%s | 3.141592653589793 |      4.1
 %Y-%m-%d %H:%i:%s | 3.141592653589793 |      4.1
(5 rows)

-- select get_format with order by (explain)
--Testcase 3211:
EXPLAIN VERBOSE
SELECT id, date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) FROM time_tbl order by date_format(c3 + '1 12:59:10', get_format('datetime', 'jis'));
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2127.71..2136.24 rows=3413 width=36)
   Output: id, (date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), get_format('datetime'::text, 'jis'::text)))
   Sort Key: (date_format((time_tbl.c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), get_format('datetime'::text, 'jis'::text)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1927.42 rows=3413 width=36)
         Output: id, (date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), get_format('datetime'::text, 'jis'::text)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), public.get_format('datetime'::text, 'jis'::text)) FROM public.time_tblmysql
(7 rows)

-- select get_format with order by (result)
--Testcase 3212:
SELECT id, date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) FROM time_tbl order by date_format(c3 + '1 12:59:10', get_format('datetime', 'jis'));
 id |     date_format     
----+---------------------
  0 | 2021-01-05 01:09:40
  1 | 2021-01-06 12:11:23
  2 | 2021-01-07 00:11:22
  3 | 2021-01-08 04:59:10
  4 | 2021-01-08 13:59:09
(5 rows)

-- select get_format with order by index (result)
--Testcase 3213:
SELECT id, date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) FROM time_tbl order by 2,1;
 id |     date_format     
----+---------------------
  0 | 2021-01-05 01:09:40
  1 | 2021-01-06 12:11:23
  2 | 2021-01-07 00:11:22
  3 | 2021-01-08 04:59:10
  4 | 2021-01-08 13:59:09
(5 rows)

-- select get_format with order by index (result)
--Testcase 3214:
SELECT id, date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) FROM time_tbl order by 1,2;
 id |     date_format     
----+---------------------
  0 | 2021-01-05 01:09:40
  1 | 2021-01-06 12:11:23
  2 | 2021-01-07 00:11:22
  3 | 2021-01-08 04:59:10
  4 | 2021-01-08 13:59:09
(5 rows)

-- select get_format with group by (explain)
--Testcase 3215:
EXPLAIN VERBOSE
SELECT count(id), date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) FROM time_tbl group by date_format(c3 + '1 12:59:10', get_format('datetime', 'jis'));
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(id)), (date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), get_format('datetime'::text, 'jis'::text)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT count(id), public.date_format((c3 + '@ 1 day 12 hours 59 mins 10 secs'::interval), public.get_format('datetime'::text, 'jis'::text)) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select get_format with group by (result)
--Testcase 3216:
SELECT count(id), date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) FROM time_tbl group by date_format(c3 + '1 12:59:10', get_format('datetime', 'jis'));
 count |     date_format     
-------+---------------------
     1 | 2021-01-05 01:09:40
     1 | 2021-01-06 12:11:23
     1 | 2021-01-07 00:11:22
     1 | 2021-01-08 04:59:10
     1 | 2021-01-08 13:59:09
(5 rows)

-- select get_format with group by index (result)
--Testcase 3217:
SELECT id, date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) FROM time_tbl group by 2,1;
 id |     date_format     
----+---------------------
  0 | 2021-01-05 01:09:40
  1 | 2021-01-06 12:11:23
  2 | 2021-01-07 00:11:22
  3 | 2021-01-08 04:59:10
  4 | 2021-01-08 13:59:09
(5 rows)

-- select get_format with group by index (result)
--Testcase 3218:
SELECT id, date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) FROM time_tbl group by 1,2;
 id |     date_format     
----+---------------------
  0 | 2021-01-05 01:09:40
  1 | 2021-01-06 12:11:23
  2 | 2021-01-07 00:11:22
  3 | 2021-01-08 04:59:10
  4 | 2021-01-08 13:59:09
(5 rows)

-- select get_format with group by index having (result)
--Testcase 3219:
SELECT id, date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')), c3 FROM time_tbl group by 3,2,1 HAVING date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) > '2000-01-02';
 id |     date_format     |         c3          
----+---------------------+---------------------
  0 | 2021-01-05 01:09:40 | 2021-01-03 12:10:30
  1 | 2021-01-06 12:11:23 | 2021-01-04 23:12:13
  2 | 2021-01-07 00:11:22 | 2021-01-05 11:12:12
  3 | 2021-01-08 04:59:10 | 2021-01-06 16:00:00
  4 | 2021-01-08 13:59:09 | 2021-01-07 00:59:59
(5 rows)

-- select get_format with group by index having (result)
--Testcase 3220:
SELECT id, date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')), c3 FROM time_tbl group by 1,2,3 HAVING date_format(c3 + '1 12:59:10', get_format('datetime', 'jis')) > '2000-01-02';
 id |     date_format     |         c3          
----+---------------------+---------------------
  0 | 2021-01-05 01:09:40 | 2021-01-03 12:10:30
  1 | 2021-01-06 12:11:23 | 2021-01-04 23:12:13
  2 | 2021-01-07 00:11:22 | 2021-01-05 11:12:12
  3 | 2021-01-08 04:59:10 | 2021-01-06 16:00:00
  4 | 2021-01-08 13:59:09 | 2021-01-07 00:59:59
(5 rows)

-- select get_format and as
--Testcase 3221:
SELECT get_format('datetime', 'jis') as get_format1 FROM time_tbl;
    get_format1    
-------------------
 %Y-%m-%d %H:%i:%s
 %Y-%m-%d %H:%i:%s
 %Y-%m-%d %H:%i:%s
 %Y-%m-%d %H:%i:%s
 %Y-%m-%d %H:%i:%s
(5 rows)

-- FROM_UNIXTIME()
-- select from_unixtime (stub function, explain)
--Testcase 3222:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl;
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1935.95 rows=3413 width=40)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text) FROM public.time_tblmysql
(4 rows)

-- select from_unixtime (stub function, result)
--Testcase 3223:
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl;
    from_unixtime    |          from_unixtime           
---------------------+----------------------------------
 2015-11-13 08:08:01 | 2015 13th November 08:08:01 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:02 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:03 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:04 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:05 2015
(5 rows)

-- select from_unixtime (stub function, not pushdown constraints, explain)
--Testcase 3224:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl WHERE to_hex(id) > '0';
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..804.14 rows=1138 width=40)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text), id FROM public.time_tblmysql
(5 rows)

-- select from_unixtime (stub function, not pushdown constraints, result)
--Testcase 3225:
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl WHERE to_hex(id) > '0';
    from_unixtime    |          from_unixtime           
---------------------+----------------------------------
 2015-11-13 08:08:01 | 2015 13th November 08:08:02 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:03 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:04 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:05 2015
(4 rows)

-- select from_unixtime (stub function, pushdown constraints, explain)
--Testcase 3226:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl WHERE id = 1;
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..161.59 rows=17 width=40)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text) FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select from_unixtime (stub function, pushdown constraints, result)
--Testcase 3227:
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl WHERE id = 1;
    from_unixtime    |          from_unixtime           
---------------------+----------------------------------
 2015-11-13 08:08:01 | 2015 13th November 08:08:02 2015
(1 row)

-- select from_unixtime (stub function, from_unixtime in constraints, explain)
--Testcase 3228:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl WHERE from_unixtime(id + 1447430881) > from_unixtime(1447430881);
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2473.68 rows=1138 width=40)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text) FROM public.time_tblmysql WHERE ((public.from_unixtime((id + 1447430881)) > public.from_unixtime(1447430881::bigint)))
(4 rows)

-- select from_unixtime (stub function, from_unixtime in constraints, result)
--Testcase 3229:
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl WHERE from_unixtime(id + 1447430881) > from_unixtime(1447430881);
    from_unixtime    |          from_unixtime           
---------------------+----------------------------------
 2015-11-13 08:08:01 | 2015 13th November 08:08:02 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:03 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:04 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:05 2015
(4 rows)

-- select from_unixtime and agg (pushdown, explain)
--Testcase 3230:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), sum(id) FROM time_tbl;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (from_unixtime('1447430881'::bigint)), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), sum(id) FROM public.time_tblmysql
(6 rows)

-- select from_unixtime and log2 (pushdown, result)
--Testcase 3231:
SELECT from_unixtime(1447430881), log2(id) FROM time_tbl;
    from_unixtime    |       log2        
---------------------+-------------------
 2015-11-13 08:08:01 |                  
 2015-11-13 08:08:01 |                 0
 2015-11-13 08:08:01 |                 1
 2015-11-13 08:08:01 | 1.584962500721156
 2015-11-13 08:08:01 |                 2
(5 rows)

-- select from_unixtime with non pushdown func and explicit constant (explain)
--Testcase 3232:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), to_hex(id), 4 FROM time_tbl;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (from_unixtime('1447430881'::bigint)), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select from_unixtime with order by (explain)
--Testcase 3233:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x'), c1 FROM time_tbl ORDER BY from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x');
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2136.24..2144.78 rows=3413 width=48)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text)), c1
   Sort Key: (from_unixtime('1447430881'::bigint)), (from_unixtime(((time_tbl.id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1935.95 rows=3413 width=48)
         Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text)), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text), c1 FROM public.time_tblmysql
(7 rows)

-- select from_unixtime with order by index (explain)
--Testcase 3234:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x'), c1 FROM time_tbl ORDER BY 1,2,3;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2136.24..2144.78 rows=3413 width=48)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text)), c1
   Sort Key: (from_unixtime('1447430881'::bigint)), (from_unixtime(((time_tbl.id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text)), time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1935.95 rows=3413 width=48)
         Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text)), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text), c1 FROM public.time_tblmysql
(7 rows)

-- from_unixtime constraints with order by (explain)
--Testcase 3235:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl WHERE from_unixtime(id + 1447430881) > from_unixtime(1447430881) ORDER BY from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x');
                                                                                                                             QUERY PLAN                                                                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2531.44..2534.29 rows=1138 width=40)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
   Sort Key: (from_unixtime('1447430881'::bigint)), (from_unixtime(((time_tbl.id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..2473.68 rows=1138 width=40)
         Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text) FROM public.time_tblmysql WHERE ((public.from_unixtime((id + 1447430881)) > public.from_unixtime(1447430881::bigint)))
(7 rows)

-- from_unixtime constraints with order by (result)
--Testcase 3236:
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') FROM time_tbl WHERE from_unixtime(id + 1447430881) > from_unixtime(1447430881) ORDER BY from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x');
    from_unixtime    |          from_unixtime           
---------------------+----------------------------------
 2015-11-13 08:08:01 | 2015 13th November 08:08:02 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:03 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:04 2015
 2015-11-13 08:08:01 | 2015 13th November 08:08:05 2015
(4 rows)

-- select from_unixtime with group by (explain)
--Testcase 3237:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x'), c1 FROM time_tbl GROUP BY c1,id;
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=52)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text)), c1, id
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text), c1, id FROM public.time_tblmysql GROUP BY 3, 4
(6 rows)

-- select from_unixtime with group by index (explain)
--Testcase 3238:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x'), c1 FROM time_tbl GROUP BY 1,2,3;
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=48)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text)), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text), c1 FROM public.time_tblmysql GROUP BY 1, 2, 3
(6 rows)

-- select from_unixtime with group by index having (explain)
--Testcase 3239:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x'), c1 FROM time_tbl GROUP BY 1,2,3 HAVING from_unixtime(1447430881) = '2015-11-13 08:08:01';
                                                                                                                                           QUERY PLAN                                                                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=48)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text)), c1
   Filter: ((from_unixtime('1447430881'::bigint)) = '2015-11-13 08:08:01'::timestamp without time zone)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text), c1 FROM public.time_tblmysql GROUP BY 1, 2, 3 HAVING ((public.from_unixtime(1447430881::bigint) = '2015-11-13 08:08:01'::timestamp without time zone))
(7 rows)

-- select from_unixtime with group by index having (result)
--Testcase 3240:
SELECT from_unixtime(1447430881), from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x'), c1 FROM time_tbl GROUP BY 1,2,3 HAVING from_unixtime(1447430881) = '2015-11-13 08:08:01';
    from_unixtime    |          from_unixtime           |    c1    
---------------------+----------------------------------+----------
 2015-11-13 08:08:01 | 2015 13th November 08:08:01 2015 | 12:10:30
 2015-11-13 08:08:01 | 2015 13th November 08:08:02 2015 | 23:12:13
 2015-11-13 08:08:01 | 2015 13th November 08:08:03 2015 | 11:12:12
 2015-11-13 08:08:01 | 2015 13th November 08:08:04 2015 | 16:00:00
 2015-11-13 08:08:01 | 2015 13th November 08:08:05 2015 | 00:59:59
(5 rows)

-- select from_unixtime and as
--Testcase 3241:
EXPLAIN VERBOSE
SELECT from_unixtime(1447430881) as from_unixtime1, from_unixtime(id + 1447430881, '%Y %D %M %h:%i:%s %x') as from_unixtime2 FROM time_tbl;
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1935.95 rows=3413 width=40)
   Output: (from_unixtime('1447430881'::bigint)), (from_unixtime(((id + 1447430881))::bigint, '%Y %D %M %h:%i:%s %x'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_unixtime(1447430881::bigint), public.from_unixtime((id + 1447430881), '%Y %D %M %h:%i:%s %x'::text) FROM public.time_tblmysql
(4 rows)

-- FROM_DAYS()
-- select from_days (stub function, explain)
--Testcase 3242:
EXPLAIN VERBOSE
SELECT from_days(id + 200719) FROM time_tbl;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=4)
   Output: (from_days((id + 200719)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_days((id + 200719)) FROM public.time_tblmysql
(4 rows)

-- select from_days (stub function, result)
--Testcase 3243:
SELECT from_days(id + 200719) FROM time_tbl;
 from_days  
------------
 0549-07-20
 0549-07-21
 0549-07-22
 0549-07-23
 0549-07-24
(5 rows)

-- select from_days (stub function, not pushdown constraints, explain)
--Testcase 3244:
EXPLAIN VERBOSE
SELECT from_days(id + 200719) FROM time_tbl WHERE to_hex(id) > '0';
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..516.80 rows=1138 width=4)
   Output: (from_days((id + 200719)))
   Filter: (to_hex(time_tbl.id) > '0'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_days((id + 200719)), id FROM public.time_tblmysql
(5 rows)

-- select from_days (stub function, not pushdown constraints, result)
--Testcase 3245:
SELECT from_days(id + 200719) FROM time_tbl WHERE to_hex(id) > '0';
 from_days  
------------
 0549-07-21
 0549-07-22
 0549-07-23
 0549-07-24
(4 rows)

-- select from_days (stub function, pushdown constraints, explain)
--Testcase 3246:
EXPLAIN VERBOSE
SELECT from_days(id + 200719) FROM time_tbl WHERE id = 1;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..157.29 rows=17 width=4)
   Output: (from_days((id + 200719)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_days((id + 200719)) FROM public.time_tblmysql WHERE ((id = 1))
(4 rows)

-- select from_days (stub function, pushdown constraints, result)
--Testcase 3247:
SELECT from_days(id + 200719) FROM time_tbl WHERE id = 1;
 from_days  
------------
 0549-07-21
(1 row)

-- from_days in constrains (stub function, explain)
--Testcase 3248:
EXPLAIN VERBOSE
SELECT from_days(id + 200719) FROM time_tbl WHERE from_days(id + 200719) > from_days(day('2001-01-01'::date));
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3031.05 rows=1138 width=4)
   Output: (from_days((id + 200719)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_days((id + 200719)) FROM public.time_tblmysql WHERE ((public.from_days((id + 200719)) > public.from_days(public.day('2001-01-01 00:00:00'::timestamp without time zone))))
(4 rows)

-- from_days in constrains (stub function, result)
--Testcase 3249:
SELECT from_days(id + 200719) FROM time_tbl WHERE from_days(id + 200719) > from_days(day('2001-01-01'::date));
 from_days  
------------
 0549-07-20
 0549-07-21
 0549-07-22
 0549-07-23
 0549-07-24
(5 rows)

-- select from_days and agg (pushdown, explain)
--Testcase 3250:
EXPLAIN VERBOSE
SELECT from_days(max(id) + 200719), sum(id) FROM time_tbl;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (from_days((max(id) + 200719))), (sum(id))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.from_days((max(id) + 200719)), sum(id) FROM public.time_tblmysql
(6 rows)

-- select from_days and agg (pushdown, result)
--Testcase 3251:
SELECT from_days(max(id) + 200719), sum(id) FROM time_tbl;
 from_days  | sum 
------------+-----
 0549-07-24 |  10
(1 row)

-- select from_days and log2 (pushdown, explain)
--Testcase 3252:
EXPLAIN VERBOSE
SELECT from_days(id + 200719), log2(id) FROM time_tbl;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1935.95 rows=3413 width=12)
   Output: (from_days((id + 200719))), (log2((id)::double precision))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_days((id + 200719)), public.log2(id) FROM public.time_tblmysql
(4 rows)

-- select from_days and log2 (pushdown, result)
--Testcase 3253:
SELECT from_days(id + 200719), log2(id) FROM time_tbl;
 from_days  |       log2        
------------+-------------------
 0549-07-20 |                  
 0549-07-21 |                 0
 0549-07-22 |                 1
 0549-07-23 | 1.584962500721156
 0549-07-24 |                 2
(5 rows)

-- select from_days with non pushdown func and explicit constant (explain)
--Testcase 3254:
EXPLAIN VERBOSE
SELECT from_days(id + 200719), to_hex(id), 4 FROM time_tbl;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1082.70 rows=3413 width=40)
   Output: (from_days((id + 200719))), (to_hex(id)), 4
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_days((id + 200719)), to_hex(id), 4 FROM public.time_tblmysql
(4 rows)

-- select from_days with order by (explain)
--Testcase 3255:
EXPLAIN VERBOSE
SELECT from_days(id + 200719), c1 FROM time_tbl ORDER BY from_days(id + 200719);
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=12)
   Output: (from_days((id + 200719))), c1
   Sort Key: (from_days((time_tbl.id + 200719)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=12)
         Output: (from_days((id + 200719))), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.from_days((id + 200719)), c1 FROM public.time_tblmysql
(7 rows)

-- select from_days with order by index (explain)
--Testcase 3256:
EXPLAIN VERBOSE
SELECT from_days(id + 200719), c1 FROM time_tbl ORDER BY 1,2;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=12)
   Output: (from_days((id + 200719))), c1
   Sort Key: (from_days((time_tbl.id + 200719))), time_tbl.c1
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=12)
         Output: (from_days((id + 200719))), c1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.from_days((id + 200719)), c1 FROM public.time_tblmysql
(7 rows)

-- from_days constraints with order by (explain)
--Testcase 3257:
EXPLAIN VERBOSE
SELECT from_days(id + 200719) FROM time_tbl WHERE from_days(id + 200719) > from_days(day('2001-01-01'::date)) ORDER BY from_days(id + 200719);
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=3088.82..3091.66 rows=1138 width=4)
   Output: (from_days((id + 200719)))
   Sort Key: (from_days((time_tbl.id + 200719)))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..3031.05 rows=1138 width=4)
         Output: (from_days((id + 200719)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.from_days((id + 200719)) FROM public.time_tblmysql WHERE ((public.from_days((id + 200719)) > public.from_days(public.day('2001-01-01 00:00:00'::timestamp without time zone))))
(7 rows)

-- from_days constraints with order by (result)
--Testcase 3258:
SELECT from_days(id + 200719) FROM time_tbl WHERE from_days(id + 200719) > from_days(day('2001-01-01'::date)) ORDER BY from_days(id + 200719);
 from_days  
------------
 0549-07-20
 0549-07-21
 0549-07-22
 0549-07-23
 0549-07-24
(5 rows)

-- select from_days with group by (explain)
--Testcase 3259:
EXPLAIN VERBOSE
SELECT from_days(id + 200719), c1 FROM time_tbl GROUP BY c1,id;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=16)
   Output: (from_days((id + 200719))), c1, id
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.from_days((id + 200719)), c1, id FROM public.time_tblmysql GROUP BY 2, 3
(6 rows)

-- select from_days with group by index (explain)
--Testcase 3260:
EXPLAIN VERBOSE
SELECT from_days(id + 200719), c1 FROM time_tbl GROUP BY 1,2;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=12)
   Output: (from_days((id + 200719))), c1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.from_days((id + 200719)), c1 FROM public.time_tblmysql GROUP BY 1, 2
(6 rows)

-- select from_days with group by having (explain)
--Testcase 3261:
EXPLAIN VERBOSE
SELECT from_days(id + 200719), c1 FROM time_tbl GROUP BY from_days(id + 200719),c1,id HAVING from_days(id + 200719) > '0549-07-21';
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (from_days((id + 200719))), c1, id
   Filter: ((from_days((time_tbl.id + 200719))) > '0549-07-21'::date)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT public.from_days((id + 200719)), c1, id FROM public.time_tblmysql GROUP BY 1, 2, 3
(7 rows)

-- select from_days with group by index having (result)
--Testcase 3262:
SELECT id, from_days(id + 200719), c1 FROM time_tbl GROUP BY 1,2,3 HAVING from_days(id + 200719) > '0549-07-21';
 id | from_days  |    c1    
----+------------+----------
  2 | 0549-07-22 | 11:12:12
  3 | 0549-07-23 | 16:00:00
  4 | 0549-07-24 | 00:59:59
(3 rows)

-- select from_days and as
--Testcase 3263:
EXPLAIN VERBOSE
SELECT from_days(id + 200719) as from_days1 FROM time_tbl;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1074.17 rows=3413 width=4)
   Output: (from_days((id + 200719)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.from_days((id + 200719)) FROM public.time_tblmysql
(4 rows)

-- EXTRACT()
-- select mysql_extract (stub function, explain)
--Testcase 3264:
EXPLAIN VERBOSE
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl;
                                                                                                                 QUERY PLAN                                                                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=12)
   Output: (mysql_extract('YEAR'::text, (c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_extract('YEAR'::text, c2), public.mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone), public.mysql_extract('DAY_MINUTE'::text, c3) FROM public.time_tblmysql
(4 rows)

-- select mysql_extract (stub function, result)
--Testcase 3265:
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl;
 mysql_extract | mysql_extract | mysql_extract 
---------------+---------------+---------------
          2021 |        123456 |         31210
          2021 |        123456 |         42312
          2021 |        123456 |         51112
          2021 |        123456 |         61600
          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract (stub function, not pushdown constraints, explain)
--Testcase 3266:
EXPLAIN VERBOSE
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..241.99 rows=17 width=12)
   Output: (mysql_extract('YEAR'::text, (c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, c3))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_extract('YEAR'::text, c2), public.mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone), public.mysql_extract('DAY_MINUTE'::text, c3), id FROM public.time_tblmysql
(5 rows)

-- select mysql_extract (stub function, not pushdown constraints, result)
--Testcase 3267:
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl WHERE to_hex(id) = '1';
 mysql_extract | mysql_extract | mysql_extract 
---------------+---------------+---------------
          2021 |        123456 |         42312
(1 row)

-- select mysql_extract (stub function, pushdown constraints, explain)
--Testcase 3268:
EXPLAIN VERBOSE
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl WHERE id != 200;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2776.07 rows=3396 width=12)
   Output: (mysql_extract('YEAR'::text, (c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_extract('YEAR'::text, c2), public.mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone), public.mysql_extract('DAY_MINUTE'::text, c3) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select mysql_extract (stub function, pushdown constraints, result)
--Testcase 3269:
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl WHERE id != 200;
 mysql_extract | mysql_extract | mysql_extract 
---------------+---------------+---------------
          2021 |        123456 |         31210
          2021 |        123456 |         42312
          2021 |        123456 |         51112
          2021 |        123456 |         61600
          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract (stub function, mysql_extract in constraints, explain)
--Testcase 3270:
EXPLAIN VERBOSE
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl WHERE mysql_extract('YEAR_MONTH', c3 ) != mysql_extract('YEAR_MONTH', '2000-01-01'::timestamp);
                                                                                                                                                                                             QUERY PLAN                                                                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..4482.57 rows=3396 width=12)
   Output: (mysql_extract('YEAR'::text, (c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_extract('YEAR'::text, c2), public.mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone), public.mysql_extract('DAY_MINUTE'::text, c3) FROM public.time_tblmysql WHERE ((public.mysql_extract('YEAR_MONTH'::text, c3) <> public.mysql_extract('YEAR_MONTH'::text, '2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select mysql_extract (stub function, mysql_extract in constraints, result)
--Testcase 3271:
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl WHERE mysql_extract('YEAR_MONTH', c3 ) != mysql_extract('YEAR_MONTH', '2000-01-01'::timestamp);
 mysql_extract | mysql_extract | mysql_extract 
---------------+---------------+---------------
          2021 |        123456 |         31210
          2021 |        123456 |         42312
          2021 |        123456 |         51112
          2021 |        123456 |         61600
          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract (stub function, mysql_extract in constraints, explain)
--Testcase 3272:
EXPLAIN VERBOSE
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl WHERE mysql_extract('YEAR_MONTH', c3 ) > '1';
                                                                                                                                               QUERY PLAN                                                                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1885.02 rows=1138 width=12)
   Output: (mysql_extract('YEAR'::text, (c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, c3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_extract('YEAR'::text, c2), public.mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone), public.mysql_extract('DAY_MINUTE'::text, c3) FROM public.time_tblmysql WHERE ((public.mysql_extract('YEAR_MONTH'::text, c3) > 1))
(4 rows)

-- select mysql_extract (stub function, mysql_extract in constraints, result)
--Testcase 3273:
SELECT mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl WHERE mysql_extract('YEAR_MONTH', c3 ) > '1';
 mysql_extract | mysql_extract | mysql_extract 
---------------+---------------+---------------
          2021 |        123456 |         31210
          2021 |        123456 |         42312
          2021 |        123456 |         51112
          2021 |        123456 |         61600
          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract with agg (pushdown, explain)
--Testcase 3274:
EXPLAIN VERBOSE
SELECT max(c3), mysql_extract('YEAR', max(c3)) FROM time_tbl;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (max(c3)), (mysql_extract('YEAR'::text, max(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.mysql_extract('YEAR'::text, max(c3)) FROM public.time_tblmysql
(6 rows)

-- select mysql_extract as nest function with agg (pushdown, result)
--Testcase 3275:
SELECT max(c3), mysql_extract('YEAR', max(c3)) FROM time_tbl;
         max         | mysql_extract 
---------------------+---------------
 2021-01-07 00:59:59 |          2021
(1 row)

-- select mysql_extract with non pushdown func and explicit constant (explain)
--Testcase 3276:
EXPLAIN VERBOSE
SELECT mysql_extract('YEAR', date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (mysql_extract('YEAR'::text, date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_extract('YEAR'::text, public.date_sub(c3, '@ 1 day 12 hours 59 mins 10 secs'::interval)), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select mysql_extract with non pushdown func and explicit constant (result)
--Testcase 3277:
SELECT mysql_extract('YEAR', date_sub(c3, '1 12:59:10')), pi(), 4.1 FROM time_tbl;
 mysql_extract |        pi         | ?column? 
---------------+-------------------+----------
          2021 | 3.141592653589793 |      4.1
          2021 | 3.141592653589793 |      4.1
          2021 | 3.141592653589793 |      4.1
          2021 | 3.141592653589793 |      4.1
          2021 | 3.141592653589793 |      4.1
(5 rows)

-- select mysql_extract with order by (explain)
--Testcase 3278:
EXPLAIN VERBOSE
SELECT id, mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl order by mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3);
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2980.96..2989.49 rows=3413 width=16)
   Output: id, (mysql_extract('YEAR'::text, (c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, c3))
   Sort Key: (mysql_extract('YEAR'::text, (time_tbl.c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, time_tbl.c3))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..2780.67 rows=3413 width=16)
         Output: id, (mysql_extract('YEAR'::text, (c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, c3))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.mysql_extract('YEAR'::text, c2), public.mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone), public.mysql_extract('DAY_MINUTE'::text, c3) FROM public.time_tblmysql
(7 rows)

-- select mysql_extract with order by (result)
--Testcase 3279:
SELECT id, mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl order by mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3);
 id | mysql_extract | mysql_extract | mysql_extract 
----+---------------+---------------+---------------
  0 |          2021 |        123456 |         31210
  1 |          2021 |        123456 |         42312
  2 |          2021 |        123456 |         51112
  3 |          2021 |        123456 |         61600
  4 |          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract with order by index (result)
--Testcase 3280:
SELECT id, mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl order by 4,3,2,1;
 id | mysql_extract | mysql_extract | mysql_extract 
----+---------------+---------------+---------------
  0 |          2021 |        123456 |         31210
  1 |          2021 |        123456 |         42312
  2 |          2021 |        123456 |         51112
  3 |          2021 |        123456 |         61600
  4 |          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract with order by index (result)
--Testcase 3281:
SELECT id, mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl order by 1,2,3,4;
 id | mysql_extract | mysql_extract | mysql_extract 
----+---------------+---------------+---------------
  0 |          2021 |        123456 |         31210
  1 |          2021 |        123456 |         42312
  2 |          2021 |        123456 |         51112
  3 |          2021 |        123456 |         61600
  4 |          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract with group by (explain)
--Testcase 3282:
EXPLAIN VERBOSE
SELECT max(c3), mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl group by mysql_extract('DAY_MINUTE', c3),c2;
                                                                                                                               QUERY PLAN                                                                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=24)
   Output: (max(c3)), (mysql_extract('YEAR'::text, (c2)::timestamp without time zone)), (mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone)), (mysql_extract('DAY_MINUTE'::text, c3)), c2
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.mysql_extract('YEAR'::text, c2), public.mysql_extract('MICROSECOND'::text, '2021-01-03 12:10:30.123456'::timestamp without time zone), public.mysql_extract('DAY_MINUTE'::text, c3), c2 FROM public.time_tblmysql GROUP BY 4, 5
(6 rows)

-- select mysql_extract with group by (result)
--Testcase 3283:
SELECT max(c3), mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl group by mysql_extract('DAY_MINUTE', c3),c2;
         max         | mysql_extract | mysql_extract | mysql_extract 
---------------------+---------------+---------------+---------------
 2021-01-03 12:10:30 |          2021 |        123456 |         31210
 2021-01-04 23:12:13 |          2021 |        123456 |         42312
 2021-01-05 11:12:12 |          2021 |        123456 |         51112
 2021-01-06 16:00:00 |          2021 |        123456 |         61600
 2021-01-07 00:59:59 |          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract with group by index (result)
--Testcase 3284:
SELECT id, mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl group by 4,3,2,1;
 id | mysql_extract | mysql_extract | mysql_extract 
----+---------------+---------------+---------------
  0 |          2021 |        123456 |         31210
  1 |          2021 |        123456 |         42312
  2 |          2021 |        123456 |         51112
  3 |          2021 |        123456 |         61600
  4 |          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract with group by index (result)
--Testcase 3285:
SELECT id, mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3) FROM time_tbl group by 1,2,3,4;
 id | mysql_extract | mysql_extract | mysql_extract 
----+---------------+---------------+---------------
  0 |          2021 |        123456 |         31210
  1 |          2021 |        123456 |         42312
  2 |          2021 |        123456 |         51112
  3 |          2021 |        123456 |         61600
  4 |          2021 |        123456 |         70059
(5 rows)

-- select mysql_extract with group by index having (result)
--Testcase 3286:
SELECT id, mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3), c2 FROM time_tbl group by 5, 4, 3, 2, 1 HAVING mysql_extract('YEAR', c2) > 2000;
 id | mysql_extract | mysql_extract | mysql_extract |     c2     
----+---------------+---------------+---------------+------------
  0 |          2021 |        123456 |         31210 | 2021-01-02
  1 |          2021 |        123456 |         42312 | 2021-01-01
  2 |          2021 |        123456 |         51112 | 2021-01-10
  3 |          2021 |        123456 |         61600 | 2021-01-15
  4 |          2021 |        123456 |         70059 | 2021-01-29
(5 rows)

-- select mysql_extract with group by index having (result)
--Testcase 3287:
SELECT id, mysql_extract('YEAR', c2), mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp), mysql_extract('DAY_MINUTE', c3), c2 FROM time_tbl group by 1, 2, 3, 4, 5 HAVING mysql_extract('YEAR', c2) > 2000;
 id | mysql_extract | mysql_extract | mysql_extract |     c2     
----+---------------+---------------+---------------+------------
  0 |          2021 |        123456 |         31210 | 2021-01-02
  1 |          2021 |        123456 |         42312 | 2021-01-01
  2 |          2021 |        123456 |         51112 | 2021-01-10
  3 |          2021 |        123456 |         61600 | 2021-01-15
  4 |          2021 |        123456 |         70059 | 2021-01-29
(5 rows)

-- select mysql_extract and as
--Testcase 3288:
SELECT mysql_extract('YEAR', c2) as mysql_extract1, mysql_extract('MICROSECOND', '2021-01-03 12:10:30.123456'::timestamp) as mysql_extract2, mysql_extract('DAY_MINUTE', c3) as mysql_extract3 FROM time_tbl;
 mysql_extract1 | mysql_extract2 | mysql_extract3 
----------------+----------------+----------------
           2021 |         123456 |          31210
           2021 |         123456 |          42312
           2021 |         123456 |          51112
           2021 |         123456 |          61600
           2021 |         123456 |          70059
(5 rows)

-- DAYOFYEAR()
-- select dayofyear (stub function, explain)
--Testcase 3289:
EXPLAIN VERBOSE
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (dayofyear(c2)), (dayofyear('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofyear(c2), public.dayofyear('2021-01-01'::date) FROM public.time_tblmysql
(4 rows)

-- select dayofyear (stub function, result)
--Testcase 3290:
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl;
 dayofyear | dayofyear 
-----------+-----------
         2 |         1
         1 |         1
        10 |         1
        15 |         1
        29 |         1
(5 rows)

-- select dayofyear (stub function, not pushdown constraints, explain)
--Testcase 3291:
EXPLAIN VERBOSE
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl WHERE to_hex(id) = '1';
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.69 rows=17 width=8)
   Output: (dayofyear(c2)), (dayofyear('2021-01-01'::date))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofyear(c2), public.dayofyear('2021-01-01'::date), id FROM public.time_tblmysql
(5 rows)

-- select dayofyear (stub function, not pushdown constraints, result)
--Testcase 3292:
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl WHERE to_hex(id) = '1';
 dayofyear | dayofyear 
-----------+-----------
         1 |         1
(1 row)

-- select dayofyear (stub function, pushdown constraints, explain)
--Testcase 3293:
EXPLAIN VERBOSE
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl WHERE id != 200;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.58 rows=3396 width=8)
   Output: (dayofyear(c2)), (dayofyear('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofyear(c2), public.dayofyear('2021-01-01'::date) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select dayofyear (stub function, pushdown constraints, result)
--Testcase 3294:
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl WHERE id != 200;
 dayofyear | dayofyear 
-----------+-----------
         2 |         1
         1 |         1
        10 |         1
        15 |         1
        29 |         1
(5 rows)

-- select dayofyear (stub function, dayofyear in constraints, explain)
--Testcase 3295:
EXPLAIN VERBOSE
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl WHERE dayofyear(c2) != dayofyear('2000-01-01'::date);
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3625.08 rows=3396 width=8)
   Output: (dayofyear(c2)), (dayofyear('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofyear(c2), public.dayofyear('2021-01-01'::date) FROM public.time_tblmysql WHERE ((public.dayofyear(c2) <> public.dayofyear('2000-01-01'::date)))
(4 rows)

-- select dayofyear (stub function, dayofyear in constraints, result)
--Testcase 3296:
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl WHERE dayofyear(c2) != dayofyear('2000-01-01'::date);
 dayofyear | dayofyear 
-----------+-----------
         2 |         1
        10 |         1
        15 |         1
        29 |         1
(4 rows)

-- select dayofyear (stub function, dayofyear in constraints, explain)
--Testcase 3297:
EXPLAIN VERBOSE
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl WHERE dayofyear('2021-01-01 12:00:00'::date) > 0;
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1597.67 rows=1138 width=8)
   Output: (dayofyear(c2)), (dayofyear('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofyear(c2), public.dayofyear('2021-01-01'::date) FROM public.time_tblmysql WHERE ((public.dayofyear('2021-01-01'::date) > 0))
(4 rows)

-- select dayofyear (stub function, dayofyear in constraints, result)
--Testcase 3298:
SELECT dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl WHERE dayofyear('2021-01-01 12:00:00'::date) > 0;
 dayofyear | dayofyear 
-----------+-----------
         2 |         1
         1 |         1
        10 |         1
        15 |         1
        29 |         1
(5 rows)

-- select dayofyear with agg (pushdown, explain)
--Testcase 3299:
EXPLAIN VERBOSE
SELECT max(c2), dayofyear(max(c2)) FROM time_tbl;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (max(c2)), (dayofyear(max(c2)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c2), public.dayofyear(max(c2)) FROM public.time_tblmysql
(6 rows)

-- select dayofyear as nest function with agg (pushdown, result)
--Testcase 3300:
SELECT max(c2), dayofyear(max(c2)) FROM time_tbl;
    max     | dayofyear 
------------+-----------
 2021-01-29 |        29
(1 row)

-- select dayofyear with non pushdown func and explicit constant (explain)
--Testcase 3301:
EXPLAIN VERBOSE
SELECT dayofyear(c2), dayofyear('2021-01-01'::date), pi(), 4.1 FROM time_tbl;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (dayofyear(c2)), (dayofyear('2021-01-01'::date)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofyear(c2), public.dayofyear('2021-01-01'::date), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select dayofyear with non pushdown func and explicit constant (result)
--Testcase 3302:
SELECT dayofyear(c2), dayofyear('2021-01-01'::date), pi(), 4.1 FROM time_tbl;
 dayofyear | dayofyear |        pi         | ?column? 
-----------+-----------+-------------------+----------
         2 |         1 | 3.141592653589793 |      4.1
         1 |         1 | 3.141592653589793 |      4.1
        10 |         1 | 3.141592653589793 |      4.1
        15 |         1 | 3.141592653589793 |      4.1
        29 |         1 | 3.141592653589793 |      4.1
(5 rows)

-- select dayofyear with order by (explain)
--Testcase 3303:
EXPLAIN VERBOSE
SELECT id, dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl order by dayofyear(c2), dayofyear('2021-01-01'::date);
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=12)
   Output: id, (dayofyear(c2)), (dayofyear('2021-01-01'::date))
   Sort Key: (dayofyear(time_tbl.c2)), (dayofyear('2021-01-01'::date))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=12)
         Output: id, (dayofyear(c2)), (dayofyear('2021-01-01'::date))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.dayofyear(c2), public.dayofyear('2021-01-01'::date) FROM public.time_tblmysql
(7 rows)

-- select dayofyear with order by (result)
--Testcase 3304:
SELECT id, dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl order by dayofyear(c2), dayofyear('2021-01-01'::date);
 id | dayofyear | dayofyear 
----+-----------+-----------
  1 |         1 |         1
  0 |         2 |         1
  2 |        10 |         1
  3 |        15 |         1
  4 |        29 |         1
(5 rows)

-- select dayofyear with order by index (result)
--Testcase 3305:
SELECT id, dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl order by 3,2,1;
 id | dayofyear | dayofyear 
----+-----------+-----------
  1 |         1 |         1
  0 |         2 |         1
  2 |        10 |         1
  3 |        15 |         1
  4 |        29 |         1
(5 rows)

-- select dayofyear with order by index (result)
--Testcase 3306:
SELECT id, dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl order by 1,2,3;
 id | dayofyear | dayofyear 
----+-----------+-----------
  0 |         2 |         1
  1 |         1 |         1
  2 |        10 |         1
  3 |        15 |         1
  4 |        29 |         1
(5 rows)

-- select dayofyear with group by (explain)
--Testcase 3307:
EXPLAIN VERBOSE
SELECT max(c3), dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl group by dayofyear(c2);
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (dayofyear(c2)), (dayofyear('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.dayofyear(c2), public.dayofyear('2021-01-01'::date) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select dayofyear with group by (result)
--Testcase 3308:
SELECT max(c3), dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl group by dayofyear(c2);
         max         | dayofyear | dayofyear 
---------------------+-----------+-----------
 2021-01-03 12:10:30 |         2 |         1
 2021-01-04 23:12:13 |         1 |         1
 2021-01-05 11:12:12 |        10 |         1
 2021-01-06 16:00:00 |        15 |         1
 2021-01-07 00:59:59 |        29 |         1
(5 rows)

-- select dayofyear with group by index (result)
--Testcase 3309:
SELECT id, dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl group by 3,2,1;
 id | dayofyear | dayofyear 
----+-----------+-----------
  0 |         2 |         1
  1 |         1 |         1
  2 |        10 |         1
  3 |        15 |         1
  4 |        29 |         1
(5 rows)

-- select dayofyear with group by index (result)
--Testcase 3310:
SELECT id, dayofyear(c2), dayofyear('2021-01-01'::date) FROM time_tbl group by 1,2,3;
 id | dayofyear | dayofyear 
----+-----------+-----------
  0 |         2 |         1
  1 |         1 |         1
  2 |        10 |         1
  3 |        15 |         1
  4 |        29 |         1
(5 rows)

-- select dayofyear with group by index having (result)
--Testcase 3311:
SELECT id, dayofyear(c2), dayofyear('2021-01-01'::date), c2 FROM time_tbl group by 4, 3, 2, 1 HAVING dayofyear(c2) > 0;
 id | dayofyear | dayofyear |     c2     
----+-----------+-----------+------------
  0 |         2 |         1 | 2021-01-02
  1 |         1 |         1 | 2021-01-01
  2 |        10 |         1 | 2021-01-10
  3 |        15 |         1 | 2021-01-15
  4 |        29 |         1 | 2021-01-29
(5 rows)

-- select dayofyear with group by index having (result)
--Testcase 3312:
SELECT id, dayofyear(c2), dayofyear('2021-01-01'::date), c2 FROM time_tbl group by 1, 2, 3, 4 HAVING dayofyear(c2) > 0;
 id | dayofyear | dayofyear |     c2     
----+-----------+-----------+------------
  0 |         2 |         1 | 2021-01-02
  1 |         1 |         1 | 2021-01-01
  2 |        10 |         1 | 2021-01-10
  3 |        15 |         1 | 2021-01-15
  4 |        29 |         1 | 2021-01-29
(5 rows)

-- select dayofyear and as
--Testcase 3313:
SELECT dayofyear(c2) as dayofyear1, dayofyear('2021-01-01'::date) as dayofyear2 FROM time_tbl;
 dayofyear1 | dayofyear2 
------------+------------
          2 |          1
          1 |          1
         10 |          1
         15 |          1
         29 |          1
(5 rows)

-- DAYOFWEEK()
-- select dayofweek (stub function, explain)
--Testcase 3314:
EXPLAIN VERBOSE
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (dayofweek(c2)), (dayofweek('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofweek(c2), public.dayofweek('2021-01-01'::date) FROM public.time_tblmysql
(4 rows)

-- select dayofweek (stub function, result)
--Testcase 3315:
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl;
 dayofweek | dayofweek 
-----------+-----------
         7 |         6
         6 |         6
         1 |         6
         6 |         6
         6 |         6
(5 rows)

-- select dayofweek (stub function, not pushdown constraints, explain)
--Testcase 3316:
EXPLAIN VERBOSE
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl WHERE to_hex(id) = '1';
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.69 rows=17 width=8)
   Output: (dayofweek(c2)), (dayofweek('2021-01-01'::date))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofweek(c2), public.dayofweek('2021-01-01'::date), id FROM public.time_tblmysql
(5 rows)

-- select dayofweek (stub function, not pushdown constraints, result)
--Testcase 3317:
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl WHERE to_hex(id) = '1';
 dayofweek | dayofweek 
-----------+-----------
         6 |         6
(1 row)

-- select dayofweek (stub function, pushdown constraints, explain)
--Testcase 3318:
EXPLAIN VERBOSE
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl WHERE id != 200;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.58 rows=3396 width=8)
   Output: (dayofweek(c2)), (dayofweek('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofweek(c2), public.dayofweek('2021-01-01'::date) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select dayofweek (stub function, pushdown constraints, result)
--Testcase 3319:
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl WHERE id != 200;
 dayofweek | dayofweek 
-----------+-----------
         7 |         6
         6 |         6
         1 |         6
         6 |         6
         6 |         6
(5 rows)

-- select dayofweek (stub function, dayofweek in constraints, explain)
--Testcase 3320:
EXPLAIN VERBOSE
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl WHERE dayofweek(c2) != dayofweek('2000-01-01'::date);
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3625.08 rows=3396 width=8)
   Output: (dayofweek(c2)), (dayofweek('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofweek(c2), public.dayofweek('2021-01-01'::date) FROM public.time_tblmysql WHERE ((public.dayofweek(c2) <> public.dayofweek('2000-01-01'::date)))
(4 rows)

-- select dayofweek (stub function, dayofweek in constraints, result)
--Testcase 3321:
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl WHERE dayofweek(c2) != dayofweek('2000-01-01'::date);
 dayofweek | dayofweek 
-----------+-----------
         6 |         6
         1 |         6
         6 |         6
         6 |         6
(4 rows)

-- select dayofweek (stub function, dayofweek in constraints, explain)
--Testcase 3322:
EXPLAIN VERBOSE
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl WHERE dayofweek('2021-01-01 12:00:00'::date) > 0;
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1597.67 rows=1138 width=8)
   Output: (dayofweek(c2)), (dayofweek('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofweek(c2), public.dayofweek('2021-01-01'::date) FROM public.time_tblmysql WHERE ((public.dayofweek('2021-01-01'::date) > 0))
(4 rows)

-- select dayofweek (stub function, dayofweek in constraints, result)
--Testcase 3323:
SELECT dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl WHERE dayofweek('2021-01-01 12:00:00'::date) > 0;
 dayofweek | dayofweek 
-----------+-----------
         7 |         6
         6 |         6
         1 |         6
         6 |         6
         6 |         6
(5 rows)

-- select dayofweek with agg (pushdown, explain)
--Testcase 3324:
EXPLAIN VERBOSE
SELECT max(c2), dayofweek(max(c2)) FROM time_tbl;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (max(c2)), (dayofweek(max(c2)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c2), public.dayofweek(max(c2)) FROM public.time_tblmysql
(6 rows)

-- select dayofweek as nest function with agg (pushdown, result)
--Testcase 3325:
SELECT max(c2), dayofweek(max(c2)) FROM time_tbl;
    max     | dayofweek 
------------+-----------
 2021-01-29 |         6
(1 row)

-- select dayofweek with non pushdown func and explicit constant (explain)
--Testcase 3326:
EXPLAIN VERBOSE
SELECT dayofweek(c2), dayofweek('2021-01-01'::date), pi(), 4.1 FROM time_tbl;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (dayofweek(c2)), (dayofweek('2021-01-01'::date)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofweek(c2), public.dayofweek('2021-01-01'::date), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select dayofweek with non pushdown func and explicit constant (result)
--Testcase 3327:
SELECT dayofweek(c2), dayofweek('2021-01-01'::date), pi(), 4.1 FROM time_tbl;
 dayofweek | dayofweek |        pi         | ?column? 
-----------+-----------+-------------------+----------
         7 |         6 | 3.141592653589793 |      4.1
         6 |         6 | 3.141592653589793 |      4.1
         1 |         6 | 3.141592653589793 |      4.1
         6 |         6 | 3.141592653589793 |      4.1
         6 |         6 | 3.141592653589793 |      4.1
(5 rows)

-- select dayofweek with order by (explain)
--Testcase 3328:
EXPLAIN VERBOSE
SELECT id, dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl order by dayofweek(c2), dayofweek('2021-01-01'::date);
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=12)
   Output: id, (dayofweek(c2)), (dayofweek('2021-01-01'::date))
   Sort Key: (dayofweek(time_tbl.c2)), (dayofweek('2021-01-01'::date))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=12)
         Output: id, (dayofweek(c2)), (dayofweek('2021-01-01'::date))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.dayofweek(c2), public.dayofweek('2021-01-01'::date) FROM public.time_tblmysql
(7 rows)

-- select dayofweek with order by (result)
--Testcase 3329:
SELECT id, dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl order by dayofweek(c2), dayofweek('2021-01-01'::date);
 id | dayofweek | dayofweek 
----+-----------+-----------
  2 |         1 |         6
  1 |         6 |         6
  3 |         6 |         6
  4 |         6 |         6
  0 |         7 |         6
(5 rows)

-- select dayofweek with order by index (result)
--Testcase 3330:
SELECT id, dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl order by 3,2,1;
 id | dayofweek | dayofweek 
----+-----------+-----------
  2 |         1 |         6
  1 |         6 |         6
  3 |         6 |         6
  4 |         6 |         6
  0 |         7 |         6
(5 rows)

-- select dayofweek with order by index (result)
--Testcase 3331:
SELECT id, dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl order by 1,2,3;
 id | dayofweek | dayofweek 
----+-----------+-----------
  0 |         7 |         6
  1 |         6 |         6
  2 |         1 |         6
  3 |         6 |         6
  4 |         6 |         6
(5 rows)

-- select dayofweek with group by (explain)
--Testcase 3332:
EXPLAIN VERBOSE
SELECT max(c3), dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl group by dayofweek(c2);
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (dayofweek(c2)), (dayofweek('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.dayofweek(c2), public.dayofweek('2021-01-01'::date) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select dayofweek with group by (result)
--Testcase 3333:
SELECT max(c3), dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl group by dayofweek(c2);
         max         | dayofweek | dayofweek 
---------------------+-----------+-----------
 2021-01-03 12:10:30 |         7 |         6
 2021-01-07 00:59:59 |         6 |         6
 2021-01-05 11:12:12 |         1 |         6
(3 rows)

-- select dayofweek with group by index (result)
--Testcase 3334:
SELECT id, dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl group by 3,2,1;
 id | dayofweek | dayofweek 
----+-----------+-----------
  0 |         7 |         6
  1 |         6 |         6
  2 |         1 |         6
  3 |         6 |         6
  4 |         6 |         6
(5 rows)

-- select dayofweek with group by index (result)
--Testcase 3335:
SELECT id, dayofweek(c2), dayofweek('2021-01-01'::date) FROM time_tbl group by 1,2,3;
 id | dayofweek | dayofweek 
----+-----------+-----------
  0 |         7 |         6
  1 |         6 |         6
  2 |         1 |         6
  3 |         6 |         6
  4 |         6 |         6
(5 rows)

-- select dayofweek with group by index having (result)
--Testcase 3336:
SELECT id, dayofweek(c2), dayofweek('2021-01-01'::date), c2 FROM time_tbl group by 4, 3, 2, 1 HAVING dayofweek(c2) > 0;
 id | dayofweek | dayofweek |     c2     
----+-----------+-----------+------------
  0 |         7 |         6 | 2021-01-02
  1 |         6 |         6 | 2021-01-01
  2 |         1 |         6 | 2021-01-10
  3 |         6 |         6 | 2021-01-15
  4 |         6 |         6 | 2021-01-29
(5 rows)

-- select dayofweek with group by index having (result)
--Testcase 3337:
SELECT id, dayofweek(c2), dayofweek('2021-01-01'::date), c2 FROM time_tbl group by 1, 2, 3, 4 HAVING dayofweek(c2) > 0;
 id | dayofweek | dayofweek |     c2     
----+-----------+-----------+------------
  0 |         7 |         6 | 2021-01-02
  1 |         6 |         6 | 2021-01-01
  2 |         1 |         6 | 2021-01-10
  3 |         6 |         6 | 2021-01-15
  4 |         6 |         6 | 2021-01-29
(5 rows)

-- select dayofweek and as
--Testcase 3338:
SELECT dayofweek(c2) as dayofweek1, dayofweek('2021-01-01'::date) as dayofweek2 FROM time_tbl;
 dayofweek1 | dayofweek2 
------------+------------
          7 |          6
          6 |          6
          1 |          6
          6 |          6
          6 |          6
(5 rows)

-- DAYOFMONTH()
-- select dayofmonth (stub function, explain)
--Testcase 3339:
EXPLAIN VERBOSE
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=8)
   Output: (dayofmonth(c2)), (dayofmonth('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofmonth(c2), public.dayofmonth('2021-01-01'::date) FROM public.time_tblmysql
(4 rows)

-- select dayofmonth (stub function, result)
--Testcase 3340:
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl;
 dayofmonth | dayofmonth 
------------+------------
          2 |          1
          1 |          1
         10 |          1
         15 |          1
         29 |          1
(5 rows)

-- select dayofmonth (stub function, not pushdown constraints, explain)
--Testcase 3341:
EXPLAIN VERBOSE
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl WHERE to_hex(id) = '1';
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.69 rows=17 width=8)
   Output: (dayofmonth(c2)), (dayofmonth('2021-01-01'::date))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofmonth(c2), public.dayofmonth('2021-01-01'::date), id FROM public.time_tblmysql
(5 rows)

-- select dayofmonth (stub function, not pushdown constraints, result)
--Testcase 3342:
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl WHERE to_hex(id) = '1';
 dayofmonth | dayofmonth 
------------+------------
          1 |          1
(1 row)

-- select dayofmonth (stub function, pushdown constraints, explain)
--Testcase 3343:
EXPLAIN VERBOSE
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl WHERE id != 200;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.58 rows=3396 width=8)
   Output: (dayofmonth(c2)), (dayofmonth('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofmonth(c2), public.dayofmonth('2021-01-01'::date) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select dayofmonth (stub function, pushdown constraints, result)
--Testcase 3344:
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl WHERE id != 200;
 dayofmonth | dayofmonth 
------------+------------
          2 |          1
          1 |          1
         10 |          1
         15 |          1
         29 |          1
(5 rows)

-- select dayofmonth (stub function, dayofmonth in constraints, explain)
--Testcase 3345:
EXPLAIN VERBOSE
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl WHERE dayofmonth(c2) != dayofmonth('2000-01-01'::date);
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3625.08 rows=3396 width=8)
   Output: (dayofmonth(c2)), (dayofmonth('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofmonth(c2), public.dayofmonth('2021-01-01'::date) FROM public.time_tblmysql WHERE ((public.dayofmonth(c2) <> public.dayofmonth('2000-01-01'::date)))
(4 rows)

-- select dayofmonth (stub function, dayofmonth in constraints, result)
--Testcase 3346:
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl WHERE dayofmonth(c2) != dayofmonth('2000-01-01'::date);
 dayofmonth | dayofmonth 
------------+------------
          2 |          1
         10 |          1
         15 |          1
         29 |          1
(4 rows)

-- select dayofmonth (stub function, dayofmonth in constraints, explain)
--Testcase 3347:
EXPLAIN VERBOSE
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl WHERE dayofmonth('2021-01-01 12:00:00'::date) > 0;
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1597.67 rows=1138 width=8)
   Output: (dayofmonth(c2)), (dayofmonth('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofmonth(c2), public.dayofmonth('2021-01-01'::date) FROM public.time_tblmysql WHERE ((public.dayofmonth('2021-01-01'::date) > 0))
(4 rows)

-- select dayofmonth (stub function, dayofmonth in constraints, result)
--Testcase 3348:
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl WHERE dayofmonth('2021-01-01 12:00:00'::date) > 0;
 dayofmonth | dayofmonth 
------------+------------
          2 |          1
          1 |          1
         10 |          1
         15 |          1
         29 |          1
(5 rows)

-- select dayofmonth with agg (pushdown, explain)
--Testcase 3349:
EXPLAIN VERBOSE
SELECT max(c2), dayofmonth(max(c2)) FROM time_tbl;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (max(c2)), (dayofmonth(max(c2)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c2), public.dayofmonth(max(c2)) FROM public.time_tblmysql
(6 rows)

-- select dayofmonth as nest function with agg (pushdown, result)
--Testcase 3350:
SELECT max(c2), dayofmonth(max(c2)) FROM time_tbl;
    max     | dayofmonth 
------------+------------
 2021-01-29 |         29
(1 row)

-- select dayofmonth with non pushdown func and explicit constant (explain)
--Testcase 3351:
EXPLAIN VERBOSE
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date), pi(), 4.1 FROM time_tbl;
                                                                       QUERY PLAN                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (dayofmonth(c2)), (dayofmonth('2021-01-01'::date)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayofmonth(c2), public.dayofmonth('2021-01-01'::date), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select dayofmonth with non pushdown func and explicit constant (result)
--Testcase 3352:
SELECT dayofmonth(c2), dayofmonth('2021-01-01'::date), pi(), 4.1 FROM time_tbl;
 dayofmonth | dayofmonth |        pi         | ?column? 
------------+------------+-------------------+----------
          2 |          1 | 3.141592653589793 |      4.1
          1 |          1 | 3.141592653589793 |      4.1
         10 |          1 | 3.141592653589793 |      4.1
         15 |          1 | 3.141592653589793 |      4.1
         29 |          1 | 3.141592653589793 |      4.1
(5 rows)

-- select dayofmonth with order by (explain)
--Testcase 3353:
EXPLAIN VERBOSE
SELECT id, dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl order by dayofmonth(c2), dayofmonth('2021-01-01'::date);
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=12)
   Output: id, (dayofmonth(c2)), (dayofmonth('2021-01-01'::date))
   Sort Key: (dayofmonth(time_tbl.c2)), (dayofmonth('2021-01-01'::date))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=12)
         Output: id, (dayofmonth(c2)), (dayofmonth('2021-01-01'::date))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.dayofmonth(c2), public.dayofmonth('2021-01-01'::date) FROM public.time_tblmysql
(7 rows)

-- select dayofmonth with order by (result)
--Testcase 3354:
SELECT id, dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl order by dayofmonth(c2), dayofmonth('2021-01-01'::date);
 id | dayofmonth | dayofmonth 
----+------------+------------
  1 |          1 |          1
  0 |          2 |          1
  2 |         10 |          1
  3 |         15 |          1
  4 |         29 |          1
(5 rows)

-- select dayofmonth with order by index (result)
--Testcase 3355:
SELECT id, dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl order by 3,2,1;
 id | dayofmonth | dayofmonth 
----+------------+------------
  1 |          1 |          1
  0 |          2 |          1
  2 |         10 |          1
  3 |         15 |          1
  4 |         29 |          1
(5 rows)

-- select dayofmonth with order by index (result)
--Testcase 3356:
SELECT id, dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl order by 1,2,3;
 id | dayofmonth | dayofmonth 
----+------------+------------
  0 |          2 |          1
  1 |          1 |          1
  2 |         10 |          1
  3 |         15 |          1
  4 |         29 |          1
(5 rows)

-- select dayofmonth with group by (explain)
--Testcase 3357:
EXPLAIN VERBOSE
SELECT max(c3), dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl group by dayofmonth(c2);
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=16)
   Output: (max(c3)), (dayofmonth(c2)), (dayofmonth('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.dayofmonth(c2), public.dayofmonth('2021-01-01'::date) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select dayofmonth with group by (result)
--Testcase 3358:
SELECT max(c3), dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl group by dayofmonth(c2);
         max         | dayofmonth | dayofmonth 
---------------------+------------+------------
 2021-01-03 12:10:30 |          2 |          1
 2021-01-04 23:12:13 |          1 |          1
 2021-01-05 11:12:12 |         10 |          1
 2021-01-06 16:00:00 |         15 |          1
 2021-01-07 00:59:59 |         29 |          1
(5 rows)

-- select dayofmonth with group by index (result)
--Testcase 3359:
SELECT id, dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl group by 3,2,1;
 id | dayofmonth | dayofmonth 
----+------------+------------
  0 |          2 |          1
  1 |          1 |          1
  2 |         10 |          1
  3 |         15 |          1
  4 |         29 |          1
(5 rows)

-- select dayofmonth with group by index (result)
--Testcase 3360:
SELECT id, dayofmonth(c2), dayofmonth('2021-01-01'::date) FROM time_tbl group by 1,2,3;
 id | dayofmonth | dayofmonth 
----+------------+------------
  0 |          2 |          1
  1 |          1 |          1
  2 |         10 |          1
  3 |         15 |          1
  4 |         29 |          1
(5 rows)

-- select dayofmonth with group by index having (result)
--Testcase 3361:
SELECT id, dayofmonth(c2), dayofmonth('2021-01-01'::date), c2 FROM time_tbl group by 4, 3, 2, 1 HAVING dayofmonth(c2) > 0;
 id | dayofmonth | dayofmonth |     c2     
----+------------+------------+------------
  0 |          2 |          1 | 2021-01-02
  1 |          1 |          1 | 2021-01-01
  2 |         10 |          1 | 2021-01-10
  3 |         15 |          1 | 2021-01-15
  4 |         29 |          1 | 2021-01-29
(5 rows)

-- select dayofmonth with group by index having (result)
--Testcase 3362:
SELECT id, dayofmonth(c2), dayofmonth('2021-01-01'::date), c2 FROM time_tbl group by 1, 2, 3, 4 HAVING dayofmonth(c2) > 0;
 id | dayofmonth | dayofmonth |     c2     
----+------------+------------+------------
  0 |          2 |          1 | 2021-01-02
  1 |          1 |          1 | 2021-01-01
  2 |         10 |          1 | 2021-01-10
  3 |         15 |          1 | 2021-01-15
  4 |         29 |          1 | 2021-01-29
(5 rows)

-- select dayofmonth and as
--Testcase 3363:
SELECT dayofmonth(c2) as dayofmonth1, dayofmonth('2021-01-01'::date) as dayofmonth2 FROM time_tbl;
 dayofmonth1 | dayofmonth2 
-------------+-------------
           2 |           1
           1 |           1
          10 |           1
          15 |           1
          29 |           1
(5 rows)

-- DAYNAME()
-- select dayname (stub function, explain)
--Testcase 3364:
EXPLAIN VERBOSE
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=64)
   Output: (dayname(c2)), (dayname('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayname(c2), public.dayname('2021-01-01'::date) FROM public.time_tblmysql
(4 rows)

-- select dayname (stub function, result)
--Testcase 3365:
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl;
 dayname  | dayname 
----------+---------
 Saturday | Friday
 Friday   | Friday
 Sunday   | Friday
 Friday   | Friday
 Friday   | Friday
(5 rows)

-- select dayname (stub function, not pushdown constraints, explain)
--Testcase 3366:
EXPLAIN VERBOSE
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl WHERE to_hex(id) = '1';
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..237.69 rows=17 width=64)
   Output: (dayname(c2)), (dayname('2021-01-01'::date))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayname(c2), public.dayname('2021-01-01'::date), id FROM public.time_tblmysql
(5 rows)

-- select dayname (stub function, not pushdown constraints, result)
--Testcase 3367:
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl WHERE to_hex(id) = '1';
 dayname | dayname 
---------+---------
 Friday  | Friday
(1 row)

-- select dayname (stub function, pushdown constraints, explain)
--Testcase 3368:
EXPLAIN VERBOSE
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl WHERE id != 200;
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.58 rows=3396 width=64)
   Output: (dayname(c2)), (dayname('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayname(c2), public.dayname('2021-01-01'::date) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select dayname (stub function, pushdown constraints, result)
--Testcase 3369:
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl WHERE id != 200;
 dayname  | dayname 
----------+---------
 Saturday | Friday
 Friday   | Friday
 Sunday   | Friday
 Friday   | Friday
 Friday   | Friday
(5 rows)

-- select dayname (stub function, dayname in constraints, explain)
--Testcase 3370:
EXPLAIN VERBOSE
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl WHERE dayname(c2) != dayname('2000-01-01'::date);
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3625.08 rows=3396 width=64)
   Output: (dayname(c2)), (dayname('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayname(c2), public.dayname('2021-01-01'::date) FROM public.time_tblmysql WHERE ((public.dayname(c2) <> public.dayname('2000-01-01'::date)))
(4 rows)

-- select dayname (stub function, dayname in constraints, result)
--Testcase 3371:
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl WHERE dayname(c2) != dayname('2000-01-01'::date);
 dayname | dayname 
---------+---------
 Friday  | Friday
 Sunday  | Friday
 Friday  | Friday
 Friday  | Friday
(4 rows)

-- select dayname (stub function, dayname in constraints, explain)
--Testcase 3372:
EXPLAIN VERBOSE
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl WHERE dayname('2021-01-01 12:00:00'::date) = 'Friday';
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1014.75 rows=17 width=64)
   Output: (dayname(c2)), (dayname('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayname(c2), public.dayname('2021-01-01'::date) FROM public.time_tblmysql WHERE ((public.dayname('2021-01-01'::date) = 'Friday'::text))
(4 rows)

-- select dayname (stub function, dayname in constraints, result)
--Testcase 3373:
SELECT dayname(c2), dayname('2021-01-01'::date) FROM time_tbl WHERE dayname('2021-01-01 12:00:00'::date) > 'Friday';
 dayname | dayname 
---------+---------
(0 rows)

-- select dayname with agg (pushdown, explain)
--Testcase 3374:
EXPLAIN VERBOSE
SELECT max(c2), dayname(max(c2)) FROM time_tbl;
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=36)
   Output: (max(c2)), (dayname(max(c2)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c2), public.dayname(max(c2)) FROM public.time_tblmysql
(6 rows)

-- select dayname as nest function with agg (pushdown, result)
--Testcase 3375:
SELECT max(c2), dayname(max(c2)) FROM time_tbl;
    max     | dayname 
------------+---------
 2021-01-29 | Friday
(1 row)

-- select dayname with non pushdown func and explicit constant (explain)
--Testcase 3376:
EXPLAIN VERBOSE
SELECT dayname(c2), dayname('2021-01-01'::date), pi(), 4.1 FROM time_tbl;
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=104)
   Output: (dayname(c2)), (dayname('2021-01-01'::date)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.dayname(c2), public.dayname('2021-01-01'::date), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select dayname with non pushdown func and explicit constant (result)
--Testcase 3377:
SELECT dayname(c2), dayname('2021-01-01'::date), pi(), 4.1 FROM time_tbl;
 dayname  | dayname |        pi         | ?column? 
----------+---------+-------------------+----------
 Saturday | Friday  | 3.141592653589793 |      4.1
 Friday   | Friday  | 3.141592653589793 |      4.1
 Sunday   | Friday  | 3.141592653589793 |      4.1
 Friday   | Friday  | 3.141592653589793 |      4.1
 Friday   | Friday  | 3.141592653589793 |      4.1
(5 rows)

-- select dayname with order by (explain)
--Testcase 3378:
EXPLAIN VERBOSE
SELECT id, dayname(c2), dayname('2021-01-01'::date) FROM time_tbl order by dayname(c2), dayname('2021-01-01'::date);
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=68)
   Output: id, (dayname(c2)), (dayname('2021-01-01'::date))
   Sort Key: (dayname(time_tbl.c2)), (dayname('2021-01-01'::date))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..1918.89 rows=3413 width=68)
         Output: id, (dayname(c2)), (dayname('2021-01-01'::date))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.dayname(c2), public.dayname('2021-01-01'::date) FROM public.time_tblmysql
(7 rows)

-- select dayname with order by (result)
--Testcase 3379:
SELECT id, dayname(c2), dayname('2021-01-01'::date) FROM time_tbl order by dayname(c2), dayname('2021-01-01'::date);
 id | dayname  | dayname 
----+----------+---------
  1 | Friday   | Friday
  3 | Friday   | Friday
  4 | Friday   | Friday
  0 | Saturday | Friday
  2 | Sunday   | Friday
(5 rows)

-- select dayname with order by index (result)
--Testcase 3380:
SELECT id, dayname(c2), dayname('2021-01-01'::date) FROM time_tbl order by 3,2,1;
 id | dayname  | dayname 
----+----------+---------
  1 | Friday   | Friday
  3 | Friday   | Friday
  4 | Friday   | Friday
  0 | Saturday | Friday
  2 | Sunday   | Friday
(5 rows)

-- select dayname with order by index (result)
--Testcase 3381:
SELECT id, dayname(c2), dayname('2021-01-01'::date) FROM time_tbl order by 1,2,3;
 id | dayname  | dayname 
----+----------+---------
  0 | Saturday | Friday
  1 | Friday   | Friday
  2 | Sunday   | Friday
  3 | Friday   | Friday
  4 | Friday   | Friday
(5 rows)

-- select dayname with group by (explain)
--Testcase 3382:
EXPLAIN VERBOSE
SELECT max(c3), dayname(c2), dayname('2021-01-01'::date) FROM time_tbl group by dayname(c2);
                                                         QUERY PLAN                                                          
-----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=72)
   Output: (max(c3)), (dayname(c2)), (dayname('2021-01-01'::date))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.dayname(c2), public.dayname('2021-01-01'::date) FROM public.time_tblmysql GROUP BY 2
(6 rows)

-- select dayname with group by (result)
--Testcase 3383:
SELECT max(c3), dayname(c2), dayname('2021-01-01'::date) FROM time_tbl group by dayname(c2);
         max         | dayname  | dayname 
---------------------+----------+---------
 2021-01-03 12:10:30 | Saturday | Friday
 2021-01-07 00:59:59 | Friday   | Friday
 2021-01-05 11:12:12 | Sunday   | Friday
(3 rows)

-- select dayname with group by index (result)
--Testcase 3384:
SELECT id, dayname(c2), dayname('2021-01-01'::date) FROM time_tbl group by 3,2,1;
 id | dayname  | dayname 
----+----------+---------
  0 | Saturday | Friday
  1 | Friday   | Friday
  2 | Sunday   | Friday
  3 | Friday   | Friday
  4 | Friday   | Friday
(5 rows)

-- select dayname with group by index (result)
--Testcase 3385:
SELECT id, dayname(c2), dayname('2021-01-01'::date) FROM time_tbl group by 1,2,3;
 id | dayname  | dayname 
----+----------+---------
  0 | Saturday | Friday
  1 | Friday   | Friday
  2 | Sunday   | Friday
  3 | Friday   | Friday
  4 | Friday   | Friday
(5 rows)

-- select dayname with group by index having (result)
--Testcase 3386:
SELECT id, dayname(c2), dayname('2021-01-01'::date), c2 FROM time_tbl group by 4, 3, 2, 1 HAVING dayname(c2) = 'Friday';
 id | dayname | dayname |     c2     
----+---------+---------+------------
  1 | Friday  | Friday  | 2021-01-01
  3 | Friday  | Friday  | 2021-01-15
  4 | Friday  | Friday  | 2021-01-29
(3 rows)

-- select dayname with group by index having (result)
--Testcase 3387:
SELECT id, dayname(c2), dayname('2021-01-01'::date), c2 FROM time_tbl group by 1, 2, 3, 4 HAVING dayname(c2) > 'Friday';
 id | dayname  | dayname |     c2     
----+----------+---------+------------
  0 | Saturday | Friday  | 2021-01-02
  2 | Sunday   | Friday  | 2021-01-10
(2 rows)

-- select dayname and as
--Testcase 3388:
SELECT dayname(c2) as dayname1, dayname('2021-01-01'::date) as dayname2 FROM time_tbl;
 dayname1 | dayname2 
----------+----------
 Saturday | Friday
 Friday   | Friday
 Sunday   | Friday
 Friday   | Friday
 Friday   | Friday
(5 rows)

-- DAY()
-- select day (stub function, explain)
--Testcase 3389:
EXPLAIN VERBOSE
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl;
                                                                                                   QUERY PLAN                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3633.92 rows=3413 width=16)
   Output: (day((c2)::timestamp without time zone)), (day(c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.day(c2), public.day(c3), public.day('2021-01-01 00:00:00'::timestamp without time zone), public.day('1997-01-31 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(4 rows)

-- select day (stub function, result)
--Testcase 3390:
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl;
 day | day | day | day 
-----+-----+-----+-----
   2 |   3 |   1 |  31
   1 |   4 |   1 |  31
  10 |   5 |   1 |  31
  15 |   6 |   1 |  31
  29 |   7 |   1 |  31
(5 rows)

-- select day (stub function, not pushdown constraints, explain)
--Testcase 3391:
EXPLAIN VERBOSE
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..246.24 rows=17 width=16)
   Output: (day((c2)::timestamp without time zone)), (day(c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
   Filter: (to_hex(time_tbl.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.day(c2), public.day(c3), public.day('2021-01-01 00:00:00'::timestamp without time zone), public.day('1997-01-31 12:00:00'::timestamp without time zone), id FROM public.time_tblmysql
(5 rows)

-- select day (stub function, not pushdown constraints, result)
--Testcase 3392:
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl WHERE to_hex(id) = '1';
 day | day | day | day 
-----+-----+-----+-----
   1 |   4 |   1 |  31
(1 row)

-- select day (stub function, pushdown constraints, explain)
--Testcase 3393:
EXPLAIN VERBOSE
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3625.07 rows=3396 width=16)
   Output: (day((c2)::timestamp without time zone)), (day(c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.day(c2), public.day(c3), public.day('2021-01-01 00:00:00'::timestamp without time zone), public.day('1997-01-31 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((id <> 200))
(4 rows)

-- select day (stub function, pushdown constraints, result)
--Testcase 3394:
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl WHERE id != 200;
 day | day | day | day 
-----+-----+-----+-----
   2 |   3 |   1 |  31
   1 |   4 |   1 |  31
  10 |   5 |   1 |  31
  15 |   6 |   1 |  31
  29 |   7 |   1 |  31
(5 rows)

-- select day (stub function, day in constraints, explain)
--Testcase 3395:
EXPLAIN VERBOSE
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl WHERE day(c2) != day('2000-01-01'::date);
                                                                                                                                                 QUERY PLAN                                                                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..5340.10 rows=3396 width=16)
   Output: (day((c2)::timestamp without time zone)), (day(c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.day(c2), public.day(c3), public.day('2021-01-01 00:00:00'::timestamp without time zone), public.day('1997-01-31 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.day(c2) <> public.day('2000-01-01 00:00:00'::timestamp without time zone)))
(4 rows)

-- select day (stub function, day in constraints, result)
--Testcase 3396:
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl WHERE day(c2) != day('2000-01-01'::date);
 day | day | day | day 
-----+-----+-----+-----
   2 |   3 |   1 |  31
  10 |   5 |   1 |  31
  15 |   6 |   1 |  31
  29 |   7 |   1 |  31
(4 rows)

-- select day (stub function, day in constraints, explain)
--Testcase 3397:
EXPLAIN VERBOSE
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl WHERE day('2021-01-01 12:00:00'::date) > 0;
                                                                                                                                          QUERY PLAN                                                                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..2169.52 rows=1138 width=16)
   Output: (day((c2)::timestamp without time zone)), (day(c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.day(c2), public.day(c3), public.day('2021-01-01 00:00:00'::timestamp without time zone), public.day('1997-01-31 12:00:00'::timestamp without time zone) FROM public.time_tblmysql WHERE ((public.day('2021-01-01 00:00:00'::timestamp without time zone) > 0))
(4 rows)

-- select day (stub function, day in constraints, result)
--Testcase 3398:
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl WHERE day('2021-01-01 12:00:00'::date) > 0;
 day | day | day | day 
-----+-----+-----+-----
   2 |   3 |   1 |  31
   1 |   4 |   1 |  31
  10 |   5 |   1 |  31
  15 |   6 |   1 |  31
  29 |   7 |   1 |  31
(5 rows)

-- select day with agg (pushdown, explain)
--Testcase 3399:
EXPLAIN VERBOSE
SELECT max(c2), day(max(c2)) FROM time_tbl;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (max(c2)), (day((max(c2))::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c2), public.day(max(c2)) FROM public.time_tblmysql
(6 rows)

-- select day as nest function with agg (pushdown, result)
--Testcase 3400:
SELECT max(c2), day(max(c2)) FROM time_tbl;
    max     | day 
------------+-----
 2021-01-29 |  29
(1 row)

-- select day with non pushdown func and explicit constant (explain)
--Testcase 3401:
EXPLAIN VERBOSE
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp), pi(), 4.1 FROM time_tbl;
                                                                                                                        QUERY PLAN                                                                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.time_tbl  (cost=100.00..3633.92 rows=3413 width=56)
   Output: (day((c2)::timestamp without time zone)), (day(c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.day(c2), public.day(c3), public.day('2021-01-01 00:00:00'::timestamp without time zone), public.day('1997-01-31 12:00:00'::timestamp without time zone), 3.141592653589793::double precision, 4.1 FROM public.time_tblmysql
(4 rows)

-- select day with non pushdown func and explicit constant (result)
--Testcase 3402:
SELECT day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp), pi(), 4.1 FROM time_tbl;
 day | day | day | day |        pi         | ?column? 
-----+-----+-----+-----+-------------------+----------
   2 |   3 |   1 |  31 | 3.141592653589793 |      4.1
   1 |   4 |   1 |  31 | 3.141592653589793 |      4.1
  10 |   5 |   1 |  31 | 3.141592653589793 |      4.1
  15 |   6 |   1 |  31 | 3.141592653589793 |      4.1
  29 |   7 |   1 |  31 | 3.141592653589793 |      4.1
(5 rows)

-- select day with order by (explain)
--Testcase 3403:
EXPLAIN VERBOSE
SELECT id, day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl order by day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp);
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=3834.21..3842.74 rows=3413 width=20)
   Output: id, (day((c2)::timestamp without time zone)), (day(c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
   Sort Key: (day((time_tbl.c2)::timestamp without time zone)), (day(time_tbl.c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
   ->  Foreign Scan on public.time_tbl  (cost=100.00..3633.92 rows=3413 width=20)
         Output: id, (day((c2)::timestamp without time zone)), (day(c3)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.day(c2), public.day(c3), public.day('2021-01-01 00:00:00'::timestamp without time zone), public.day('1997-01-31 12:00:00'::timestamp without time zone) FROM public.time_tblmysql
(7 rows)

-- select day with order by (result)
--Testcase 3404:
SELECT id, day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl order by day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp);
 id | day | day | day | day 
----+-----+-----+-----+-----
  1 |   1 |   4 |   1 |  31
  0 |   2 |   3 |   1 |  31
  2 |  10 |   5 |   1 |  31
  3 |  15 |   6 |   1 |  31
  4 |  29 |   7 |   1 |  31
(5 rows)

-- select day with order by index (result)
--Testcase 3405:
SELECT id, day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl order by 5,4,3,2,1;
 id | day | day | day | day 
----+-----+-----+-----+-----
  0 |   2 |   3 |   1 |  31
  1 |   1 |   4 |   1 |  31
  2 |  10 |   5 |   1 |  31
  3 |  15 |   6 |   1 |  31
  4 |  29 |   7 |   1 |  31
(5 rows)

-- select day with order by index (result)
--Testcase 3406:
SELECT id, day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl order by 1,2,3,4,5;
 id | day | day | day | day 
----+-----+-----+-----+-----
  0 |   2 |   3 |   1 |  31
  1 |   1 |   4 |   1 |  31
  2 |  10 |   5 |   1 |  31
  3 |  15 |   6 |   1 |  31
  4 |  29 |   7 |   1 |  31
(5 rows)

-- select day with group by (explain)
--Testcase 3407:
EXPLAIN VERBOSE
SELECT max(c3), day(c2), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl group by day(c2), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp);
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=20)
   Output: (max(c3)), (day((c2)::timestamp without time zone)), (day('2021-01-01 00:00:00'::timestamp without time zone)), (day('1997-01-31 12:00:00'::timestamp without time zone))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.time_tbl)
     Remote SQL: SELECT max(c3), public.day(c2), public.day('2021-01-01 00:00:00'::timestamp without time zone), public.day('1997-01-31 12:00:00'::timestamp without time zone) FROM public.time_tblmysql GROUP BY 2, 3, 4
(6 rows)

-- select day with group by (result)
--Testcase 3408:
SELECT max(c3), day(c2), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl group by day(c2);
         max         | day | day | day 
---------------------+-----+-----+-----
 2021-01-03 12:10:30 |   2 |   1 |  31
 2021-01-04 23:12:13 |   1 |   1 |  31
 2021-01-05 11:12:12 |  10 |   1 |  31
 2021-01-06 16:00:00 |  15 |   1 |  31
 2021-01-07 00:59:59 |  29 |   1 |  31
(5 rows)

-- select day with group by index (result)
--Testcase 3409:
SELECT id, day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl group by 5,4,3,2,1;
 id | day | day | day | day 
----+-----+-----+-----+-----
  0 |   2 |   3 |   1 |  31
  1 |   1 |   4 |   1 |  31
  2 |  10 |   5 |   1 |  31
  3 |  15 |   6 |   1 |  31
  4 |  29 |   7 |   1 |  31
(5 rows)

-- select day with group by index (result)
--Testcase 3410:
SELECT id, day(c2), day(c3), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp) FROM time_tbl group by 1,2,3,4,5;
 id | day | day | day | day 
----+-----+-----+-----+-----
  0 |   2 |   3 |   1 |  31
  1 |   1 |   4 |   1 |  31
  2 |  10 |   5 |   1 |  31
  3 |  15 |   6 |   1 |  31
  4 |  29 |   7 |   1 |  31
(5 rows)

-- select day with group by index having (result)
--Testcase 3411:
SELECT id, day(c2), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp), c2 FROM time_tbl group by 5,4,3,2,1 HAVING day(c2) > 0;
 id | day | day | day |     c2     
----+-----+-----+-----+------------
  0 |   2 |   1 |  31 | 2021-01-02
  1 |   1 |   1 |  31 | 2021-01-01
  2 |  10 |   1 |  31 | 2021-01-10
  3 |  15 |   1 |  31 | 2021-01-15
  4 |  29 |   1 |  31 | 2021-01-29
(5 rows)

-- select day with group by index having (result)
--Testcase 3412:
SELECT id, day(c2), day('2021-01-01'::date), day('1997-01-31 12:00:00'::timestamp), c2 FROM time_tbl group by 1,2,3,4,5 HAVING day(c2) > 0;
 id | day | day | day |     c2     
----+-----+-----+-----+------------
  0 |   2 |   1 |  31 | 2021-01-02
  1 |   1 |   1 |  31 | 2021-01-01
  2 |  10 |   1 |  31 | 2021-01-10
  3 |  15 |   1 |  31 | 2021-01-15
  4 |  29 |   1 |  31 | 2021-01-29
(5 rows)

-- select day and as
--Testcase 3413:
SELECT day(c2) as day1, day(c3) as day2, day('2021-01-01'::date) as day3, day('1997-01-31 12:00:00'::timestamp) as day4 FROM time_tbl;
 day1 | day2 | day3 | day4 
------+------+------+------
    2 |    3 |    1 |   31
    1 |    4 |    1 |   31
   10 |    5 |    1 |   31
   15 |    6 |    1 |   31
   29 |    7 |    1 |   31
(5 rows)

-- ============================================================================
-- Stub aggregate function for mysql fdw
-- ============================================================================
--Testcase 3414:
CREATE FOREIGN TABLE s7a (id int, tag1 text, value1 float, value2 int, value3 float, value4 int, value5 bit, str1 text, str2 text, __spd_url text) SERVER pgspider_core_svr;
--Testcase 3415:
CREATE FOREIGN TABLE s7a__pgspider_svr__0 (id int, tag1 text, value1 float, value2 int, value3 float, value4 int, value5 bit varying (16), str1 text, str2 text, __spd_url text) SERVER pgspider_svr OPTIONS (table_name 's7amysql');
--Testcase 3416:
SELECT * FROM s7a;
 id | tag1 | value1 | value2 | value3 | value4 |      value5      |   str1    |   str2    |        __spd_url         
----+------+--------+--------+--------+--------+------------------+-----------+-----------+--------------------------
  0 | a    |    0.1 |    100 |   -0.1 |   -100 | 1001000110100    | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  1 | a    |    0.2 |    100 |   -0.2 |   -101 | 1111111100110100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  2 | a    |    0.3 |    100 |   -0.3 |   -102 |                  | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  3 | b    |    1.1 |    200 |   -1.1 |   -200 | 1111101000110100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  4 | b    |    2.2 |    200 |   -2.2 |   -210 | 1100110100110100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
  5 | b    |    3.3 |    200 |   -3.3 |   -220 | 1010101100110100 | ---XYZ--- |    XYZ    | /pgspider_svr/mysql_svr/
(6 rows)

-- ===================================================================
-- test BIT_XOR()
-- ===================================================================
-- select bit_xor (explain)
--Testcase 3417:
EXPLAIN VERBOSE
SELECT bit_xor(id), bit_xor(tag1), bit_xor(value1), bit_xor(value2), bit_xor(value3), bit_xor(value4), bit_xor(value5), bit_xor(str1) FROM s7a;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=256)
   Output: (bit_xor(id)), (bit_xor(tag1)), (bit_xor(value1)), (bit_xor(value2)), (bit_xor(value3)), (bit_xor(value4)), (bit_xor(value5)), (bit_xor(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.bit_xor(id), public.bit_xor(tag1), public.bit_xor(value1), public.bit_xor(value2), public.bit_xor(value3), public.bit_xor(value4), public.bit_xor(value5), public.bit_xor(str1) FROM public.s7amysql
(6 rows)

-- select bit_xor (result)
--Testcase 3418:
SELECT bit_xor(id), bit_xor(tag1), bit_xor(value1), bit_xor(value2), bit_xor(value3), bit_xor(value4), bit_xor(value5), bit_xor(str1) FROM s7a;
 bit_xor | bit_xor | bit_xor | bit_xor |       bit_xor        | bit_xor | bit_xor | bit_xor 
---------+---------+---------+---------+----------------------+---------+---------+---------
       1 |       0 |       0 |     172 | 18446744073709551612 |     175 |   28980 |       0
(1 row)

-- select bit_xor with group by (explain)
--Testcase 3419:
EXPLAIN VERBOSE
SELECT tag1, bit_xor(value5) FROM s7a GROUP BY tag1;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=64)
   Output: tag1, (bit_xor(value5))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT tag1, public.bit_xor(value5) FROM public.s7amysql GROUP BY 1
(6 rows)

-- select bit_xor with group by (result)
--Testcase 3420:
SELECT tag1, bit_xor(value5) FROM s7a GROUP BY tag1;
 tag1 | bit_xor 
------+---------
 a    |   60672
 b    |   39988
(2 rows)

-- select bit_xor with group by having (explain)
--Testcase 3421:
EXPLAIN VERBOSE
SELECT id, bit_xor(value5) FROM s7a GROUP BY id, str1 HAVING bit_xor(value5) > 0;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=68)
   Output: id, (bit_xor(value5)), str1
   Filter: ((bit_xor(s7a.value5)) > '0'::numeric)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.bit_xor(value5), str1 FROM public.s7amysql GROUP BY 1, 3
(7 rows)

-- select bit_xor with group by having (result)
--Testcase 3422:
SELECT id, bit_xor(value5) FROM s7a GROUP BY id, str1 HAVING bit_xor(value5) > 0;
 id | bit_xor 
----+---------
  0 |    4660
  1 |   65332
  3 |   64052
  4 |   52532
  5 |   43828
(5 rows)

-- ===================================================================
-- test GROUP_CONCAT()
-- ===================================================================
-- select group_concat (explain)
--Testcase 3423:
EXPLAIN VERBOSE
SELECT group_concat(id), group_concat(tag1), group_concat(value1), group_concat(value2), group_concat(value3), group_concat(str2) FROM s7a;
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=192)
   Output: (group_concat(id)), (group_concat(tag1)), (group_concat(value1)), (group_concat(value2)), (group_concat(value3)), (group_concat(str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(id), public.group_concat(tag1), public.group_concat(value1), public.group_concat(value2), public.group_concat(value3), public.group_concat(str2) FROM public.s7amysql
(6 rows)

-- select group_concat (result)
--Testcase 3424:
SELECT group_concat(id), group_concat(tag1), group_concat(value1), group_concat(value2), group_concat(value3), group_concat(str2) FROM s7a;
 group_concat | group_concat |      group_concat       |      group_concat       |         group_concat          |                        group_concat                         
--------------+--------------+-------------------------+-------------------------+-------------------------------+-------------------------------------------------------------
 0,1,2,3,4,5  | a,a,a,b,b,b  | 0.1,0.2,0.3,1.1,2.2,3.3 | 100,100,100,200,200,200 | -0.1,-0.2,-0.3,-1.1,-2.2,-3.3 |    XYZ   ,   XYZ   ,   XYZ   ,   XYZ   ,   XYZ   ,   XYZ   
(1 row)

-- select group_concat (explain)
--Testcase 3425:
EXPLAIN VERBOSE
SELECT group_concat(value1 + 1) FROM s7a;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (group_concat((value1 + '1'::double precision)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat((value1 + 1::double precision)) FROM public.s7amysql
(6 rows)

-- select group_concat with group by (result)
--Testcase 3426:
SELECT group_concat(value1 + 1) FROM s7a;
                                                 group_concat                                                  
---------------------------------------------------------------------------------------------------------------
 1.1000000014901161,1.2000000029802322,1.300000011920929,2.100000023841858,3.200000047683716,4.299999952316284
(1 row)

-- select group_concat with stub function (explain)
--Testcase 3427:
EXPLAIN VERBOSE
SELECT tag1, group_concat(sqrt(value1)) FROM s7a GROUP BY tag1;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=64)
   Output: tag1, (group_concat(sqrt(value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT tag1, public.group_concat(sqrt(value1)) FROM public.s7amysql GROUP BY 1
(6 rows)

-- select group_concat with stub function (result)
--Testcase 3428:
SELECT tag1, group_concat(sqrt(value1)) FROM s7a GROUP BY tag1;
 tag1 |                       group_concat                       
------+----------------------------------------------------------
 a    | 0.3162277683729184,0.4472135988319589,0.5477225683874355
 b    | 1.0488088595363112,1.4832397134933097,1.8165901993339841
(2 rows)

-- select group_concat with group by (explain)
--Testcase 3429:
EXPLAIN VERBOSE
SELECT id, group_concat(value3) FROM s7a GROUP BY 1;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=36)
   Output: id, (group_concat(value3))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.group_concat(value3) FROM public.s7amysql GROUP BY 1
(6 rows)

-- select group_concat with group by(explain)
--Testcase 3430:
SELECT id, group_concat(value3) FROM s7a GROUP BY 1;
 id | group_concat 
----+--------------
  0 | -0.1
  1 | -0.2
  2 | -0.3
  3 | -1.1
  4 | -2.2
  5 | -3.3
(6 rows)

-- select group_concat with group by having (explain)
--Testcase 3431:
EXPLAIN VERBOSE
SELECT id, group_concat(value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(value3) IS NOT NULL;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: id, (group_concat(value3)), value1
   Filter: ((group_concat(s7a.value3)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.group_concat(value3), value1 FROM public.s7amysql GROUP BY 1, 3
(7 rows)

-- select group_concat with group by having (result)
--Testcase 3432:
SELECT id, group_concat(value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(value3) IS NOT NULL;
 id | group_concat 
----+--------------
  0 | -0.1
  1 | -0.2
  2 | -0.3
  3 | -1.1
  4 | -2.2
  5 | -3.3
(6 rows)

-- select group_concat with group by having (explain)
--Testcase 3433:
EXPLAIN VERBOSE
SELECT id, group_concat(value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(value3 + 1) IS NOT NULL;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: id, (group_concat(value3)), value1
   Filter: ((group_concat((s7a.value3 + '1'::double precision))) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.group_concat(value3), value1, public.group_concat((value3 + 1::double precision)) FROM public.s7amysql GROUP BY 1, 3
(7 rows)

-- select group_concat with group by having (result)
--Testcase 3434:
SELECT id, group_concat(value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(value3 + 1) IS NOT NULL;
 id | group_concat 
----+--------------
  0 | -0.1
  1 | -0.2
  2 | -0.3
  3 | -1.1
  4 | -2.2
  5 | -3.3
(6 rows)

-- select group_concat with group by having (explain)
--Testcase 3435:
EXPLAIN VERBOSE
SELECT id, group_concat(value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(abs(value3)) IS NOT NULL;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: id, (group_concat(value3)), value1
   Filter: ((group_concat(abs(s7a.value3))) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.group_concat(value3), value1, public.group_concat(abs(value3)) FROM public.s7amysql GROUP BY 1, 3
(7 rows)

-- select group_concat with group by having (result)
--Testcase 3436:
SELECT id, group_concat(value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(abs(value3)) IS NOT NULL;
 id | group_concat 
----+--------------
  0 | -0.1
  1 | -0.2
  2 | -0.3
  3 | -1.1
  4 | -2.2
  5 | -3.3
(6 rows)

-- select group_concat with multiple argument by ROW() expression.
--Testcase 3437:
EXPLAIN VERBOSE
SELECT group_concat((id, tag1, value2, str1, value5)) FROM s7a;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (group_concat(ROW(id, tag1, value2, str1, value5)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(ROW(id, tag1, value2, str1, value5)) FROM public.s7amysql
(6 rows)

--Testcase 3438:
SELECT group_concat((id, tag1, value2, str1, value5)) FROM s7a;
                                    group_concat                                     
-------------------------------------------------------------------------------------
 0a100---XYZ---\x124,1a100---XYZ---4,3b200---XYZ---4,4b200---XYZ---4,5b200---XYZ---4
(1 row)

-- select group_concat with multiple argument by ROW() expression and GROUP BY
--Testcase 3439:
EXPLAIN VERBOSE
SELECT group_concat((id, tag1, value2, str1, value5)) FROM s7a GROUP BY value2;
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=36)
   Output: (group_concat(ROW(id, tag1, value2, str1, value5))), value2
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(ROW(id, tag1, value2, str1, value5)), value2 FROM public.s7amysql GROUP BY 2
(6 rows)

--Testcase 3440:
SELECT group_concat((id, tag1, value2, str1, value5)) FROM s7a GROUP BY value2;
                  group_concat                   
-------------------------------------------------
 0a100---XYZ---\x124,1a100---XYZ---4
 3b200---XYZ---4,4b200---XYZ---4,5b200---XYZ---4
(2 rows)

-- select group_concat with single argument
--Testcase 3441:
EXPLAIN VERBOSE
SELECT group_concat(value1 ORDER By value1) FROM s7a;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (group_concat(value1 ORDER BY value1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(value1 ORDER BY value1 ASC NULLS LAST) FROM public.s7amysql
(6 rows)

--Testcase 3442:
SELECT group_concat(value1 ORDER By value1) FROM s7a;
      group_concat       
-------------------------
 0.1,0.2,0.3,1.1,2.2,3.3
(1 row)

-- select group_concat with single argument and ORDER BY
--Testcase 3443:
EXPLAIN VERBOSE
SELECT group_concat(value1 ORDER By value1 ASC) FROM s7a;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (group_concat(value1 ORDER BY value1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(value1 ORDER BY value1 ASC NULLS LAST) FROM public.s7amysql
(6 rows)

--Testcase 3444:
SELECT group_concat(value1 ORDER By value1 ASC) FROM s7a;
      group_concat       
-------------------------
 0.1,0.2,0.3,1.1,2.2,3.3
(1 row)

-- select group_concat with single argument and ORDER BY
--Testcase 3445:
EXPLAIN VERBOSE
SELECT group_concat(value1 ORDER By value1 DESC) FROM s7a;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (group_concat(value1 ORDER BY value1 DESC))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(value1 ORDER BY value1 DESC NULLS FIRST) FROM public.s7amysql
(6 rows)

--Testcase 3446:
SELECT group_concat(value1 ORDER By value1 DESC) FROM s7a;
      group_concat       
-------------------------
 3.3,2.2,1.1,0.3,0.2,0.1
(1 row)

-- ===================================================================
-- test GROUP_CONCAT(DISTINCT) - PGSPIDER push down in single node only
-- ===================================================================
-- select group_concat(DISTINCT) (explain)
--Testcase 3447:
EXPLAIN VERBOSE
SELECT group_concat(DISTINCT id), group_concat(DISTINCT tag1), group_concat(DISTINCT value1), group_concat(DISTINCT value2), group_concat(DISTINCT value3), group_concat(DISTINCT value5), group_concat(DISTINCT str2) FROM s7a;
                                                                                                                                                  QUERY PLAN                                                                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=224)
   Output: (group_concat(DISTINCT id)), (group_concat(DISTINCT tag1)), (group_concat(DISTINCT value1)), (group_concat(DISTINCT value2)), (group_concat(DISTINCT value3)), (group_concat(DISTINCT value5)), (group_concat(DISTINCT str2))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(DISTINCT id), public.group_concat(DISTINCT tag1), public.group_concat(DISTINCT value1), public.group_concat(DISTINCT value2), public.group_concat(DISTINCT value3), public.group_concat(DISTINCT value5), public.group_concat(DISTINCT str2) FROM public.s7amysql
(6 rows)

-- select group_concat(DISTINCT) (result)
--Testcase 3448:
SELECT group_concat(DISTINCT id), group_concat(DISTINCT tag1), group_concat(DISTINCT value1), group_concat(DISTINCT value2), group_concat(DISTINCT value3), group_concat(DISTINCT value5), group_concat(DISTINCT str2) FROM s7a;
 group_concat | group_concat |      group_concat       | group_concat |         group_concat          |         group_concat         | group_concat 
--------------+--------------+-------------------------+--------------+-------------------------------+------------------------------+--------------
 0,1,2,3,4,5  | a,b          | 0.1,0.2,0.3,1.1,2.2,3.3 | 100,200      | -3.3,-2.2,-1.1,-0.3,-0.2,-0.1 | 4660,43828,52532,64052,65332 |    XYZ   
(1 row)

-- select group_concat(DISTINCT) (explain)
--Testcase 3449:
EXPLAIN VERBOSE
SELECT group_concat(DISTINCT (value1 + 1)) FROM s7a;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (group_concat(DISTINCT (value1 + '1'::double precision)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(DISTINCT (value1 + 1::double precision)) FROM public.s7amysql
(6 rows)

-- select group_concat(DISTINCT) (result)
--Testcase 3450:
SELECT group_concat(DISTINCT (value1 + 1)) FROM s7a;
                                                 group_concat                                                  
---------------------------------------------------------------------------------------------------------------
 1.1000000014901161,1.2000000029802322,1.300000011920929,2.100000023841858,3.200000047683716,4.299999952316284
(1 row)

-- select group_concat(DISTINCT) with group by (explain)
--Testcase 3451:
EXPLAIN VERBOSE
SELECT value2, group_concat(DISTINCT value3) FROM s7a GROUP BY value2;
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=36)
   Output: value2, (group_concat(DISTINCT value3))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT value2, public.group_concat(DISTINCT value3) FROM public.s7amysql GROUP BY 1
(6 rows)

-- select group_concat(DISTINCT) with group by (result)
--Testcase 3452:
SELECT value2, group_concat(DISTINCT value3) FROM s7a GROUP BY value2;
 value2 |  group_concat  
--------+----------------
    100 | -0.3,-0.2,-0.1
    200 | -3.3,-2.2,-1.1
(2 rows)

-- select group_concat(DISTINCT) multiple argument (T_Row expr)
--Testcase 3453:
EXPLAIN VERBOSE
SELECT group_concat(DISTINCT (id, tag1, value2, str1, value5)) FROM s7a;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (group_concat(DISTINCT ROW(id, tag1, value2, str1, value5)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(DISTINCT ROW(id, tag1, value2, str1, value5)) FROM public.s7amysql
(6 rows)

--Testcase 3454:
SELECT group_concat(DISTINCT (id, tag1, value2, str1, value5)) FROM s7a;
                                            group_concat                                            
----------------------------------------------------------------------------------------------------
 0a100---XYZ---4660,1a100---XYZ---65332,3b200---XYZ---64052,4b200---XYZ---52532,5b200---XYZ---43828
(1 row)

-- select group_concat(DISTINCT) multiple argument (T_Row expr)
--Testcase 3455:
EXPLAIN VERBOSE
SELECT group_concat(DISTINCT (tag1, value2)) FROM s7a;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=32)
   Output: (group_concat(DISTINCT ROW(tag1, value2)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.group_concat(DISTINCT ROW(tag1, value2)) FROM public.s7amysql
(6 rows)

--Testcase 3456:
SELECT group_concat(DISTINCT (tag1, value2)) FROM s7a;
 group_concat 
--------------
 a100,b200
(1 row)

-- select group_concat(DISTINCT) multiple argument with group by (result)
--Testcase 3457:
EXPLAIN VERBOSE
SELECT value2, group_concat(DISTINCT (tag1, value3, value2)) FROM s7a GROUP BY value2;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=36)
   Output: value2, (group_concat(DISTINCT ROW(tag1, value3, value2)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT value2, public.group_concat(DISTINCT ROW(tag1, value3, value2)) FROM public.s7amysql GROUP BY 1
(6 rows)

--Testcase 3458:
SELECT value2, group_concat(DISTINCT (tag1, value3, value2)) FROM s7a GROUP BY value2;
 value2 |        group_concat        
--------+----------------------------
    100 | a-0.3100,a-0.2100,a-0.1100
    200 | b-3.3200,b-2.2200,b-1.1200
(2 rows)

-- select group_concat(DISTINCT) with stub function (explain)
--Testcase 3459:
EXPLAIN VERBOSE
SELECT id, group_concat(DISTINCT sqrt(value1)) FROM s7a GROUP BY id;
                                              QUERY PLAN                                               
-------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=36)
   Output: id, (group_concat(DISTINCT sqrt(value1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.group_concat(DISTINCT sqrt(value1)) FROM public.s7amysql GROUP BY 1
(6 rows)

-- select group_concat(DISTINCT) with stub function (result)
--Testcase 3460:
SELECT id, group_concat(DISTINCT sqrt(value1)) FROM s7a GROUP BY id;
 id |    group_concat    
----+--------------------
  0 | 0.3162277683729184
  1 | 0.4472135988319589
  2 | 0.5477225683874355
  3 | 1.0488088595363112
  4 | 1.4832397134933097
  5 | 1.8165901993339841
(6 rows)

-- select group_concat(DISTINCT) with group by having (explain)
--Testcase 3461:
EXPLAIN VERBOSE
SELECT id, group_concat(DISTINCT value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(DISTINCT value3) IS NOT NULL;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: id, (group_concat(DISTINCT value3)), value1
   Filter: ((group_concat(DISTINCT s7a.value3)) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.group_concat(DISTINCT value3), value1 FROM public.s7amysql GROUP BY 1, 3
(7 rows)

-- select group_concat(DISTINCT) with group by having (result)
--Testcase 3462:
SELECT id, group_concat(DISTINCT value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(DISTINCT value3) IS NOT NULL;
 id | group_concat 
----+--------------
  0 | -0.1
  1 | -0.2
  2 | -0.3
  3 | -1.1
  4 | -2.2
  5 | -3.3
(6 rows)

-- select group_concat(DISTINCT) with group by having (explain)
--Testcase 3463:
EXPLAIN VERBOSE
SELECT id, group_concat(DISTINCT value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(DISTINCT (value3 + 1)) IS NOT NULL;
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: id, (group_concat(DISTINCT value3)), value1
   Filter: ((group_concat(DISTINCT (s7a.value3 + '1'::double precision))) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.group_concat(DISTINCT value3), value1, public.group_concat(DISTINCT (value3 + 1::double precision)) FROM public.s7amysql GROUP BY 1, 3
(7 rows)

-- select group_concat(DISTINCT) with group by having (result)
--Testcase 3464:
SELECT id, group_concat(DISTINCT value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(DISTINCT (value3 + 1)) IS NOT NULL;
 id | group_concat 
----+--------------
  0 | -0.1
  1 | -0.2
  2 | -0.3
  3 | -1.1
  4 | -2.2
  5 | -3.3
(6 rows)

-- select group_concat(DISTINCT) with group by having (explain)
--Testcase 3465:
EXPLAIN VERBOSE
SELECT id, group_concat(DISTINCT value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(DISTINCT abs(value3)) IS NOT NULL;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=44)
   Output: id, (group_concat(DISTINCT value3)), value1
   Filter: ((group_concat(DISTINCT abs(s7a.value3))) IS NOT NULL)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT id, public.group_concat(DISTINCT value3), value1, public.group_concat(DISTINCT abs(value3)) FROM public.s7amysql GROUP BY 1, 3
(7 rows)

-- select group_concat(DISTINCT) with group by having (result)
--Testcase 3466:
SELECT id, group_concat(DISTINCT value3) FROM s7a GROUP BY 1, value1 HAVING group_concat(DISTINCT abs(value3)) IS NOT NULL;
 id | group_concat 
----+--------------
  0 | -0.1
  1 | -0.2
  2 | -0.3
  3 | -1.1
  4 | -2.2
  5 | -3.3
(6 rows)

-- ===================================================================
-- test COUNT()
-- ===================================================================
-- select count(*)
--Testcase 3467:
EXPLAIN VERBOSE
SELECT COUNT(*) FROM s7a;
                      QUERY PLAN                      
------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (count(*))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT count(*) FROM public.s7amysql
(6 rows)

--Testcase 3468:
SELECT COUNT(*) FROM s7a;
 count 
-------
     6
(1 row)

-- select COUNT(expr)
--Testcase 3469:
EXPLAIN VERBOSE
SELECT COUNT(tag1) FROM s7a;
                       QUERY PLAN                        
---------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (count(tag1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT count(tag1) FROM public.s7amysql
(6 rows)

--Testcase 3470:
SELECT COUNT(tag1) FROM s7a;
 count 
-------
     6
(1 row)

-- select COUNT(expr)
--Testcase 3471:
EXPLAIN VERBOSE
SELECT COUNT(tag1) FROM s7a GROUP BY tag1;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(tag1)), tag1
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT count(tag1), tag1 FROM public.s7amysql GROUP BY 2
(6 rows)

--Testcase 3472:
SELECT COUNT(tag1) FROM s7a GROUP BY tag1;
 count 
-------
     3
     3
(2 rows)

-- select COUNT(DISTINCT expr,[expr...]) PGSPIDER do not push down this case
--Testcase 3473:
EXPLAIN VERBOSE
SELECT COUNT(DISTINCT tag1) FROM s7a;
                            QUERY PLAN                            
------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (count(DISTINCT tag1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT count(DISTINCT tag1) FROM public.s7amysql
(6 rows)

--Testcase 3474:
SELECT COUNT(DISTINCT tag1) FROM s7a GROUP BY tag1;
 count 
-------
     1
     1
(2 rows)

-- select COUNT(DISTINCT expr,[expr...]) PGSPIDER do not push down this case
--Testcase 3475:
EXPLAIN VERBOSE
SELECT COUNT(DISTINCT (id, tag1, value2, str1, value5)) FROM s7a;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (count(DISTINCT ROW(id, tag1, value2, str1, value5)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT count(DISTINCT ROW(id, tag1, value2, str1, value5)) FROM public.s7amysql
(6 rows)

--Testcase 3476:
SELECT COUNT(DISTINCT (id, tag1, value2, str1, value5)) FROM s7a;
 count 
-------
     5
(1 row)

-- select COUNT(DISTINCT expr,[expr...]) PGSPIDER do not push down this case
--Testcase 3477:
EXPLAIN VERBOSE
SELECT COUNT(DISTINCT (tag1, value2)) FROM s7a;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (count(DISTINCT ROW(tag1, value2)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT count(DISTINCT ROW(tag1, value2)) FROM public.s7amysql
(6 rows)

--Testcase 3478:
SELECT COUNT(DISTINCT (tag1, value2)) FROM s7a;
 count 
-------
     2
(1 row)

-- ===================================================================
-- test JSON_ARRAYAGG() PGSPIDER push down in single node only
-- ===================================================================
-- select json_agg (explain)
--Testcase 3479:
EXPLAIN VERBOSE
SELECT json_agg(id), json_agg(tag1), json_agg(value1), json_agg(value2), json_agg(value3), json_agg(value5), json_agg(str1) FROM s7a;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=272.13..272.14 rows=1 width=224)
   Output: json_agg(id), json_agg(tag1), json_agg(value1), json_agg(value2), json_agg(value3), json_agg(value5), json_agg(str1)
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=97)
         Output: id, tag1, value1, value2, value3, value5, str1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, tag1, value1, value2, value3, value5, str1 FROM public.s7amysql
(6 rows)

-- select json_agg (result)
--Testcase 3480:
SELECT json_agg(id), json_agg(tag1), json_agg(value1), json_agg(value2), json_agg(value3), json_agg(value5), json_agg(str1) FROM s7a;
      json_agg      |            json_agg            |            json_agg            |            json_agg            |               json_agg               |                                                json_agg                                                 |                                    json_agg                                    
--------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------------+---------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------
 [0, 1, 2, 3, 4, 5] | ["a", "a", "a", "b", "b", "b"] | [0.1, 0.2, 0.3, 1.1, 2.2, 3.3] | [100, 100, 100, 200, 200, 200] | [-0.1, -0.2, -0.3, -1.1, -2.2, -3.3] | ["1001000110100", "1111111100110100", null, "1111101000110100", "1100110100110100", "1010101100110100"] | ["---XYZ---", "---XYZ---", "---XYZ---", "---XYZ---", "---XYZ---", "---XYZ---"]
(1 row)

-- select json_agg with group by (explain)
--Testcase 3481:
EXPLAIN VERBOSE
SELECT tag1, json_agg(value3) FROM s7a GROUP BY tag1;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=229.45..231.95 rows=200 width=64)
   Output: tag1, json_agg(value3)
   Group Key: s7a.tag1
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=40)
         Output: tag1, value3
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT tag1, value3 FROM public.s7amysql
(7 rows)

-- select json_agg with group by (result)
--Testcase 3482:
SELECT tag1, json_agg(value3) FROM s7a GROUP BY tag1;
 tag1 |      json_agg      
------+--------------------
 a    | [-0.1, -0.2, -0.3]
 b    | [-1.1, -2.2, -3.3]
(2 rows)

-- select json_agg with group by (explain)
--Testcase 3483:
EXPLAIN VERBOSE
SELECT tag1, json_agg(value3 + 1) FROM s7a GROUP BY tag1;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=237.99..240.49 rows=200 width=64)
   Output: tag1, json_agg((value3 + '1'::double precision))
   Group Key: s7a.tag1
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=40)
         Output: tag1, value3
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT tag1, value3 FROM public.s7amysql
(7 rows)

-- select json_agg with group by (result)
--Testcase 3484:
SELECT tag1, json_agg(value3 + 1) FROM s7a GROUP BY tag1;
 tag1 |                     json_agg                      
------+---------------------------------------------------
 a    | [0.9, 0.8, 0.7]
 b    | [-0.10000000000000009, -1.2000000000000002, -2.3]
(2 rows)

-- select json_agg with stub function (explain)
--Testcase 3485:
EXPLAIN VERBOSE
SELECT tag1, json_agg(abs(value3)) FROM s7a GROUP BY tag1;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=237.99..240.49 rows=200 width=64)
   Output: tag1, json_agg(abs(value3))
   Group Key: s7a.tag1
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=40)
         Output: tag1, value3
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT tag1, value3 FROM public.s7amysql
(7 rows)

-- select json_agg with stub function (result)
--Testcase 3486:
SELECT tag1, json_agg(abs(value3)) FROM s7a GROUP BY tag1;
 tag1 |    json_agg     
------+-----------------
 a    | [0.1, 0.2, 0.3]
 b    | [1.1, 2.2, 3.3]
(2 rows)

-- select json_agg with group by having (explain)
--Testcase 3487:
EXPLAIN VERBOSE
SELECT tag1, json_agg(value3) FROM s7a GROUP BY 1, value1 HAVING json_agg(value3) IS NOT NULL;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=246.52..249.52 rows=199 width=72)
   Output: tag1, json_agg(value3), value1
   Group Key: s7a.tag1, s7a.value1
   Filter: (json_agg(s7a.value3) IS NOT NULL)
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=48)
         Output: tag1, value1, value3
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT tag1, value1, value3 FROM public.s7amysql
(8 rows)

-- select json_agg with group by having (result)
--Testcase 3488:
SELECT tag1, json_agg(value3) FROM s7a GROUP BY 1, value1 HAVING json_agg(value3) IS NOT NULL;
 tag1 | json_agg 
------+----------
 b    | [-3.3]
 b    | [-1.1]
 a    | [-0.3]
 b    | [-2.2]
 a    | [-0.1]
 a    | [-0.2]
(6 rows)

-- select json_agg with group by having (explain)
--Testcase 3489:
EXPLAIN VERBOSE
SELECT tag1, json_agg(value3 + 1) FROM s7a GROUP BY 1, value1 HAVING json_agg(value3 + 1) IS NOT NULL;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=263.58..266.58 rows=199 width=72)
   Output: tag1, json_agg((value3 + '1'::double precision)), value1
   Group Key: s7a.tag1, s7a.value1
   Filter: (json_agg((s7a.value3 + '1'::double precision)) IS NOT NULL)
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=48)
         Output: tag1, value1, value3
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT tag1, value1, value3 FROM public.s7amysql
(8 rows)

-- select json_agg with group by having (result)
--Testcase 3490:
SELECT tag1, json_agg(value3 + 1) FROM s7a GROUP BY 1, value1 HAVING json_agg(value3 + 1) IS NOT NULL;
 tag1 |        json_agg        
------+------------------------
 b    | [-2.3]
 b    | [-0.10000000000000009]
 a    | [0.7]
 b    | [-1.2000000000000002]
 a    | [0.9]
 a    | [0.8]
(6 rows)

-- select json_agg with group by having (explain)
--Testcase 3491:
EXPLAIN VERBOSE
SELECT tag1, json_agg(abs(value3)) FROM s7a GROUP BY 1, value1 HAVING json_agg(abs(value3)) IS NOT NULL;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=263.58..266.58 rows=199 width=72)
   Output: tag1, json_agg(abs(value3)), value1
   Group Key: s7a.tag1, s7a.value1
   Filter: (json_agg(abs(s7a.value3)) IS NOT NULL)
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=48)
         Output: tag1, value1, value3
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT tag1, value1, value3 FROM public.s7amysql
(8 rows)

-- select json_agg with group by having (result)
--Testcase 3492:
SELECT tag1, json_agg(abs(value3)) FROM s7a GROUP BY 1, value1 HAVING json_agg(abs(value3)) IS NOT NULL;
 tag1 | json_agg 
------+----------
 b    | [3.3]
 b    | [1.1]
 a    | [0.3]
 b    | [2.2]
 a    | [0.1]
 a    | [0.2]
(6 rows)

-- ===================================================================
-- test JSON_OBJECTAGG() PGSPIDER push down in single node only
-- ===================================================================
-- select json_objectagg (explain)
--Testcase 3493:
EXPLAIN VERBOSE
SELECT json_object_agg(tag1, str1), json_object_agg(id, value4) FROM s7a;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Aggregate  (cost=229.46..229.47 rows=1 width=64)
   Output: json_object_agg(tag1, str1), json_object_agg(id, value4)
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=72)
         Output: tag1, str1, id, value4
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, tag1, value4, str1 FROM public.s7amysql
(6 rows)

-- select json_objectagg (result)
--Testcase 3494:
SELECT json_object_agg(tag1, str1), json_object_agg(id, value4) FROM s7a;
                                                   json_object_agg                                                    |                              json_object_agg                               
----------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------
 { "a" : "---XYZ---", "a" : "---XYZ---", "a" : "---XYZ---", "b" : "---XYZ---", "b" : "---XYZ---", "b" : "---XYZ---" } | { "0" : -100, "1" : -101, "2" : -102, "3" : -200, "4" : -210, "5" : -220 }
(1 row)

-- select json_objectagg with group by (explain)
--Testcase 3495:
EXPLAIN VERBOSE
SELECT id, json_object_agg(tag1, str1) FROM s7a GROUP BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=229.45..231.95 rows=200 width=36)
   Output: id, json_object_agg(tag1, str1)
   Group Key: s7a.id
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=68)
         Output: id, tag1, str1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, tag1, str1 FROM public.s7amysql
(7 rows)

-- select json_objectagg with group by (result)
--Testcase 3496:
SELECT id, json_object_agg(tag1, str1) FROM s7a GROUP BY id;
 id |    json_object_agg    
----+-----------------------
  3 | { "b" : "---XYZ---" }
  5 | { "b" : "---XYZ---" }
  4 | { "b" : "---XYZ---" }
  0 | { "a" : "---XYZ---" }
  2 | { "a" : "---XYZ---" }
  1 | { "a" : "---XYZ---" }
(6 rows)

-- select json_objectagg with group by (explain)
--Testcase 3497:
EXPLAIN VERBOSE
SELECT id, json_object_agg(tag1, value2 + 1) FROM s7a GROUP BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=237.99..240.49 rows=200 width=36)
   Output: id, json_object_agg(tag1, (value2 + 1))
   Group Key: s7a.id
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=40)
         Output: id, tag1, value2
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, tag1, value2 FROM public.s7amysql
(7 rows)

-- select json_objectagg with group by (result)
--Testcase 3498:
SELECT id, json_object_agg(tag1, value2 + 1) FROM s7a GROUP BY id;
 id | json_object_agg 
----+-----------------
  3 | { "b" : 201 }
  5 | { "b" : 201 }
  4 | { "b" : 201 }
  0 | { "a" : 101 }
  2 | { "a" : 101 }
  1 | { "a" : 101 }
(6 rows)

-- select json_objectagg with stub function (explain)
--Testcase 3499:
EXPLAIN VERBOSE
SELECT id, json_object_agg(tag1, abs(value2)) FROM s7a GROUP BY id;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=237.99..240.49 rows=200 width=36)
   Output: id, json_object_agg(tag1, abs(value2))
   Group Key: s7a.id
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=40)
         Output: id, tag1, value2
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, tag1, value2 FROM public.s7amysql
(7 rows)

-- select json_objectagg with stub function (result)
--Testcase 3500:
SELECT id, json_object_agg(tag1, abs(value2)) FROM s7a GROUP BY id;
 id | json_object_agg 
----+-----------------
  3 | { "b" : 200 }
  5 | { "b" : 200 }
  4 | { "b" : 200 }
  0 | { "a" : 100 }
  2 | { "a" : 100 }
  1 | { "a" : 100 }
(6 rows)

-- select json_objectagg with group by having (explain)
--Testcase 3501:
EXPLAIN VERBOSE
SELECT id, json_object_agg(tag1, str1) FROM s7a GROUP BY 1, value1 HAVING json_object_agg(tag1, str1) IS NOT NULL;
                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 HashAggregate  (cost=246.52..249.52 rows=199 width=44)
   Output: id, json_object_agg(tag1, str1), value1
   Group Key: s7a.id, s7a.value1
   Filter: (json_object_agg(s7a.tag1, s7a.str1) IS NOT NULL)
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=76)
         Output: id, value1, tag1, str1
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, tag1, value1, str1 FROM public.s7amysql
(8 rows)

-- select json_objectagg with group by having (result)
--Testcase 3502:
SELECT id, json_object_agg(tag1, str1) FROM s7a GROUP BY 1, value1 HAVING json_object_agg(tag1, str1) IS NOT NULL;
 id |    json_object_agg    
----+-----------------------
  2 | { "a" : "---XYZ---" }
  3 | { "b" : "---XYZ---" }
  1 | { "a" : "---XYZ---" }
  5 | { "b" : "---XYZ---" }
  0 | { "a" : "---XYZ---" }
  4 | { "b" : "---XYZ---" }
(6 rows)

-- select json_objectagg with group by having (explain)
--Testcase 3503:
EXPLAIN VERBOSE
SELECT id, json_object_agg(tag1, str1) FROM s7a GROUP BY 1, value1 HAVING json_object_agg(tag1, abs(value2 + 1)) IS NOT NULL;
                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 HashAggregate  (cost=263.58..266.58 rows=199 width=44)
   Output: id, json_object_agg(tag1, str1), value1
   Group Key: s7a.id, s7a.value1
   Filter: (json_object_agg(s7a.tag1, abs((s7a.value2 + 1))) IS NOT NULL)
   ->  Foreign Scan on public.s7a  (cost=100.00..212.39 rows=3413 width=80)
         Output: id, value1, tag1, str1, value2
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, tag1, value1, value2, str1 FROM public.s7amysql
(8 rows)

-- select json_objectagg with group by having (result)
--Testcase 3504:
SELECT id, json_object_agg(tag1, str1) FROM s7a GROUP BY 1, value1 HAVING json_object_agg(tag1, abs(value2 + 1)) IS NOT NULL;
 id |    json_object_agg    
----+-----------------------
  2 | { "a" : "---XYZ---" }
  3 | { "b" : "---XYZ---" }
  1 | { "a" : "---XYZ---" }
  5 | { "b" : "---XYZ---" }
  0 | { "a" : "---XYZ---" }
  4 | { "b" : "---XYZ---" }
(6 rows)

-- ===================================================================
-- test STD()
-- ===================================================================
-- select std (explain)
--Testcase 3505:
EXPLAIN VERBOSE
SELECT std(id), std(tag1), std(value1), std(value2), std(value3), std(str1) FROM s7a;
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=48)
   Output: (std(id)), (std(tag1)), (std(value1)), (std(value2)), (std(value3)), (std(str1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT public.std(id), public.std(tag1), public.std(value1), public.std(value2), public.std(value3), public.std(str1) FROM public.s7amysql
(6 rows)

-- select std (result)
--Testcase 3506:
SELECT std(id), std(tag1), std(value1), std(value2), std(value3), std(str1) FROM s7a;
        std        | std |        std        | std |        std        | std 
-------------------+-----+-------------------+-----+-------------------+-----
 1.707825127659933 |   0 | 1.186029781781151 |  50 | 1.186029781781151 |   0
(1 row)

-- select std with group by (explain)
--Testcase 3507:
EXPLAIN VERBOSE
SELECT tag1, std(value4) FROM s7a GROUP BY tag1;
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: tag1, (std(value4))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT tag1, public.std(value4) FROM public.s7amysql GROUP BY 1
(6 rows)

-- select std with group by (result)
--Testcase 3508:
SELECT tag1, std(value4) FROM s7a GROUP BY tag1;
 tag1 |        std        
------+-------------------
 a    | 0.816496580927726
 b    |  8.16496580927726
(2 rows)

-- select std with group by (explain)
--Testcase 3509:
EXPLAIN VERBOSE
SELECT tag1, std(value4 + 1) FROM s7a GROUP BY tag1;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: tag1, (std((value4 + 1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT tag1, public.std((value4 + 1)) FROM public.s7amysql GROUP BY 1
(6 rows)

-- select std with group by (result)
--Testcase 3510:
SELECT tag1, std(value4 + 1) FROM s7a GROUP BY tag1;
 tag1 |        std        
------+-------------------
 a    | 0.816496580927726
 b    |  8.16496580927726
(2 rows)

-- select std with stub function (explain)
--Testcase 3511:
EXPLAIN VERBOSE
SELECT tag1, std(abs(value4 + 1)) FROM s7a GROUP BY tag1;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: tag1, (std(abs((value4 + 1))))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT tag1, public.std(abs((value4 + 1))) FROM public.s7amysql GROUP BY 1
(6 rows)

-- select std with stub function (result)
--Testcase 3512:
SELECT tag1, std(abs(value4 + 1)) FROM s7a GROUP BY tag1;
 tag1 |        std        
------+-------------------
 a    | 0.816496580927726
 b    |  8.16496580927726
(2 rows)

-- select std with group by having (explain)
--Testcase 3513:
EXPLAIN VERBOSE
SELECT tag1, std(value4) FROM s7a GROUP BY tag1 HAVING  std(value4) > 0;
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: tag1, (std(value4))
   Filter: ((std(s7a.value4)) > '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT tag1, public.std(value4) FROM public.s7amysql GROUP BY 1
(7 rows)

-- select std with group by having (result)
--Testcase 3514:
SELECT tag1, std(value4) FROM s7a GROUP BY tag1 HAVING  std(value4) > 0;
 tag1 |        std        
------+-------------------
 a    | 0.816496580927726
 b    |  8.16496580927726
(2 rows)

-- select std with group by having (explain)
--Testcase 3515:
EXPLAIN VERBOSE
SELECT tag1, std(value4) FROM s7a GROUP BY tag1 HAVING std(abs(value4 + 1)) = 0;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: tag1, (std(value4))
   Filter: ((std(abs((s7a.value4 + 1)))) = '0'::double precision)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s7a)
     Remote SQL: SELECT tag1, public.std(value4), public.std(abs((value4 + 1))) FROM public.s7amysql GROUP BY 1
(7 rows)

-- select std with group by having (result)
--Testcase 3516:
SELECT tag1, std(value4) FROM s7a GROUP BY tag1 HAVING std(abs(value4 + 1)) = 0;
 tag1 | std 
------+-----
(0 rows)

-- test for JSON function
--Testcase 3517:
CREATE FOREIGN TABLE s8 (id int, c1 json, c2 int, c3 text, __spd_url text) SERVER pgspider_core_svr;
--Testcase 3518:
CREATE FOREIGN TABLE s9 (id int, c1 json, __spd_url text) SERVER pgspider_core_svr;
--Testcase 3519:
CREATE FOREIGN TABLE s8__pgspider_svr__0 (id int, c1 json, c2 int, c3 text, __spd_url text) SERVER pgspider_svr OPTIONS (table_name 's8mysql');
--Testcase 3520:
CREATE FOREIGN TABLE s9__pgspider_svr__0 (id int, c1 json, __spd_url text) SERVER pgspider_svr OPTIONS (table_name 's9mysql');
--Testcase 3521:
SELECT * FROM s8__pgspider_svr__0;
 id |                            c1                             | c2 |   c3   |  __spd_url  
----+-----------------------------------------------------------+----+--------+-------------
  0 | [[1, 2], [3, 4], 5]                                       |  1 | This   | /mysql_svr/
  1 | []                                                        |  2 | is     | /mysql_svr/
  2 | {}                                                        |  3 | text   | /mysql_svr/
  3 | {"a": "10", "b": "15", "x": 25}                           |  4 | scalar | /mysql_svr/
  4 | {"a": 1, "b": 2, "c": {"d": 4}}                           |  5 | scalar | /mysql_svr/
  5 | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] |  5 | scalar | /mysql_svr/
(6 rows)

--Testcase 3522:
SELECT * FROM s8__pgspider_svr__0;
 id |                            c1                             | c2 |   c3   |  __spd_url  
----+-----------------------------------------------------------+----+--------+-------------
  0 | [[1, 2], [3, 4], 5]                                       |  1 | This   | /mysql_svr/
  1 | []                                                        |  2 | is     | /mysql_svr/
  2 | {}                                                        |  3 | text   | /mysql_svr/
  3 | {"a": "10", "b": "15", "x": 25}                           |  4 | scalar | /mysql_svr/
  4 | {"a": 1, "b": 2, "c": {"d": 4}}                           |  5 | scalar | /mysql_svr/
  5 | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] |  5 | scalar | /mysql_svr/
(6 rows)

-- select json_build_array (builtin function, explain)
--Testcase 3523:
EXPLAIN VERBOSE
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, mysql_pi()) FROM s8;
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1108.30 rows=3413 width=160)
   Output: (json_build_array(c1, c2)), (json_build_array(c1, c3)), (json_build_array(c1, 1)), (json_build_array(c1, 'a')), (json_build_array(c1, mysql_pi()))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, public.mysql_pi()) FROM public.s8mysql
(4 rows)

-- select json_build_array (builtin function, result)
--Testcase 3524:
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, mysql_pi()) FROM s8;
                        json_build_array                        |                           json_build_array                            |                        json_build_array                        |                         json_build_array                         |                                json_build_array                                
----------------------------------------------------------------+-----------------------------------------------------------------------+----------------------------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------------------
 [[[1, 2], [3, 4], 5], 1]                                       | [[[1, 2], [3, 4], 5], "This"]                                         | [[[1, 2], [3, 4], 5], 1]                                       | [[[1, 2], [3, 4], 5], "a"]                                       | [[[1, 2], [3, 4], 5], 3.141592653589793]
 [[], 2]                                                        | [[], "is"]                                                            | [[], 1]                                                        | [[], "a"]                                                        | [[], 3.141592653589793]
 [{}, 3]                                                        | [{}, "text"]                                                          | [{}, 1]                                                        | [{}, "a"]                                                        | [{}, 3.141592653589793]
 [{"a": "10", "b": "15", "x": 25}, 4]                           | [{"a": "10", "b": "15", "x": 25}, "scalar"]                           | [{"a": "10", "b": "15", "x": 25}, 1]                           | [{"a": "10", "b": "15", "x": 25}, "a"]                           | [{"a": "10", "b": "15", "x": 25}, 3.141592653589793]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 5]                           | [{"a": 1, "b": 2, "c": {"d": 4}}, "scalar"]                           | [{"a": 1, "b": 2, "c": {"d": 4}}, 1]                           | [{"a": 1, "b": 2, "c": {"d": 4}}, "a"]                           | [{"a": 1, "b": 2, "c": {"d": 4}}, 3.141592653589793]
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], 5] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "scalar"] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], 1] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "a"] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], 3.141592653589793]
(6 rows)

-- select json_build_array (builtin function, not pushdown constraints, explain)
--Testcase 3525:
EXPLAIN VERBOSE
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, NULL), json_build_array(c1, TRUE), json_build_array(c1, mysql_pi()) FROM s8 WHERE to_hex(id) = '1';
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..233.66 rows=17 width=160)
   Output: (json_build_array(c1, c2)), (json_build_array(c1, c3)), (json_build_array(c1, NULL::unknown)), (json_build_array(c1, true)), (json_build_array(c1, mysql_pi()))
   Filter: (to_hex(s8.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, NULL::unknown), json_build_array(c1, true), json_build_array(c1, public.mysql_pi()), id FROM public.s8mysql
(5 rows)

-- select json_build_array (builtin function, not pushdown constraints, result)
--Testcase 3526:
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, NULL), json_build_array(c1, TRUE), json_build_array(c1, mysql_pi()) FROM s8 WHERE to_hex(id) = '1';
 json_build_array | json_build_array | json_build_array | json_build_array |    json_build_array     
------------------+------------------+------------------+------------------+-------------------------
 [[], 2]          | [[], "is"]       | [[], null]       | [[], true]       | [[], 3.141592653589793]
(1 row)

-- select json_build_array (builtin function, pushdown constraints, explain)
--Testcase 3527:
EXPLAIN VERBOSE
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, '[true, false]'::json) FROM s8 WHERE id = 1;
                                                                                                   QUERY PLAN                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..153.21 rows=17 width=160)
   Output: (json_build_array(c1, c2)), (json_build_array(c1, c3)), (json_build_array(c1, 1)), (json_build_array(c1, 'a')), (json_build_array(c1, '[true, false]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, '[true, false]'::json) FROM public.s8mysql WHERE ((id = 1))
(4 rows)

-- select json_build_array (builtin function, pushdown constraints, result)
--Testcase 3528:
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, '[true, false]'::json) FROM s8 WHERE id = 1;
 json_build_array | json_build_array | json_build_array | json_build_array |  json_build_array   
------------------+------------------+------------------+------------------+---------------------
 [[], 2]          | [[], "is"]       | [[], 1]          | [[], "a"]        | [[], [true, false]]
(1 row)

-- select json_build_array (builtin function, builtin in constraints, explain)
--Testcase 3529:
EXPLAIN VERBOSE
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, NULL), json_build_array(c1, TRUE), json_build_array(c1, '[true, false]') FROM s8 WHERE json_length(json_build_array(c1, c2)) > 1;
                                                                                                                            QUERY PLAN                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1051.43 rows=1138 width=160)
   Output: (json_build_array(c1, c2)), (json_build_array(c1, c3)), (json_build_array(c1, NULL::unknown)), (json_build_array(c1, true)), (json_build_array(c1, '[true, false]'))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, NULL::unknown), json_build_array(c1, true), json_build_array(c1, '[true, false]') FROM public.s8mysql WHERE ((public.json_length(json_build_array(c1, c2)) > 1))
(4 rows)

-- select json_build_array (builtin function, builtin in constraints, result)
--Testcase 3530:
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, NULL), json_build_array(c1, TRUE), json_build_array(c1, '[true, false]') FROM s8 WHERE json_length(json_build_array(c1, c2)) > 1;
                        json_build_array                        |                           json_build_array                            |                         json_build_array                          |                         json_build_array                          |                               json_build_array                               
----------------------------------------------------------------+-----------------------------------------------------------------------+-------------------------------------------------------------------+-------------------------------------------------------------------+------------------------------------------------------------------------------
 [[[1, 2], [3, 4], 5], 1]                                       | [[[1, 2], [3, 4], 5], "This"]                                         | [[[1, 2], [3, 4], 5], null]                                       | [[[1, 2], [3, 4], 5], true]                                       | [[[1, 2], [3, 4], 5], "[true, false]"]
 [[], 2]                                                        | [[], "is"]                                                            | [[], null]                                                        | [[], true]                                                        | [[], "[true, false]"]
 [{}, 3]                                                        | [{}, "text"]                                                          | [{}, null]                                                        | [{}, true]                                                        | [{}, "[true, false]"]
 [{"a": "10", "b": "15", "x": 25}, 4]                           | [{"a": "10", "b": "15", "x": 25}, "scalar"]                           | [{"a": "10", "b": "15", "x": 25}, null]                           | [{"a": "10", "b": "15", "x": 25}, true]                           | [{"a": "10", "b": "15", "x": 25}, "[true, false]"]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 5]                           | [{"a": 1, "b": 2, "c": {"d": 4}}, "scalar"]                           | [{"a": 1, "b": 2, "c": {"d": 4}}, null]                           | [{"a": 1, "b": 2, "c": {"d": 4}}, true]                           | [{"a": 1, "b": 2, "c": {"d": 4}}, "[true, false]"]
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], 5] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "scalar"] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], null] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], true] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[true, false]"]
(6 rows)

-- select json_build_array (builtin function, builtin in constraints, explain)
--Testcase 3531:
EXPLAIN VERBOSE
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, mysql_pi()) FROM s8 WHERE json_length(json_build_array(c1, c2)) > id;
                                                                                                                       QUERY PLAN                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1335.93 rows=1138 width=160)
   Output: (json_build_array(c1, c2)), (json_build_array(c1, c3)), (json_build_array(c1, 1)), (json_build_array(c1, 'a')), (json_build_array(c1, mysql_pi()))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, public.mysql_pi()) FROM public.s8mysql WHERE ((public.json_length(json_build_array(c1, c2)) > id))
(4 rows)

-- select json_build_array (builtin function, builtin in constraints, result)
--Testcase 3532:
SELECT json_build_array(c1, c2), json_build_array(c1, c3), json_build_array(c1, 1), json_build_array(c1, 'a'), json_build_array(c1, mysql_pi()) FROM s8 WHERE json_length(json_build_array(c1, c2)) > id;
     json_build_array     |       json_build_array        |     json_build_array     |      json_build_array      |             json_build_array             
--------------------------+-------------------------------+--------------------------+----------------------------+------------------------------------------
 [[[1, 2], [3, 4], 5], 1] | [[[1, 2], [3, 4], 5], "This"] | [[[1, 2], [3, 4], 5], 1] | [[[1, 2], [3, 4], 5], "a"] | [[[1, 2], [3, 4], 5], 3.141592653589793]
 [[], 2]                  | [[], "is"]                    | [[], 1]                  | [[], "a"]                  | [[], 3.141592653589793]
(2 rows)

-- select json_build_array as nest function with agg (pushdown, explain)
--Testcase 3533:
EXPLAIN VERBOSE
SELECT sum(id),json_build_array('["a", ["b", "c"], "d"]',  sum(id)) FROM s8;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_build_array('["a", ["b", "c"], "d"]', sum(id)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), json_build_array('["a", ["b", "c"], "d"]', sum(id)) FROM public.s8mysql
(6 rows)

-- select json_build_array as nest function with agg (pushdown, result)
--Testcase 3534:
SELECT sum(id),json_build_array('["a", ["b", "c"], "d"]',  sum(id)) FROM s8;
 sum |            json_build_array            
-----+----------------------------------------
  15 | ["[\"a\", [\"b\", \"c\"], \"d\"]", 15]
(1 row)

-- select json_build_array with non pushdown func and explicit constant (explain)
--Testcase 3535:
EXPLAIN VERBOSE
SELECT json_build_array(c1, c2), pi(), 4.1 FROM s8;
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..220.92 rows=3413 width=72)
   Output: (json_build_array(c1, c2)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_array(c1, c2), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_build_array with non pushdown func and explicit constant (result)
--Testcase 3536:
SELECT json_build_array(c1, c2), pi(), 4.1 FROM s8;
                        json_build_array                        |        pi         | ?column? 
----------------------------------------------------------------+-------------------+----------
 [[[1, 2], [3, 4], 5], 1]                                       | 3.141592653589793 |      4.1
 [[], 2]                                                        | 3.141592653589793 |      4.1
 [{}, 3]                                                        | 3.141592653589793 |      4.1
 [{"a": "10", "b": "15", "x": 25}, 4]                           | 3.141592653589793 |      4.1
 [{"a": 1, "b": 2, "c": {"d": 4}}, 5]                           | 3.141592653589793 |      4.1
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], 5] | 3.141592653589793 |      4.1
(6 rows)

-- select json_build_array with order by (explain)
--Testcase 3537:
EXPLAIN VERBOSE
SELECT json_length(json_build_array(c1, c2)) FROM s8 ORDER BY 1;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=4)
   Output: (json_length(json_build_array(c1, c2)))
   Sort Key: (json_length(json_build_array(s8.c1, s8.c2)))
   ->  Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=4)
         Output: (json_length(json_build_array(c1, c2)))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.json_length(json_build_array(c1, c2)) FROM public.s8mysql
(7 rows)

-- select json_build_array with order by (result)
--Testcase 3538:
SELECT json_length(json_build_array(c1, c2)) FROM s8 ORDER BY 1;
 json_length 
-------------
           2
           2
           2
           2
           2
           2
(6 rows)

-- select json_build_array with group by (explain)
--Testcase 3539:
EXPLAIN VERBOSE
SELECT json_length(json_build_array('["a", ["b", "c"], "d"]',  id)) FROM s8 GROUP BY 1;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=4)
   Output: (json_length(json_build_array('["a", ["b", "c"], "d"]', id)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_length(json_build_array('["a", ["b", "c"], "d"]', id)) FROM public.s8mysql GROUP BY 1
(6 rows)

-- select json_build_array with group by (result)
--Testcase 3540:
SELECT json_length(json_build_array('["a", ["b", "c"], "d"]',  id)) FROM s8 GROUP BY 1;
 json_length 
-------------
           2
(1 row)

-- select json_build_array with group by having (explain)
--Testcase 3541:
EXPLAIN VERBOSE
SELECT json_length(json_build_array('["a", ["b", "c"], "d"]',  c2)), c2 FROM s8 GROUP BY 1, 2 HAVING count(c2) > 1;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (json_length(json_build_array('["a", ["b", "c"], "d"]', c2))), c2
   Filter: ((count(s8.c2)) > 1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_length(json_build_array('["a", ["b", "c"], "d"]', c2)), c2, count(c2) FROM public.s8mysql GROUP BY 1, 2
(7 rows)

-- select json_build_array with group by having (result)
--Testcase 3542:
SELECT json_length(json_build_array('["a", ["b", "c"], "d"]',  c2)), c2 FROM s8 GROUP BY 1, 2 HAVING count(c2) > 1;
 json_length | c2 
-------------+----
           2 |  5
(1 row)

-- select json_build_array and as
--Testcase 3543:
SELECT json_build_array(c1, c2) AS json_build_array1 FROM s8;
                       json_build_array1                        
----------------------------------------------------------------
 [[[1, 2], [3, 4], 5], 1]
 [[], 2]
 [{}, 3]
 [{"a": "10", "b": "15", "x": 25}, 4]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 5]
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], 5]
(6 rows)

-- json_array_append
-- select json_array_append (stub function, explain)
--Testcase 3544:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_array_append (stub function, result)
--Testcase 3545:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8;
                                         json_array_append                                         
---------------------------------------------------------------------------------------------------
 [[1, 2], [3, 4, 1, "This", 1, "a", 3.141592653589793], 5]
 []
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5, "scalar", 1, "a", 3.141592653589793], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- select json_array_append (stub function, not pushdown constraints, explain)
--Testcase 3546:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], NULL', '$[1], TRUE', '$[1], pi()') FROM s8 WHERE to_hex(id) = '1';
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..233.44 rows=17 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', NULL","''$[1]'', TRUE","''$[1]'', pi()"}'::path_value[]))
   Filter: (to_hex(s8.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', NULL","''$[1]'', TRUE","''$[1]'', pi()"}'::public.path_value[]), id FROM public.s8mysql
(5 rows)

-- select json_array_append (stub function, not pushdown constraints, result)
--Testcase 3547:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], NULL', '$[1], TRUE', '$[1], pi()') FROM s8 WHERE to_hex(id) = '1';
 json_array_append 
-------------------
 []
(1 row)

-- select json_array_append (stub function, pushdown constraints, explain)
--Testcase 3548:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..157.25 rows=17 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', CAST(\"[true, false]\" AS JSON)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC E'{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', CAST(\\"[true, false]\\" AS JSON)"}'::public.path_value[]) FROM public.s8mysql WHERE ((id = 1))
(4 rows)

-- select json_array_append (stub function, pushdown constraints, result)
--Testcase 3549:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
 json_array_append 
-------------------
 []
(1 row)

-- select json_array_append (stub function, stub in constraints, explain)
--Testcase 3550:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], NULL', '$[1], TRUE', '$[1], "[true, false]"') FROM s8 WHERE log2(id) > 1;
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1321.71 rows=1138 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', NULL","''$[1]'', TRUE","''$[1]'', ''[true, false]''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', NULL","''$[1]'', TRUE","''$[1]'', ''[true, false]''"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.log2(id) > 1::double precision))
(4 rows)

-- select json_array_append (stub function, stub in constraints, result)
--Testcase 3551:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], NULL', '$[1], TRUE', '$[1], "[true, false]"') FROM s8 WHERE log2(id) > 1;
                                          json_array_append                                          
-----------------------------------------------------------------------------------------------------
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5, "scalar", null, true, "[true, false]"], {"x": "abc"}, {"y": "bcd"}]
(3 rows)

-- select json_array_append (stub function, stub in constraints, explain)
--Testcase 3552:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8 WHERE json_depth(json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()')) > 0;
                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2166.42 rows=1138 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.json_depth(public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::public.path_value[])) > 0))
(4 rows)

-- select json_array_append (stub function, stub in constraints, result)
--Testcase 3553:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8 WHERE json_depth(json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()')) > 0;
                                         json_array_append                                         
---------------------------------------------------------------------------------------------------
 [[1, 2], [3, 4, 1, "This", 1, "a", 3.141592653589793], 5]
 []
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5, "scalar", 1, "a", 3.141592653589793], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_append with 1 arg explain
--Testcase 3554:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2') FROM s8;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_append with 1 arg result
--Testcase 3555:
SELECT json_array_append(c1, '$[1], c2') FROM s8;
                      json_array_append                       
--------------------------------------------------------------
 [[1, 2], [3, 4, 1], 5]
 []
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_append with 2 args explain
--Testcase 3556:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3') FROM s8;
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_append with 2 args result
--Testcase 3557:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3') FROM s8;
                           json_array_append                            
------------------------------------------------------------------------
 [[1, 2], [3, 4, 1, "This"], 5]
 []
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5, "scalar"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_append with 3 args explain
--Testcase 3558:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1') FROM s8;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_append with 3 args result
--Testcase 3559:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1') FROM s8;
                             json_array_append                             
---------------------------------------------------------------------------
 [[1, 2], [3, 4, 1, "This", 1], 5]
 []
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5, "scalar", 1], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_append with 4 args explain
--Testcase 3560:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"') FROM s8;
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_append with 4 args result
--Testcase 3561:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"') FROM s8;
                               json_array_append                                
--------------------------------------------------------------------------------
 [[1, 2], [3, 4, 1, "This", 1, "a"], 5]
 []
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5, "scalar", 1, "a"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_append with 5 args explain
--Testcase 3562:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_append with 5 args result
--Testcase 3563:
SELECT json_array_append(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8;
                                         json_array_append                                         
---------------------------------------------------------------------------------------------------
 [[1, 2], [3, 4, 1, "This", 1, "a", 3.141592653589793], 5]
 []
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5, "scalar", 1, "a", 3.141592653589793], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- select json_array_append as nest function with agg (pushdown, explain)
--Testcase 3564:
EXPLAIN VERBOSE
SELECT sum(id),json_array_append('["a", ["b", "c"], "d"]', '$[1], sum(id)') FROM s8;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_array_append('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', sum(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_array_append('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', sum(id)"}'::public.path_value[]) FROM public.s8mysql
(6 rows)

-- select json_array_append as nest function with agg (pushdown, result)
--Testcase 3565:
SELECT sum(id),json_array_append('["a", ["b", "c"], "d"]', '$[1], sum(id)') FROM s8;
 sum |     json_array_append      
-----+----------------------------
  15 | ["a", ["b", "c", 15], "d"]
(1 row)

-- select json_array_append as nest function with json_build_array (pushdown, explain)
--Testcase 3566:
EXPLAIN VERBOSE
SELECT json_array_append(json_build_array('["a", ["b", "c"], "d"]', c1), '$[1], log2(id)') FROM s8;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=32)
   Output: (json_array_append(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$[1]'', log2(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$[1]'', log2(id)"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_array_append as nest function with agg (pushdown, result)
--Testcase 3567:
SELECT json_array_append(json_build_array('["a", ["b", "c"], "d"]', c1), '$[1], log2(id)') FROM s8;
                                                json_array_append                                                 
------------------------------------------------------------------------------------------------------------------
 ["[\"a\", [\"b\", \"c\"], \"d\"]", [[1, 2], [3, 4], 5, null]]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", [0.0]]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", [{}, 1.0]]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", [{"a": "10", "b": "15", "x": 25}, 1.584962500721156]]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", [{"a": 1, "b": 2, "c": {"d": 4}}, 2.0]]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 2.321928094887362]]
(6 rows)

-- select json_array_append with non pushdown func and explicit constant (explain)
--Testcase 3568:
EXPLAIN VERBOSE
SELECT json_array_append(c1, '$[1], c2'), pi(), 4.1 FROM s8;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_array_append(c1, VARIADIC '{"''$[1]'', c2"}'::path_value[])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_append(c1, VARIADIC '{"''$[1]'', c2"}'::public.path_value[]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_array_append with non pushdown func and explicit constant (result)
--Testcase 3569:
SELECT json_array_append(c1, '$[1], c2'), pi(), 4.1 FROM s8;
                      json_array_append                       |        pi         | ?column? 
--------------------------------------------------------------+-------------------+----------
 [[1, 2], [3, 4, 1], 5]                                       | 3.141592653589793 |      4.1
 []                                                           | 3.141592653589793 |      4.1
 {}                                                           | 3.141592653589793 |      4.1
 {"a": "10", "b": "15", "x": 25}                              | 3.141592653589793 |      4.1
 {"a": 1, "b": 2, "c": {"d": 4}}                              | 3.141592653589793 |      4.1
 ["abc", [{"k": "10"}, "def", 5], {"x": "abc"}, {"y": "bcd"}] | 3.141592653589793 |      4.1
(6 rows)

-- select json_array_append with order by (explain)
--Testcase 3570:
EXPLAIN VERBOSE
SELECT json_length(json_array_append(c1, '$[1], c2')) FROM s8 ORDER BY 1;
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=4)
   Output: (json_length(json_array_append(c1, VARIADIC '{"''$[1]'', c2"}'::path_value[])))
   Sort Key: (json_length(json_array_append(s8.c1, VARIADIC '{"''$[1]'', c2"}'::path_value[])))
   ->  Foreign Scan on public.s8  (cost=100.00..1918.89 rows=3413 width=4)
         Output: (json_length(json_array_append(c1, VARIADIC '{"''$[1]'', c2"}'::path_value[])))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.json_length(public.json_array_append(c1, VARIADIC '{"''$[1]'', c2"}'::public.path_value[])) FROM public.s8mysql
(7 rows)

-- select json_array_append with order by (result)
--Testcase 3571:
SELECT json_length(json_array_append(c1, '$[1], c2')) FROM s8 ORDER BY 1;
 json_length 
-------------
           0
           0
           3
           3
           3
           4
(6 rows)

-- select json_array_append with group by (explain)
--Testcase 3572:
EXPLAIN VERBOSE
SELECT json_length(json_array_append('["a", ["b", "c"], "d"]', '$[1], id')) FROM s8 GROUP BY 1;
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=4)
   Output: (json_length(json_array_append('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', id"}'::path_value[])))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_length(public.json_array_append('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', id"}'::public.path_value[])) FROM public.s8mysql GROUP BY 1
(6 rows)

-- select json_array_append with group by (result)
--Testcase 3573:
SELECT json_length(json_array_append('["a", ["b", "c"], "d"]', '$[1], id')) FROM s8 GROUP BY 1;
 json_length 
-------------
           3
(1 row)

-- select json_array_append with group by having (explain)
--Testcase 3574:
EXPLAIN VERBOSE
SELECT json_depth(json_array_append('["a", ["b", "c"], "d"]', '$[1], c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (json_depth(json_array_append('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', c2"}'::path_value[]))), c2
   Filter: ((count(s8.c2)) > 1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_depth(public.json_array_append('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', c2"}'::public.path_value[])), c2, count(c2) FROM public.s8mysql GROUP BY 2, 1
(7 rows)

-- select json_array_append with group by having (result)
--Testcase 3575:
SELECT json_depth(json_array_append('["a", ["b", "c"], "d"]', '$[1], c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
 json_depth 
------------
          3
(1 row)

-- select json_array_append and as
--Testcase 3576:
SELECT json_array_append(c1, '$[1], c2') AS json_array_append1 FROM s8;
                      json_array_append1                      
--------------------------------------------------------------
 [[1, 2], [3, 4, 1], 5]
 []
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def", 5], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_insert
-- select json_array_insert (stub function, explain)
--Testcase 3577:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_array_insert (stub function, result)
--Testcase 3578:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8;
                                         json_array_insert                                         
---------------------------------------------------------------------------------------------------
 [[1, 2], 3.141592653589793, "a", 1, "This", 1, [3, 4], 5]
 [2, 3.141592653589793, "a", 1, "is"]
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", 3.141592653589793, "a", 1, "scalar", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- select json_array_insert (stub function, not pushdown constraints, explain)
--Testcase 3579:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], NULL', '$[1], TRUE', '$[1], pi()') FROM s8 WHERE to_hex(id) = '1';
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..233.44 rows=17 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', NULL","''$[1]'', TRUE","''$[1]'', pi()"}'::path_value[]))
   Filter: (to_hex(s8.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', NULL","''$[1]'', TRUE","''$[1]'', pi()"}'::public.path_value[]), id FROM public.s8mysql
(5 rows)

-- select json_array_insert (stub function, not pushdown constraints, result)
--Testcase 3580:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], NULL', '$[1], TRUE', '$[1], pi()') FROM s8 WHERE to_hex(id) = '1';
            json_array_insert             
------------------------------------------
 [2, 3.141592653589793, true, null, "is"]
(1 row)

-- select json_array_insert (stub function, pushdown constraints, explain)
--Testcase 3581:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..157.25 rows=17 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', CAST(\"[true, false]\" AS JSON)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC E'{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', CAST(\\"[true, false]\\" AS JSON)"}'::public.path_value[]) FROM public.s8mysql WHERE ((id = 1))
(4 rows)

-- select json_array_insert (stub function, pushdown constraints, result)
--Testcase 3582:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
        json_array_insert         
----------------------------------
 [2, [true, false], "a", 1, "is"]
(1 row)

-- select json_array_insert (stub function, stub in constraints, explain)
--Testcase 3583:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], NULL', '$[1], TRUE', '$[1], "[true, false]"') FROM s8 WHERE log2(id) > 1;
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1321.71 rows=1138 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', NULL","''$[1]'', TRUE","''$[1]'', ''[true, false]''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', NULL","''$[1]'', TRUE","''$[1]'', ''[true, false]''"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.log2(id) > 1::double precision))
(4 rows)

-- select json_array_insert (stub function, stub in constraints, result)
--Testcase 3584:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], NULL', '$[1], TRUE', '$[1], "[true, false]"') FROM s8 WHERE log2(id) > 1;
                                          json_array_insert                                          
-----------------------------------------------------------------------------------------------------
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", "[true, false]", true, null, "scalar", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(3 rows)

-- select json_array_insert (stub function, stub in constraints, explain)
--Testcase 3585:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8 WHERE json_depth(json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()')) > 0;
                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2166.42 rows=1138 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.json_depth(public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::public.path_value[])) > 0))
(4 rows)

-- select json_array_insert (stub function, stub in constraints, result)
--Testcase 3586:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8 WHERE json_depth(json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()')) > 0;
                                         json_array_insert                                         
---------------------------------------------------------------------------------------------------
 [[1, 2], 3.141592653589793, "a", 1, "This", 1, [3, 4], 5]
 [2, 3.141592653589793, "a", 1, "is"]
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", 3.141592653589793, "a", 1, "scalar", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_insert with 1 arg explain
--Testcase 3587:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2') FROM s8;
                                                        QUERY PLAN                                                         
---------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_insert with 1 arg result
--Testcase 3588:
SELECT json_array_insert(c1, '$[1], c2') FROM s8;
                      json_array_insert                       
--------------------------------------------------------------
 [[1, 2], 1, [3, 4], 5]
 [2]
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_insert with 2 args explain
--Testcase 3589:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3') FROM s8;
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_insert with 2 args result
--Testcase 3590:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3') FROM s8;
                           json_array_insert                            
------------------------------------------------------------------------
 [[1, 2], "This", 1, [3, 4], 5]
 [2, "is"]
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", "scalar", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_insert with 3 args explain
--Testcase 3591:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1') FROM s8;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_insert with 3 args result
--Testcase 3592:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1') FROM s8;
                             json_array_insert                             
---------------------------------------------------------------------------
 [[1, 2], 1, "This", 1, [3, 4], 5]
 [2, 1, "is"]
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", 1, "scalar", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_insert with 4 args explain
--Testcase 3593:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"') FROM s8;
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_insert with 4 args result
--Testcase 3594:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"') FROM s8;
                               json_array_insert                                
--------------------------------------------------------------------------------
 [[1, 2], "a", 1, "This", 1, [3, 4], 5]
 [2, "a", 1, "is"]
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", "a", 1, "scalar", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_array_insert with 5 args explain
--Testcase 3595:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2","''$[1]'', c3","''$[1]'', 1","''$[1]'', ''a''","''$[1]'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_array_insert with 5 args result
--Testcase 3596:
SELECT json_array_insert(c1, '$[1], c2', '$[1], c3', '$[1], 1', '$[1], "a"', '$[1], pi()') FROM s8;
                                         json_array_insert                                         
---------------------------------------------------------------------------------------------------
 [[1, 2], 3.141592653589793, "a", 1, "This", 1, [3, 4], 5]
 [2, 3.141592653589793, "a", 1, "is"]
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", 3.141592653589793, "a", 1, "scalar", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- select json_array_insert as nest function with agg (pushdown, explain)
--Testcase 3597:
EXPLAIN VERBOSE
SELECT sum(id),json_array_insert('["a", ["b", "c"], "d"]', '$[1], sum(id)') FROM s8;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_array_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', sum(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_array_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', sum(id)"}'::public.path_value[]) FROM public.s8mysql
(6 rows)

-- select json_array_insert as nest function with agg (pushdown, result)
--Testcase 3598:
SELECT sum(id),json_array_insert('["a", ["b", "c"], "d"]', '$[1], sum(id)') FROM s8;
 sum |     json_array_insert      
-----+----------------------------
  15 | ["a", 15, ["b", "c"], "d"]
(1 row)

-- select json_array_insert as nest function with json_build_array (pushdown, explain)
--Testcase 3599:
EXPLAIN VERBOSE
SELECT json_array_insert(json_build_array('["a", ["b", "c"], "d"]', c1), '$[1], log2(id)') FROM s8;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=32)
   Output: (json_array_insert(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$[1]'', log2(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$[1]'', log2(id)"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_array_insert as nest function with agg (pushdown, result)
--Testcase 3600:
SELECT json_array_insert(json_build_array('["a", ["b", "c"], "d"]', c1), '$[1], log2(id)') FROM s8;
                                                json_array_insert                                                 
------------------------------------------------------------------------------------------------------------------
 ["[\"a\", [\"b\", \"c\"], \"d\"]", null, [[1, 2], [3, 4], 5]]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", 0.0, []]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", 1.0, {}]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", 1.584962500721156, {"a": "10", "b": "15", "x": 25}]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", 2.0, {"a": 1, "b": 2, "c": {"d": 4}}]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", 2.321928094887362, ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]]
(6 rows)

-- select json_array_insert with non pushdown func and explicit constant (explain)
--Testcase 3601:
EXPLAIN VERBOSE
SELECT json_array_insert(c1, '$[1], c2'), pi(), 4.1 FROM s8;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_array_insert(c1, VARIADIC '{"''$[1]'', c2"}'::path_value[])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2"}'::public.path_value[]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_array_insert with non pushdown func and explicit constant (result)
--Testcase 3602:
SELECT json_array_insert(c1, '$[1], c2'), pi(), 4.1 FROM s8;
                      json_array_insert                       |        pi         | ?column? 
--------------------------------------------------------------+-------------------+----------
 [[1, 2], 1, [3, 4], 5]                                       | 3.141592653589793 |      4.1
 [2]                                                          | 3.141592653589793 |      4.1
 {}                                                           | 3.141592653589793 |      4.1
 {"a": "10", "b": "15", "x": 25}                              | 3.141592653589793 |      4.1
 {"a": 1, "b": 2, "c": {"d": 4}}                              | 3.141592653589793 |      4.1
 ["abc", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] | 3.141592653589793 |      4.1
(6 rows)

-- select json_array_insert with order by (explain)
--Testcase 3603:
EXPLAIN VERBOSE
SELECT json_length(json_array_insert(c1, '$[1], c2')) FROM s8 ORDER BY 1;
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=4)
   Output: (json_length(json_array_insert(c1, VARIADIC '{"''$[1]'', c2"}'::path_value[])))
   Sort Key: (json_length(json_array_insert(s8.c1, VARIADIC '{"''$[1]'', c2"}'::path_value[])))
   ->  Foreign Scan on public.s8  (cost=100.00..1918.89 rows=3413 width=4)
         Output: (json_length(json_array_insert(c1, VARIADIC '{"''$[1]'', c2"}'::path_value[])))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.json_length(public.json_array_insert(c1, VARIADIC '{"''$[1]'', c2"}'::public.path_value[])) FROM public.s8mysql
(7 rows)

-- select json_array_insert with order by (result)
--Testcase 3604:
SELECT json_length(json_array_insert(c1, '$[1], c2')) FROM s8 ORDER BY 1;
 json_length 
-------------
           0
           1
           3
           3
           4
           5
(6 rows)

-- select json_array_insert with group by (explain)
--Testcase 3605:
EXPLAIN VERBOSE
SELECT json_length(json_array_insert('["a", ["b", "c"], "d"]', '$[1], id')) FROM s8 GROUP BY id, 1;
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: (json_length(json_array_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', id"}'::path_value[]))), id
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_length(public.json_array_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', id"}'::public.path_value[])), id FROM public.s8mysql GROUP BY 2, 1
(6 rows)

-- select json_array_insert with group by (result)
--Testcase 3606:
SELECT json_length(json_array_insert('["a", ["b", "c"], "d"]', '$[1], id')) FROM s8 GROUP BY id, 1;
 json_length 
-------------
           4
           4
           4
           4
           4
           4
(6 rows)

-- select json_array_insert with group by having (explain)
--Testcase 3607:
EXPLAIN VERBOSE
SELECT json_depth(json_array_insert('["a", ["b", "c"], "d"]', '$[1], c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (json_depth(json_array_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', c2"}'::path_value[]))), c2
   Filter: ((count(s8.c2)) > 1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_depth(public.json_array_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$[1]'', c2"}'::public.path_value[])), c2, count(c2) FROM public.s8mysql GROUP BY 2, 1
(7 rows)

-- select json_array_insert with group by having (result)
--Testcase 3608:
SELECT json_depth(json_array_insert('["a", ["b", "c"], "d"]', '$[1], c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
 json_depth 
------------
          3
(1 row)

-- select json_array_insert and as
--Testcase 3609:
SELECT json_array_insert(c1, '$[1], c2') AS json_array_insert1 FROM s8;
                      json_array_insert1                      
--------------------------------------------------------------
 [[1, 2], 1, [3, 4], 5]
 [2]
 {}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", 5, [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- select  json_contains (stub function, explain)
--Testcase 3610:
EXPLAIN VERBOSE
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8;
                                                                                                                                                         QUERY PLAN                                                                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4478.64 rows=3413 width=20)
   Output: (json_contains(c1, '1'::json, '$.a'::text)), (json_contains(c1, '{"a": 1}'::json, '$.a'::text)), (json_contains(c1, c1, '$.a'::text)), (json_contains(c1, '1'::text)), (json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains(c1, '1'::json, '$.a'::text), public.json_contains(c1, '{"a": 1}'::json, '$.a'::text), public.json_contains(c1, c1, '$.a'::text), public.json_contains(c1, '1'::text), public.json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text) FROM public.s8mysql
(4 rows)

-- select  json_contains (stub function, result)
--Testcase 3611:
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8;
 json_contains | json_contains | json_contains | json_contains | json_contains 
---------------+---------------+---------------+---------------+---------------
               |               |               |             1 |             1
               |               |               |             0 |             1
               |               |               |             0 |             1
             0 |             0 |             0 |             0 |             1
             1 |             0 |             0 |             0 |             1
               |               |               |             0 |             1
(6 rows)

-- select  json_contains (stub function, not pushdown constraints, explain)
--Testcase 3612:
EXPLAIN VERBOSE
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                           QUERY PLAN                                                                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..250.44 rows=17 width=20)
   Output: (json_contains(c1, '1'::json, '$.a'::text)), (json_contains(c1, '{"a": 1}'::json, '$.a'::text)), (json_contains(c1, c1, '$.a'::text)), (json_contains(c1, '1'::text)), (json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains(c1, '1'::json, '$.a'::text), public.json_contains(c1, '{"a": 1}'::json, '$.a'::text), public.json_contains(c1, c1, '$.a'::text), public.json_contains(c1, '1'::text), public.json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text), id FROM public.s8mysql
(5 rows)

-- select  json_contains (stub function, not pushdown constraints, result)
--Testcase 3613:
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8 WHERE to_hex(id) = '2';
 json_contains | json_contains | json_contains | json_contains | json_contains 
---------------+---------------+---------------+---------------+---------------
               |               |               |             0 |             1
(1 row)

-- select  json_contains (stub function, pushdown constraints, explain)
--Testcase 3614:
EXPLAIN VERBOSE
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8 WHERE id != 0;
                                                                                                                                                                  QUERY PLAN                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4465.58 rows=3396 width=20)
   Output: (json_contains(c1, '1'::json, '$.a'::text)), (json_contains(c1, '{"a": 1}'::json, '$.a'::text)), (json_contains(c1, c1, '$.a'::text)), (json_contains(c1, '1'::text)), (json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains(c1, '1'::json, '$.a'::text), public.json_contains(c1, '{"a": 1}'::json, '$.a'::text), public.json_contains(c1, c1, '$.a'::text), public.json_contains(c1, '1'::text), public.json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select  json_contains (stub function, pushdown constraints, result)
--Testcase 3615:
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8 WHERE id != 0;
 json_contains | json_contains | json_contains | json_contains | json_contains 
---------------+---------------+---------------+---------------+---------------
               |               |               |             0 |             1
               |               |               |             0 |             1
             0 |             0 |             0 |             0 |             1
             1 |             0 |             0 |             0 |             1
               |               |               |             0 |             1
(5 rows)

-- select  json_contains (stub function, json_contains in constraints, explain)
--Testcase 3616:
EXPLAIN VERBOSE
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8 WHERE json_contains(c1, '1', '$.a') != 1;
                                                                                                                                                                                         QUERY PLAN                                                                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5318.83 rows=3396 width=20)
   Output: (json_contains(c1, '1'::json, '$.a'::text)), (json_contains(c1, '{"a": 1}'::json, '$.a'::text)), (json_contains(c1, c1, '$.a'::text)), (json_contains(c1, '1'::text)), (json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains(c1, '1'::json, '$.a'::text), public.json_contains(c1, '{"a": 1}'::json, '$.a'::text), public.json_contains(c1, c1, '$.a'::text), public.json_contains(c1, '1'::text), public.json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text) FROM public.s8mysql WHERE ((public.json_contains(c1, '1'::json, '$.a'::text) <> 1))
(4 rows)

-- select  json_contains (stub function, json_contains in constraints, result)
--Testcase 3617:
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8 WHERE json_contains(c1, '1', '$.a') != 1;
 json_contains | json_contains | json_contains | json_contains | json_contains 
---------------+---------------+---------------+---------------+---------------
             0 |             0 |             0 |             0 |             1
(1 row)

-- select  json_contains (stub function, json_contains in constraints, explain)
--Testcase 3618:
EXPLAIN VERBOSE
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8 WHERE json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') = 1;
                                                                                                                                                                                                           QUERY PLAN                                                                                                                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1027.50 rows=17 width=20)
   Output: (json_contains(c1, '1'::json, '$.a'::text)), (json_contains(c1, '{"a": 1}'::json, '$.a'::text)), (json_contains(c1, c1, '$.a'::text)), (json_contains(c1, '1'::text)), (json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains(c1, '1'::json, '$.a'::text), public.json_contains(c1, '{"a": 1}'::json, '$.a'::text), public.json_contains(c1, c1, '$.a'::text), public.json_contains(c1, '1'::text), public.json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text) FROM public.s8mysql WHERE ((public.json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::json, '$.a'::text) = 1))
(4 rows)

-- select  json_contains (stub function, json_contains in constraints, result)
--Testcase 3619:
SELECT json_contains(c1, '1', '$.a'), json_contains(c1, '{"a": 1}', '$.a'), json_contains(c1, c1, '$.a'), json_contains(c1,'1'), json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') FROM s8 WHERE json_contains('{"a": 1, "b": 2, "c": {"d": 4}}','1', '$.a') = 1;
 json_contains | json_contains | json_contains | json_contains | json_contains 
---------------+---------------+---------------+---------------+---------------
               |               |               |             1 |             1
               |               |               |             0 |             1
               |               |               |             0 |             1
             0 |             0 |             0 |             0 |             1
             1 |             0 |             0 |             0 |             1
               |               |               |             0 |             1
(6 rows)

-- select json_contains as nest function with agg (pushdown, explain)
--Testcase 3620:
EXPLAIN VERBOSE
SELECT sum(id),json_contains('{"a": 1, "b": 2, "c": {"d": 4}}', '1') FROM s8;
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (sum(id)), (json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_contains('{"a": 1, "b": 2, "c": {"d": 4}}'::json, '1'::text) FROM public.s8mysql
(6 rows)

-- select json_contains as nest function with agg (pushdown, result)
--Testcase 3621:
SELECT sum(id),json_contains('{"a": 1, "b": 2, "c": {"d": 4}}', '1') FROM s8;
 sum | json_contains 
-----+---------------
  15 |             0
(1 row)

-- select json_contains with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3622:
EXPLAIN VERBOSE
SELECT json_contains(c1, c1, '$.a'), pi(), 4.1 FROM s8;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (json_contains(c1, c1, '$.a'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains(c1, c1, '$.a'::text), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_contains with non pushdown func and explicit constant (result)
--Testcase 3623:
SELECT json_contains(c1, c1, '$.a'), pi(), 4.1 FROM s8;
 json_contains |        pi         | ?column? 
---------------+-------------------+----------
               | 3.141592653589793 |      4.1
               | 3.141592653589793 |      4.1
               | 3.141592653589793 |      4.1
             0 | 3.141592653589793 |      4.1
             0 | 3.141592653589793 |      4.1
               | 3.141592653589793 |      4.1
(6 rows)

-- select json_contains with order by index (result)
--Testcase 3624:
SELECT id,  json_contains(c1, '1', '$.a') FROM s8 ORDER BY 2, 1;
 id | json_contains 
----+---------------
  3 |             0
  4 |             1
  0 |              
  1 |              
  2 |              
  5 |              
(6 rows)

-- select json_contains with order by index (result)
--Testcase 3625:
SELECT id,  json_contains(c1, '1', '$.a') FROM s8 ORDER BY 1, 2;
 id | json_contains 
----+---------------
  0 |              
  1 |              
  2 |              
  3 |             0
  4 |             1
  5 |              
(6 rows)

-- select json_contains with group by (EXPLAIN)
--Testcase 3626:
EXPLAIN VERBOSE
SELECT count(id), json_contains(c1, '1', '$.a') FROM s8 group by json_contains(c1, '1', '$.a');
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_contains(c1, '1'::json, '$.a'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_contains(c1, '1'::json, '$.a'::text) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_contains with group by (result)
--Testcase 3627:
SELECT count(id), json_contains(c1, '1', '$.a') FROM s8 group by json_contains(c1, '1', '$.a');
 count | json_contains 
-------+---------------
     4 |              
     1 |             0
     1 |             1
(3 rows)

-- select json_contains with group by index (result)
--Testcase 3628:
SELECT id,  json_contains(c1, '1', '$.a') FROM s8 group by 2, 1;
 id | json_contains 
----+---------------
  0 |              
  1 |              
  2 |              
  3 |             0
  4 |             1
  5 |              
(6 rows)

-- select json_contains with group by index (result)
--Testcase 3629:
SELECT id,  json_contains(c1, '1', '$.a') FROM s8 group by 1, 2;
 id | json_contains 
----+---------------
  0 |              
  1 |              
  2 |              
  3 |             0
  4 |             1
  5 |              
(6 rows)

-- select json_contains with group by having (EXPLAIN)
--Testcase 3630:
EXPLAIN VERBOSE
SELECT count(c2), json_contains(c1, '1', '$.a') FROM s8 group by json_contains(c1, '1', '$.a') HAVING count(c2) > 0;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_contains(c1, '1'::json, '$.a'::text))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_contains(c1, '1'::json, '$.a'::text) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_contains with group by having (result)
--Testcase 3631:
SELECT count(c2), json_contains(c1, '1', '$.a') FROM s8 group by json_contains(c1, '1', '$.a') HAVING count(c2) > 0;
 count | json_contains 
-------+---------------
     4 |              
     1 |             0
     1 |             1
(3 rows)

-- select json_contains with group by index having (result)
--Testcase 3632:
SELECT c2,  json_contains(c1, '1', '$.a') FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_contains 
----+---------------
  1 |              
  2 |              
  3 |              
  4 |             0
  5 |             1
  5 |              
(6 rows)

-- select json_contains with group by index having (result)
--Testcase 3633:
SELECT c2,  json_contains(c1, '1', '$.a') FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_contains 
----+---------------
  1 |              
  2 |              
  3 |              
  4 |             0
  5 |             1
  5 |              
(6 rows)

-- select json_contains and as
--Testcase 3634:
SELECT json_contains(c1, c1, '$.a') as json_contains1 FROM s8;
 json_contains1 
----------------
               
               
               
              0
              0
               
(6 rows)

-- select json_contains_path (builtin function, explain)
--Testcase 3635:
EXPLAIN VERBOSE
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8;
                                                                                                                                                                  QUERY PLAN                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3625.39 rows=3413 width=16)
   Output: (json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a}'::text[])), (json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a}'::text[]), public.json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]) FROM public.s8mysql
(4 rows)

-- select json_contains_path (builtin function, result)
--Testcase 3636:
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8;
 json_contains_path | json_contains_path | json_contains_path | json_contains_path 
--------------------+--------------------+--------------------+--------------------
                  0 |                  0 |                  0 |                  1
                  0 |                  0 |                  0 |                  1
                  0 |                  0 |                  0 |                  1
                  1 |                  1 |                  1 |                  1
                  1 |                  0 |                  1 |                  1
                  0 |                  0 |                  0 |                  1
(6 rows)

-- select json_contains_path (builtin function, not pushdown constraints, explain)
--Testcase 3637:
EXPLAIN VERBOSE
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                                    QUERY PLAN                                                                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..246.19 rows=17 width=16)
   Output: (json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a}'::text[])), (json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a}'::text[]), public.json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]), id FROM public.s8mysql
(5 rows)

-- select json_contains_path (builtin function, not pushdown constraints, result)
--Testcase 3638:
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8 WHERE to_hex(id) = '2';
 json_contains_path | json_contains_path | json_contains_path | json_contains_path 
--------------------+--------------------+--------------------+--------------------
                  0 |                  0 |                  0 |                  1
(1 row)

-- select json_contains_path (builtin function, pushdown constraints, explain)
--Testcase 3639:
EXPLAIN VERBOSE
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8 WHERE id != 0;
                                                                                                                                                                           QUERY PLAN                                                                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3616.58 rows=3396 width=16)
   Output: (json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a}'::text[])), (json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a}'::text[]), public.json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_contains_path (builtin function, pushdown constraints, result)
--Testcase 3640:
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8 WHERE id != 0;
 json_contains_path | json_contains_path | json_contains_path | json_contains_path 
--------------------+--------------------+--------------------+--------------------
                  0 |                  0 |                  0 |                  1
                  0 |                  0 |                  0 |                  1
                  1 |                  1 |                  1 |                  1
                  1 |                  0 |                  1 |                  1
                  0 |                  0 |                  0 |                  1
(5 rows)

-- select json_contains_path (builtin function, json_contains_path in constraints, explain)
--Testcase 3641:
EXPLAIN VERBOSE
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8 WHERE json_contains_path(c1, 'one', '$.a', '$.e') != 0;
                                                                                                                                                                                                         QUERY PLAN                                                                                                                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4469.83 rows=3396 width=16)
   Output: (json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a}'::text[])), (json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a}'::text[]), public.json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]) FROM public.s8mysql WHERE ((public.json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]) <> 0))
(4 rows)

-- select json_contains_path (builtin function, json_contains_path in constraints, result)
--Testcase 3642:
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8 WHERE json_contains_path(c1, 'one', '$.a', '$.e') != 0;
 json_contains_path | json_contains_path | json_contains_path | json_contains_path 
--------------------+--------------------+--------------------+--------------------
                  1 |                  1 |                  1 |                  1
                  1 |                  0 |                  1 |                  1
(2 rows)

-- select json_contains_path (builtin function, json_contains_path in constraints, explain)
--Testcase 3643:
EXPLAIN VERBOSE
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8 WHERE json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') = 1;
                                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1023.25 rows=17 width=16)
   Output: (json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[])), (json_contains_path(c1, VARIADIC '{all,$.a}'::text[])), (json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a,$.x}'::text[]), public.json_contains_path(c1, VARIADIC '{all,$.a}'::text[]), public.json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]) FROM public.s8mysql WHERE ((public.json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]) = 1))
(4 rows)

-- select json_contains_path (builtin function, json_contains_path in constraints, result)
--Testcase 3644:
SELECT json_contains_path(c1, 'one', '$.a', '$.e'), json_contains_path(c1, 'all', '$.a', '$.x'), json_contains_path(c1, 'all', '$.a'), json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8 WHERE json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') = 1;
 json_contains_path | json_contains_path | json_contains_path | json_contains_path 
--------------------+--------------------+--------------------+--------------------
                  0 |                  0 |                  0 |                  1
                  0 |                  0 |                  0 |                  1
                  0 |                  0 |                  0 |                  1
                  1 |                  1 |                  1 |                  1
                  1 |                  0 |                  1 |                  1
                  0 |                  0 |                  0 |                  1
(6 rows)

-- select json_contains_path as nest function with agg (pushdown, explain)
--Testcase 3645:
EXPLAIN VERBOSE
SELECT sum(id),json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8;
                                                                       QUERY PLAN                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (sum(id)), (json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}'::json, VARIADIC '{one,$.c.d}'::text[]) FROM public.s8mysql
(6 rows)

-- select json_contains_path as nest function with agg (pushdown, result)
--Testcase 3646:
SELECT sum(id),json_contains_path('{"a": 1, "b": 2, "c": {"d": 4}}', 'one', '$.c.d') FROM s8;
 sum | json_contains_path 
-----+--------------------
  15 |                  1
(1 row)

-- select json_contains_path with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3647:
EXPLAIN VERBOSE
SELECT json_contains_path(c1, 'all', '$.a'), pi(), 4.1 FROM s8;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (json_contains_path(c1, VARIADIC '{all,$.a}'::text[])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_contains_path(c1, VARIADIC '{all,$.a}'::text[]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_contains_path with non pushdown func and explicit constant (result)
--Testcase 3648:
SELECT json_contains_path(c1, 'all', '$.a'), pi(), 4.1 FROM s8;
 json_contains_path |        pi         | ?column? 
--------------------+-------------------+----------
                  0 | 3.141592653589793 |      4.1
                  0 | 3.141592653589793 |      4.1
                  0 | 3.141592653589793 |      4.1
                  1 | 3.141592653589793 |      4.1
                  1 | 3.141592653589793 |      4.1
                  0 | 3.141592653589793 |      4.1
(6 rows)

-- select json_contains_path with order by index (result)
--Testcase 3649:
SELECT id,  json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 ORDER BY 2, 1;
 id | json_contains_path 
----+--------------------
  0 |                  0
  1 |                  0
  2 |                  0
  5 |                  0
  3 |                  1
  4 |                  1
(6 rows)

-- select json_contains_path with order by index (result)
--Testcase 3650:
SELECT id,  json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 ORDER BY 1, 2;
 id | json_contains_path 
----+--------------------
  0 |                  0
  1 |                  0
  2 |                  0
  3 |                  1
  4 |                  1
  5 |                  0
(6 rows)

-- select json_contains_path with group by (EXPLAIN)
--Testcase 3651:
EXPLAIN VERBOSE
SELECT count(id), json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 group by json_contains_path(c1, 'one', '$.a', '$.e');
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_contains_path with group by (result)
--Testcase 3652:
SELECT count(id), json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 group by json_contains_path(c1, 'one', '$.a', '$.e');
 count | json_contains_path 
-------+--------------------
     4 |                  0
     2 |                  1
(2 rows)

-- select json_contains_path with group by index (result)
--Testcase 3653:
SELECT id,  json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 group by 2, 1;
 id | json_contains_path 
----+--------------------
  0 |                  0
  1 |                  0
  2 |                  0
  3 |                  1
  4 |                  1
  5 |                  0
(6 rows)

-- select json_contains_path with group by index (result)
--Testcase 3654:
SELECT id,  json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 group by 1, 2;
 id | json_contains_path 
----+--------------------
  0 |                  0
  1 |                  0
  2 |                  0
  3 |                  1
  4 |                  1
  5 |                  0
(6 rows)

-- select json_contains_path with group by having (EXPLAIN)
--Testcase 3655:
EXPLAIN VERBOSE
SELECT count(c2), json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 group by json_contains_path(c1, 'one', '$.a', '$.e') HAVING count(c2) > 0;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_contains_path(c1, VARIADIC '{one,$.a,$.e}'::text[]) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_contains_path with group by having (result)
--Testcase 3656:
SELECT count(c2), json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 group by json_contains_path(c1, 'one', '$.a', '$.e') HAVING count(c2) > 0;
 count | json_contains_path 
-------+--------------------
     4 |                  0
     2 |                  1
(2 rows)

-- select json_contains_path with group by index having (result)
--Testcase 3657:
SELECT c2,  json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_contains_path 
----+--------------------
  1 |                  0
  2 |                  0
  3 |                  0
  4 |                  1
  5 |                  1
  5 |                  0
(6 rows)

-- select json_contains_path with group by index having (result)
--Testcase 3658:
SELECT c2,  json_contains_path(c1, 'one', '$.a', '$.e') FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_contains_path 
----+--------------------
  1 |                  0
  2 |                  0
  3 |                  0
  4 |                  1
  5 |                  1
  5 |                  0
(6 rows)

-- select json_contains_path and as
--Testcase 3659:
SELECT json_contains_path(c1, 'all', '$.a') as json_contains_path1 FROM s8;
 json_contains_path1 
---------------------
                   0
                   0
                   0
                   1
                   1
                   0
(6 rows)

-- select json_depth (builtin function, explain)
--Testcase 3660:
EXPLAIN VERBOSE
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4487.17 rows=3413 width=20)
   Output: (json_depth(c1)), (json_depth(json_build_array(c1, c2))), (json_depth('[10, {"a": 20}]'::json)), (json_depth('1'::json)), (json_depth('true'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_depth(c1), public.json_depth(json_build_array(c1, c2)), public.json_depth('[10, {"a": 20}]'::json), public.json_depth('1'::json), public.json_depth('true'::json) FROM public.s8mysql
(4 rows)

-- select json_depth (builtin function, result)
--Testcase 3661:
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8;
 json_depth | json_depth | json_depth | json_depth | json_depth 
------------+------------+------------+------------+------------
          3 |          4 |          3 |          1 |          1
          1 |          2 |          3 |          1 |          1
          1 |          2 |          3 |          1 |          1
          2 |          3 |          3 |          1 |          1
          3 |          4 |          3 |          1 |          1
          4 |          5 |          3 |          1 |          1
(6 rows)

-- select json_depth (builtin function, not pushdown constraints, explain)
--Testcase 3662:
EXPLAIN VERBOSE
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8 WHERE to_hex(id) = '2';
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..250.49 rows=17 width=20)
   Output: (json_depth(c1)), (json_depth(json_build_array(c1, c2))), (json_depth('[10, {"a": 20}]'::json)), (json_depth('1'::json)), (json_depth('true'::json))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_depth(c1), public.json_depth(json_build_array(c1, c2)), public.json_depth('[10, {"a": 20}]'::json), public.json_depth('1'::json), public.json_depth('true'::json), id FROM public.s8mysql
(5 rows)

-- select json_depth (builtin function, not pushdown constraints, result)
--Testcase 3663:
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8 WHERE to_hex(id) = '2';
 json_depth | json_depth | json_depth | json_depth | json_depth 
------------+------------+------------+------------+------------
          1 |          2 |          3 |          1 |          1
(1 row)

-- select json_depth (builtin function, pushdown constraints, explain)
--Testcase 3664:
EXPLAIN VERBOSE
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8 WHERE id != 0;
                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4474.07 rows=3396 width=20)
   Output: (json_depth(c1)), (json_depth(json_build_array(c1, c2))), (json_depth('[10, {"a": 20}]'::json)), (json_depth('1'::json)), (json_depth('true'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_depth(c1), public.json_depth(json_build_array(c1, c2)), public.json_depth('[10, {"a": 20}]'::json), public.json_depth('1'::json), public.json_depth('true'::json) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_depth (builtin function, pushdown constraints, result)
--Testcase 3665:
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8 WHERE id != 0;
 json_depth | json_depth | json_depth | json_depth | json_depth 
------------+------------+------------+------------+------------
          1 |          2 |          3 |          1 |          1
          1 |          2 |          3 |          1 |          1
          2 |          3 |          3 |          1 |          1
          3 |          4 |          3 |          1 |          1
          4 |          5 |          3 |          1 |          1
(5 rows)

-- select json_depth (builtin function, json_depth in constraints, explain)
--Testcase 3666:
EXPLAIN VERBOSE
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8 WHERE json_depth(c1) != 1;
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5327.32 rows=3396 width=20)
   Output: (json_depth(c1)), (json_depth(json_build_array(c1, c2))), (json_depth('[10, {"a": 20}]'::json)), (json_depth('1'::json)), (json_depth('true'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_depth(c1), public.json_depth(json_build_array(c1, c2)), public.json_depth('[10, {"a": 20}]'::json), public.json_depth('1'::json), public.json_depth('true'::json) FROM public.s8mysql WHERE ((public.json_depth(c1) <> 1))
(4 rows)

-- select json_depth (builtin function, json_depth in constraints, result)
--Testcase 3667:
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8 WHERE json_depth(c1) != 1;
 json_depth | json_depth | json_depth | json_depth | json_depth 
------------+------------+------------+------------+------------
          3 |          4 |          3 |          1 |          1
          2 |          3 |          3 |          1 |          1
          3 |          4 |          3 |          1 |          1
          4 |          5 |          3 |          1 |          1
(4 rows)

-- select json_depth (builtin function, json_depth in constraints, explain)
--Testcase 3668:
EXPLAIN VERBOSE
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8 WHERE json_depth('true') = 1;
                                                                                                                               QUERY PLAN                                                                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1027.54 rows=17 width=20)
   Output: (json_depth(c1)), (json_depth(json_build_array(c1, c2))), (json_depth('[10, {"a": 20}]'::json)), (json_depth('1'::json)), (json_depth('true'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_depth(c1), public.json_depth(json_build_array(c1, c2)), public.json_depth('[10, {"a": 20}]'::json), public.json_depth('1'::json), public.json_depth('true'::json) FROM public.s8mysql WHERE ((public.json_depth('true'::json) = 1))
(4 rows)

-- select json_depth (builtin function, json_depth in constraints, result)
--Testcase 3669:
SELECT json_depth(c1), json_depth(json_build_array(c1, c2)), json_depth('[10, {"a": 20}]'), json_depth('1'), json_depth('true') FROM s8 WHERE json_depth('true') = 1;
 json_depth | json_depth | json_depth | json_depth | json_depth 
------------+------------+------------+------------+------------
          3 |          4 |          3 |          1 |          1
          1 |          2 |          3 |          1 |          1
          1 |          2 |          3 |          1 |          1
          2 |          3 |          3 |          1 |          1
          3 |          4 |          3 |          1 |          1
          4 |          5 |          3 |          1 |          1
(6 rows)

-- select json_depth with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3670:
EXPLAIN VERBOSE
SELECT json_depth('[10, {"a": 20}]'), pi(), 4.1 FROM s8;
                                                           QUERY PLAN                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (json_depth('[10, {"a": 20}]'::json)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_depth('[10, {"a": 20}]'::json), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_depth with non pushdown func and explicit constant (result)
--Testcase 3671:
SELECT json_depth('[10, {"a": 20}]'), pi(), 4.1 FROM s8;
 json_depth |        pi         | ?column? 
------------+-------------------+----------
          3 | 3.141592653589793 |      4.1
          3 | 3.141592653589793 |      4.1
          3 | 3.141592653589793 |      4.1
          3 | 3.141592653589793 |      4.1
          3 | 3.141592653589793 |      4.1
          3 | 3.141592653589793 |      4.1
(6 rows)

-- select json_depth with order by index (result)
--Testcase 3672:
SELECT id,  json_depth(c1) FROM s8 ORDER BY 2, 1;
 id | json_depth 
----+------------
  1 |          1
  2 |          1
  3 |          2
  0 |          3
  4 |          3
  5 |          4
(6 rows)

-- select json_depth with order by index (result)
--Testcase 3673:
SELECT id,  json_depth(c1) FROM s8 ORDER BY 1, 2;
 id | json_depth 
----+------------
  0 |          3
  1 |          1
  2 |          1
  3 |          2
  4 |          3
  5 |          4
(6 rows)

-- select json_depth with group by (EXPLAIN)
--Testcase 3674:
EXPLAIN VERBOSE
SELECT count(id), json_depth(c1) FROM s8 group by json_depth(c1);
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_depth(c1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_depth(c1) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_depth with group by (result)
--Testcase 3675:
SELECT count(id), json_depth(c1) FROM s8 group by json_depth(c1);
 count | json_depth 
-------+------------
     2 |          3
     2 |          1
     1 |          2
     1 |          4
(4 rows)

-- select json_depth with group by index (result)
--Testcase 3676:
SELECT id,  json_depth(c1) FROM s8 group by 2, 1;
 id | json_depth 
----+------------
  0 |          3
  1 |          1
  2 |          1
  3 |          2
  4 |          3
  5 |          4
(6 rows)

-- select json_depth with group by index (result)
--Testcase 3677:
SELECT id,  json_depth(c1) FROM s8 group by 1, 2;
 id | json_depth 
----+------------
  0 |          3
  1 |          1
  2 |          1
  3 |          2
  4 |          3
  5 |          4
(6 rows)

-- select json_depth with group by having (EXPLAIN)
--Testcase 3678:
EXPLAIN VERBOSE
SELECT count(c2), json_depth(c1) FROM s8 group by json_depth(c1) HAVING count(c2) > 0;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_depth(c1))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_depth(c1) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_depth with group by having (result)
--Testcase 3679:
SELECT count(c2), json_depth(c1) FROM s8 group by json_depth(c1) HAVING count(c2) > 0;
 count | json_depth 
-------+------------
     2 |          3
     2 |          1
     1 |          2
     1 |          4
(4 rows)

-- select json_depth with group by index having (result)
--Testcase 3680:
SELECT c2,  json_depth(c1) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_depth 
----+------------
  1 |          3
  2 |          1
  3 |          1
  4 |          2
  5 |          3
  5 |          4
(6 rows)

-- select json_depth with group by index having (result)
--Testcase 3681:
SELECT c2,  json_depth(c1) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_depth 
----+------------
  1 |          3
  2 |          1
  3 |          1
  4 |          2
  5 |          3
  5 |          4
(6 rows)

-- select json_depth and as
--Testcase 3682:
SELECT json_depth('[10, {"a": 20}]') as json_depth1 FROM s8;
 json_depth1 
-------------
           3
           3
           3
           3
           3
           3
(6 rows)

-- select json_extract (builtin function, explain)
--Testcase 3683:
EXPLAIN VERBOSE
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8;
                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5357.49 rows=3413 width=160)
   Output: (json_extract(c1, VARIADIC '{$[1]}'::text[])), (json_extract((json_extract(c1, VARIADIC '{$[1],$[0]}'::text[]))::json, VARIADIC '{$[0]}'::text[])), (json_extract(c1, VARIADIC '{$.a}'::text[])), (json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[])), (json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_extract(c1, VARIADIC '{$[1]}'::text[]), public.json_extract(public.json_extract(c1, VARIADIC '{$[1],$[0]}'::text[])::json, VARIADIC '{$[0]}'::text[]), public.json_extract(c1, VARIADIC '{$.a}'::text[]), public.json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[]), public.json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]) FROM public.s8mysql
(4 rows)

-- select json_extract (builtin function, result)
--Testcase 3684:
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8;
     json_extract     |          json_extract           | json_extract |                       json_extract                        | json_extract 
----------------------+---------------------------------+--------------+-----------------------------------------------------------+--------------
 [3, 4]               | [3, 4]                          |              | [[1, 2], [3, 4], 5]                                       | 1
                      |                                 |              | []                                                        | 1
                      | {}                              |              | {}                                                        | 1
                      | {"a": "10", "b": "15", "x": 25} | "10"         | {"a": "10", "b": "15", "x": 25}                           | 1
                      | {"a": 1, "b": 2, "c": {"d": 4}} | 1            | {"a": 1, "b": 2, "c": {"d": 4}}                           | 1
 [{"k": "10"}, "def"] | [{"k": "10"}, "def"]            |              | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] | 1
(6 rows)

-- select json_extract (builtin function, not pushdown constraints, explain)
--Testcase 3685:
EXPLAIN VERBOSE
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..254.82 rows=17 width=160)
   Output: (json_extract(c1, VARIADIC '{$[1]}'::text[])), (json_extract((json_extract(c1, VARIADIC '{$[1],$[0]}'::text[]))::json, VARIADIC '{$[0]}'::text[])), (json_extract(c1, VARIADIC '{$.a}'::text[])), (json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[])), (json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_extract(c1, VARIADIC '{$[1]}'::text[]), public.json_extract(public.json_extract(c1, VARIADIC '{$[1],$[0]}'::text[])::json, VARIADIC '{$[0]}'::text[]), public.json_extract(c1, VARIADIC '{$.a}'::text[]), public.json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[]), public.json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]), id FROM public.s8mysql
(5 rows)

-- select json_extract (builtin function, not pushdown constraints, result)
--Testcase 3686:
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8 WHERE to_hex(id) = '2';
 json_extract | json_extract | json_extract | json_extract | json_extract 
--------------+--------------+--------------+--------------+--------------
              | {}           |              | {}           | 1
(1 row)

-- select json_extract (builtin function, pushdown constraints, explain)
--Testcase 3687:
EXPLAIN VERBOSE
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8 WHERE id != 0;
                                                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5340.05 rows=3396 width=160)
   Output: (json_extract(c1, VARIADIC '{$[1]}'::text[])), (json_extract((json_extract(c1, VARIADIC '{$[1],$[0]}'::text[]))::json, VARIADIC '{$[0]}'::text[])), (json_extract(c1, VARIADIC '{$.a}'::text[])), (json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[])), (json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_extract(c1, VARIADIC '{$[1]}'::text[]), public.json_extract(public.json_extract(c1, VARIADIC '{$[1],$[0]}'::text[])::json, VARIADIC '{$[0]}'::text[]), public.json_extract(c1, VARIADIC '{$.a}'::text[]), public.json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[]), public.json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_extract (builtin function, pushdown constraints, result)
--Testcase 3688:
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8 WHERE id != 0;
     json_extract     |          json_extract           | json_extract |                       json_extract                        | json_extract 
----------------------+---------------------------------+--------------+-----------------------------------------------------------+--------------
                      |                                 |              | []                                                        | 1
                      | {}                              |              | {}                                                        | 1
                      | {"a": "10", "b": "15", "x": 25} | "10"         | {"a": "10", "b": "15", "x": 25}                           | 1
                      | {"a": 1, "b": 2, "c": {"d": 4}} | 1            | {"a": 1, "b": 2, "c": {"d": 4}}                           | 1
 [{"k": "10"}, "def"] | [{"k": "10"}, "def"]            |              | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] | 1
(5 rows)

-- select json_extract (builtin function, json_extract in constraints, explain)
--Testcase 3689:
EXPLAIN VERBOSE
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8 WHERE json_extract(c1, '$[1]')::numeric != 1;
                                                                                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..6210.37 rows=3396 width=160)
   Output: (json_extract(c1, VARIADIC '{$[1]}'::text[])), (json_extract((json_extract(c1, VARIADIC '{$[1],$[0]}'::text[]))::json, VARIADIC '{$[0]}'::text[])), (json_extract(c1, VARIADIC '{$.a}'::text[])), (json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[])), (json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_extract(c1, VARIADIC '{$[1]}'::text[]), public.json_extract(public.json_extract(c1, VARIADIC '{$[1],$[0]}'::text[])::json, VARIADIC '{$[0]}'::text[]), public.json_extract(c1, VARIADIC '{$.a}'::text[]), public.json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[]), public.json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]) FROM public.s8mysql WHERE ((public.json_extract(c1, VARIADIC '{$[1]}'::text[])::numeric <> 1::numeric))
(4 rows)

-- select json_extract (builtin function, json_extract in constraints, result)
--Testcase 3690:
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8 WHERE json_extract(c1, '$[1]')::numeric != 1;
     json_extract     |     json_extract     | json_extract |                       json_extract                        | json_extract 
----------------------+----------------------+--------------+-----------------------------------------------------------+--------------
 [3, 4]               | [3, 4]               |              | [[1, 2], [3, 4], 5]                                       | 1
 [{"k": "10"}, "def"] | [{"k": "10"}, "def"] |              | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] | 1
(2 rows)

-- select json_extract (builtin function, json_extract in constraints, explain)
--Testcase 3691:
EXPLAIN VERBOSE
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8 WHERE json_extract('{"id": 1, "b": {"c": 30}}', '$.id')::numeric = 1;
                                                                                                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1048.94 rows=17 width=160)
   Output: (json_extract(c1, VARIADIC '{$[1]}'::text[])), (json_extract((json_extract(c1, VARIADIC '{$[1],$[0]}'::text[]))::json, VARIADIC '{$[0]}'::text[])), (json_extract(c1, VARIADIC '{$.a}'::text[])), (json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[])), (json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_extract(c1, VARIADIC '{$[1]}'::text[]), public.json_extract(public.json_extract(c1, VARIADIC '{$[1],$[0]}'::text[])::json, VARIADIC '{$[0]}'::text[]), public.json_extract(c1, VARIADIC '{$.a}'::text[]), public.json_extract(json_build_array(c1, c3), VARIADIC '{$[0]}'::text[]), public.json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[]) FROM public.s8mysql WHERE ((public.json_extract('{"id": 1, "b": {"c": 30}}'::json, VARIADIC '{$.id}'::text[])::numeric = 1::numeric))
(4 rows)

-- select json_extract (builtin function, json_extract in constraints, result)
--Testcase 3692:
SELECT json_extract(c1, '$[1]'), json_extract(json_extract(c1, '$[1]', '$[0]')::json, '$[0]'), json_extract(c1, '$.a'), json_extract(json_build_array(c1, c3), '$[0]'), json_extract('{"id": 1, "b": {"c": 30}}', '$.id') FROM s8 WHERE json_extract('{"id": 1, "b": {"c": 30}}', '$.id')::numeric = 1;
     json_extract     |          json_extract           | json_extract |                       json_extract                        | json_extract 
----------------------+---------------------------------+--------------+-----------------------------------------------------------+--------------
 [3, 4]               | [3, 4]                          |              | [[1, 2], [3, 4], 5]                                       | 1
                      |                                 |              | []                                                        | 1
                      | {}                              |              | {}                                                        | 1
                      | {"a": "10", "b": "15", "x": 25} | "10"         | {"a": "10", "b": "15", "x": 25}                           | 1
                      | {"a": 1, "b": 2, "c": {"d": 4}} | 1            | {"a": 1, "b": 2, "c": {"d": 4}}                           | 1
 [{"k": "10"}, "def"] | [{"k": "10"}, "def"]            |              | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] | 1
(6 rows)

-- select json_extract as nest function with agg (pushdown, explain)
--Testcase 3693:
EXPLAIN VERBOSE
SELECT sum(id),json_extract(json_build_array('{"id": 1, "b": {"c": 30}}', sum(id)), '$.id') FROM s8;
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_extract(json_build_array('{"id": 1, "b": {"c": 30}}', sum(id)), VARIADIC '{$.id}'::text[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_extract(json_build_array('{"id": 1, "b": {"c": 30}}', sum(id)), VARIADIC '{$.id}'::text[]) FROM public.s8mysql
(6 rows)

-- select json_extract as nest function with agg (pushdown, result)
--Testcase 3694:
SELECT sum(id),json_extract(json_build_array('{"id": 1, "b": {"c": 30}}', sum(id)), '$.id') FROM s8;
 sum | json_extract 
-----+--------------
  15 | 
(1 row)

-- select json_extract with abnormal cast
--Testcase 3695:
SELECT json_extract(c1, '$.a')::int FROM s8;  -- should fail
ERROR:  PGSpider can not get data from child node : mysql_svr
CONTEXT:  remote SQL command: CLOSE c1
ERROR:  PGSpider can not get data from child node : pgspider_svr
-- select json_extract with normal cast
--Testcase 3696:
SELECT json_extract('{"a": "2000-01-01"}', '$.a')::timestamp, json_extract('{"a": "2000-01-01"}', '$.a')::date , json_extract('{"a": 1234}', '$.a')::bigint, json_extract('{"a": "b"}', '$.a')::text FROM s8;
    json_extract     | json_extract | json_extract | json_extract 
---------------------+--------------+--------------+--------------
 2000-01-01 00:00:00 | 2000-01-01   |         1234 | "b"
 2000-01-01 00:00:00 | 2000-01-01   |         1234 | "b"
 2000-01-01 00:00:00 | 2000-01-01   |         1234 | "b"
 2000-01-01 00:00:00 | 2000-01-01   |         1234 | "b"
 2000-01-01 00:00:00 | 2000-01-01   |         1234 | "b"
 2000-01-01 00:00:00 | 2000-01-01   |         1234 | "b"
(6 rows)

-- select json_extract with normal cast
--Testcase 3697:
SELECT json_extract('{"a": "2000-01-01"}', '$.a')::timestamptz, json_extract('{"a": "12:10:20.123456"}', '$.a')::time , json_extract('{"a": "12:10:20.123456"}', '$.a')::timetz FROM s8;
      json_extract      |  json_extract   |    json_extract    
------------------------+-----------------+--------------------
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
(6 rows)

-- select json_extract with type modifier (explain)
--Testcase 3698:
EXPLAIN VERBOSE
SELECT json_extract('{"a": "2000-01-01 12:02:01.123456"}', '$.a')::timestamp(3), json_extract('{"a": "2000-01-01 12:02:01.123456"}', '$.a')::timestamptz(3), json_extract('{"a": "12:10:20.123456"}', '$.a')::time(3), json_extract('{"a": "12:10:20.123456"}', '$.a')::timetz(3) FROM s8;
                                                                                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3727.78 rows=3413 width=36)
   Output: ((json_extract('{"a": "2000-01-01 12:02:01.123456"}'::json, VARIADIC '{$.a}'::text[]))::timestamp(3) without time zone), ((json_extract('{"a": "2000-01-01 12:02:01.123456"}'::json, VARIADIC '{$.a}'::text[]))::timestamp(3) with time zone), ((json_extract('{"a": "12:10:20.123456"}'::json, VARIADIC '{$.a}'::text[]))::time(3) without time zone), ((json_extract('{"a": "12:10:20.123456"}'::json, VARIADIC '{$.a}'::text[]))::time(3) with time zone)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_extract('{"a": "2000-01-01 12:02:01.123456"}'::json, VARIADIC '{$.a}'::text[])::timestamp(3) without time zone, public.json_extract('{"a": "2000-01-01 12:02:01.123456"}'::json, VARIADIC '{$.a}'::text[])::timestamp(3) with time zone, public.json_extract('{"a": "12:10:20.123456"}'::json, VARIADIC '{$.a}'::text[])::time(3) without time zone, public.json_extract('{"a": "12:10:20.123456"}'::json, VARIADIC '{$.a}'::text[])::time(3) with time zone FROM public.s8mysql
(4 rows)

-- select json_extract with type modifier (result)
--Testcase 3699:
SELECT json_extract('{"a": "2000-01-01 12:02:01.123456"}', '$.a')::timestamp(3), json_extract('{"a": "2000-01-01 12:02:01.123456"}', '$.a')::timestamptz(3), json_extract('{"a": "12:10:20.123456"}', '$.a')::time(3), json_extract('{"a": "12:10:20.123456"}', '$.a')::timetz(3) FROM s8;
      json_extract       |        json_extract        | json_extract |  json_extract   
-------------------------+----------------------------+--------------+-----------------
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
(6 rows)

-- select json_extract with type modifier (explain)
--Testcase 3700:
EXPLAIN VERBOSE
SELECT json_extract('{"a": 100}', '$.a')::numeric(10, 2), json_extract('{"a": 100}', '$.a')::decimal(10, 2), json_unquote(json_extract('{"a": "1.123456"}', '$.a'))::numeric(10, 3) FROM s8;
                                                                                                                                 QUERY PLAN                                                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3702.18 rows=3413 width=48)
   Output: ((json_extract('{"a": 100}'::json, VARIADIC '{$.a}'::text[]))::numeric(10,2)), ((json_extract('{"a": 100}'::json, VARIADIC '{$.a}'::text[]))::numeric(10,2)), ((json_unquote(json_extract('{"a": "1.123456"}'::json, VARIADIC '{$.a}'::text[])))::numeric(10,3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_extract('{"a": 100}'::json, VARIADIC '{$.a}'::text[])::numeric(10,2), public.json_unquote(public.json_extract('{"a": "1.123456"}'::json, VARIADIC '{$.a}'::text[]))::numeric(10,3) FROM public.s8mysql
(4 rows)

-- select json_extract with type modifier (result)
--Testcase 3701:
SELECT json_extract('{"a": 100}', '$.a')::numeric(10, 2), json_extract('{"a": 100}', '$.a')::decimal(10, 2), json_unquote(json_extract('{"a": "1.123456"}', '$.a'))::numeric(10, 3) FROM s8;
 json_extract | json_extract | json_unquote 
--------------+--------------+--------------
       100.00 |       100.00 |        1.123
       100.00 |       100.00 |        1.123
       100.00 |       100.00 |        1.123
       100.00 |       100.00 |        1.123
       100.00 |       100.00 |        1.123
       100.00 |       100.00 |        1.123
(6 rows)

-- select json_extract with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3702:
EXPLAIN VERBOSE
SELECT json_extract(c1, '$.a'), pi(), 4.1 FROM s8;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_extract(c1, VARIADIC '{$.a}'::text[])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_extract(c1, VARIADIC '{$.a}'::text[]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_extract with non pushdown func and explicit constant (result)
--Testcase 3703:
SELECT json_extract(c1, '$.a'), pi(), 4.1 FROM s8;
 json_extract |        pi         | ?column? 
--------------+-------------------+----------
              | 3.141592653589793 |      4.1
              | 3.141592653589793 |      4.1
              | 3.141592653589793 |      4.1
 "10"         | 3.141592653589793 |      4.1
 1            | 3.141592653589793 |      4.1
              | 3.141592653589793 |      4.1
(6 rows)

-- select json_extract with order by index (result)
--Testcase 3704:
SELECT id,  json_extract(c1, '$[1]') FROM s8 ORDER BY 2, 1;
 id |     json_extract     
----+----------------------
  0 | [3, 4]
  5 | [{"k": "10"}, "def"]
  1 | 
  2 | 
  3 | 
  4 | 
(6 rows)

-- select json_extract with order by index (result)
--Testcase 3705:
SELECT id,  json_extract(c1, '$[1]') FROM s8 ORDER BY 1, 2;
 id |     json_extract     
----+----------------------
  0 | [3, 4]
  1 | 
  2 | 
  3 | 
  4 | 
  5 | [{"k": "10"}, "def"]
(6 rows)

-- select json_extract with group by (EXPLAIN)
--Testcase 3706:
EXPLAIN VERBOSE
SELECT count(id), json_extract(c1, '$[1]') FROM s8 group by json_extract(c1, '$[1]');
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(id)), (json_extract(c1, VARIADIC '{$[1]}'::text[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_extract(c1, VARIADIC '{$[1]}'::text[]) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_extract with group by (result)
--Testcase 3707:
SELECT count(id), json_extract(c1, '$[1]') FROM s8 group by json_extract(c1, '$[1]');
 count |     json_extract     
-------+----------------------
     1 | [3, 4]
     4 | 
     1 | [{"k": "10"}, "def"]
(3 rows)

-- select json_extract with group by index (result)
--Testcase 3708:
SELECT id,  json_extract(c1, '$[1]') FROM s8 group by 2, 1;
 id |     json_extract     
----+----------------------
  0 | [3, 4]
  1 | 
  2 | 
  3 | 
  4 | 
  5 | [{"k": "10"}, "def"]
(6 rows)

-- select json_extract with group by index (result)
--Testcase 3709:
SELECT id,  json_extract(c1, '$[1]') FROM s8 group by 1, 2;
 id |     json_extract     
----+----------------------
  0 | [3, 4]
  1 | 
  2 | 
  3 | 
  4 | 
  5 | [{"k": "10"}, "def"]
(6 rows)

-- select json_extract with group by having (EXPLAIN)
--Testcase 3710:
EXPLAIN VERBOSE
SELECT count(c2), json_extract(c1, '$[1]') FROM s8 group by json_extract(c1, '$[1]') HAVING count(c2) > 0;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(c2)), (json_extract(c1, VARIADIC '{$[1]}'::text[]))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_extract(c1, VARIADIC '{$[1]}'::text[]) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_extract with group by having (result)
--Testcase 3711:
SELECT count(c2), json_extract(c1, '$[1]') FROM s8 group by json_extract(c1, '$[1]') HAVING count(c2) > 0;
 count |     json_extract     
-------+----------------------
     1 | [3, 4]
     4 | 
     1 | [{"k": "10"}, "def"]
(3 rows)

-- select json_extract with group by index having (result)
--Testcase 3712:
SELECT c2,  json_extract(c1, '$[1]') FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 |     json_extract     
----+----------------------
  1 | [3, 4]
  2 | 
  3 | 
  4 | 
  5 | 
  5 | [{"k": "10"}, "def"]
(6 rows)

-- select json_extract with group by index having (result)
--Testcase 3713:
SELECT c2,  json_extract(c1, '$[1]') FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 |     json_extract     
----+----------------------
  1 | [3, 4]
  2 | 
  3 | 
  4 | 
  5 | 
  5 | [{"k": "10"}, "def"]
(6 rows)

-- select json_extract and as
--Testcase 3714:
SELECT json_extract(c1, '$.a') as json_extract1 FROM s8;
 json_extract1 
---------------
 
 
 
 "10"
 1
 
(6 rows)

-- JSON_INSERT()
-- select json_insert (stub function, explain)
--Testcase 3715:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_insert (stub function, result)
--Testcase 3716:
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
                        json_insert                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3, "b": "text", "c": 1}
 {"a": "10", "b": "15", "c": 1, "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- select json_insert (stub function, not pushdown constraints, explain)
--Testcase 3717:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, pi()') FROM s8 WHERE to_hex(id) = '1';
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..233.44 rows=17 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', pi()"}'::path_value[]))
   Filter: (to_hex(s8.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', pi()"}'::public.path_value[]), id FROM public.s8mysql
(5 rows)

-- select json_insert (stub function, not pushdown constraints, result)
--Testcase 3718:
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, pi()') FROM s8 WHERE to_hex(id) = '1';
 json_insert 
-------------
 []
(1 row)

-- select json_insert (stub function, pushdown constraints, explain)
--Testcase 3719:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..157.25 rows=17 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', CAST(\"[true, false]\" AS JSON)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC E'{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', CAST(\\"[true, false]\\" AS JSON)"}'::public.path_value[]) FROM public.s8mysql WHERE ((id = 1))
(4 rows)

-- select json_insert (stub function, pushdown constraints, result)
--Testcase 3720:
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
 json_insert 
-------------
 []
(1 row)

-- select json_insert (stub function, stub in constraints, explain)
--Testcase 3721:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, "[true, false]"') FROM s8 WHERE log2(id) > 1;
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1321.71 rows=1138 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', ''[true, false]''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', ''[true, false]''"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.log2(id) > 1::double precision))
(4 rows)

-- select json_insert (stub function, stub in constraints, result)
--Testcase 3722:
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, "[true, false]"') FROM s8 WHERE log2(id) > 1;
                        json_insert                        
-----------------------------------------------------------
 {"a": "10", "b": "15", "c": null, "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(3 rows)

-- select json_insert (stub function, stub in constraints, explain)
--Testcase 3723:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8 WHERE json_depth(json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()')) > 0;
                                                                                                                                                                 QUERY PLAN                                                                                                                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2166.42 rows=1138 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.json_depth(public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[])) > 0))
(4 rows)

-- select json_insert (stub function, stub in constraints, result)
--Testcase 3724:
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8 WHERE json_depth(json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()')) > 0;
                        json_insert                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3, "b": "text", "c": 1}
 {"a": "10", "b": "15", "c": 1, "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_insert with 1 arg explain
--Testcase 3725:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2') FROM s8;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_insert with 1 arg result
--Testcase 3726:
SELECT json_insert(c1, '$.a, c2') FROM s8;
                        json_insert                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_insert with 2 args explain
--Testcase 3727:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3') FROM s8;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_insert with 2 args result
--Testcase 3728:
SELECT json_insert(c1, '$.a, c2', '$.b, c3') FROM s8;
                        json_insert                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3, "b": "text"}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_insert with 3 args explain
--Testcase 3729:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1') FROM s8;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_insert with 3 args result
--Testcase 3730:
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1') FROM s8;
                        json_insert                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3, "b": "text", "c": 1}
 {"a": "10", "b": "15", "c": 1, "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_insert with 4 args explain
--Testcase 3731:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"') FROM s8;
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_insert with 4 args result
--Testcase 3732:
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"') FROM s8;
                        json_insert                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3, "b": "text", "c": 1}
 {"a": "10", "b": "15", "c": 1, "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_insert with 5 args explain
--Testcase 3733:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_insert with 5 args result
--Testcase 3734:
SELECT json_insert(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
                        json_insert                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3, "b": "text", "c": 1}
 {"a": "10", "b": "15", "c": 1, "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- select json_insert as nest function with agg (pushdown, explain)
--Testcase 3735:
EXPLAIN VERBOSE
SELECT sum(id),json_insert('["a", ["b", "c"], "d"]', '$, sum(id)') FROM s8;
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', sum(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', sum(id)"}'::public.path_value[]) FROM public.s8mysql
(6 rows)

-- select json_insert as nest function with agg (pushdown, result)
--Testcase 3736:
SELECT sum(id),json_insert('["a", ["b", "c"], "d"]', '$, sum(id)') FROM s8;
 sum |      json_insert       
-----+------------------------
  15 | ["a", ["b", "c"], "d"]
(1 row)

-- select json_insert as nest function with json_build_array (pushdown, explain)
--Testcase 3737:
EXPLAIN VERBOSE
SELECT json_insert(json_build_array('["a", ["b", "c"], "d"]', c1), '$, log2(id)') FROM s8;
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=32)
   Output: (json_insert(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$'', log2(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$'', log2(id)"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_insert as nest function with agg (pushdown, result)
--Testcase 3738:
SELECT json_insert(json_build_array('["a", ["b", "c"], "d"]', c1), '$, log2(id)') FROM s8;
                                          json_insert                                          
-----------------------------------------------------------------------------------------------
 ["[\"a\", [\"b\", \"c\"], \"d\"]", [[1, 2], [3, 4], 5]]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", []]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", {}]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", {"a": "10", "b": "15", "x": 25}]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", {"a": 1, "b": 2, "c": {"d": 4}}]
 ["[\"a\", [\"b\", \"c\"], \"d\"]", ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]]
(6 rows)

-- select json_insert with non pushdown func and explicit constant (explain)
--Testcase 3739:
EXPLAIN VERBOSE
SELECT json_insert(c1, '$.a, c2'), pi(), 4.1 FROM s8;
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_insert(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_insert(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_insert with non pushdown func and explicit constant (result)
--Testcase 3740:
SELECT json_insert(c1, '$.a, c2'), pi(), 4.1 FROM s8;
                        json_insert                        |        pi         | ?column? 
-----------------------------------------------------------+-------------------+----------
 [[1, 2], [3, 4], 5]                                       | 3.141592653589793 |      4.1
 []                                                        | 3.141592653589793 |      4.1
 {"a": 3}                                                  | 3.141592653589793 |      4.1
 {"a": "10", "b": "15", "x": 25}                           | 3.141592653589793 |      4.1
 {"a": 1, "b": 2, "c": {"d": 4}}                           | 3.141592653589793 |      4.1
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] | 3.141592653589793 |      4.1
(6 rows)

-- select json_insert with order by (explain)
--Testcase 3741:
EXPLAIN VERBOSE
SELECT json_length(json_insert(c1, '$.a, c2')) FROM s8 ORDER BY 1;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=4)
   Output: (json_length(json_insert(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
   Sort Key: (json_length(json_insert(s8.c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
   ->  Foreign Scan on public.s8  (cost=100.00..1918.89 rows=3413 width=4)
         Output: (json_length(json_insert(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.json_length(public.json_insert(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[])) FROM public.s8mysql
(7 rows)

-- select json_insert with order by (result)
--Testcase 3742:
SELECT json_length(json_insert(c1, '$.a, c2')) FROM s8 ORDER BY 1;
 json_length 
-------------
           0
           1
           3
           3
           3
           4
(6 rows)

-- select json_insert with group by (explain)
--Testcase 3743:
EXPLAIN VERBOSE
SELECT json_length(json_insert('["a", ["b", "c"], "d"]', '$, id')) FROM s8 GROUP BY id, 1;
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: (json_length(json_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', id"}'::path_value[]))), id
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_length(public.json_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', id"}'::public.path_value[])), id FROM public.s8mysql GROUP BY 2, 1
(6 rows)

-- select json_insert with group by (result)
--Testcase 3744:
SELECT json_length(json_insert('["a", ["b", "c"], "d"]', '$, id')) FROM s8 GROUP BY id, 1;
 json_length 
-------------
           3
           3
           3
           3
           3
           3
(6 rows)

-- select json_insert with group by having (explain)
--Testcase 3745:
EXPLAIN VERBOSE
SELECT json_depth(json_insert('["a", ["b", "c"], "d"]', '$, c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (json_depth(json_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', c2"}'::path_value[]))), c2
   Filter: ((count(s8.c2)) > 1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_depth(public.json_insert('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', c2"}'::public.path_value[])), c2, count(c2) FROM public.s8mysql GROUP BY 2, 1
(7 rows)

-- select json_insert with group by having (result)
--Testcase 3746:
SELECT json_depth(json_insert('["a", ["b", "c"], "d"]', '$, c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
 json_depth 
------------
          3
(1 row)

-- select json_insert and as
--Testcase 3747:
SELECT json_insert(c1, '$.a, c2') AS json_insert1 FROM s8;
                       json_insert1                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3}
 {"a": "10", "b": "15", "x": 25}
 {"a": 1, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- JSON_KEYS()
-- select json_keys (builtin function, explain)
--Testcase 3748:
EXPLAIN VERBOSE
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.a') FROM s8;
                                                                                                                                 QUERY PLAN                                                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4495.70 rows=3413 width=160)
   Output: (json_keys(c1)), (json_keys(c1, '$'::text)), (json_keys(json_build_object('a', c3))), (json_keys(json_build_object('a', c3), '$.a'::text)), (json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.a'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_keys(c1), public.json_keys(c1, '$'::text), public.json_keys(json_build_object('a', c3)), public.json_keys(json_build_object('a', c3), '$.a'::text), public.json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.a'::text) FROM public.s8mysql
(4 rows)

-- select json_keys (builtin function, result)
--Testcase 3749:
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.a') FROM s8;
    json_keys    |    json_keys    | json_keys | json_keys | json_keys 
-----------------+-----------------+-----------+-----------+-----------
                 |                 | ["a"]     |           | 
                 |                 | ["a"]     |           | 
 []              | []              | ["a"]     |           | 
 ["a", "b", "x"] | ["a", "b", "x"] | ["a"]     |           | 
 ["a", "b", "c"] | ["a", "b", "c"] | ["a"]     |           | 
                 |                 | ["a"]     |           | 
(6 rows)

-- select json_keys (builtin function, not pushdown constraints, explain)
--Testcase 3750:
EXPLAIN VERBOSE
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.a') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                   QUERY PLAN                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..250.53 rows=17 width=160)
   Output: (json_keys(c1)), (json_keys(c1, '$'::text)), (json_keys(json_build_object('a', c3))), (json_keys(json_build_object('a', c3), '$.a'::text)), (json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.a'::text))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_keys(c1), public.json_keys(c1, '$'::text), public.json_keys(json_build_object('a', c3)), public.json_keys(json_build_object('a', c3), '$.a'::text), public.json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.a'::text), id FROM public.s8mysql
(5 rows)

-- select json_keys (builtin function, not pushdown constraints, result)
--Testcase 3751:
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.a') FROM s8 WHERE to_hex(id) = '2';
 json_keys | json_keys | json_keys | json_keys | json_keys 
-----------+-----------+-----------+-----------+-----------
 []        | []        | ["a"]     |           | 
(1 row)

-- select json_keys (builtin function, pushdown constraints, explain)
--Testcase 3752:
EXPLAIN VERBOSE
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.a') FROM s8 WHERE id != 0;
                                                                                                                                          QUERY PLAN                                                                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4482.56 rows=3396 width=160)
   Output: (json_keys(c1)), (json_keys(c1, '$'::text)), (json_keys(json_build_object('a', c3))), (json_keys(json_build_object('a', c3), '$.a'::text)), (json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.a'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_keys(c1), public.json_keys(c1, '$'::text), public.json_keys(json_build_object('a', c3)), public.json_keys(json_build_object('a', c3), '$.a'::text), public.json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.a'::text) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_keys (builtin function, pushdown constraints, result)
--Testcase 3753:
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.a') FROM s8 WHERE id != 0;
    json_keys    |    json_keys    | json_keys | json_keys | json_keys 
-----------------+-----------------+-----------+-----------+-----------
                 |                 | ["a"]     |           | 
 []              | []              | ["a"]     |           | 
 ["a", "b", "x"] | ["a", "b", "x"] | ["a"]     |           | 
 ["a", "b", "c"] | ["a", "b", "c"] | ["a"]     |           | 
                 |                 | ["a"]     |           | 
(5 rows)

-- select json_keys (builtin function, json_keys in constraints, explain)
--Testcase 3754:
EXPLAIN VERBOSE
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.b') FROM s8 WHERE json_length(json_keys(c1)) != 1;
                                                                                                                                                             QUERY PLAN                                                                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..6189.06 rows=3396 width=160)
   Output: (json_keys(c1)), (json_keys(c1, '$'::text)), (json_keys(json_build_object('a', c3))), (json_keys(json_build_object('a', c3), '$.a'::text)), (json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.b'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_keys(c1), public.json_keys(c1, '$'::text), public.json_keys(json_build_object('a', c3)), public.json_keys(json_build_object('a', c3), '$.a'::text), public.json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.b'::text) FROM public.s8mysql WHERE ((public.json_length(public.json_keys(c1)) <> 1))
(4 rows)

-- select json_keys (builtin function, json_keys in constraints, result)
--Testcase 3755:
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.b') FROM s8 WHERE json_length(json_keys(c1)) != 1;
    json_keys    |    json_keys    | json_keys | json_keys | json_keys 
-----------------+-----------------+-----------+-----------+-----------
 []              | []              | ["a"]     |           | ["c"]
 ["a", "b", "x"] | ["a", "b", "x"] | ["a"]     |           | ["c"]
 ["a", "b", "c"] | ["a", "b", "c"] | ["a"]     |           | ["c"]
(3 rows)

-- select json_keys (builtin function, json_keys in constraints, explain)
--Testcase 3756:
EXPLAIN VERBOSE
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.b') FROM s8 WHERE json_length(json_keys('{"a": 1, "b": {"c": 30}}', '$.b')) = 1;
                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1880.84 rows=17 width=160)
   Output: (json_keys(c1)), (json_keys(c1, '$'::text)), (json_keys(json_build_object('a', c3))), (json_keys(json_build_object('a', c3), '$.a'::text)), (json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.b'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_keys(c1), public.json_keys(c1, '$'::text), public.json_keys(json_build_object('a', c3)), public.json_keys(json_build_object('a', c3), '$.a'::text), public.json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.b'::text) FROM public.s8mysql WHERE ((public.json_length(public.json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.b'::text)) = 1))
(4 rows)

-- select json_keys (builtin function, json_keys in constraints, result)
--Testcase 3757:
SELECT json_keys(c1), json_keys(c1, '$'), json_keys(json_build_object('a', c3)), json_keys(json_build_object('a', c3), '$.a'), json_keys('{"a": 1, "b": {"c": 30}}', '$.b') FROM s8 WHERE json_length(json_keys('{"a": 1, "b": {"c": 30}}', '$.b')) = 1;
    json_keys    |    json_keys    | json_keys | json_keys | json_keys 
-----------------+-----------------+-----------+-----------+-----------
                 |                 | ["a"]     |           | ["c"]
                 |                 | ["a"]     |           | ["c"]
 []              | []              | ["a"]     |           | ["c"]
 ["a", "b", "x"] | ["a", "b", "x"] | ["a"]     |           | ["c"]
 ["a", "b", "c"] | ["a", "b", "c"] | ["a"]     |           | ["c"]
                 |                 | ["a"]     |           | ["c"]
(6 rows)

-- select json_keys as nest function with agg (pushdown, explain)
--Testcase 3758:
EXPLAIN VERBOSE
SELECT sum(id),json_keys('{"a": 1, "b": {"c": 30}}', '$.b') FROM s8;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.b'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_keys('{"a": 1, "b": {"c": 30}}'::json, '$.b'::text) FROM public.s8mysql
(6 rows)

-- select json_keys as nest function with agg (pushdown, result)
--Testcase 3759:
SELECT sum(id),json_keys('{"a": 1, "b": {"c": 30}}', '$.b') FROM s8;
 sum | json_keys 
-----+-----------
  15 | ["c"]
(1 row)

-- select json_keys with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3760:
EXPLAIN VERBOSE
SELECT json_keys(json_build_object('a', c3)), pi(), 4.1 FROM s8;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (json_keys(json_build_object('a', c3))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_keys(json_build_object('a', c3)), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_keys with non pushdown func and explicit constant (result)
--Testcase 3761:
SELECT json_keys(json_build_object('a', c3)), pi(), 4.1 FROM s8;
 json_keys |        pi         | ?column? 
-----------+-------------------+----------
 ["a"]     | 3.141592653589793 |      4.1
 ["a"]     | 3.141592653589793 |      4.1
 ["a"]     | 3.141592653589793 |      4.1
 ["a"]     | 3.141592653589793 |      4.1
 ["a"]     | 3.141592653589793 |      4.1
 ["a"]     | 3.141592653589793 |      4.1
(6 rows)

-- select json_keys with order by index (result)
--Testcase 3762:
SELECT id,  json_length(json_keys(c1)) FROM s8 ORDER BY 2, 1;
 id | json_length 
----+-------------
  2 |           0
  3 |           3
  4 |           3
  0 |            
  1 |            
  5 |            
(6 rows)

-- select json_keys with order by index (result)
--Testcase 3763:
SELECT id,  json_length(json_keys(c1)) FROM s8 ORDER BY 1, 2;
 id | json_length 
----+-------------
  0 |            
  1 |            
  2 |           0
  3 |           3
  4 |           3
  5 |            
(6 rows)

-- select json_keys with group by (EXPLAIN)
--Testcase 3764:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_keys(c1)) FROM s8 group by json_length(json_keys(c1));
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_keys(c1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_length(public.json_keys(c1)) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_keys with group by (result)
--Testcase 3765:
SELECT count(id), json_length(json_keys(c1)) FROM s8 group by json_length(json_keys(c1));
 count | json_length 
-------+-------------
     3 |            
     1 |           0
     2 |           3
(3 rows)

-- select json_keys with group by index (result)
--Testcase 3766:
SELECT id,  json_length(json_keys(c1)) FROM s8 group by 2, 1;
 id | json_length 
----+-------------
  0 |            
  1 |            
  2 |           0
  3 |           3
  4 |           3
  5 |            
(6 rows)

-- select json_keys with group by index (result)
--Testcase 3767:
SELECT id,  json_length(json_keys(c1)) FROM s8 group by 1, 2;
 id | json_length 
----+-------------
  0 |            
  1 |            
  2 |           0
  3 |           3
  4 |           3
  5 |            
(6 rows)

-- select json_keys with group by having (EXPLAIN)
--Testcase 3768:
EXPLAIN VERBOSE
SELECT count(c2), json_length(json_keys(c1)) FROM s8 group by json_length(json_keys(c1)) HAVING count(c2) > 0;
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_length(json_keys(c1)))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_length(public.json_keys(c1)) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_keys with group by having (result)
--Testcase 3769:
SELECT count(c2), json_length(json_keys(c1)) FROM s8 group by json_length(json_keys(c1)) HAVING count(c2) > 0;
 count | json_length 
-------+-------------
     3 |            
     1 |           0
     2 |           3
(3 rows)

-- select json_keys with group by index having (result)
--Testcase 3770:
SELECT c2,  json_length(json_keys(c1)) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |            
  2 |            
  3 |           0
  4 |           3
  5 |           3
  5 |            
(6 rows)

-- select json_keys with group by index having (result)
--Testcase 3771:
SELECT c2,  json_length(json_keys(c1)) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |            
  2 |            
  3 |           0
  4 |           3
  5 |           3
  5 |            
(6 rows)

-- select json_keys and as
--Testcase 3772:
SELECT json_keys(json_build_object('a', c3)) as json_keys1 FROM s8;
 json_keys1 
------------
 ["a"]
 ["a"]
 ["a"]
 ["a"]
 ["a"]
 ["a"]
(6 rows)

-- select json_length (builtin function, explain)
--Testcase 3773:
EXPLAIN VERBOSE
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2780.67 rows=3413 width=12)
   Output: (json_length(c1)), (json_length(json_build_array(c1, 'a', c2))), (json_length('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_length(c1), public.json_length(json_build_array(c1, 'a', c2)), public.json_length('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql
(4 rows)

-- select json_length (builtin function, result)
--Testcase 3774:
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8;
 json_length | json_length | json_length 
-------------+-------------+-------------
           3 |           3 |           2
           0 |           3 |           2
           0 |           3 |           2
           3 |           3 |           2
           3 |           3 |           2
           4 |           3 |           2
(6 rows)

-- select json_length (builtin function, not pushdown constraints, explain)
--Testcase 3775:
EXPLAIN VERBOSE
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE to_hex(id) = '2';
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..241.99 rows=17 width=12)
   Output: (json_length(c1)), (json_length(json_build_array(c1, 'a', c2))), (json_length('{"a": 1, "b": {"c": 30}}'::json))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_length(c1), public.json_length(json_build_array(c1, 'a', c2)), public.json_length('{"a": 1, "b": {"c": 30}}'::json), id FROM public.s8mysql
(5 rows)

-- select json_length (builtin function, not pushdown constraints, result)
--Testcase 3776:
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE to_hex(id) = '2';
 json_length | json_length | json_length 
-------------+-------------+-------------
           0 |           3 |           2
(1 row)

-- select json_length (builtin function, pushdown constraints, explain)
--Testcase 3777:
EXPLAIN VERBOSE
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE id != 0;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2776.07 rows=3396 width=12)
   Output: (json_length(c1)), (json_length(json_build_array(c1, 'a', c2))), (json_length('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_length(c1), public.json_length(json_build_array(c1, 'a', c2)), public.json_length('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_length (builtin function, pushdown constraints, result)
--Testcase 3778:
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE id != 0;
 json_length | json_length | json_length 
-------------+-------------+-------------
           0 |           3 |           2
           0 |           3 |           2
           3 |           3 |           2
           3 |           3 |           2
           4 |           3 |           2
(5 rows)

-- select json_length (builtin function, json_length in constraints, explain)
--Testcase 3779:
EXPLAIN VERBOSE
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_length(c1) != 1;
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3629.32 rows=3396 width=12)
   Output: (json_length(c1)), (json_length(json_build_array(c1, 'a', c2))), (json_length('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_length(c1), public.json_length(json_build_array(c1, 'a', c2)), public.json_length('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql WHERE ((public.json_length(c1) <> 1))
(4 rows)

-- select json_length (builtin function, json_length in constraints, result)
--Testcase 3780:
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_length(c1) != 1;
 json_length | json_length | json_length 
-------------+-------------+-------------
           3 |           3 |           2
           0 |           3 |           2
           0 |           3 |           2
           3 |           3 |           2
           3 |           3 |           2
           4 |           3 |           2
(6 rows)

-- select json_length (builtin function, json_length in constraints, explain)
--Testcase 3781:
EXPLAIN VERBOSE
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_length('{"a": 1, "b": {"c": 30}}') = 2;
                                                                                                                  QUERY PLAN                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1019.04 rows=17 width=12)
   Output: (json_length(c1)), (json_length(json_build_array(c1, 'a', c2))), (json_length('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_length(c1), public.json_length(json_build_array(c1, 'a', c2)), public.json_length('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql WHERE ((public.json_length('{"a": 1, "b": {"c": 30}}'::json) = 2))
(4 rows)

-- select json_length (builtin function, json_length in constraints, result)
--Testcase 3782:
SELECT json_length(c1), json_length(json_build_array(c1, 'a', c2)), json_length('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_length('{"a": 1, "b": {"c": 30}}') = 2;
 json_length | json_length | json_length 
-------------+-------------+-------------
           3 |           3 |           2
           0 |           3 |           2
           0 |           3 |           2
           3 |           3 |           2
           3 |           3 |           2
           4 |           3 |           2
(6 rows)

-- select json_length as nest function with agg (pushdown, explain)
--Testcase 3783:
EXPLAIN VERBOSE
SELECT sum(id),json_length('{"a": 1, "b": {"c": 30}}') FROM s8;
                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (sum(id)), (json_length('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_length('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql
(6 rows)

-- select json_length as nest function with agg (pushdown, result)
--Testcase 3784:
SELECT sum(id),json_length('{"a": 1, "b": {"c": 30}}') FROM s8;
 sum | json_length 
-----+-------------
  15 |           2
(1 row)

-- select json_length with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3785:
EXPLAIN VERBOSE
SELECT json_length(json_build_array(c1, 'a', c2)), pi(), 4.1 FROM s8;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (json_length(json_build_array(c1, 'a', c2))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_length(json_build_array(c1, 'a', c2)), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_length with non pushdown func and explicit constant (result)
--Testcase 3786:
SELECT json_length(json_build_array(c1, 'a', c2)), pi(), 4.1 FROM s8;
 json_length |        pi         | ?column? 
-------------+-------------------+----------
           3 | 3.141592653589793 |      4.1
           3 | 3.141592653589793 |      4.1
           3 | 3.141592653589793 |      4.1
           3 | 3.141592653589793 |      4.1
           3 | 3.141592653589793 |      4.1
           3 | 3.141592653589793 |      4.1
(6 rows)

-- select json_length with order by index (result)
--Testcase 3787:
SELECT id, json_length(c1) FROM s8 ORDER BY 2, 1;
 id | json_length 
----+-------------
  1 |           0
  2 |           0
  0 |           3
  3 |           3
  4 |           3
  5 |           4
(6 rows)

-- select json_length with order by index (result)
--Testcase 3788:
SELECT id, json_length(c1) FROM s8 ORDER BY 1, 2;
 id | json_length 
----+-------------
  0 |           3
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           4
(6 rows)

-- select json_length with group by (EXPLAIN)
--Testcase 3789:
EXPLAIN VERBOSE
SELECT count(id), json_length(c1) FROM s8 group by json_length(c1);
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(c1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_length(c1) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_length with group by (result)
--Testcase 3790:
SELECT count(id), json_length(c1) FROM s8 group by json_length(c1);
 count | json_length 
-------+-------------
     3 |           3
     2 |           0
     1 |           4
(3 rows)

-- select json_length with group by index (result)
--Testcase 3791:
SELECT id, json_length(c1) FROM s8 group by 2, 1;
 id | json_length 
----+-------------
  0 |           3
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           4
(6 rows)

-- select json_length with group by index (result)
--Testcase 3792:
SELECT id, json_length(c1) FROM s8 group by 1, 2;
 id | json_length 
----+-------------
  0 |           3
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           4
(6 rows)

-- select json_length with group by having (EXPLAIN)
--Testcase 3793:
EXPLAIN VERBOSE
SELECT count(c2), json_length(c1) FROM s8 group by json_length(c1) HAVING count(c2) > 0;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_length(c1))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_length(c1) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_length with group by having (result)
--Testcase 3794:
SELECT count(c2), json_length(c1) FROM s8 group by json_length(c1) HAVING count(c2) > 0;
 count | json_length 
-------+-------------
     3 |           3
     2 |           0
     1 |           4
(3 rows)

-- select json_length with group by index having (result)
--Testcase 3795:
SELECT c2, json_length(c1) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           3
  2 |           0
  3 |           0
  4 |           3
  5 |           3
  5 |           4
(6 rows)

-- select json_length with group by index having (result)
--Testcase 3796:
SELECT c2, json_length(c1) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           3
  2 |           0
  3 |           0
  4 |           3
  5 |           3
  5 |           4
(6 rows)

-- select json_length and as
--Testcase 3797:
SELECT json_length(json_build_array(c1, 'a', c2)) as json_length1 FROM s8;
 json_length1 
--------------
            3
            3
            3
            3
            3
            3
(6 rows)

-- select json_merge (builtin function, explain)
--Testcase 3798:
EXPLAIN VERBOSE
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8;
                                                                                                                                                                 QUERY PLAN                                                                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3633.92 rows=3413 width=128)
   Output: (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql
(4 rows)

-- select json_merge (builtin function, result)
--Testcase 3799:
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8;
                           json_merge                            |                                  json_merge                                  |                                     json_merge                                     |     json_merge      
-----------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------------+---------------------
 [[1, 2], [3, 4], 5, 1, 2]                                       | [[1, 2], [3, 4], 5, 1, 2, true, false]                                       | [[[1, 2], [3, 4], 5], "[1, 2]", true, false]                                       | [1, 2, true, false]
 [1, 2]                                                          | [1, 2, true, false]                                                          | [[], "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{}, 1, 2]                                                      | [{}, 1, 2, true, false]                                                      | [{}, "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{"a": "10", "b": "15", "x": 25}, 1, 2]                         | [{"a": "10", "b": "15", "x": 25}, 1, 2, true, false]                         | [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | [1, 2, true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2, true, false]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | [1, 2, true, false]
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2] | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2, true, false] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | [1, 2, true, false]
(6 rows)

-- select json_merge (builtin function, not pushdown constraints, explain)
--Testcase 3800:
EXPLAIN VERBOSE
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                                   QUERY PLAN                                                                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..246.24 rows=17 width=128)
   Output: (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]), id FROM public.s8mysql
(5 rows)

-- select json_merge (builtin function, not pushdown constraints, result)
--Testcase 3801:
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8 WHERE to_hex(id) = '2';
 json_merge |       json_merge        |         json_merge          |     json_merge      
------------+-------------------------+-----------------------------+---------------------
 [{}, 1, 2] | [{}, 1, 2, true, false] | [{}, "[1, 2]", true, false] | [1, 2, true, false]
(1 row)

-- select json_merge (builtin function, pushdown constraints, explain)
--Testcase 3802:
EXPLAIN VERBOSE
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8 WHERE id != 0;
                                                                                                                                                                          QUERY PLAN                                                                                                                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3625.07 rows=3396 width=128)
   Output: (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_merge (builtin function, pushdown constraints, result)
--Testcase 3803:
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8 WHERE id != 0;
                           json_merge                            |                                  json_merge                                  |                                     json_merge                                     |     json_merge      
-----------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------------+---------------------
 [1, 2]                                                          | [1, 2, true, false]                                                          | [[], "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{}, 1, 2]                                                      | [{}, 1, 2, true, false]                                                      | [{}, "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{"a": "10", "b": "15", "x": 25}, 1, 2]                         | [{"a": "10", "b": "15", "x": 25}, 1, 2, true, false]                         | [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | [1, 2, true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2, true, false]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | [1, 2, true, false]
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2] | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2, true, false] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | [1, 2, true, false]
(5 rows)

-- select json_merge (builtin function, json_merge in constraints, explain)
--Testcase 3804:
EXPLAIN VERBOSE
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge(c1, '[1, 2]')) != 1;
                                                                                                                                                                                                             QUERY PLAN                                                                                                                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5331.57 rows=3396 width=128)
   Output: (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((public.json_length(public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])) <> 1))
(4 rows)

-- select json_merge (builtin function, json_merge in constraints, result)
--Testcase 3805:
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge(c1, '[1, 2]')) != 1;
                           json_merge                            |                                  json_merge                                  |                                     json_merge                                     |     json_merge      
-----------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------------+---------------------
 [[1, 2], [3, 4], 5, 1, 2]                                       | [[1, 2], [3, 4], 5, 1, 2, true, false]                                       | [[[1, 2], [3, 4], 5], "[1, 2]", true, false]                                       | [1, 2, true, false]
 [1, 2]                                                          | [1, 2, true, false]                                                          | [[], "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{}, 1, 2]                                                      | [{}, 1, 2, true, false]                                                      | [{}, "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{"a": "10", "b": "15", "x": 25}, 1, 2]                         | [{"a": "10", "b": "15", "x": 25}, 1, 2, true, false]                         | [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | [1, 2, true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2, true, false]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | [1, 2, true, false]
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2] | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2, true, false] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | [1, 2, true, false]
(6 rows)

-- select json_merge (builtin function, json_merge in constraints, explain)
--Testcase 3806:
EXPLAIN VERBOSE
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge('[1, 2]', '[true, false]')) = 4;
                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1876.55 rows=17 width=128)
   Output: (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((public.json_length(public.json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[])) = 4))
(4 rows)

-- select json_merge (builtin function, json_merge in constraints, result)
--Testcase 3807:
SELECT json_merge(c1, '[1, 2]'), json_merge(c1, '[1, 2]', '[true, false]'), json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge('[1, 2]', '[true, false]')) = 4;
                           json_merge                            |                                  json_merge                                  |                                     json_merge                                     |     json_merge      
-----------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------------+---------------------
 [[1, 2], [3, 4], 5, 1, 2]                                       | [[1, 2], [3, 4], 5, 1, 2, true, false]                                       | [[[1, 2], [3, 4], 5], "[1, 2]", true, false]                                       | [1, 2, true, false]
 [1, 2]                                                          | [1, 2, true, false]                                                          | [[], "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{}, 1, 2]                                                      | [{}, 1, 2, true, false]                                                      | [{}, "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{"a": "10", "b": "15", "x": 25}, 1, 2]                         | [{"a": "10", "b": "15", "x": 25}, 1, 2, true, false]                         | [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | [1, 2, true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2, true, false]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | [1, 2, true, false]
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2] | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2, true, false] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | [1, 2, true, false]
(6 rows)

-- select json_merge as nest function with agg (pushdown, explain)
--Testcase 3808:
EXPLAIN VERBOSE
SELECT sum(id),json_merge('[1, 2]', '[true, false]') FROM s8;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_merge(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql
(6 rows)

-- select json_merge as nest function with agg (pushdown, result)
--Testcase 3809:
SELECT sum(id),json_merge('[1, 2]', '[true, false]') FROM s8;
 sum |     json_merge      
-----+---------------------
  15 | [1, 2, true, false]
(1 row)

-- select json_merge with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3810:
EXPLAIN VERBOSE
SELECT json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), pi(), 4.1 FROM s8;
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_merge with non pushdown func and explicit constant (result)
--Testcase 3811:
SELECT json_merge(json_build_array(c1, '[1, 2]'), '[true, false]'), pi(), 4.1 FROM s8;
                                     json_merge                                     |        pi         | ?column? 
------------------------------------------------------------------------------------+-------------------+----------
 [[[1, 2], [3, 4], 5], "[1, 2]", true, false]                                       | 3.141592653589793 |      4.1
 [[], "[1, 2]", true, false]                                                        | 3.141592653589793 |      4.1
 [{}, "[1, 2]", true, false]                                                        | 3.141592653589793 |      4.1
 [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | 3.141592653589793 |      4.1
 [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | 3.141592653589793 |      4.1
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | 3.141592653589793 |      4.1
(6 rows)

-- select json_merge with order by index (result)
--Testcase 3812:
SELECT id, json_length(json_merge(c1, '[1, 2]')) FROM s8 ORDER BY 2, 1;
 id | json_length 
----+-------------
  1 |           2
  2 |           3
  3 |           3
  4 |           3
  0 |           5
  5 |           6
(6 rows)

-- select json_merge with order by index (result)
--Testcase 3813:
SELECT id, json_length(json_merge(c1, '[1, 2]')) FROM s8 ORDER BY 1, 2;
 id | json_length 
----+-------------
  0 |           5
  1 |           2
  2 |           3
  3 |           3
  4 |           3
  5 |           6
(6 rows)

-- select json_merge with group by (EXPLAIN)
--Testcase 3814:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_merge(c1, '[1, 2]')) FROM s8 group by json_length(json_merge(c1, '[1, 2]'));
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_length(public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_merge with group by (result)
--Testcase 3815:
SELECT count(id), json_length(json_merge(c1, '[1, 2]')) FROM s8 group by json_length(json_merge(c1, '[1, 2]'));
 count | json_length 
-------+-------------
     1 |           5
     1 |           2
     3 |           3
     1 |           6
(4 rows)

-- select json_merge with group by index (result)
--Testcase 3816:
SELECT id, json_length(json_merge(c1, '[1, 2]')) FROM s8 group by 2, 1;
 id | json_length 
----+-------------
  0 |           5
  1 |           2
  2 |           3
  3 |           3
  4 |           3
  5 |           6
(6 rows)

-- select json_merge with group by index (result)
--Testcase 3817:
SELECT id, json_length(json_merge(c1, '[1, 2]')) FROM s8 group by 1, 2;
 id | json_length 
----+-------------
  0 |           5
  1 |           2
  2 |           3
  3 |           3
  4 |           3
  5 |           6
(6 rows)

-- select json_merge with group by having (EXPLAIN)
--Testcase 3818:
EXPLAIN VERBOSE
SELECT count(c2), json_length(json_merge(c1, '[1, 2]')) FROM s8 group by json_length(json_merge(c1, '[1, 2]')) HAVING count(c2) > 0;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_length(json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_length(public.json_merge(VARIADIC ARRAY[c1, '[1, 2]'::json])) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_merge with group by having (result)
--Testcase 3819:
SELECT count(c2), json_length(json_merge(c1, '[1, 2]')) FROM s8 group by json_length(json_merge(c1, '[1, 2]')) HAVING count(c2) > 0;
 count | json_length 
-------+-------------
     1 |           5
     1 |           2
     3 |           3
     1 |           6
(4 rows)

-- select json_merge with group by index having (result)
--Testcase 3820:
SELECT c2, json_length(json_merge(c1, '[1, 2]')) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           5
  2 |           2
  3 |           3
  4 |           3
  5 |           3
  5 |           6
(6 rows)

-- select json_merge with group by index having (result)
--Testcase 3821:
SELECT c2, json_length(json_merge(c1, '[1, 2]')) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           5
  2 |           2
  3 |           3
  4 |           3
  5 |           3
  5 |           6
(6 rows)

-- select json_merge and as
--Testcase 3822:
SELECT json_merge(json_build_array(c1, '[1, 2]'), '[true, false]') as json_merge1 FROM s8;
                                    json_merge1                                     
------------------------------------------------------------------------------------
 [[[1, 2], [3, 4], 5], "[1, 2]", true, false]
 [[], "[1, 2]", true, false]
 [{}, "[1, 2]", true, false]
 [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false]
(6 rows)

-- select json_merge_patch (builtin function, explain)
--Testcase 3823:
EXPLAIN VERBOSE
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8;
                                                                                                                                                                             QUERY PLAN                                                                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3633.92 rows=3413 width=128)
   Output: (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql
(4 rows)

-- select json_merge_patch (builtin function, result)
--Testcase 3824:
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8;
 json_merge_patch | json_merge_patch | json_merge_patch | json_merge_patch 
------------------+------------------+------------------+------------------
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
(6 rows)

-- select json_merge_patch (builtin function, not pushdown constraints, explain)
--Testcase 3825:
EXPLAIN VERBOSE
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                                               QUERY PLAN                                                                                                                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..246.24 rows=17 width=128)
   Output: (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]), id FROM public.s8mysql
(5 rows)

-- select json_merge_patch (builtin function, not pushdown constraints, result)
--Testcase 3826:
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8 WHERE to_hex(id) = '2';
 json_merge_patch | json_merge_patch | json_merge_patch | json_merge_patch 
------------------+------------------+------------------+------------------
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
(1 row)

-- select json_merge_patch (builtin function, pushdown constraints, explain)
--Testcase 3827:
EXPLAIN VERBOSE
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8 WHERE id != 0;
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3625.07 rows=3396 width=128)
   Output: (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_merge_patch (builtin function, pushdown constraints, result)
--Testcase 3828:
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8 WHERE id != 0;
 json_merge_patch | json_merge_patch | json_merge_patch | json_merge_patch 
------------------+------------------+------------------+------------------
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
(5 rows)

-- select json_merge_patch (builtin function, json_merge_patch in constraints, explain)
--Testcase 3829:
EXPLAIN VERBOSE
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge_patch(c1, '[1, 2]')) != 1;
                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5331.57 rows=3396 width=128)
   Output: (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((public.json_length(public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])) <> 1))
(4 rows)

-- select json_merge_patch (builtin function, json_merge_patch in constraints, result)
--Testcase 3830:
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge_patch(c1, '[1, 2]')) != 1;
 json_merge_patch | json_merge_patch | json_merge_patch | json_merge_patch 
------------------+------------------+------------------+------------------
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
(6 rows)

-- select json_merge_patch (builtin function, json_merge_patch in constraints, explain)
--Testcase 3831:
EXPLAIN VERBOSE
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge_patch('[1, 2]', '[true, false]')) = 2;
                                                                                                                                                                                                                                 QUERY PLAN                                                                                                                                                                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1876.55 rows=17 width=128)
   Output: (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((public.json_length(public.json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[])) = 2))
(4 rows)

-- select json_merge_patch (builtin function, json_merge_patch in constraints, result)
--Testcase 3832:
SELECT json_merge_patch(c1, '[1, 2]'), json_merge_patch(c1, '[1, 2]', '[true, false]'), json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_patch('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge_patch('[1, 2]', '[true, false]')) = 2;
 json_merge_patch | json_merge_patch | json_merge_patch | json_merge_patch 
------------------+------------------+------------------+------------------
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
 [1, 2]           | [true, false]    | [true, false]    | [true, false]
(6 rows)

-- select json_merge_patch as nest function with agg (pushdown, explain)
--Testcase 3833:
EXPLAIN VERBOSE
SELECT sum(id),json_merge_patch('[1, 2]', '[true, false]') FROM s8;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_merge_patch(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql
(6 rows)

-- select json_merge_patch as nest function with agg (pushdown, result)
--Testcase 3834:
SELECT sum(id),json_merge_patch('[1, 2]', '[true, false]') FROM s8;
 sum | json_merge_patch 
-----+------------------
  15 | [true, false]
(1 row)

-- select json_merge_patch with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3835:
EXPLAIN VERBOSE
SELECT json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), pi(), 4.1 FROM s8;
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_patch(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_merge_patch with non pushdown func and explicit constant (result)
--Testcase 3836:
SELECT json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]'), pi(), 4.1 FROM s8;
 json_merge_patch |        pi         | ?column? 
------------------+-------------------+----------
 [true, false]    | 3.141592653589793 |      4.1
 [true, false]    | 3.141592653589793 |      4.1
 [true, false]    | 3.141592653589793 |      4.1
 [true, false]    | 3.141592653589793 |      4.1
 [true, false]    | 3.141592653589793 |      4.1
 [true, false]    | 3.141592653589793 |      4.1
(6 rows)

-- select json_merge_patch with order by index (result)
--Testcase 3837:
SELECT id, json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 ORDER BY 2, 1;
 id | json_length 
----+-------------
  0 |           2
  1 |           2
  2 |           2
  3 |           2
  4 |           2
  5 |           2
(6 rows)

-- select json_merge_patch with order by index (result)
--Testcase 3838:
SELECT id, json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 ORDER BY 1, 2;
 id | json_length 
----+-------------
  0 |           2
  1 |           2
  2 |           2
  3 |           2
  4 |           2
  5 |           2
(6 rows)

-- select json_merge_patch with group by (EXPLAIN)
--Testcase 3839:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 group by json_length(json_merge_patch(c1, '[1, 2]'));
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_length(public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_merge_patch with group by (result)
--Testcase 3840:
SELECT count(id), json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 group by json_length(json_merge_patch(c1, '[1, 2]'));
 count | json_length 
-------+-------------
     6 |           2
(1 row)

-- select json_merge_patch with group by index (result)
--Testcase 3841:
SELECT id, json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 group by 2, 1;
 id | json_length 
----+-------------
  0 |           2
  1 |           2
  2 |           2
  3 |           2
  4 |           2
  5 |           2
(6 rows)

-- select json_merge_patch with group by index (result)
--Testcase 3842:
SELECT id, json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 group by 1, 2;
 id | json_length 
----+-------------
  0 |           2
  1 |           2
  2 |           2
  3 |           2
  4 |           2
  5 |           2
(6 rows)

-- select json_merge_patch with group by having (EXPLAIN)
--Testcase 3843:
EXPLAIN VERBOSE
SELECT count(c2), json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 group by json_length(json_merge_patch(c1, '[1, 2]')) HAVING count(c2) > 0;
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_length(json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_length(public.json_merge_patch(VARIADIC ARRAY[c1, '[1, 2]'::json])) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_merge_patch with group by having (result)
--Testcase 3844:
SELECT count(c2), json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 group by json_length(json_merge_patch(c1, '[1, 2]')) HAVING count(c2) > 0;
 count | json_length 
-------+-------------
     6 |           2
(1 row)

-- select json_merge_patch with group by index having (result)
--Testcase 3845:
SELECT c2, json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           2
  2 |           2
  3 |           2
  4 |           2
  5 |           2
(5 rows)

-- select json_merge_patch with group by index having (result)
--Testcase 3846:
SELECT c2, json_length(json_merge_patch(c1, '[1, 2]')) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           2
  2 |           2
  3 |           2
  4 |           2
  5 |           2
(5 rows)

-- select json_merge_patch and as
--Testcase 3847:
SELECT json_merge_patch(json_build_array(c1, '[1, 2]'), '[true, false]') as json_merge_patch1 FROM s8;
 json_merge_patch1 
-------------------
 [true, false]
 [true, false]
 [true, false]
 [true, false]
 [true, false]
 [true, false]
(6 rows)

-- select json_merge_preserve (builtin function, explain)
--Testcase 3848:
EXPLAIN VERBOSE
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8;
                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3633.92 rows=3413 width=128)
   Output: (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql
(4 rows)

-- select json_merge_preserve (builtin function, result)
--Testcase 3849:
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8;
                       json_merge_preserve                       |                             json_merge_preserve                              |                                json_merge_preserve                                 | json_merge_preserve 
-----------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------------+---------------------
 [[1, 2], [3, 4], 5, 1, 2]                                       | [[1, 2], [3, 4], 5, 1, 2, true, false]                                       | [[[1, 2], [3, 4], 5], "[1, 2]", true, false]                                       | [1, 2, true, false]
 [1, 2]                                                          | [1, 2, true, false]                                                          | [[], "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{}, 1, 2]                                                      | [{}, 1, 2, true, false]                                                      | [{}, "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{"a": "10", "b": "15", "x": 25}, 1, 2]                         | [{"a": "10", "b": "15", "x": 25}, 1, 2, true, false]                         | [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | [1, 2, true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2, true, false]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | [1, 2, true, false]
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2] | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2, true, false] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | [1, 2, true, false]
(6 rows)

-- select json_merge_preserve (builtin function, not pushdown constraints, explain)
--Testcase 3850:
EXPLAIN VERBOSE
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..246.24 rows=17 width=128)
   Output: (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]), id FROM public.s8mysql
(5 rows)

-- select json_merge_preserve (builtin function, not pushdown constraints, result)
--Testcase 3851:
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8 WHERE to_hex(id) = '2';
 json_merge_preserve |   json_merge_preserve   |     json_merge_preserve     | json_merge_preserve 
---------------------+-------------------------+-----------------------------+---------------------
 [{}, 1, 2]          | [{}, 1, 2, true, false] | [{}, "[1, 2]", true, false] | [1, 2, true, false]
(1 row)

-- select json_merge_preserve (builtin function, pushdown constraints, explain)
--Testcase 3852:
EXPLAIN VERBOSE
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8 WHERE id != 0;
                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3625.07 rows=3396 width=128)
   Output: (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_merge_preserve (builtin function, pushdown constraints, result)
--Testcase 3853:
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8 WHERE id != 0;
                       json_merge_preserve                       |                             json_merge_preserve                              |                                json_merge_preserve                                 | json_merge_preserve 
-----------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------------+---------------------
 [1, 2]                                                          | [1, 2, true, false]                                                          | [[], "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{}, 1, 2]                                                      | [{}, 1, 2, true, false]                                                      | [{}, "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{"a": "10", "b": "15", "x": 25}, 1, 2]                         | [{"a": "10", "b": "15", "x": 25}, 1, 2, true, false]                         | [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | [1, 2, true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2, true, false]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | [1, 2, true, false]
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2] | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2, true, false] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | [1, 2, true, false]
(5 rows)

-- select json_merge_preserve (builtin function, json_merge_preserve in constraints, explain)
--Testcase 3854:
EXPLAIN VERBOSE
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge_preserve(c1, '[1, 2]')) != 1;
                                                                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5331.57 rows=3396 width=128)
   Output: (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((public.json_length(public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])) <> 1))
(4 rows)

-- select json_merge_preserve (builtin function, json_merge_preserve in constraints, result)
--Testcase 3855:
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge_preserve(c1, '[1, 2]')) != 1;
                       json_merge_preserve                       |                             json_merge_preserve                              |                                json_merge_preserve                                 | json_merge_preserve 
-----------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------------+---------------------
 [[1, 2], [3, 4], 5, 1, 2]                                       | [[1, 2], [3, 4], 5, 1, 2, true, false]                                       | [[[1, 2], [3, 4], 5], "[1, 2]", true, false]                                       | [1, 2, true, false]
 [1, 2]                                                          | [1, 2, true, false]                                                          | [[], "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{}, 1, 2]                                                      | [{}, 1, 2, true, false]                                                      | [{}, "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{"a": "10", "b": "15", "x": 25}, 1, 2]                         | [{"a": "10", "b": "15", "x": 25}, 1, 2, true, false]                         | [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | [1, 2, true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2, true, false]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | [1, 2, true, false]
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2] | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2, true, false] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | [1, 2, true, false]
(6 rows)

-- select json_merge_preserve (builtin function, json_merge_preserve in constraints, explain)
--Testcase 3856:
EXPLAIN VERBOSE
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge_preserve('[1, 2]', '[true, false]')) = 4;
                                                                                                                                                                                                                                         QUERY PLAN                                                                                                                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1876.55 rows=17 width=128)
   Output: (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])), (json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json])), (json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), (json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json]), public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json, '[true, false]'::json]), public.json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), public.json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql WHERE ((public.json_length(public.json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[])) = 4))
(4 rows)

-- select json_merge_preserve (builtin function, json_merge_preserve in constraints, result)
--Testcase 3857:
SELECT json_merge_preserve(c1, '[1, 2]'), json_merge_preserve(c1, '[1, 2]', '[true, false]'), json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), json_merge_preserve('[1, 2]', '[true, false]') FROM s8 WHERE json_length(json_merge_preserve('[1, 2]', '[true, false]')) = 4;
                       json_merge_preserve                       |                             json_merge_preserve                              |                                json_merge_preserve                                 | json_merge_preserve 
-----------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------------+---------------------
 [[1, 2], [3, 4], 5, 1, 2]                                       | [[1, 2], [3, 4], 5, 1, 2, true, false]                                       | [[[1, 2], [3, 4], 5], "[1, 2]", true, false]                                       | [1, 2, true, false]
 [1, 2]                                                          | [1, 2, true, false]                                                          | [[], "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{}, 1, 2]                                                      | [{}, 1, 2, true, false]                                                      | [{}, "[1, 2]", true, false]                                                        | [1, 2, true, false]
 [{"a": "10", "b": "15", "x": 25}, 1, 2]                         | [{"a": "10", "b": "15", "x": 25}, 1, 2, true, false]                         | [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | [1, 2, true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, 1, 2, true, false]                         | [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | [1, 2, true, false]
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2] | ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}, 1, 2, true, false] | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | [1, 2, true, false]
(6 rows)

-- select json_merge_preserve as nest function with agg (pushdown, explain)
--Testcase 3858:
EXPLAIN VERBOSE
SELECT sum(id),json_merge_preserve('[1, 2]', '[true, false]') FROM s8;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_merge_preserve(VARIADIC '{"[1, 2]","[true, false]"}'::json[]) FROM public.s8mysql
(6 rows)

-- select json_merge_preserve as nest function with agg (pushdown, result)
--Testcase 3859:
SELECT sum(id),json_merge_preserve('[1, 2]', '[true, false]') FROM s8;
 sum | json_merge_preserve 
-----+---------------------
  15 | [1, 2, true, false]
(1 row)

-- select json_merge_preserve with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3860:
EXPLAIN VERBOSE
SELECT json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), pi(), 4.1 FROM s8;
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_merge_preserve(VARIADIC ARRAY[json_build_array(c1, '[1, 2]'), '[true, false]'::json]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_merge_preserve with non pushdown func and explicit constant (result)
--Testcase 3861:
SELECT json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]'), pi(), 4.1 FROM s8;
                                json_merge_preserve                                 |        pi         | ?column? 
------------------------------------------------------------------------------------+-------------------+----------
 [[[1, 2], [3, 4], 5], "[1, 2]", true, false]                                       | 3.141592653589793 |      4.1
 [[], "[1, 2]", true, false]                                                        | 3.141592653589793 |      4.1
 [{}, "[1, 2]", true, false]                                                        | 3.141592653589793 |      4.1
 [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]                           | 3.141592653589793 |      4.1
 [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]                           | 3.141592653589793 |      4.1
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false] | 3.141592653589793 |      4.1
(6 rows)

-- select json_merge_preserve with order by index (result)
--Testcase 3862:
SELECT id, json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 ORDER BY 2, 1;
 id | json_length 
----+-------------
  1 |           2
  2 |           3
  3 |           3
  4 |           3
  0 |           5
  5 |           6
(6 rows)

-- select json_merge_preserve with order by index (result)
--Testcase 3863:
SELECT id, json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 ORDER BY 1, 2;
 id | json_length 
----+-------------
  0 |           5
  1 |           2
  2 |           3
  3 |           3
  4 |           3
  5 |           6
(6 rows)

-- select json_merge_preserve with group by (EXPLAIN)
--Testcase 3864:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 group by json_length(json_merge_preserve(c1, '[1, 2]'));
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_length(public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_merge_preserve with group by (result)
--Testcase 3865:
SELECT count(id), json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 group by json_length(json_merge_preserve(c1, '[1, 2]'));
 count | json_length 
-------+-------------
     1 |           5
     1 |           2
     3 |           3
     1 |           6
(4 rows)

-- select json_merge_preserve with group by index (result)
--Testcase 3866:
SELECT id, json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 group by 2, 1;
 id | json_length 
----+-------------
  0 |           5
  1 |           2
  2 |           3
  3 |           3
  4 |           3
  5 |           6
(6 rows)

-- select json_merge_preserve with group by index (result)
--Testcase 3867:
SELECT id, json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 group by 1, 2;
 id | json_length 
----+-------------
  0 |           5
  1 |           2
  2 |           3
  3 |           3
  4 |           3
  5 |           6
(6 rows)

-- select json_merge_preserve with group by having (EXPLAIN)
--Testcase 3868:
EXPLAIN VERBOSE
SELECT count(c2), json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 group by json_length(json_merge_preserve(c1, '[1, 2]')) HAVING count(c2) > 0;
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_length(json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_length(public.json_merge_preserve(VARIADIC ARRAY[c1, '[1, 2]'::json])) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_merge_preserve with group by having (result)
--Testcase 3869:
SELECT count(c2), json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 group by json_length(json_merge_preserve(c1, '[1, 2]')) HAVING count(c2) > 0;
 count | json_length 
-------+-------------
     1 |           5
     1 |           2
     3 |           3
     1 |           6
(4 rows)

-- select json_merge_preserve with group by index having (result)
--Testcase 3870:
SELECT c2, json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           5
  2 |           2
  3 |           3
  4 |           3
  5 |           3
  5 |           6
(6 rows)

-- select json_merge_preserve with group by index having (result)
--Testcase 3871:
SELECT c2, json_length(json_merge_preserve(c1, '[1, 2]')) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           5
  2 |           2
  3 |           3
  4 |           3
  5 |           3
  5 |           6
(6 rows)

-- select json_merge_preserve and as
--Testcase 3872:
SELECT json_merge_preserve(json_build_array(c1, '[1, 2]'), '[true, false]') as json_merge_preserve1 FROM s8;
                                json_merge_preserve1                                
------------------------------------------------------------------------------------
 [[[1, 2], [3, 4], 5], "[1, 2]", true, false]
 [[], "[1, 2]", true, false]
 [{}, "[1, 2]", true, false]
 [{"a": "10", "b": "15", "x": 25}, "[1, 2]", true, false]
 [{"a": 1, "b": 2, "c": {"d": 4}}, "[1, 2]", true, false]
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "[1, 2]", true, false]
(6 rows)

-- json_build_object --> json_object in mysql
-- select json_build_object (builtin function, explain)
--Testcase 3873:
EXPLAIN VERBOSE
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8;
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=32)
   Output: (json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL::unknown, 'h', true))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', public.mysql_pi(), 'g', NULL::unknown, 'h', true) FROM public.s8mysql
(4 rows)

-- select json_build_object (builtin function, result)
--Testcase 3874:
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8;
                                                                             json_build_object                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"a": [[1, 2], [3, 4], 5], "b": 1, "c": "This", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": [], "b": 2, "c": "is", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": {}, "b": 3, "c": "text", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": {"a": "10", "b": "15", "x": 25}, "b": 4, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": {"a": 1, "b": 2, "c": {"d": 4}}, "b": 5, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "b": 5, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
(6 rows)

-- select json_build_object (builtin function, not pushdown constraints, explain)
--Testcase 3875:
EXPLAIN VERBOSE
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8 WHERE to_hex(id) = '1';
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..233.49 rows=17 width=32)
   Output: (json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL::unknown, 'h', true))
   Filter: (to_hex(s8.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', public.mysql_pi(), 'g', NULL::unknown, 'h', true), id FROM public.s8mysql
(5 rows)

-- select json_build_object (builtin function, not pushdown constraints, result)
--Testcase 3876:
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8 WHERE to_hex(id) = '1';
                                                json_build_object                                                
-----------------------------------------------------------------------------------------------------------------
 {"a": [], "b": 2, "c": "is", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
(1 row)

-- select json_build_object (builtin function, pushdown constraints, explain)
--Testcase 3877:
EXPLAIN VERBOSE
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8 WHERE id = 1;
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..157.29 rows=17 width=32)
   Output: (json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL::unknown, 'h', true))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', public.mysql_pi(), 'g', NULL::unknown, 'h', true) FROM public.s8mysql WHERE ((id = 1))
(4 rows)

-- select json_build_object (builtin function, pushdown constraints, result)
--Testcase 3878:
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8 WHERE id = 1;
                                                json_build_object                                                
-----------------------------------------------------------------------------------------------------------------
 {"a": [], "b": 2, "c": "is", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
(1 row)

-- select json_build_object (builtin function, stub in constraints, explain)
--Testcase 3879:
EXPLAIN VERBOSE
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8 WHERE log2(id) > 1;
                                                                                                              QUERY PLAN                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1324.55 rows=1138 width=32)
   Output: (json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL::unknown, 'h', true))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', public.mysql_pi(), 'g', NULL::unknown, 'h', true) FROM public.s8mysql WHERE ((public.log2(id) > 1::double precision))
(4 rows)

-- select json_build_object (builtin function, stub in constraints, result)
--Testcase 3880:
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8 WHERE log2(id) > 1;
                                                                             json_build_object                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"a": {"a": "10", "b": "15", "x": 25}, "b": 4, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": {"a": 1, "b": 2, "c": {"d": 4}}, "b": 5, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "b": 5, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
(3 rows)

-- select json_build_object (builtin function, stub in constraints, explain)
--Testcase 3881:
EXPLAIN VERBOSE
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8 WHERE json_depth(json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE)) > 0;
                                                                                                                                                                            QUERY PLAN                                                                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2177.80 rows=1138 width=32)
   Output: (json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL::unknown, 'h', true))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', public.mysql_pi(), 'g', NULL::unknown, 'h', true) FROM public.s8mysql WHERE ((public.json_depth(json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', public.mysql_pi(), 'g', NULL::unknown, 'h', true)) > 0))
(4 rows)

-- select json_build_object (builtin function, stub in constraints, result)
--Testcase 3882:
SELECT json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE) FROM s8 WHERE json_depth(json_build_object('a', c1, 'b', c2, 'c', c3, 'd', 1, 'e', 'this is ''text'' value', 'f', mysql_pi(), 'g', NULL, 'h', TRUE)) > 0;
                                                                             json_build_object                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"a": [[1, 2], [3, 4], 5], "b": 1, "c": "This", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": [], "b": 2, "c": "is", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": {}, "b": 3, "c": "text", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": {"a": "10", "b": "15", "x": 25}, "b": 4, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": {"a": 1, "b": 2, "c": {"d": 4}}, "b": 5, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
 {"a": ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "b": 5, "c": "scalar", "d": 1, "e": "this is 'text' value", "f": 3.141592653589793, "g": null, "h": true}
(6 rows)

-- select json_build_object as nest function with agg (pushdown, explain)
--Testcase 3883:
EXPLAIN VERBOSE
SELECT sum(id),json_build_object('sum', sum(id)) FROM s8;
                        QUERY PLAN                        
----------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), json_build_object('sum', (sum(id)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id) FROM public.s8mysql
(6 rows)

-- select json_build_object as nest function with agg (pushdown, result)
--Testcase 3884:
SELECT sum(id),json_build_object('sum', sum(id)) FROM s8;
 sum | json_build_object 
-----+-------------------
  15 | {"sum" : 15}
(1 row)

-- select json_build_object as nest function with stub (pushdown, explain)
--Testcase 3885:
EXPLAIN VERBOSE
SELECT json_build_object('json_val', '{"a": 100}'::json, 'stub_log2', log2(id)) FROM s8;
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1082.70 rows=3413 width=32)
   Output: (json_build_object('json_val', '{"a": 100}'::json, 'stub_log2', log2((id)::double precision)))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT json_build_object('json_val', '{"a": 100}'::json, 'stub_log2', public.log2(id)) FROM public.s8mysql
(4 rows)

-- select json_build_object as nest function with agg (pushdown, result)
--Testcase 3886:
SELECT json_build_object('json_val', '{"a": 100}'::json, 'stub_log2', log2(id)) FROM s8;
                    json_build_object                     
----------------------------------------------------------
 {"json_val": {"a": 100}, "stub_log2": null}
 {"json_val": {"a": 100}, "stub_log2": 0.0}
 {"json_val": {"a": 100}, "stub_log2": 1.0}
 {"json_val": {"a": 100}, "stub_log2": 1.584962500721156}
 {"json_val": {"a": 100}, "stub_log2": 2.0}
 {"json_val": {"a": 100}, "stub_log2": 2.321928094887362}
(6 rows)

-- select json_build_object with non pushdown func and explicit constant (explain)
--Testcase 3887:
EXPLAIN VERBOSE
SELECT json_build_object('val1', '100'), cosd(id), 4.1 FROM s8;
                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..237.99 rows=3413 width=72)
   Output: json_build_object('val1', '100'), cosd((id)::double precision), 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id FROM public.s8mysql
(4 rows)

-- select json_build_object with non pushdown func and explicit constant (result)
--Testcase 3888:
SELECT json_build_object('val1', '100'), cosd(id), 4.1 FROM s8;
 json_build_object |        cosd        | ?column? 
-------------------+--------------------+----------
 {"val1" : "100"}  |                  1 |      4.1
 {"val1" : "100"}  | 0.9998476951563913 |      4.1
 {"val1" : "100"}  | 0.9993908270190958 |      4.1
 {"val1" : "100"}  | 0.9986295347545738 |      4.1
 {"val1" : "100"}  | 0.9975640502598242 |      4.1
 {"val1" : "100"}  | 0.9961946980917455 |      4.1
(6 rows)

-- select json_build_object with order by (explain)
--Testcase 3889:
EXPLAIN VERBOSE
SELECT json_length(json_build_object(c1, '$[1], c2')) FROM s8 ORDER BY 1;
                                               QUERY PLAN                                               
--------------------------------------------------------------------------------------------------------
 Sort  (cost=1274.46..1282.99 rows=3413 width=4)
   Output: (json_length(json_build_object(c1, '$[1], c2')))
   Sort Key: (json_length(json_build_object(s8.c1, '$[1], c2')))
   ->  Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=4)
         Output: (json_length(json_build_object(c1, '$[1], c2')))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.json_length(json_build_object(c1, '$[1], c2')) FROM public.s8mysql
(7 rows)

-- select json_build_object with order by (result)
--Testcase 3890:
SELECT json_length(json_build_object(c1, '$[1], c2')) FROM s8 ORDER BY 1;
 json_length 
-------------
           1
           1
           1
           1
           1
           1
(6 rows)

-- select json_build_object with group by (explain)
--Testcase 3891:
EXPLAIN VERBOSE
SELECT json_length(json_build_object('a', c1, 'b', c2, 'c', c3)) FROM s8 GROUP BY 1;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=4)
   Output: (json_length(json_build_object('a', c1, 'b', c2, 'c', c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_length(json_build_object('a', c1, 'b', c2, 'c', c3)) FROM public.s8mysql GROUP BY 1
(6 rows)

-- select json_build_object with group by (result)
--Testcase 3892:
SELECT json_length(json_build_object('a', c1, 'b', c2, 'c', c3)) FROM s8 GROUP BY 1;
 json_length 
-------------
           3
(1 row)

-- select json_build_object with group by having (explain)
--Testcase 3893:
EXPLAIN VERBOSE
SELECT json_depth(json_build_object('a', c1, 'b', c2, 'c', c3)) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
                                                               QUERY PLAN                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (json_depth(json_build_object('a', c1, 'b', c2, 'c', c3))), c2
   Filter: ((count(s8.c2)) > 1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_depth(json_build_object('a', c1, 'b', c2, 'c', c3)), c2, count(c2) FROM public.s8mysql GROUP BY 2, 1
(7 rows)

-- select json_build_object with group by having (result)
--Testcase 3894:
SELECT json_depth(json_build_object('a', c1, 'b', c2, 'c', c3)) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
 json_depth 
------------
(0 rows)

-- select json_build_object and as
--Testcase 3895:
SELECT json_build_object('a', c1, 'b', c2, 'c', c3) AS json_build_object1 FROM s8;
                                     json_build_object1                                     
--------------------------------------------------------------------------------------------
 {"a" : [[1, 2], [3, 4], 5], "b" : 1, "c" : "This"}
 {"a" : [], "b" : 2, "c" : "is"}
 {"a" : {}, "b" : 3, "c" : "text"}
 {"a" : {"a": "10", "b": "15", "x": 25}, "b" : 4, "c" : "scalar"}
 {"a" : {"a": 1, "b": 2, "c": {"d": 4}}, "b" : 5, "c" : "scalar"}
 {"a" : ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}], "b" : 5, "c" : "scalar"}
(6 rows)

-- select json_overlaps (builtin function, explain)
--Testcase 3896:
EXPLAIN VERBOSE
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8;
                                                                                                                                                                            QUERY PLAN                                                                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4487.17 rows=3413 width=20)
   Output: (json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(c1, c1)), (json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json)), (json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(c1, c1), public.json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json), public.json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json) FROM public.s8mysql
(4 rows)

-- select json_overlaps (builtin function, result)
--Testcase 3897:
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8;
 json_overlaps | json_overlaps | json_overlaps | json_overlaps | json_overlaps 
---------------+---------------+---------------+---------------+---------------
             1 |             0 |             1 |             1 |             1
             0 |             0 |             0 |             1 |             1
             0 |             0 |             0 |             1 |             1
             0 |             0 |             1 |             1 |             1
             0 |             0 |             1 |             1 |             1
             0 |             0 |             1 |             1 |             1
(6 rows)

-- select json_overlaps (builtin function, not pushdown constraints, explain)
--Testcase 3898:
EXPLAIN VERBOSE
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                                              QUERY PLAN                                                                                                                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..250.49 rows=17 width=20)
   Output: (json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(c1, c1)), (json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json)), (json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(c1, c1), public.json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json), public.json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json), id FROM public.s8mysql
(5 rows)

-- select json_overlaps (builtin function, not pushdown constraints, result)
--Testcase 3899:
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8 WHERE to_hex(id) = '2';
 json_overlaps | json_overlaps | json_overlaps | json_overlaps | json_overlaps 
---------------+---------------+---------------+---------------+---------------
             0 |             0 |             0 |             1 |             1
(1 row)

-- select json_overlaps (builtin function, pushdown constraints, explain)
--Testcase 3900:
EXPLAIN VERBOSE
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8 WHERE id != 0;
                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4474.07 rows=3396 width=20)
   Output: (json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(c1, c1)), (json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json)), (json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(c1, c1), public.json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json), public.json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_overlaps (builtin function, pushdown constraints, result)
--Testcase 3901:
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8 WHERE id != 0;
 json_overlaps | json_overlaps | json_overlaps | json_overlaps | json_overlaps 
---------------+---------------+---------------+---------------+---------------
             0 |             0 |             0 |             1 |             1
             0 |             0 |             0 |             1 |             1
             0 |             0 |             1 |             1 |             1
             0 |             0 |             1 |             1 |             1
             0 |             0 |             1 |             1 |             1
(5 rows)

-- select json_overlaps (builtin function, json_overlaps in constraints, explain)
--Testcase 3902:
EXPLAIN VERBOSE
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8 WHERE json_overlaps(c1, '[[1, 2], [3, 4], 5]') != 1;
                                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5327.32 rows=3396 width=20)
   Output: (json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(c1, c1)), (json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json)), (json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(c1, c1), public.json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json), public.json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json) FROM public.s8mysql WHERE ((public.json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json) <> 1))
(4 rows)

-- select json_overlaps (builtin function, json_overlaps in constraints, result)
--Testcase 3903:
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8 WHERE json_overlaps(c1, '[[1, 2], [3, 4], 5]') != 1;
 json_overlaps | json_overlaps | json_overlaps | json_overlaps | json_overlaps 
---------------+---------------+---------------+---------------+---------------
             0 |             0 |             0 |             1 |             1
             0 |             0 |             0 |             1 |             1
             0 |             0 |             1 |             1 |             1
             0 |             0 |             1 |             1 |             1
             0 |             0 |             1 |             1 |             1
(5 rows)

-- select json_overlaps (builtin function, json_overlaps in constraints, explain)
--Testcase 3904:
EXPLAIN VERBOSE
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8 WHERE json_overlaps('[1,3,5,7]', '[2,5,7]') = 1;
                                                                                                                                                                                                               QUERY PLAN                                                                                                                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1027.54 rows=17 width=20)
   Output: (json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json)), (json_overlaps(c1, c1)), (json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json)), (json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'::json), public.json_overlaps(c1, c1), public.json_overlaps('{"a":1,"b":10,"d":10}'::json, '{"c":1,"e":10,"f":1,"d":10}'::json), public.json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json) FROM public.s8mysql WHERE ((public.json_overlaps('[1,3,5,7]'::json, '[2,5,7]'::json) = 1))
(4 rows)

-- select json_overlaps (builtin function, json_overlaps in constraints, result)
--Testcase 3905:
SELECT json_overlaps(c1, '[[1, 2], [3, 4], 5]'), json_overlaps(json_build_array(c1, '1'), '[[1, 2], [3, 4], 5]'), json_overlaps(c1, c1),json_overlaps('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}'),json_overlaps('[1,3,5,7]', '[2,5,7]') FROM s8 WHERE json_overlaps('[1,3,5,7]', '[2,5,7]') = 1;
 json_overlaps | json_overlaps | json_overlaps | json_overlaps | json_overlaps 
---------------+---------------+---------------+---------------+---------------
             1 |             0 |             1 |             1 |             1
             0 |             0 |             0 |             1 |             1
             0 |             0 |             0 |             1 |             1
             0 |             0 |             1 |             1 |             1
             0 |             0 |             1 |             1 |             1
             0 |             0 |             1 |             1 |             1
(6 rows)

-- select json_overlaps with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3906:
EXPLAIN VERBOSE
SELECT json_overlaps(c1, c1), pi(), 4.1 FROM s8;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=44)
   Output: (json_overlaps(c1, c1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_overlaps(c1, c1), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_overlaps with non pushdown func and explicit constant (result)
--Testcase 3907:
SELECT json_overlaps(c1, c1), pi(), 4.1 FROM s8;
 json_overlaps |        pi         | ?column? 
---------------+-------------------+----------
             1 | 3.141592653589793 |      4.1
             0 | 3.141592653589793 |      4.1
             0 | 3.141592653589793 |      4.1
             1 | 3.141592653589793 |      4.1
             1 | 3.141592653589793 |      4.1
             1 | 3.141592653589793 |      4.1
(6 rows)

-- select json_overlaps with order by index (result)
--Testcase 3908:
SELECT id,  json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 ORDER BY 2, 1;
 id | json_overlaps 
----+---------------
  1 |             0
  2 |             0
  3 |             0
  4 |             0
  5 |             0
  0 |             1
(6 rows)

-- select json_overlaps with order by index (result)
--Testcase 3909:
SELECT id,  json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 ORDER BY 1, 2;
 id | json_overlaps 
----+---------------
  0 |             1
  1 |             0
  2 |             0
  3 |             0
  4 |             0
  5 |             0
(6 rows)

-- select json_overlaps with group by (EXPLAIN)
--Testcase 3910:
EXPLAIN VERBOSE
SELECT count(id), json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 group by json_overlaps(c1, '[[1, 2], [3, 4], 5]');
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_overlaps with group by (result)
--Testcase 3911:
SELECT count(id), json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 group by json_overlaps(c1, '[[1, 2], [3, 4], 5]');
 count | json_overlaps 
-------+---------------
     1 |             1
     5 |             0
(2 rows)

-- select json_overlaps with group by index (result)
--Testcase 3912:
SELECT id,  json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 group by 2, 1;
 id | json_overlaps 
----+---------------
  0 |             1
  1 |             0
  2 |             0
  3 |             0
  4 |             0
  5 |             0
(6 rows)

-- select json_overlaps with group by index (result)
--Testcase 3913:
SELECT id,  json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 group by 1, 2;
 id | json_overlaps 
----+---------------
  0 |             1
  1 |             0
  2 |             0
  3 |             0
  4 |             0
  5 |             0
(6 rows)

-- select json_overlaps with group by having (EXPLAIN)
--Testcase 3914:
EXPLAIN VERBOSE
SELECT count(c2), json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 group by json_overlaps(c1, '[[1, 2], [3, 4], 5]') HAVING count(c2) > 0;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_overlaps(c1, '[[1, 2], [3, 4], 5]'::json) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_overlaps with group by having (result)
--Testcase 3915:
SELECT count(c2), json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 group by json_overlaps(c1, '[[1, 2], [3, 4], 5]') HAVING count(c2) > 0;
 count | json_overlaps 
-------+---------------
     1 |             1
     5 |             0
(2 rows)

-- select json_overlaps with group by index having (result)
--Testcase 3916:
SELECT c2,  json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_overlaps 
----+---------------
  1 |             1
  2 |             0
  3 |             0
  4 |             0
  5 |             0
(5 rows)

-- select json_overlaps with group by index having (result)
--Testcase 3917:
SELECT c2,  json_overlaps(c1, '[[1, 2], [3, 4], 5]') FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_overlaps 
----+---------------
  1 |             1
  2 |             0
  3 |             0
  4 |             0
  5 |             0
(5 rows)

-- select json_overlaps and as
--Testcase 3918:
SELECT json_overlaps(c1, c1) as json_overlaps1 FROM s8;
 json_overlaps1 
----------------
              1
              0
              0
              1
              1
              1
(6 rows)

-- select json_pretty (builtin function, explain)
--Testcase 3919:
EXPLAIN VERBOSE
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3633.92 rows=3413 width=128)
   Output: (json_pretty(c1)), (json_pretty(json_build_array(c1, 1))), (json_pretty('[1,3,5]'::json)), (json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_pretty(c1), public.json_pretty(json_build_array(c1, 1)), public.json_pretty('[1,3,5]'::json), public.json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json) FROM public.s8mysql
(4 rows)

-- select json_pretty (builtin function, result)
--Testcase 3920:
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8;
   json_pretty   |    json_pretty    | json_pretty |     json_pretty      
-----------------+-------------------+-------------+----------------------
 [              +| [                +| [          +| [                   +
   [            +|   [              +|   1,       +|   "a",              +
     1,         +|     [            +|   3,       +|   1,                +
     2          +|       1,         +|   5        +|   {                 +
   ],           +|       2          +| ]           |     "key1": "value1"+
   [            +|     ],           +|             |   },                +
     3,         +|     [            +|             |   "5",              +
     4          +|       3,         +|             |   "77",             +
   ],           +|       4          +|             |   {                 +
   5            +|     ],           +|             |     "key2": [       +
 ]               |     5            +|             |       "value3",     +
                 |   ],             +|             |       "valuex",     +
                 |   1              +|             |       "valuey"      +
                 | ]                 |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 []              | [                +| [          +| [                   +
                 |   [],            +|   1,       +|   "a",              +
                 |   1              +|   3,       +|   1,                +
                 | ]                 |   5        +|   {                 +
                 |                   | ]           |     "key1": "value1"+
                 |                   |             |   },                +
                 |                   |             |   "5",              +
                 |                   |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {}              | [                +| [          +| [                   +
                 |   {},            +|   1,       +|   "a",              +
                 |   1              +|   3,       +|   1,                +
                 | ]                 |   5        +|   {                 +
                 |                   | ]           |     "key1": "value1"+
                 |                   |             |   },                +
                 |                   |             |   "5",              +
                 |                   |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {              +| [                +| [          +| [                   +
   "a": "10",   +|   {              +|   1,       +|   "a",              +
   "b": "15",   +|     "a": "10",   +|   3,       +|   1,                +
   "x": 25      +|     "b": "15",   +|   5        +|   {                 +
 }               |     "x": 25      +| ]           |     "key1": "value1"+
                 |   },             +|             |   },                +
                 |   1              +|             |   "5",              +
                 | ]                 |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {              +| [                +| [          +| [                   +
   "a": 1,      +|   {              +|   1,       +|   "a",              +
   "b": 2,      +|     "a": 1,      +|   3,       +|   1,                +
   "c": {       +|     "b": 2,      +|   5        +|   {                 +
     "d": 4     +|     "c": {       +| ]           |     "key1": "value1"+
   }            +|       "d": 4     +|             |   },                +
 }               |     }            +|             |   "5",              +
                 |   },             +|             |   "77",             +
                 |   1              +|             |   {                 +
                 | ]                 |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 [              +| [                +| [          +| [                   +
   "abc",       +|   [              +|   1,       +|   "a",              +
   [            +|     "abc",       +|   3,       +|   1,                +
     {          +|     [            +|   5        +|   {                 +
       "k": "10"+|       {          +| ]           |     "key1": "value1"+
     },         +|         "k": "10"+|             |   },                +
     "def"      +|       },         +|             |   "5",              +
   ],           +|       "def"      +|             |   "77",             +
   {            +|     ],           +|             |   {                 +
     "x": "abc" +|     {            +|             |     "key2": [       +
   },           +|       "x": "abc" +|             |       "value3",     +
   {            +|     },           +|             |       "valuex",     +
     "y": "bcd" +|     {            +|             |       "valuey"      +
   }            +|       "y": "bcd" +|             |     ]               +
 ]               |     }            +|             |   },                +
                 |   ],             +|             |   "j",              +
                 |   1              +|             |   "2"               +
                 | ]                 |             | ]
(6 rows)

-- select json_pretty (builtin function, not pushdown constraints, explain)
--Testcase 3921:
EXPLAIN VERBOSE
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                              QUERY PLAN                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..246.24 rows=17 width=128)
   Output: (json_pretty(c1)), (json_pretty(json_build_array(c1, 1))), (json_pretty('[1,3,5]'::json)), (json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_pretty(c1), public.json_pretty(json_build_array(c1, 1)), public.json_pretty('[1,3,5]'::json), public.json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json), id FROM public.s8mysql
(5 rows)

-- select json_pretty (builtin function, not pushdown constraints, result)
--Testcase 3922:
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8 WHERE to_hex(id) = '2';
 json_pretty | json_pretty | json_pretty |     json_pretty      
-------------+-------------+-------------+----------------------
 {}          | [          +| [          +| [                   +
             |   {},      +|   1,       +|   "a",              +
             |   1        +|   3,       +|   1,                +
             | ]           |   5        +|   {                 +
             |             | ]           |     "key1": "value1"+
             |             |             |   },                +
             |             |             |   "5",              +
             |             |             |   "77",             +
             |             |             |   {                 +
             |             |             |     "key2": [       +
             |             |             |       "value3",     +
             |             |             |       "valuex",     +
             |             |             |       "valuey"      +
             |             |             |     ]               +
             |             |             |   },                +
             |             |             |   "j",              +
             |             |             |   "2"               +
             |             |             | ]
(1 row)

-- select json_pretty (builtin function, pushdown constraints, explain)
--Testcase 3923:
EXPLAIN VERBOSE
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8 WHERE id != 0;
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3625.07 rows=3396 width=128)
   Output: (json_pretty(c1)), (json_pretty(json_build_array(c1, 1))), (json_pretty('[1,3,5]'::json)), (json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_pretty(c1), public.json_pretty(json_build_array(c1, 1)), public.json_pretty('[1,3,5]'::json), public.json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_pretty (builtin function, pushdown constraints, result)
--Testcase 3924:
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8 WHERE id != 0;
   json_pretty   |    json_pretty    | json_pretty |     json_pretty      
-----------------+-------------------+-------------+----------------------
 []              | [                +| [          +| [                   +
                 |   [],            +|   1,       +|   "a",              +
                 |   1              +|   3,       +|   1,                +
                 | ]                 |   5        +|   {                 +
                 |                   | ]           |     "key1": "value1"+
                 |                   |             |   },                +
                 |                   |             |   "5",              +
                 |                   |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {}              | [                +| [          +| [                   +
                 |   {},            +|   1,       +|   "a",              +
                 |   1              +|   3,       +|   1,                +
                 | ]                 |   5        +|   {                 +
                 |                   | ]           |     "key1": "value1"+
                 |                   |             |   },                +
                 |                   |             |   "5",              +
                 |                   |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {              +| [                +| [          +| [                   +
   "a": "10",   +|   {              +|   1,       +|   "a",              +
   "b": "15",   +|     "a": "10",   +|   3,       +|   1,                +
   "x": 25      +|     "b": "15",   +|   5        +|   {                 +
 }               |     "x": 25      +| ]           |     "key1": "value1"+
                 |   },             +|             |   },                +
                 |   1              +|             |   "5",              +
                 | ]                 |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {              +| [                +| [          +| [                   +
   "a": 1,      +|   {              +|   1,       +|   "a",              +
   "b": 2,      +|     "a": 1,      +|   3,       +|   1,                +
   "c": {       +|     "b": 2,      +|   5        +|   {                 +
     "d": 4     +|     "c": {       +| ]           |     "key1": "value1"+
   }            +|       "d": 4     +|             |   },                +
 }               |     }            +|             |   "5",              +
                 |   },             +|             |   "77",             +
                 |   1              +|             |   {                 +
                 | ]                 |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 [              +| [                +| [          +| [                   +
   "abc",       +|   [              +|   1,       +|   "a",              +
   [            +|     "abc",       +|   3,       +|   1,                +
     {          +|     [            +|   5        +|   {                 +
       "k": "10"+|       {          +| ]           |     "key1": "value1"+
     },         +|         "k": "10"+|             |   },                +
     "def"      +|       },         +|             |   "5",              +
   ],           +|       "def"      +|             |   "77",             +
   {            +|     ],           +|             |   {                 +
     "x": "abc" +|     {            +|             |     "key2": [       +
   },           +|       "x": "abc" +|             |       "value3",     +
   {            +|     },           +|             |       "valuex",     +
     "y": "bcd" +|     {            +|             |       "valuey"      +
   }            +|       "y": "bcd" +|             |     ]               +
 ]               |     }            +|             |   },                +
                 |   ],             +|             |   "j",              +
                 |   1              +|             |   "2"               +
                 | ]                 |             | ]
(5 rows)

-- select json_pretty (builtin function, json_pretty in constraints, explain)
--Testcase 3925:
EXPLAIN VERBOSE
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8 WHERE json_length(json_pretty(c1)) != 1;
                                                                                                                                                         QUERY PLAN                                                                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5331.57 rows=3396 width=128)
   Output: (json_pretty(c1)), (json_pretty(json_build_array(c1, 1))), (json_pretty('[1,3,5]'::json)), (json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_pretty(c1), public.json_pretty(json_build_array(c1, 1)), public.json_pretty('[1,3,5]'::json), public.json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json) FROM public.s8mysql WHERE ((public.json_length(public.json_pretty(c1)) <> 1))
(4 rows)

-- select json_pretty (builtin function, json_pretty in constraints, result)
--Testcase 3926:
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8 WHERE json_length(json_pretty(c1)) != 1;
   json_pretty   |    json_pretty    | json_pretty |     json_pretty      
-----------------+-------------------+-------------+----------------------
 [              +| [                +| [          +| [                   +
   [            +|   [              +|   1,       +|   "a",              +
     1,         +|     [            +|   3,       +|   1,                +
     2          +|       1,         +|   5        +|   {                 +
   ],           +|       2          +| ]           |     "key1": "value1"+
   [            +|     ],           +|             |   },                +
     3,         +|     [            +|             |   "5",              +
     4          +|       3,         +|             |   "77",             +
   ],           +|       4          +|             |   {                 +
   5            +|     ],           +|             |     "key2": [       +
 ]               |     5            +|             |       "value3",     +
                 |   ],             +|             |       "valuex",     +
                 |   1              +|             |       "valuey"      +
                 | ]                 |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 []              | [                +| [          +| [                   +
                 |   [],            +|   1,       +|   "a",              +
                 |   1              +|   3,       +|   1,                +
                 | ]                 |   5        +|   {                 +
                 |                   | ]           |     "key1": "value1"+
                 |                   |             |   },                +
                 |                   |             |   "5",              +
                 |                   |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {}              | [                +| [          +| [                   +
                 |   {},            +|   1,       +|   "a",              +
                 |   1              +|   3,       +|   1,                +
                 | ]                 |   5        +|   {                 +
                 |                   | ]           |     "key1": "value1"+
                 |                   |             |   },                +
                 |                   |             |   "5",              +
                 |                   |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {              +| [                +| [          +| [                   +
   "a": "10",   +|   {              +|   1,       +|   "a",              +
   "b": "15",   +|     "a": "10",   +|   3,       +|   1,                +
   "x": 25      +|     "b": "15",   +|   5        +|   {                 +
 }               |     "x": 25      +| ]           |     "key1": "value1"+
                 |   },             +|             |   },                +
                 |   1              +|             |   "5",              +
                 | ]                 |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {              +| [                +| [          +| [                   +
   "a": 1,      +|   {              +|   1,       +|   "a",              +
   "b": 2,      +|     "a": 1,      +|   3,       +|   1,                +
   "c": {       +|     "b": 2,      +|   5        +|   {                 +
     "d": 4     +|     "c": {       +| ]           |     "key1": "value1"+
   }            +|       "d": 4     +|             |   },                +
 }               |     }            +|             |   "5",              +
                 |   },             +|             |   "77",             +
                 |   1              +|             |   {                 +
                 | ]                 |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 [              +| [                +| [          +| [                   +
   "abc",       +|   [              +|   1,       +|   "a",              +
   [            +|     "abc",       +|   3,       +|   1,                +
     {          +|     [            +|   5        +|   {                 +
       "k": "10"+|       {          +| ]           |     "key1": "value1"+
     },         +|         "k": "10"+|             |   },                +
     "def"      +|       },         +|             |   "5",              +
   ],           +|       "def"      +|             |   "77",             +
   {            +|     ],           +|             |   {                 +
     "x": "abc" +|     {            +|             |     "key2": [       +
   },           +|       "x": "abc" +|             |       "value3",     +
   {            +|     },           +|             |       "valuex",     +
     "y": "bcd" +|     {            +|             |       "valuey"      +
   }            +|       "y": "bcd" +|             |     ]               +
 ]               |     }            +|             |   },                +
                 |   ],             +|             |   "j",              +
                 |   1              +|             |   "2"               +
                 | ]                 |             | ]
(6 rows)

-- select json_pretty (builtin function, json_pretty in constraints, explain)
--Testcase 3927:
EXPLAIN VERBOSE
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8 WHERE json_length( json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]')) = 8;
                                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1876.55 rows=17 width=128)
   Output: (json_pretty(c1)), (json_pretty(json_build_array(c1, 1))), (json_pretty('[1,3,5]'::json)), (json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_pretty(c1), public.json_pretty(json_build_array(c1, 1)), public.json_pretty('[1,3,5]'::json), public.json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json) FROM public.s8mysql WHERE ((public.json_length(public.json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json)) = 8))
(4 rows)

-- select json_pretty (builtin function, json_pretty in constraints, result)
--Testcase 3928:
SELECT json_pretty(c1), json_pretty(json_build_array(c1, 1)), json_pretty('[1,3,5]'),  json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8 WHERE json_length( json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]')) = 8;
   json_pretty   |    json_pretty    | json_pretty |     json_pretty      
-----------------+-------------------+-------------+----------------------
 [              +| [                +| [          +| [                   +
   [            +|   [              +|   1,       +|   "a",              +
     1,         +|     [            +|   3,       +|   1,                +
     2          +|       1,         +|   5        +|   {                 +
   ],           +|       2          +| ]           |     "key1": "value1"+
   [            +|     ],           +|             |   },                +
     3,         +|     [            +|             |   "5",              +
     4          +|       3,         +|             |   "77",             +
   ],           +|       4          +|             |   {                 +
   5            +|     ],           +|             |     "key2": [       +
 ]               |     5            +|             |       "value3",     +
                 |   ],             +|             |       "valuex",     +
                 |   1              +|             |       "valuey"      +
                 | ]                 |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 []              | [                +| [          +| [                   +
                 |   [],            +|   1,       +|   "a",              +
                 |   1              +|   3,       +|   1,                +
                 | ]                 |   5        +|   {                 +
                 |                   | ]           |     "key1": "value1"+
                 |                   |             |   },                +
                 |                   |             |   "5",              +
                 |                   |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {}              | [                +| [          +| [                   +
                 |   {},            +|   1,       +|   "a",              +
                 |   1              +|   3,       +|   1,                +
                 | ]                 |   5        +|   {                 +
                 |                   | ]           |     "key1": "value1"+
                 |                   |             |   },                +
                 |                   |             |   "5",              +
                 |                   |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {              +| [                +| [          +| [                   +
   "a": "10",   +|   {              +|   1,       +|   "a",              +
   "b": "15",   +|     "a": "10",   +|   3,       +|   1,                +
   "x": 25      +|     "b": "15",   +|   5        +|   {                 +
 }               |     "x": 25      +| ]           |     "key1": "value1"+
                 |   },             +|             |   },                +
                 |   1              +|             |   "5",              +
                 | ]                 |             |   "77",             +
                 |                   |             |   {                 +
                 |                   |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 {              +| [                +| [          +| [                   +
   "a": 1,      +|   {              +|   1,       +|   "a",              +
   "b": 2,      +|     "a": 1,      +|   3,       +|   1,                +
   "c": {       +|     "b": 2,      +|   5        +|   {                 +
     "d": 4     +|     "c": {       +| ]           |     "key1": "value1"+
   }            +|       "d": 4     +|             |   },                +
 }               |     }            +|             |   "5",              +
                 |   },             +|             |   "77",             +
                 |   1              +|             |   {                 +
                 | ]                 |             |     "key2": [       +
                 |                   |             |       "value3",     +
                 |                   |             |       "valuex",     +
                 |                   |             |       "valuey"      +
                 |                   |             |     ]               +
                 |                   |             |   },                +
                 |                   |             |   "j",              +
                 |                   |             |   "2"               +
                 |                   |             | ]
 [              +| [                +| [          +| [                   +
   "abc",       +|   [              +|   1,       +|   "a",              +
   [            +|     "abc",       +|   3,       +|   1,                +
     {          +|     [            +|   5        +|   {                 +
       "k": "10"+|       {          +| ]           |     "key1": "value1"+
     },         +|         "k": "10"+|             |   },                +
     "def"      +|       },         +|             |   "5",              +
   ],           +|       "def"      +|             |   "77",             +
   {            +|     ],           +|             |   {                 +
     "x": "abc" +|     {            +|             |     "key2": [       +
   },           +|       "x": "abc" +|             |       "value3",     +
   {            +|     },           +|             |       "valuex",     +
     "y": "bcd" +|     {            +|             |       "valuey"      +
   }            +|       "y": "bcd" +|             |     ]               +
 ]               |     }            +|             |   },                +
                 |   ],             +|             |   "j",              +
                 |   1              +|             |   "2"               +
                 | ]                 |             | ]
(6 rows)

-- select json_pretty as nest function with agg (pushdown, explain)
--Testcase 3929:
EXPLAIN VERBOSE
SELECT sum(id), json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8;
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]'::json) FROM public.s8mysql
(6 rows)

-- select json_pretty as nest function with agg (pushdown, result)
--Testcase 3930:
SELECT sum(id), json_pretty('["a",1,{"key1":"value1"},"5","77",{"key2":["value3","valuex","valuey"]},"j","2"]') FROM s8;
 sum |     json_pretty      
-----+----------------------
  15 | [                   +
     |   "a",              +
     |   1,                +
     |   {                 +
     |     "key1": "value1"+
     |   },                +
     |   "5",              +
     |   "77",             +
     |   {                 +
     |     "key2": [       +
     |       "value3",     +
     |       "valuex",     +
     |       "valuey"      +
     |     ]               +
     |   },                +
     |   "j",              +
     |   "2"               +
     | ]
(1 row)

-- select json_pretty with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3931:
EXPLAIN VERBOSE
SELECT json_pretty('[1,3,5]'), pi(), 4.1 FROM s8;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_pretty('[1,3,5]'::json)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_pretty('[1,3,5]'::json), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_pretty with non pushdown func and explicit constant (result)
--Testcase 3932:
SELECT json_pretty('[1,3,5]'), pi(), 4.1 FROM s8;
 json_pretty |        pi         | ?column? 
-------------+-------------------+----------
 [          +| 3.141592653589793 |      4.1
   1,       +|                   | 
   3,       +|                   | 
   5        +|                   | 
 ]           |                   | 
 [          +| 3.141592653589793 |      4.1
   1,       +|                   | 
   3,       +|                   | 
   5        +|                   | 
 ]           |                   | 
 [          +| 3.141592653589793 |      4.1
   1,       +|                   | 
   3,       +|                   | 
   5        +|                   | 
 ]           |                   | 
 [          +| 3.141592653589793 |      4.1
   1,       +|                   | 
   3,       +|                   | 
   5        +|                   | 
 ]           |                   | 
 [          +| 3.141592653589793 |      4.1
   1,       +|                   | 
   3,       +|                   | 
   5        +|                   | 
 ]           |                   | 
 [          +| 3.141592653589793 |      4.1
   1,       +|                   | 
   3,       +|                   | 
   5        +|                   | 
 ]           |                   | 
(6 rows)

-- select json_pretty with order by index (result)
--Testcase 3933:
SELECT id, json_length(json_pretty(c1)) FROM s8 ORDER BY 2, 1;
 id | json_length 
----+-------------
  1 |           0
  2 |           0
  0 |           3
  3 |           3
  4 |           3
  5 |           4
(6 rows)

-- select json_pretty with order by index (result)
--Testcase 3934:
SELECT id, json_length(json_pretty(c1)) FROM s8 ORDER BY 1, 2;
 id | json_length 
----+-------------
  0 |           3
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           4
(6 rows)

-- select json_pretty with group by (EXPLAIN)
--Testcase 3935:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_pretty(c1)) FROM s8 group by json_length(json_pretty(c1));
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_pretty(c1)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_length(public.json_pretty(c1)) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_pretty with group by (result)
--Testcase 3936:
SELECT count(id), json_length(json_pretty(c1)) FROM s8 group by json_length(json_pretty(c1));
 count | json_length 
-------+-------------
     3 |           3
     2 |           0
     1 |           4
(3 rows)

-- select json_pretty with group by index (result)
--Testcase 3937:
SELECT id, json_length(json_pretty(c1)) FROM s8 group by 2, 1;
 id | json_length 
----+-------------
  0 |           3
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           4
(6 rows)

-- select json_pretty with group by index (result)
--Testcase 3938:
SELECT id, json_length(json_pretty(c1)) FROM s8 group by 1, 2;
 id | json_length 
----+-------------
  0 |           3
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           4
(6 rows)

-- select json_pretty with group by having (EXPLAIN)
--Testcase 3939:
EXPLAIN VERBOSE
SELECT count(c2), json_length(json_pretty(c1)) FROM s8 group by json_length(json_pretty(c1)) HAVING count(c2) > 0;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_length(json_pretty(c1)))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_length(public.json_pretty(c1)) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_pretty with group by having (result)
--Testcase 3940:
SELECT count(c2), json_length(json_pretty(c1)) FROM s8 group by json_length(json_pretty(c1)) HAVING count(c2) > 0;
 count | json_length 
-------+-------------
     3 |           3
     2 |           0
     1 |           4
(3 rows)

-- select json_pretty with group by index having (result)
--Testcase 3941:
SELECT c2, json_length(json_pretty(c1)) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           3
  2 |           0
  3 |           0
  4 |           3
  5 |           3
  5 |           4
(6 rows)

-- select json_pretty with group by index having (result)
--Testcase 3942:
SELECT c2, json_length(json_pretty(c1)) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           3
  2 |           0
  3 |           0
  4 |           3
  5 |           3
  5 |           4
(6 rows)

-- select json_pretty and as
--Testcase 3943:
SELECT json_pretty('[1,3,5]') as json_pretty1 FROM s8;
 json_pretty1 
--------------
 [           +
   1,        +
   3,        +
   5         +
 ]
 [           +
   1,        +
   3,        +
   5         +
 ]
 [           +
   1,        +
   3,        +
   5         +
 ]
 [           +
   1,        +
   3,        +
   5         +
 ]
 [           +
   1,        +
   3,        +
   5         +
 ]
 [           +
   1,        +
   3,        +
   5         +
 ]
(6 rows)

-- select json_quote (builtin function, explain)
--Testcase 3944:
EXPLAIN VERBOSE
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8;
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3625.39 rows=3413 width=128)
   Output: (json_quote(c3)), (json_quote('null'::text)), (json_quote('"null"'::text)), (json_quote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_quote(c3), public.json_quote('null'::text), public.json_quote('"null"'::text), public.json_quote('[1, 2, 3]'::text) FROM public.s8mysql
(4 rows)

-- select json_quote (builtin function, result)
--Testcase 3945:
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8;
 json_quote | json_quote | json_quote | json_quote  
------------+------------+------------+-------------
 "This"     | "null"     | "\"null\"" | "[1, 2, 3]"
 "is"       | "null"     | "\"null\"" | "[1, 2, 3]"
 "text"     | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
(6 rows)

-- select json_quote (builtin function, not pushdown constraints, explain)
--Testcase 3946:
EXPLAIN VERBOSE
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8 WHERE to_hex(id) = '2';
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..246.19 rows=17 width=128)
   Output: (json_quote(c3)), (json_quote('null'::text)), (json_quote('"null"'::text)), (json_quote('[1, 2, 3]'::text))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_quote(c3), public.json_quote('null'::text), public.json_quote('"null"'::text), public.json_quote('[1, 2, 3]'::text), id FROM public.s8mysql
(5 rows)

-- select json_quote (builtin function, not pushdown constraints, result)
--Testcase 3947:
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8 WHERE to_hex(id) = '2';
 json_quote | json_quote | json_quote | json_quote  
------------+------------+------------+-------------
 "text"     | "null"     | "\"null\"" | "[1, 2, 3]"
(1 row)

-- select json_quote (builtin function, pushdown constraints, explain)
--Testcase 3948:
EXPLAIN VERBOSE
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8 WHERE id != 0;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3616.58 rows=3396 width=128)
   Output: (json_quote(c3)), (json_quote('null'::text)), (json_quote('"null"'::text)), (json_quote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_quote(c3), public.json_quote('null'::text), public.json_quote('"null"'::text), public.json_quote('[1, 2, 3]'::text) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_quote (builtin function, pushdown constraints, result)
--Testcase 3949:
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8 WHERE id != 0;
 json_quote | json_quote | json_quote | json_quote  
------------+------------+------------+-------------
 "is"       | "null"     | "\"null\"" | "[1, 2, 3]"
 "text"     | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
(5 rows)

-- select json_quote (builtin function, json_quote in constraints, explain)
--Testcase 3950:
EXPLAIN VERBOSE
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8 WHERE json_length(json_quote(c3)) != 0;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5323.08 rows=3396 width=128)
   Output: (json_quote(c3)), (json_quote('null'::text)), (json_quote('"null"'::text)), (json_quote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_quote(c3), public.json_quote('null'::text), public.json_quote('"null"'::text), public.json_quote('[1, 2, 3]'::text) FROM public.s8mysql WHERE ((public.json_length(public.json_quote(c3)) <> 0))
(4 rows)

-- select json_quote (builtin function, json_quote in constraints, result)
--Testcase 3951:
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8 WHERE json_length(json_quote(c3)) != 0;
 json_quote | json_quote | json_quote | json_quote  
------------+------------+------------+-------------
 "This"     | "null"     | "\"null\"" | "[1, 2, 3]"
 "is"       | "null"     | "\"null\"" | "[1, 2, 3]"
 "text"     | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
(6 rows)

-- select json_quote (builtin function, json_quote in constraints, explain)
--Testcase 3952:
EXPLAIN VERBOSE
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8 WHERE json_length(json_quote('[1, 2, 3]')) = 1;
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1876.50 rows=17 width=128)
   Output: (json_quote(c3)), (json_quote('null'::text)), (json_quote('"null"'::text)), (json_quote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_quote(c3), public.json_quote('null'::text), public.json_quote('"null"'::text), public.json_quote('[1, 2, 3]'::text) FROM public.s8mysql WHERE ((public.json_length(public.json_quote('[1, 2, 3]'::text)) = 1))
(4 rows)

-- select json_quote (builtin function, json_quote in constraints, result)
--Testcase 3953:
SELECT json_quote(c3), json_quote('null'), json_quote('"null"'), json_quote('[1, 2, 3]') FROM s8 WHERE json_length(json_quote('[1, 2, 3]')) = 1;
 json_quote | json_quote | json_quote | json_quote  
------------+------------+------------+-------------
 "This"     | "null"     | "\"null\"" | "[1, 2, 3]"
 "is"       | "null"     | "\"null\"" | "[1, 2, 3]"
 "text"     | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
 "scalar"   | "null"     | "\"null\"" | "[1, 2, 3]"
(6 rows)

-- select json_quote as nest function with agg (pushdown, explain)
--Testcase 3954:
EXPLAIN VERBOSE
SELECT sum(id), json_quote('[1, 2, 3]') FROM s8;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_quote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_quote('[1, 2, 3]'::text) FROM public.s8mysql
(6 rows)

-- select json_quote as nest function with agg (pushdown, result)
--Testcase 3955:
SELECT sum(id), json_quote('[1, 2, 3]') FROM s8;
 sum | json_quote  
-----+-------------
  15 | "[1, 2, 3]"
(1 row)

-- select json_quote with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3956:
EXPLAIN VERBOSE
SELECT json_quote('null'), pi(), 4.1 FROM s8;
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_quote('null'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_quote('null'::text), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_quote with non pushdown func and explicit constant (result)
--Testcase 3957:
SELECT json_quote('null'), pi(), 4.1 FROM s8;
 json_quote |        pi         | ?column? 
------------+-------------------+----------
 "null"     | 3.141592653589793 |      4.1
 "null"     | 3.141592653589793 |      4.1
 "null"     | 3.141592653589793 |      4.1
 "null"     | 3.141592653589793 |      4.1
 "null"     | 3.141592653589793 |      4.1
 "null"     | 3.141592653589793 |      4.1
(6 rows)

-- select json_quote with order by index (result)
--Testcase 3958:
SELECT id,  json_length(json_quote(c3)) FROM s8 ORDER BY 2, 1;
 id | json_length 
----+-------------
  0 |           1
  1 |           1
  2 |           1
  3 |           1
  4 |           1
  5 |           1
(6 rows)

-- select json_quote with order by index (result)
--Testcase 3959:
SELECT id,  json_length(json_quote(c3)) FROM s8 ORDER BY 1, 2;
 id | json_length 
----+-------------
  0 |           1
  1 |           1
  2 |           1
  3 |           1
  4 |           1
  5 |           1
(6 rows)

-- select json_quote with group by (EXPLAIN)
--Testcase 3960:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_quote(c3)) FROM s8 group by json_length(json_quote(c3));
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_quote(c3)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_length(public.json_quote(c3)) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_quote with group by (result)
--Testcase 3961:
SELECT count(id), json_length(json_quote(c3)) FROM s8 group by json_length(json_quote(c3));
 count | json_length 
-------+-------------
     6 |           1
(1 row)

-- select json_quote with group by index (result)
--Testcase 3962:
SELECT id,  json_length(json_quote(c3)) FROM s8 group by 2, 1;
 id | json_length 
----+-------------
  0 |           1
  1 |           1
  2 |           1
  3 |           1
  4 |           1
  5 |           1
(6 rows)

-- select json_quote with group by index (result)
--Testcase 3963:
SELECT id,  json_length(json_quote(c3)) FROM s8 group by 1, 2;
 id | json_length 
----+-------------
  0 |           1
  1 |           1
  2 |           1
  3 |           1
  4 |           1
  5 |           1
(6 rows)

-- select json_quote with group by having (EXPLAIN)
--Testcase 3964:
EXPLAIN VERBOSE
SELECT count(c2), json_length(json_quote(c3)) FROM s8 group by json_length(json_quote(c3)) HAVING count(c2) > 0;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_length(json_quote(c3)))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_length(public.json_quote(c3)) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_quote with group by having (result)
--Testcase 3965:
SELECT count(c2), json_length(json_quote(c3)) FROM s8 group by json_length(json_quote(c3)) HAVING count(c2) > 0;
 count | json_length 
-------+-------------
     6 |           1
(1 row)

-- select json_quote with group by index having (result)
--Testcase 3966:
SELECT c2,  json_length(json_quote(c3)) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           1
  2 |           1
  3 |           1
  4 |           1
  5 |           1
(5 rows)

-- select json_quote with group by index having (result)
--Testcase 3967:
SELECT c2,  json_length(json_quote(c3)) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           1
  2 |           1
  3 |           1
  4 |           1
  5 |           1
(5 rows)

-- select json_quote and as
--Testcase 3968:
SELECT json_quote('null') as json_quote1 FROM s8;
 json_quote1 
-------------
 "null"
 "null"
 "null"
 "null"
 "null"
 "null"
(6 rows)

-- select json_remove (builtin function, explain)
--Testcase 3969:
EXPLAIN VERBOSE
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'),json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8;
                                                                                                                                                                                           QUERY PLAN                                                                                                                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4487.17 rows=3413 width=160)
   Output: (json_remove(c1, VARIADIC '{$[1]}'::text[])), (json_remove(c1, VARIADIC '{$[1],$[2]}'::text[])), (json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[])), (json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[])), (json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_remove(c1, VARIADIC '{$[1]}'::text[]), public.json_remove(c1, VARIADIC '{$[1],$[2]}'::text[]), public.json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[]), public.json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[]), public.json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]) FROM public.s8mysql
(4 rows)

-- select json_remove (builtin function, result)
--Testcase 3970:
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8;
             json_remove             |           json_remove           |                         json_remove                         |  json_remove  |      json_remove       
-------------------------------------+---------------------------------+-------------------------------------------------------------+---------------+------------------------
 [[1, 2], 5]                         | [[1, 2], 5]                     | [[[1, 2], [3, 4], 5]]                                       | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 []                                  | []                              | [[]]                                                        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {}                                  | {}                              | [{}]                                                        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {"a": "10", "b": "15", "x": 25}     | {"a": "10", "b": "15", "x": 25} | [{"a": "10", "b": "15", "x": 25}]                           | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {"a": 1, "b": 2, "c": {"d": 4}}     | {"a": 1, "b": 2, "c": {"d": 4}} | [{"a": 1, "b": 2, "c": {"d": 4}}]                           | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 ["abc", {"x": "abc"}, {"y": "bcd"}] | ["abc", {"x": "abc"}]           | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]] | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
(6 rows)

-- select json_remove (builtin function, not pushdown constraints, explain)
--Testcase 3971:
EXPLAIN VERBOSE
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                                                             QUERY PLAN                                                                                                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..250.49 rows=17 width=160)
   Output: (json_remove(c1, VARIADIC '{$[1]}'::text[])), (json_remove(c1, VARIADIC '{$[1],$[2]}'::text[])), (json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[])), (json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[])), (json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_remove(c1, VARIADIC '{$[1]}'::text[]), public.json_remove(c1, VARIADIC '{$[1],$[2]}'::text[]), public.json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[]), public.json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[]), public.json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]), id FROM public.s8mysql
(5 rows)

-- select json_remove (builtin function, not pushdown constraints, result)
--Testcase 3972:
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8 WHERE to_hex(id) = '2';
 json_remove | json_remove | json_remove |  json_remove  |      json_remove       
-------------+-------------+-------------+---------------+------------------------
 {}          | {}          | [{}]        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
(1 row)

-- select json_remove (builtin function, pushdown constraints, explain)
--Testcase 3973:
EXPLAIN VERBOSE
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8 WHERE id != 0;
                                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4474.07 rows=3396 width=160)
   Output: (json_remove(c1, VARIADIC '{$[1]}'::text[])), (json_remove(c1, VARIADIC '{$[1],$[2]}'::text[])), (json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[])), (json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[])), (json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_remove(c1, VARIADIC '{$[1]}'::text[]), public.json_remove(c1, VARIADIC '{$[1],$[2]}'::text[]), public.json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[]), public.json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[]), public.json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_remove (builtin function, pushdown constraints, result)
--Testcase 3974:
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8 WHERE id != 0;
             json_remove             |           json_remove           |                         json_remove                         |  json_remove  |      json_remove       
-------------------------------------+---------------------------------+-------------------------------------------------------------+---------------+------------------------
 []                                  | []                              | [[]]                                                        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {}                                  | {}                              | [{}]                                                        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {"a": "10", "b": "15", "x": 25}     | {"a": "10", "b": "15", "x": 25} | [{"a": "10", "b": "15", "x": 25}]                           | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {"a": 1, "b": 2, "c": {"d": 4}}     | {"a": 1, "b": 2, "c": {"d": 4}} | [{"a": 1, "b": 2, "c": {"d": 4}}]                           | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 ["abc", {"x": "abc"}, {"y": "bcd"}] | ["abc", {"x": "abc"}]           | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]] | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
(5 rows)

-- select json_remove (builtin function, json_remove in constraints, explain)
--Testcase 3975:
EXPLAIN VERBOSE
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8 WHERE json_length(json_remove(c1, '$[1]')) != 1;
                                                                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..6180.57 rows=3396 width=160)
   Output: (json_remove(c1, VARIADIC '{$[1]}'::text[])), (json_remove(c1, VARIADIC '{$[1],$[2]}'::text[])), (json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[])), (json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[])), (json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_remove(c1, VARIADIC '{$[1]}'::text[]), public.json_remove(c1, VARIADIC '{$[1],$[2]}'::text[]), public.json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[]), public.json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[]), public.json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]) FROM public.s8mysql WHERE ((public.json_length(public.json_remove(c1, VARIADIC '{$[1]}'::text[])) <> 1))
(4 rows)

-- select json_remove (builtin function, json_remove in constraints, result)
--Testcase 3976:
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8 WHERE json_length(json_remove(c1, '$[1]')) != 1;
             json_remove             |           json_remove           |                         json_remove                         |  json_remove  |      json_remove       
-------------------------------------+---------------------------------+-------------------------------------------------------------+---------------+------------------------
 [[1, 2], 5]                         | [[1, 2], 5]                     | [[[1, 2], [3, 4], 5]]                                       | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 []                                  | []                              | [[]]                                                        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {}                                  | {}                              | [{}]                                                        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {"a": "10", "b": "15", "x": 25}     | {"a": "10", "b": "15", "x": 25} | [{"a": "10", "b": "15", "x": 25}]                           | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {"a": 1, "b": 2, "c": {"d": 4}}     | {"a": 1, "b": 2, "c": {"d": 4}} | [{"a": 1, "b": 2, "c": {"d": 4}}]                           | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 ["abc", {"x": "abc"}, {"y": "bcd"}] | ["abc", {"x": "abc"}]           | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]] | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
(6 rows)

-- select json_remove (builtin function, json_remove in constraints, explain)
--Testcase 3977:
EXPLAIN VERBOSE
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8 WHERE json_length(json_remove('{ "a": 1, "b": [2, 3]}', '$.a')) = 1;
                                                                                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1880.80 rows=17 width=160)
   Output: (json_remove(c1, VARIADIC '{$[1]}'::text[])), (json_remove(c1, VARIADIC '{$[1],$[2]}'::text[])), (json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[])), (json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[])), (json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_remove(c1, VARIADIC '{$[1]}'::text[]), public.json_remove(c1, VARIADIC '{$[1],$[2]}'::text[]), public.json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[]), public.json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[]), public.json_remove('["a", ["b", "c"], "d"]'::json, VARIADIC '{$.a}'::text[]) FROM public.s8mysql WHERE ((public.json_length(public.json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[])) = 1))
(4 rows)

-- select json_remove (builtin function, json_remove in constraints, result)
--Testcase 3978:
SELECT json_remove(c1, '$[1]'), json_remove(c1, '$[1]', '$[2]'), json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), json_remove('{ "a": 1, "b": [2, 3]}', '$.a'), json_remove('["a", ["b", "c"], "d"]', '$.a') FROM s8 WHERE json_length(json_remove('{ "a": 1, "b": [2, 3]}', '$.a')) = 1;
             json_remove             |           json_remove           |                         json_remove                         |  json_remove  |      json_remove       
-------------------------------------+---------------------------------+-------------------------------------------------------------+---------------+------------------------
 [[1, 2], 5]                         | [[1, 2], 5]                     | [[[1, 2], [3, 4], 5]]                                       | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 []                                  | []                              | [[]]                                                        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {}                                  | {}                              | [{}]                                                        | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {"a": "10", "b": "15", "x": 25}     | {"a": "10", "b": "15", "x": 25} | [{"a": "10", "b": "15", "x": 25}]                           | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 {"a": 1, "b": 2, "c": {"d": 4}}     | {"a": 1, "b": 2, "c": {"d": 4}} | [{"a": 1, "b": 2, "c": {"d": 4}}]                           | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
 ["abc", {"x": "abc"}, {"y": "bcd"}] | ["abc", {"x": "abc"}]           | [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]] | {"b": [2, 3]} | ["a", ["b", "c"], "d"]
(6 rows)

-- select json_remove as nest function with agg (pushdown, explain)
--Testcase 3979:
EXPLAIN VERBOSE
SELECT sum(id), json_remove('{ "a": 1, "b": [2, 3]}', '$.a') FROM s8;
                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_remove('{ "a": 1, "b": [2, 3]}'::json, VARIADIC '{$.a}'::text[]) FROM public.s8mysql
(6 rows)

-- select json_remove as nest function with agg (pushdown, result)
--Testcase 3980:
SELECT sum(id), json_remove('{ "a": 1, "b": [2, 3]}', '$.a') FROM s8;
 sum |  json_remove  
-----+---------------
  15 | {"b": [2, 3]}
(1 row)

-- select json_remove with non pushdown func and explicit constant (EXPLAIN)
--Testcase 3981:
EXPLAIN VERBOSE
SELECT json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), pi(), 4.1 FROM s8;
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_remove(json_build_array(c1, '1'), VARIADIC '{$[1],$[2]}'::text[]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_remove with non pushdown func and explicit constant (result)
--Testcase 3982:
SELECT json_remove(json_build_array(c1, '1'), '$[1]', '$[2]'), pi(), 4.1 FROM s8;
                         json_remove                         |        pi         | ?column? 
-------------------------------------------------------------+-------------------+----------
 [[[1, 2], [3, 4], 5]]                                       | 3.141592653589793 |      4.1
 [[]]                                                        | 3.141592653589793 |      4.1
 [{}]                                                        | 3.141592653589793 |      4.1
 [{"a": "10", "b": "15", "x": 25}]                           | 3.141592653589793 |      4.1
 [{"a": 1, "b": 2, "c": {"d": 4}}]                           | 3.141592653589793 |      4.1
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]] | 3.141592653589793 |      4.1
(6 rows)

-- select json_remove with order by index (result)
--Testcase 3983:
SELECT id,  json_length(json_remove(c1, '$[1]')) FROM s8 ORDER BY 2, 1;
 id | json_length 
----+-------------
  1 |           0
  2 |           0
  0 |           2
  3 |           3
  4 |           3
  5 |           3
(6 rows)

-- select json_remove with order by index (result)
--Testcase 3984:
SELECT id,  json_length(json_remove(c1, '$[1]')) FROM s8 ORDER BY 1, 2;
 id | json_length 
----+-------------
  0 |           2
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           3
(6 rows)

-- select json_remove with group by (EXPLAIN)
--Testcase 3985:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_remove(c1, '$[1]')) FROM s8 group by json_length(json_remove(c1, '$[1]'));
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_remove(c1, VARIADIC '{$[1]}'::text[])))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_length(public.json_remove(c1, VARIADIC '{$[1]}'::text[])) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_remove with group by (result)
--Testcase 3986:
SELECT count(id), json_length(json_remove(c1, '$[1]')) FROM s8 group by json_length(json_remove(c1, '$[1]'));
 count | json_length 
-------+-------------
     1 |           2
     2 |           0
     3 |           3
(3 rows)

-- select json_remove with group by index (result)
--Testcase 3987:
SELECT id,  json_length(json_remove(c1, '$[1]')) FROM s8 group by 2, 1;
 id | json_length 
----+-------------
  0 |           2
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           3
(6 rows)

-- select json_remove with group by index (result)
--Testcase 3988:
SELECT id,  json_length(json_remove(c1, '$[1]')) FROM s8 group by 1, 2;
 id | json_length 
----+-------------
  0 |           2
  1 |           0
  2 |           0
  3 |           3
  4 |           3
  5 |           3
(6 rows)

-- select json_remove with group by having (EXPLAIN)
--Testcase 3989:
EXPLAIN VERBOSE
SELECT count(c2), json_length(json_remove(c1, '$[1]')) FROM s8 group by json_length(json_remove(c1, '$[1]')) HAVING count(c2) > 0;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_length(json_remove(c1, VARIADIC '{$[1]}'::text[])))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_length(public.json_remove(c1, VARIADIC '{$[1]}'::text[])) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_remove with group by having (result)
--Testcase 3990:
SELECT count(c2), json_length(json_remove(c1, '$[1]')) FROM s8 group by json_length(json_remove(c1, '$[1]')) HAVING count(c2) > 0;
 count | json_length 
-------+-------------
     1 |           2
     2 |           0
     3 |           3
(3 rows)

-- select json_remove with group by index having (result)
--Testcase 3991:
SELECT c2,  json_length(json_remove(c1, '$[1]')) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           2
  2 |           0
  3 |           0
  4 |           3
  5 |           3
(5 rows)

-- select json_remove with group by index having (result)
--Testcase 3992:
SELECT c2,  json_length(json_remove(c1, '$[1]')) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_length 
----+-------------
  1 |           2
  2 |           0
  3 |           0
  4 |           3
  5 |           3
(5 rows)

-- select json_remove and as
--Testcase 3993:
SELECT json_remove(json_build_array(c1, '1'), '$[1]', '$[2]') as json_remove1 FROM s8;
                        json_remove1                         
-------------------------------------------------------------
 [[[1, 2], [3, 4], 5]]
 [[]]
 [{}]
 [{"a": "10", "b": "15", "x": 25}]
 [{"a": 1, "b": 2, "c": {"d": 4}}]
 [["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]]
(6 rows)

-- select json_replace (stub function, explain)
--Testcase 3994:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_replace (stub function, result)
--Testcase 3995:
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
   json_replace    
-------------------
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
(6 rows)

-- select json_replace (stub function, not pushdown constraints, explain)
--Testcase 3996:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, pi()') FROM s8 WHERE to_hex(id) = '1';
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..233.44 rows=17 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', pi()"}'::path_value[]))
   Filter: (to_hex(s8.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', pi()"}'::public.path_value[]), id FROM public.s8mysql
(5 rows)

-- select json_replace (stub function, not pushdown constraints, result)
--Testcase 3997:
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, pi()') FROM s8 WHERE to_hex(id) = '1';
   json_replace    
-------------------
 3.141592653589793
(1 row)

-- select json_replace (stub function, pushdown constraints, explain)
--Testcase 3998:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..157.25 rows=17 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', CAST(\"[true, false]\" AS JSON)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC E'{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', CAST(\\"[true, false]\\" AS JSON)"}'::public.path_value[]) FROM public.s8mysql WHERE ((id = 1))
(4 rows)

-- select json_replace (stub function, pushdown constraints, result)
--Testcase 3999:
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
 json_replace  
---------------
 [true, false]
(1 row)

-- select json_replace (stub function, stub in constraints, explain)
--Testcase 4000:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, "[true, false]"') FROM s8 WHERE log2(id) > 1;
                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1321.71 rows=1138 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', ''[true, false]''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', ''[true, false]''"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.log2(id) > 1::double precision))
(4 rows)

-- select json_replace (stub function, stub in constraints, result)
--Testcase 4001:
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, "[true, false]"') FROM s8 WHERE log2(id) > 1;
  json_replace   
-----------------
 "[true, false]"
 "[true, false]"
 "[true, false]"
(3 rows)

-- select json_replace (stub function, stub in constraints, explain)
--Testcase 4002:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8 WHERE json_depth(json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()')) > 0;
                                                                                                                                                                  QUERY PLAN                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2166.42 rows=1138 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.json_depth(public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[])) > 0))
(4 rows)

-- select json_replace (stub function, stub in constraints, result)
--Testcase 4003:
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8 WHERE json_depth(json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()')) > 0;
   json_replace    
-------------------
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
(6 rows)

-- json_replace with 1 arg explain
--Testcase 4004:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2') FROM s8;
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_replace with 1 arg result
--Testcase 4005:
SELECT json_replace(c1, '$.a, c2') FROM s8;
                       json_replace                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {}
 {"a": 4, "b": "15", "x": 25}
 {"a": 5, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_replace with 2 args explain
--Testcase 4006:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3') FROM s8;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_replace with 2 args result
--Testcase 4007:
SELECT json_replace(c1, '$.a, c2', '$.b, c3') FROM s8;
                       json_replace                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {}
 {"a": 4, "b": "scalar", "x": 25}
 {"a": 5, "b": "scalar", "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_replace with 3 args explain
--Testcase 4008:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1') FROM s8;
                                                                   QUERY PLAN                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_replace with 3 args result
--Testcase 4009:
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1') FROM s8;
                       json_replace                        
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {}
 {"a": 4, "b": "scalar", "x": 25}
 {"a": 5, "b": "scalar", "c": 1}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_replace with 4 args explain
--Testcase 4010:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"') FROM s8;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_replace with 4 args result
--Testcase 4011:
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"') FROM s8;
 json_replace 
--------------
 "a"
 "a"
 "a"
 "a"
 "a"
 "a"
(6 rows)

-- json_replace with 5 args explain
--Testcase 4012:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_replace with 5 args result
--Testcase 4013:
SELECT json_replace(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
   json_replace    
-------------------
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
(6 rows)

-- select json_replace as nest function with agg (pushdown, explain)
--Testcase 4014:
EXPLAIN VERBOSE
SELECT sum(id),json_replace('["a", ["b", "c"], "d"]', '$, sum(id)') FROM s8;
                                                                         QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_replace('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', sum(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_replace('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', sum(id)"}'::public.path_value[]) FROM public.s8mysql
(6 rows)

-- select json_replace as nest function with agg (pushdown, result)
--Testcase 4015:
SELECT sum(id),json_replace('["a", ["b", "c"], "d"]', '$, sum(id)') FROM s8;
 sum | json_replace 
-----+--------------
  15 | 15
(1 row)

-- select json_replace as nest function with json_build_array (pushdown, explain)
--Testcase 4016:
EXPLAIN VERBOSE
SELECT json_replace(json_build_array('["a", ["b", "c"], "d"]', c1), '$, log2(id)') FROM s8;
                                                                             QUERY PLAN                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=32)
   Output: (json_replace(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$'', log2(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$'', log2(id)"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_replace as nest function with agg (pushdown, result)
--Testcase 4017:
SELECT json_replace(json_build_array('["a", ["b", "c"], "d"]', c1), '$, log2(id)') FROM s8;
   json_replace    
-------------------
 null
 0.0
 1.0
 1.584962500721156
 2.0
 2.321928094887362
(6 rows)

-- select json_replace with non pushdown func and explicit constant (explain)
--Testcase 4018:
EXPLAIN VERBOSE
SELECT json_replace(c1, '$.a, c2'), pi(), 4.1 FROM s8;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_replace(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_replace(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_replace with non pushdown func and explicit constant (result)
--Testcase 4019:
SELECT json_replace(c1, '$.a, c2'), pi(), 4.1 FROM s8;
                       json_replace                        |        pi         | ?column? 
-----------------------------------------------------------+-------------------+----------
 [[1, 2], [3, 4], 5]                                       | 3.141592653589793 |      4.1
 []                                                        | 3.141592653589793 |      4.1
 {}                                                        | 3.141592653589793 |      4.1
 {"a": 4, "b": "15", "x": 25}                              | 3.141592653589793 |      4.1
 {"a": 5, "b": 2, "c": {"d": 4}}                           | 3.141592653589793 |      4.1
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] | 3.141592653589793 |      4.1
(6 rows)

-- select json_replace with order by (explain)
--Testcase 4020:
EXPLAIN VERBOSE
SELECT json_length(json_replace(c1, '$.a, c2')) FROM s8 ORDER BY 1;
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=4)
   Output: (json_length(json_replace(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
   Sort Key: (json_length(json_replace(s8.c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
   ->  Foreign Scan on public.s8  (cost=100.00..1918.89 rows=3413 width=4)
         Output: (json_length(json_replace(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.json_length(public.json_replace(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[])) FROM public.s8mysql
(7 rows)

-- select json_replace with order by (result)
--Testcase 4021:
SELECT json_length(json_replace(c1, '$.a, c2')) FROM s8 ORDER BY 1;
 json_length 
-------------
           0
           0
           3
           3
           3
           4
(6 rows)

-- select json_replace with group by (explain)
--Testcase 4022:
EXPLAIN VERBOSE
SELECT json_length(json_replace('["a", ["b", "c"], "d"]', '$, id')) FROM s8 GROUP BY 1;
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=4)
   Output: (json_length(json_replace('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', id"}'::path_value[])))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_length(public.json_replace('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', id"}'::public.path_value[])) FROM public.s8mysql GROUP BY 1
(6 rows)

-- select json_replace with group by (result)
--Testcase 4023:
SELECT json_length(json_replace('["a", ["b", "c"], "d"]', '$, id')) FROM s8 GROUP BY 1;
 json_length 
-------------
           1
(1 row)

-- select json_replace with group by having (explain)
--Testcase 4024:
EXPLAIN VERBOSE
SELECT json_depth(json_replace('["a", ["b", "c"], "d"]', '$, c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (json_depth(json_replace('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', c2"}'::path_value[]))), c2
   Filter: ((count(s8.c2)) > 1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_depth(public.json_replace('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', c2"}'::public.path_value[])), c2, count(c2) FROM public.s8mysql GROUP BY 2, 1
(7 rows)

-- select json_replace with group by having (result)
--Testcase 4025:
SELECT json_depth(json_replace('["a", ["b", "c"], "d"]', '$, c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
 json_depth 
------------
          1
(1 row)

-- select json_replace and as
--Testcase 4026:
SELECT json_replace(c1, '$.a, c2') AS json_replace1 FROM s8;
                       json_replace1                       
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {}
 {"a": 4, "b": "15", "x": 25}
 {"a": 5, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- select json_schema_valid (builtin function, explain)
--Testcase 4027:
EXPLAIN VERBOSE
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9;
                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..5331.89 rows=3413 width=20)
   Output: (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json)), (json_schema_valid(c1, json_quote('null'::text))), (json_schema_valid(c1, '{}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), public.json_schema_valid(c1, public.json_quote('null'::text)), public.json_schema_valid(c1, '{}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql
(4 rows)

-- select json_schema_valid (builtin function, result)
--Testcase 4028:
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9;
 json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid 
-------------------+-------------------+-------------------+-------------------+-------------------
                 1 |                 1 |                 0 |                 0 |                 1
                 0 |                 0 |                 0 |                 1 |                 0
(2 rows)

-- select json_schema_valid (builtin function, not pushdown constraints, explain)
--Testcase 4029:
EXPLAIN VERBOSE
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE to_hex(id) = '1';
                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..254.69 rows=17 width=20)
   Output: (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json)), (json_schema_valid(c1, json_quote('null'::text))), (json_schema_valid(c1, '{}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json))
   Filter: (to_hex(s9.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), public.json_schema_valid(c1, public.json_quote('null'::text)), public.json_schema_valid(c1, '{}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json), id FROM public.s9mysql
(5 rows)

-- select json_schema_valid (builtin function, not pushdown constraints, result)
--Testcase 4030:
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE to_hex(id) = '1';
 json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid 
-------------------+-------------------+-------------------+-------------------+-------------------
                 0 |                 0 |                 0 |                 1 |                 0
(1 row)

-- select json_schema_valid (builtin function, pushdown constraints, explain)
--Testcase 4031:
EXPLAIN VERBOSE
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE id != 0;
                                                                                                                                                                                                       QUERY PLAN                                                                                                                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..5314.58 rows=3396 width=20)
   Output: (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json)), (json_schema_valid(c1, json_quote('null'::text))), (json_schema_valid(c1, '{}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), public.json_schema_valid(c1, public.json_quote('null'::text)), public.json_schema_valid(c1, '{}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql WHERE ((id <> 0))
(4 rows)

-- select json_schema_valid (builtin function, pushdown constraints, result)
--Testcase 4032:
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE id != 0;
 json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid 
-------------------+-------------------+-------------------+-------------------+-------------------
                 0 |                 0 |                 0 |                 1 |                 0
(1 row)

-- select json_schema_valid (builtin function, json_schema_valid in constraints, explain)
--Testcase 4033:
EXPLAIN VERBOSE
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) != 0;
                                                                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..6167.83 rows=3396 width=20)
   Output: (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json)), (json_schema_valid(c1, json_quote('null'::text))), (json_schema_valid(c1, '{}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), public.json_schema_valid(c1, public.json_quote('null'::text)), public.json_schema_valid(c1, '{}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql WHERE ((public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) <> 0))
(4 rows)

-- select json_schema_valid (builtin function, json_schema_valid in constraints, result)
--Testcase 4034:
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) != 0;
 json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid 
-------------------+-------------------+-------------------+-------------------+-------------------
                 1 |                 1 |                 0 |                 0 |                 1
(1 row)

-- select json_schema_valid (builtin function, json_schema_valid in constraints, explain)
--Testcase 4035:
EXPLAIN VERBOSE
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) = 1;
                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..1031.75 rows=17 width=20)
   Output: (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json)), (json_schema_valid(c1, json_quote('null'::text))), (json_schema_valid(c1, '{}'::json)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), public.json_schema_valid(c1, public.json_quote('null'::text)), public.json_schema_valid(c1, '{}'::json), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql WHERE ((public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) = 1))
(4 rows)

-- select json_schema_valid (builtin function, json_schema_valid in constraints, result)
--Testcase 4036:
SELECT json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 9}'::json), json_schema_valid(c1, json_quote('null')), json_schema_valid(c1, '{}'), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 30}'::json) = 1;
 json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid | json_schema_valid 
-------------------+-------------------+-------------------+-------------------+-------------------
                 1 |                 1 |                 0 |                 0 |                 1
(1 row)

-- select json_schema_valid as nest function with agg (pushdown, explain)
--Testcase 4037:
EXPLAIN VERBOSE
SELECT sum(id),json_schema_valid(json_build_object('latitude', sum(id), 'longitude', avg(id)), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9;
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (sum(id)), (json_schema_valid(json_build_object('latitude', sum(id), 'longitude', avg(id)), '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s9)
     Remote SQL: SELECT sum(id), public.json_schema_valid(json_build_object('latitude', sum(id), 'longitude', avg(id)), '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql
(6 rows)

-- select json_schema_valid as nest function with agg (pushdown, result)
--Testcase 4038:
SELECT sum(id),json_schema_valid(json_build_object('latitude', sum(id), 'longitude', avg(id)), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9;
 sum | json_schema_valid 
-----+-------------------
   1 |                 1
(1 row)

-- select json_schema_valid with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4039:
EXPLAIN VERBOSE
SELECT json_schema_valid(c1, json_quote('null')), pi(), 4.1 FROM s9;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..1918.89 rows=3413 width=44)
   Output: (json_schema_valid(c1, json_quote('null'::text))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_valid(c1, public.json_quote('null'::text)), 3.141592653589793::double precision, 4.1 FROM public.s9mysql
(4 rows)

-- select json_schema_valid with non pushdown func and explicit constant (result)
--Testcase 4040:
SELECT json_schema_valid(c1, json_quote('null')), pi(), 4.1 FROM s9;
 json_schema_valid |        pi         | ?column? 
-------------------+-------------------+----------
                 0 | 3.141592653589793 |      4.1
                 0 | 3.141592653589793 |      4.1
(2 rows)

-- select json_schema_valid with order by index (result)
--Testcase 4041:
SELECT id,  json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 order by 2, 1;
 id | json_schema_valid 
----+-------------------
  1 |                 0
  0 |                 1
(2 rows)

-- select json_schema_valid with order by index (result)
--Testcase 4042:
SELECT id,  json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 order by 1, 2;
 id | json_schema_valid 
----+-------------------
  0 |                 1
  1 |                 0
(2 rows)

-- select json_schema_valid with group by (EXPLAIN)
--Testcase 4043:
EXPLAIN VERBOSE
SELECT count(id), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 group by json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json);
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s9)
     Remote SQL: SELECT count(id), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM public.s9mysql GROUP BY 2
(6 rows)

-- select json_schema_valid with group by (result)
--Testcase 4044:
SELECT count(id), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 group by json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json);
 count | json_schema_valid 
-------+-------------------
     1 |                 1
     1 |                 0
(2 rows)

-- select json_schema_valid with group by index (result)
--Testcase 4045:
SELECT id,  json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 group by 2, 1;
 id | json_schema_valid 
----+-------------------
  0 |                 1
  1 |                 0
(2 rows)

-- select json_schema_valid with group by index (result)
--Testcase 4046:
SELECT id,  json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 group by 1, 2;
 id | json_schema_valid 
----+-------------------
  0 |                 1
  1 |                 0
(2 rows)

-- select json_schema_valid with group by having (EXPLAIN)
--Testcase 4047:
EXPLAIN VERBOSE
SELECT count(id), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 group by json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) HAVING count(id) > 0;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json))
   Filter: ((count(s9.id)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s9)
     Remote SQL: SELECT count(id), public.json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM public.s9mysql GROUP BY 2
(7 rows)

-- select json_schema_valid with group by having (result)
--Testcase 4048:
SELECT count(id), json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 group by json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) HAVING count(id) > 0;
 count | json_schema_valid 
-------+-------------------
     1 |                 1
     1 |                 0
(2 rows)

-- select json_schema_valid with group by index having (result)
--Testcase 4049:
SELECT id,  json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 group by 2, 1 HAVING count(id) > 0;
 id | json_schema_valid 
----+-------------------
  0 |                 1
  1 |                 0
(2 rows)

-- select json_schema_valid with group by index having (result)
--Testcase 4050:
SELECT id,  json_schema_valid(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json) FROM s9 group by 1, 2 HAVING count(id) > 0;
 id | json_schema_valid 
----+-------------------
  0 |                 1
  1 |                 0
(2 rows)

-- select json_schema_valid and as
--Testcase 4051:
SELECT json_schema_valid(c1, json_quote('null')) as json_schema_valid1 FROM s9;
 json_schema_valid1 
--------------------
                  0
                  0
(2 rows)

-- select json_schema_validation_report (builtin function, explain)
--Testcase 4052:
EXPLAIN VERBOSE
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9;
                                                                                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..5340.42 rows=3413 width=160)
   Output: (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json)), (json_schema_validation_report(c1, json_quote('null'::text))), (json_schema_validation_report(c1, '{}'::json)), (json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json), public.json_schema_validation_report(c1, public.json_quote('null'::text)), public.json_schema_validation_report(c1, '{}'::json), public.json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql
(4 rows)

-- select json_schema_validation_report (builtin function, result)
--Testcase 4053:
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9;
                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                     json_schema_validation_report                                                                                     |                                                                                         json_schema_validation_report                                                                                         | json_schema_validation_report 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------
 {"valid": true}                                                                                                                                                                                                                                                       | {"valid": true}                                                                                                                                                                                                                                                       | {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | {"valid": false, "reason": "The JSON document location '#' failed requirement 'required' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "required"} | {"valid": true}
 {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | {"valid": true}                                                                                                                                                                                               | {"valid": true}
(2 rows)

-- select json_schema_validation_report (builtin function, not pushdown constraints, explain)
--Testcase 4054:
EXPLAIN VERBOSE
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE to_hex(id) = '1';
                                                                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..254.74 rows=17 width=160)
   Output: (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json)), (json_schema_validation_report(c1, json_quote('null'::text))), (json_schema_validation_report(c1, '{}'::json)), (json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json))
   Filter: (to_hex(s9.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json), public.json_schema_validation_report(c1, public.json_quote('null'::text)), public.json_schema_validation_report(c1, '{}'::json), public.json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json), id FROM public.s9mysql
(5 rows)

-- select json_schema_validation_report (builtin function, not pushdown constraints, result)
--Testcase 4055:
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE to_hex(id) = '1';
                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                     json_schema_validation_report                                                                                     | json_schema_validation_report | json_schema_validation_report 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------+-------------------------------
 {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | {"valid": true}               | {"valid": true}
(1 row)

-- select json_schema_validation_report (builtin function, pushdown constraints, explain)
--Testcase 4056:
EXPLAIN VERBOSE
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE id != 0;
                                                                                                                                                                                                                                                               QUERY PLAN                                                                                                                                                                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..5323.07 rows=3396 width=160)
   Output: (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json)), (json_schema_validation_report(c1, json_quote('null'::text))), (json_schema_validation_report(c1, '{}'::json)), (json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json), public.json_schema_validation_report(c1, public.json_quote('null'::text)), public.json_schema_validation_report(c1, '{}'::json), public.json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql WHERE ((id <> 0))
(4 rows)

-- select json_schema_validation_report (builtin function, pushdown constraints, result)
--Testcase 4057:
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE id != 0;
                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                     json_schema_validation_report                                                                                     | json_schema_validation_report | json_schema_validation_report 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------+-------------------------------
 {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | {"valid": true}               | {"valid": true}
(1 row)

-- select json_schema_validation_report (builtin function, json_schema_validation_report in constraints, explain)
--Testcase 4058:
EXPLAIN VERBOSE
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) != 0;
                                                                                                                                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..7029.57 rows=3396 width=160)
   Output: (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json)), (json_schema_validation_report(c1, json_quote('null'::text))), (json_schema_validation_report(c1, '{}'::json)), (json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json), public.json_schema_validation_report(c1, public.json_quote('null'::text)), public.json_schema_validation_report(c1, '{}'::json), public.json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql WHERE ((public.json_length(public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)) <> 0))
(4 rows)

-- select json_schema_validation_report (builtin function, json_schema_validation_report in constraints, result)
--Testcase 4059:
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) != 0;
                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                     json_schema_validation_report                                                                                     |                                                                                         json_schema_validation_report                                                                                         | json_schema_validation_report 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------
 {"valid": true}                                                                                                                                                                                                                                                       | {"valid": true}                                                                                                                                                                                                                                                       | {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | {"valid": false, "reason": "The JSON document location '#' failed requirement 'required' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "required"} | {"valid": true}
 {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | {"valid": true}                                                                                                                                                                                               | {"valid": true}
(2 rows)

-- select json_schema_validation_report (builtin function, json_schema_validation_report in constraints, explain)
--Testcase 4060:
EXPLAIN VERBOSE
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE json_length(json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json)) = 1;
                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..1893.58 rows=17 width=160)
   Output: (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)), (json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json)), (json_schema_validation_report(c1, json_quote('null'::text))), (json_schema_validation_report(c1, '{}'::json)), (json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json), public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'::json), public.json_schema_validation_report(c1, public.json_quote('null'::text)), public.json_schema_validation_report(c1, '{}'::json), public.json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql WHERE ((public.json_length(public.json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json)) = 1))
(4 rows)

-- select json_schema_validation_report (builtin function, json_schema_validation_report in constraints, result)
--Testcase 4061:
SELECT json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'), json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.5}'), json_schema_validation_report(c1, json_quote('null')), json_schema_validation_report(c1, '{}'), json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9 WHERE json_length(json_schema_validation_report(json_build_object('latitude', 63, 'longitude', 30), '{"latitude": 63.444697,"longitude": 30}'::json)) = 1;
                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                                                     json_schema_validation_report                                                                                                                     |                                                                                     json_schema_validation_report                                                                                     |                                                                                         json_schema_validation_report                                                                                         | json_schema_validation_report 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------
 {"valid": true}                                                                                                                                                                                                                                                       | {"valid": true}                                                                                                                                                                                                                                                       | {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | {"valid": false, "reason": "The JSON document location '#' failed requirement 'required' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "required"} | {"valid": true}
 {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#/latitude' failed requirement 'maximum' at JSON Schema location '#/properties/latitude'", "schema-location": "#/properties/latitude", "document-location": "#/latitude", "schema-failed-keyword": "maximum"} | {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | {"valid": true}                                                                                                                                                                                               | {"valid": true}
(2 rows)

-- select json_schema_validation_report as nest function with agg (pushdown, explain)
--Testcase 4062:
EXPLAIN VERBOSE
SELECT sum(id),json_schema_validation_report(json_build_object('latitude', 63, 'longitude', sum(id)), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9;
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_schema_validation_report(json_build_object('latitude', 63, 'longitude', sum(id)), '{"latitude": 63.444697,"longitude": 30}'::json))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s9)
     Remote SQL: SELECT sum(id), public.json_schema_validation_report(json_build_object('latitude', 63, 'longitude', sum(id)), '{"latitude": 63.444697,"longitude": 30}'::json) FROM public.s9mysql
(6 rows)

-- select json_schema_validation_report as nest function with agg (pushdown, result)
--Testcase 4063:
SELECT sum(id),json_schema_validation_report(json_build_object('latitude', 63, 'longitude', sum(id)), '{"latitude": 63.444697,"longitude": 30}'::json) FROM s9;
 sum | json_schema_validation_report 
-----+-------------------------------
   1 | {"valid": true}
(1 row)

-- select json_schema_validation_report with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4064:
EXPLAIN VERBOSE
SELECT json_schema_validation_report(c1, json_quote('null')), pi(), 4.1 FROM s9;
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..1918.89 rows=3413 width=72)
   Output: (json_schema_validation_report(c1, json_quote('null'::text))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_schema_validation_report(c1, public.json_quote('null'::text)), 3.141592653589793::double precision, 4.1 FROM public.s9mysql
(4 rows)

-- select json_schema_validation_report with non pushdown func and explicit constant (result)
--Testcase 4065:
SELECT json_schema_validation_report(c1, json_quote('null')), pi(), 4.1 FROM s9;
                                                                                     json_schema_validation_report                                                                                     |        pi         | ?column? 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+----------
 {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | 3.141592653589793 |      4.1
 {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"} | 3.141592653589793 |      4.1
(2 rows)

-- select json_schema_validation_report with order by index (result)
--Testcase 4066:
SELECT id,  json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 order by 2, 1;
 id | json_length 
----+-------------
  0 |           1
  1 |           5
(2 rows)

-- select json_schema_validation_report with order by index (result)
--Testcase 4067:
SELECT id,  json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 order by 1, 2;
 id | json_length 
----+-------------
  0 |           1
  1 |           5
(2 rows)

-- select json_schema_validation_report with group by (EXPLAIN)
--Testcase 4068:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 group by json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'));
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s9)
     Remote SQL: SELECT count(id), public.json_length(public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)) FROM public.s9mysql GROUP BY 2
(6 rows)

-- select json_schema_validation_report with group by (result)
--Testcase 4069:
SELECT count(id), json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 group by json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'));
 count | json_length 
-------+-------------
     1 |           1
     1 |           5
(2 rows)

-- select json_schema_validation_report with group by index (result)
--Testcase 4070:
SELECT id,  json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 group by 2, 1;
 id | json_length 
----+-------------
  0 |           1
  1 |           5
(2 rows)

-- select json_schema_validation_report with group by index (result)
--Testcase 4071:
SELECT id,  json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 group by 1, 2;
 id | json_length 
----+-------------
  0 |           1
  1 |           5
(2 rows)

-- select json_schema_validation_report with group by having (EXPLAIN)
--Testcase 4072:
EXPLAIN VERBOSE
SELECT count(id), json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 group by json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) HAVING count(id) > 0;
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)))
   Filter: ((count(s9.id)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s9)
     Remote SQL: SELECT count(id), public.json_length(public.json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}'::json)) FROM public.s9mysql GROUP BY 2
(7 rows)

-- select json_schema_validation_report with group by having (result)
--Testcase 4073:
SELECT count(id), json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 group by json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) HAVING count(id) > 0;
 count | json_length 
-------+-------------
     1 |           1
     1 |           5
(2 rows)

-- select json_schema_validation_report with group by index having (result)
--Testcase 4074:
SELECT id,  json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 group by 2, 1 HAVING count(id) > 0;
 id | json_length 
----+-------------
  0 |           1
  1 |           5
(2 rows)

-- select json_schema_validation_report with group by index having (result)
--Testcase 4075:
SELECT id,  json_length(json_schema_validation_report(c1, '{"latitude": 63.444697,"longitude": 10.445118}')) FROM s9 group by 1, 2 HAVING count(id) > 0;
 id | json_length 
----+-------------
  0 |           1
  1 |           5
(2 rows)

-- select json_schema_validation_report and as
--Testcase 4076:
SELECT json_schema_validation_report(c1, json_quote('null')) as json_schema_validation_report1 FROM s9;
                                                                                    json_schema_validation_report1                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"}
 {"valid": false, "reason": "The JSON document location '#' failed requirement 'type' at JSON Schema location '#'", "schema-location": "#", "document-location": "#", "schema-failed-keyword": "type"}
(2 rows)

-- select json_search (builtin function, explain)
--Testcase 4077:
EXPLAIN VERBOSE
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8;
                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4487.17 rows=3413 width=160)
   Output: (json_search(c1, 'one'::text, 'abc'::text)), (json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text)), (json_search(c1, 'one'::text, '%a%'::text)), (json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text)), (json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_search(c1, 'one'::text, 'abc'::text), public.json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text), public.json_search(c1, 'one'::text, '%a%'::text), public.json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text), public.json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text) FROM public.s8mysql
(4 rows)

-- select json_search (builtin function, result)
--Testcase 4078:
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8;
 json_search |       json_search        | json_search | json_search | json_search 
-------------+--------------------------+-------------+-------------+-------------
             |                          |             |             | 
             |                          |             |             | 
             |                          |             |             | 
             |                          |             |             | 
             |                          |             |             | 
 "$[0]"      | ["$[0][0]", "$[0][2].x"] | "$[0]"      |             | 
(6 rows)

-- select json_search (builtin function, not pushdown constraints, explain)
--Testcase 4079:
EXPLAIN VERBOSE
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..250.49 rows=17 width=160)
   Output: (json_search(c1, 'one'::text, 'abc'::text)), (json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text)), (json_search(c1, 'one'::text, '%a%'::text)), (json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text)), (json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_search(c1, 'one'::text, 'abc'::text), public.json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text), public.json_search(c1, 'one'::text, '%a%'::text), public.json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text), public.json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text), id FROM public.s8mysql
(5 rows)

-- select json_search (builtin function, not pushdown constraints, result)
--Testcase 4080:
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8 WHERE to_hex(id) = '2';
 json_search | json_search | json_search | json_search | json_search 
-------------+-------------+-------------+-------------+-------------
             |             |             |             | 
(1 row)

-- select json_search (builtin function, pushdown constraints, explain)
--Testcase 4081:
EXPLAIN VERBOSE
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8 WHERE id != 0;
                                                                                                                                                                                         QUERY PLAN                                                                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4474.07 rows=3396 width=160)
   Output: (json_search(c1, 'one'::text, 'abc'::text)), (json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text)), (json_search(c1, 'one'::text, '%a%'::text)), (json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text)), (json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_search(c1, 'one'::text, 'abc'::text), public.json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text), public.json_search(c1, 'one'::text, '%a%'::text), public.json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text), public.json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_search (builtin function, pushdown constraints, result)
--Testcase 4082:
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8 WHERE id != 0;
 json_search |       json_search        | json_search | json_search | json_search 
-------------+--------------------------+-------------+-------------+-------------
             |                          |             |             | 
             |                          |             |             | 
             |                          |             |             | 
             |                          |             |             | 
 "$[0]"      | ["$[0][0]", "$[0][2].x"] | "$[0]"      |             | 
(5 rows)

-- select json_search (builtin function, json_search in constraints, explain)
--Testcase 4083:
EXPLAIN VERBOSE
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8 WHERE json_search(c1, 'one', 'abc') NOT LIKE '$';
                                                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5327.32 rows=3396 width=160)
   Output: (json_search(c1, 'one'::text, 'abc'::text)), (json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text)), (json_search(c1, 'one'::text, '%a%'::text)), (json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text)), (json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_search(c1, 'one'::text, 'abc'::text), public.json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text), public.json_search(c1, 'one'::text, '%a%'::text), public.json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text), public.json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text) FROM public.s8mysql WHERE ((public.json_search(c1, 'one'::text, 'abc'::text) !~~ '$'::text))
(4 rows)

-- select json_search (builtin function, json_search in constraints, result)
--Testcase 4084:
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8 WHERE json_search(c1, 'one', 'abc') NOT LIKE '$';
 json_search |       json_search        | json_search | json_search | json_search 
-------------+--------------------------+-------------+-------------+-------------
 "$[0]"      | ["$[0][0]", "$[0][2].x"] | "$[0]"      |             | 
(1 row)

-- select json_search (builtin function, json_search in constraints, explain)
--Testcase 4085:
EXPLAIN VERBOSE
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8 where json_search('[1,3,5,7]', 'one', '[2,5,7]') IS NULL;
                                                                                                                                                                                                                           QUERY PLAN                                                                                                                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1019.01 rows=17 width=160)
   Output: (json_search(c1, 'one'::text, 'abc'::text)), (json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text)), (json_search(c1, 'one'::text, '%a%'::text)), (json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text)), (json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_search(c1, 'one'::text, 'abc'::text), public.json_search(json_build_array(c1, '1'), 'all'::text, 'abc'::text), public.json_search(c1, 'one'::text, '%a%'::text), public.json_search('{"a":1,"b":10,"d":10}'::json, 'all'::text, '%1%'::text), public.json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text) FROM public.s8mysql WHERE ((public.json_search('[1,3,5,7]'::json, 'one'::text, '[2,5,7]'::text) IS NULL))
(4 rows)

-- select json_search (builtin function, json_search in constraints, result)
--Testcase 4086:
SELECT json_search(c1, 'one', 'abc'), json_search(json_build_array(c1, '1'), 'all', 'abc'), json_search(c1, 'one', '%a%'),json_search('{"a":1,"b":10,"d":10}', 'all', '%1%'),json_search('[1,3,5,7]', 'one', '[2,5,7]') FROM s8 where json_search('[1,3,5,7]', 'one', '[2,5,7]') IS NULL;
 json_search |       json_search        | json_search | json_search | json_search 
-------------+--------------------------+-------------+-------------+-------------
             |                          |             |             | 
             |                          |             |             | 
             |                          |             |             | 
             |                          |             |             | 
             |                          |             |             | 
 "$[0]"      | ["$[0][0]", "$[0][2].x"] | "$[0]"      |             | 
(6 rows)

-- select json_search as nest function with agg (pushdown, explain)
--Testcase 4087:
EXPLAIN VERBOSE
SELECT sum(id),json_search(json_build_array('{"a":1,"b":10,"d":10}', sum(id)), 'all', 'a') FROM s8;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_search(json_build_array('{"a":1,"b":10,"d":10}', sum(id)), 'all'::text, 'a'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_search(json_build_array('{"a":1,"b":10,"d":10}', sum(id)), 'all'::text, 'a'::text) FROM public.s8mysql
(6 rows)

-- select json_search as nest function with agg (pushdown, result)
--Testcase 4088:
SELECT sum(id),json_search(json_build_array('{"a":1,"b":10,"d":10}', sum(id)), 'all', 'a') FROM s8;
 sum | json_search 
-----+-------------
  15 | 
(1 row)

-- select json_search with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4089:
EXPLAIN VERBOSE
SELECT json_search(c1, 'one', '%a%'), pi(), 4.1 FROM s8;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_search(c1, 'one'::text, '%a%'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_search(c1, 'one'::text, '%a%'::text), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_search with non pushdown func and explicit constant (result)
--Testcase 4090:
SELECT json_search(c1, 'one', '%a%'), pi(), 4.1 FROM s8;
 json_search |        pi         | ?column? 
-------------+-------------------+----------
             | 3.141592653589793 |      4.1
             | 3.141592653589793 |      4.1
             | 3.141592653589793 |      4.1
             | 3.141592653589793 |      4.1
             | 3.141592653589793 |      4.1
 "$[0]"      | 3.141592653589793 |      4.1
(6 rows)

-- select json_search with order by index (result)
--Testcase 4091:
SELECT id, json_search(c1, 'one', 'abc') FROM s8 ORDER BY 2, 1;
 id | json_search 
----+-------------
  5 | "$[0]"
  0 | 
  1 | 
  2 | 
  3 | 
  4 | 
(6 rows)

-- select json_search with order by index (result)
--Testcase 4092:
SELECT id, json_search(c1, 'one', 'abc') FROM s8 ORDER BY 1, 2;
 id | json_search 
----+-------------
  0 | 
  1 | 
  2 | 
  3 | 
  4 | 
  5 | "$[0]"
(6 rows)

-- select json_search with group by (EXPLAIN)
--Testcase 4093:
EXPLAIN VERBOSE
SELECT count(id), json_search(c1, 'one', 'abc') FROM s8 group by json_search(c1, 'one', 'abc');
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(id)), (json_search(c1, 'one'::text, 'abc'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_search(c1, 'one'::text, 'abc'::text) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_search with group by (result)
--Testcase 4094:
SELECT count(id), json_search(c1, 'one', 'abc') FROM s8 group by json_search(c1, 'one', 'abc');
 count | json_search 
-------+-------------
     5 | 
     1 | "$[0]"
(2 rows)

-- select json_search with group by index (result)
--Testcase 4095:
SELECT id, json_search(c1, 'one', 'abc') FROM s8 group by 2, 1;
 id | json_search 
----+-------------
  0 | 
  1 | 
  2 | 
  3 | 
  4 | 
  5 | "$[0]"
(6 rows)

-- select json_search with group by index (result)
--Testcase 4096:
SELECT id, json_search(c1, 'one', 'abc') FROM s8 group by 1, 2;
 id | json_search 
----+-------------
  0 | 
  1 | 
  2 | 
  3 | 
  4 | 
  5 | "$[0]"
(6 rows)

-- select json_search with group by having (EXPLAIN)
--Testcase 4097:
EXPLAIN VERBOSE
SELECT count(c2), json_search(c1, 'one', 'abc') FROM s8 group by json_search(c1, 'one', 'abc') HAVING count(c2) > 0;
                                                    QUERY PLAN                                                     
-------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(c2)), (json_search(c1, 'one'::text, 'abc'::text))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_search(c1, 'one'::text, 'abc'::text) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_search with group by having (result)
--Testcase 4098:
SELECT count(c2), json_search(c1, 'one', 'abc') FROM s8 group by json_search(c1, 'one', 'abc') HAVING count(c2) > 0;
 count | json_search 
-------+-------------
     5 | 
     1 | "$[0]"
(2 rows)

-- select json_search with group by index having (result)
--Testcase 4099:
SELECT c2, json_search(c1, 'one', 'abc') FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_search 
----+-------------
  1 | 
  2 | 
  3 | 
  4 | 
  5 | 
  5 | "$[0]"
(6 rows)

-- select json_search with group by index having (result)
--Testcase 4100:
SELECT c2, json_search(c1, 'one', 'abc') FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_search 
----+-------------
  1 | 
  2 | 
  3 | 
  4 | 
  5 | 
  5 | "$[0]"
(6 rows)

-- select json_search and as
--Testcase 4101:
SELECT json_search(c1, 'one', '%a%') as json_search1 FROM s8;
 json_search1 
--------------
 
 
 
 
 
 "$[0]"
(6 rows)

-- JSON_SET()
-- select json_set (stub function, explain)
--Testcase 4102:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_set (stub function, result)
--Testcase 4103:
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
     json_set      
-------------------
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
(6 rows)

-- select json_set (stub function, not pushdown constraints, explain)
--Testcase 4104:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, pi()') FROM s8 WHERE to_hex(id) = '1';
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..233.44 rows=17 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', pi()"}'::path_value[]))
   Filter: (to_hex(s8.id) = '1'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', pi()"}'::public.path_value[]), id FROM public.s8mysql
(5 rows)

-- select json_set (stub function, not pushdown constraints, result)
--Testcase 4105:
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, pi()') FROM s8 WHERE to_hex(id) = '1';
     json_set      
-------------------
 3.141592653589793
(1 row)

-- select json_set (stub function, pushdown constraints, explain)
--Testcase 4106:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..157.25 rows=17 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', CAST(\"[true, false]\" AS JSON)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC E'{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', CAST(\\"[true, false]\\" AS JSON)"}'::public.path_value[]) FROM public.s8mysql WHERE ((id = 1))
(4 rows)

-- select json_set (stub function, pushdown constraints, result)
--Testcase 4107:
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, CAST("[true, false]" AS JSON)') FROM s8 WHERE id = 1;
   json_set    
---------------
 [true, false]
(1 row)

-- select json_set (stub function, stub in constraints, explain)
--Testcase 4108:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, "[true, false]"') FROM s8 WHERE log2(id) > 1;
                                                                                                               QUERY PLAN                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1321.71 rows=1138 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', ''[true, false]''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', NULL","''$'', TRUE","''$'', ''[true, false]''"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.log2(id) > 1::double precision))
(4 rows)

-- select json_set (stub function, stub in constraints, result)
--Testcase 4109:
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, NULL', '$, TRUE', '$, "[true, false]"') FROM s8 WHERE log2(id) > 1;
    json_set     
-----------------
 "[true, false]"
 "[true, false]"
 "[true, false]"
(3 rows)

-- select json_set (stub function, stub in constraints, explain)
--Testcase 4110:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8 WHERE json_depth(json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()')) > 0;
                                                                                                                                                              QUERY PLAN                                                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2166.42 rows=1138 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql WHERE ((public.json_depth(public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[])) > 0))
(4 rows)

-- select json_set (stub function, stub in constraints, result)
--Testcase 4111:
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8 WHERE json_depth(json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()')) > 0;
     json_set      
-------------------
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
(6 rows)

-- json_set with 1 arg explain
--Testcase 4112:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2') FROM s8;
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_set with 1 arg result
--Testcase 4113:
SELECT json_set(c1, '$.a, c2') FROM s8;
                         json_set                          
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3}
 {"a": 4, "b": "15", "x": 25}
 {"a": 5, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_set with 2 args explain
--Testcase 4114:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3') FROM s8;
                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_set with 2 args result
--Testcase 4115:
SELECT json_set(c1, '$.a, c2', '$.b, c3') FROM s8;
                         json_set                          
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3, "b": "text"}
 {"a": 4, "b": "scalar", "x": 25}
 {"a": 5, "b": "scalar", "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_set with 3 args explain
--Testcase 4116:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1') FROM s8;
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_set with 3 args result
--Testcase 4117:
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1') FROM s8;
                         json_set                          
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3, "b": "text", "c": 1}
 {"a": 4, "b": "scalar", "c": 1, "x": 25}
 {"a": 5, "b": "scalar", "c": 1}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_set with 4 args explain
--Testcase 4118:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"') FROM s8;
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_set with 4 args result
--Testcase 4119:
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"') FROM s8;
 json_set 
----------
 "a"
 "a"
 "a"
 "a"
 "a"
 "a"
(6 rows)

-- json_set with 5 args explain
--Testcase 4120:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2","''$.b'', c3","''$.c'', 1","''$'', ''a''","''$'', pi()"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- json_set with 5 args result
--Testcase 4121:
SELECT json_set(c1, '$.a, c2', '$.b, c3', '$.c, 1', '$, "a"', '$, pi()') FROM s8;
     json_set      
-------------------
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
 3.141592653589793
(6 rows)

-- select json_set as nest function with agg (pushdown, explain)
--Testcase 4122:
EXPLAIN VERBOSE
SELECT sum(id),json_set('["a", ["b", "c"], "d"]', '$, sum(id)') FROM s8;
                                                                       QUERY PLAN                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_set('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', sum(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_set('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', sum(id)"}'::public.path_value[]) FROM public.s8mysql
(6 rows)

-- select json_set as nest function with agg (pushdown, result)
--Testcase 4123:
SELECT sum(id),json_set('["a", ["b", "c"], "d"]', '$, sum(id)') FROM s8;
 sum | json_set 
-----+----------
  15 | 15
(1 row)

-- select json_set as nest function with json_build_array (pushdown, explain)
--Testcase 4124:
EXPLAIN VERBOSE
SELECT json_set(json_build_array('["a", ["b", "c"], "d"]', c1), '$, log2(id)') FROM s8;
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=32)
   Output: (json_set(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$'', log2(id)"}'::path_value[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(json_build_array('["a", ["b", "c"], "d"]', c1), VARIADIC '{"''$'', log2(id)"}'::public.path_value[]) FROM public.s8mysql
(4 rows)

-- select json_set as nest function with agg (pushdown, result)
--Testcase 4125:
SELECT json_set(json_build_array('["a", ["b", "c"], "d"]', c1), '$, log2(id)') FROM s8;
     json_set      
-------------------
 null
 0.0
 1.0
 1.584962500721156
 2.0
 2.321928094887362
(6 rows)

-- select json_set with non pushdown func and explicit constant (explain)
--Testcase 4126:
EXPLAIN VERBOSE
SELECT json_set(c1, '$.a, c2'), pi(), 4.1 FROM s8;
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_set(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_set(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[]), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_set with non pushdown func and explicit constant (result)
--Testcase 4127:
SELECT json_set(c1, '$.a, c2'), pi(), 4.1 FROM s8;
                         json_set                          |        pi         | ?column? 
-----------------------------------------------------------+-------------------+----------
 [[1, 2], [3, 4], 5]                                       | 3.141592653589793 |      4.1
 []                                                        | 3.141592653589793 |      4.1
 {"a": 3}                                                  | 3.141592653589793 |      4.1
 {"a": 4, "b": "15", "x": 25}                              | 3.141592653589793 |      4.1
 {"a": 5, "b": 2, "c": {"d": 4}}                           | 3.141592653589793 |      4.1
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}] | 3.141592653589793 |      4.1
(6 rows)

-- select json_set with order by (explain)
--Testcase 4128:
EXPLAIN VERBOSE
SELECT json_length(json_set(c1, '$.a, c2')) FROM s8 ORDER BY 1;
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2119.18..2127.71 rows=3413 width=4)
   Output: (json_length(json_set(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
   Sort Key: (json_length(json_set(s8.c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
   ->  Foreign Scan on public.s8  (cost=100.00..1918.89 rows=3413 width=4)
         Output: (json_length(json_set(c1, VARIADIC '{"''$.a'', c2"}'::path_value[])))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT public.json_length(public.json_set(c1, VARIADIC '{"''$.a'', c2"}'::public.path_value[])) FROM public.s8mysql
(7 rows)

-- select json_set with order by (result)
--Testcase 4129:
SELECT json_length(json_set(c1, '$.a, c2')) FROM s8 ORDER BY 1;
 json_length 
-------------
           0
           1
           3
           3
           3
           4
(6 rows)

-- select json_set with group by (explain)
--Testcase 4130:
EXPLAIN VERBOSE
SELECT json_length(json_set('["a", ["b", "c"], "d"]', '$, id')) FROM s8 GROUP BY id, 1;
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=8)
   Output: (json_length(json_set('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', id"}'::path_value[]))), id
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_length(public.json_set('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', id"}'::public.path_value[])), id FROM public.s8mysql GROUP BY 2, 1
(6 rows)

-- select json_set with group by (result)
--Testcase 4131:
SELECT json_length(json_set('["a", ["b", "c"], "d"]', '$, id')) FROM s8 GROUP BY id, 1;
 json_length 
-------------
           1
           1
           1
           1
           1
           1
(6 rows)

-- select json_set with group by having (explain)
--Testcase 4132:
EXPLAIN VERBOSE
SELECT json_depth(json_set('["a", ["b", "c"], "d"]', '$, c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=8)
   Output: (json_depth(json_set('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', c2"}'::path_value[]))), c2
   Filter: ((count(s8.c2)) > 1)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT public.json_depth(public.json_set('["a", ["b", "c"], "d"]'::json, VARIADIC '{"''$'', c2"}'::public.path_value[])), c2, count(c2) FROM public.s8mysql GROUP BY 2, 1
(7 rows)

-- select json_set with group by having (result)
--Testcase 4133:
SELECT json_depth(json_set('["a", ["b", "c"], "d"]', '$, c2')) FROM s8 GROUP BY c2, 1 HAVING count(c2) > 1;
 json_depth 
------------
          1
(1 row)

-- select json_set and as
--Testcase 4134:
SELECT json_set(c1, '$.a, c2') AS json_set1 FROM s8;
                         json_set1                         
-----------------------------------------------------------
 [[1, 2], [3, 4], 5]
 []
 {"a": 3}
 {"a": 4, "b": "15", "x": 25}
 {"a": 5, "b": 2, "c": {"d": 4}}
 ["abc", [{"k": "10"}, "def"], {"x": "abc"}, {"y": "bcd"}]
(6 rows)

-- json_storage_free()
-- insert new value for test json_storage_free()
--Testcase 4135:
CREATE EXTENSION mysql_fdw;
--Testcase 4136:
CREATE SERVER mysql_svr FOREIGN DATA WRAPPER mysql_fdw;
--Testcase 4137:
CREATE USER MAPPING FOR CURRENT_USER SERVER mysql_svr OPTIONS(username 'root', password 'Mysql_1234');
--Testcase 4138:
CREATE FOREIGN TABLE s8_mysql_svr (id int, c1 json, c2 int, c3 text) SERVER mysql_svr OPTIONS(dbname 'test', table_name 's8');
--Testcase 4139:
INSERT INTO s8_mysql_svr VALUES (6, '{"a": 10, "b": "wxyz", "c": "[true, false]"}', 1, 'Text');
-- select json_storage_free (stub function, explain)
--Testcase 4140:
EXPLAIN VERBOSE
SELECT json_storage_free(c1), json_storage_free('{"a": 10, "b": "wxyz", "c": "[true, false]"}') FROM s8 WHERE id = 6;
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..161.50 rows=17 width=8)
   Output: (json_storage_free(c1)), (json_storage_free('{"a": 10, "b": "wxyz", "c": "[true, false]"}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_storage_free(c1), public.json_storage_free('{"a": 10, "b": "wxyz", "c": "[true, false]"}'::json) FROM public.s8mysql WHERE ((id = 6))
(4 rows)

-- select json_storage_free (stub function, result)
--Testcase 4141:
SELECT json_storage_free(c1), json_storage_free('{"a": 10, "b": "wxyz", "c": "[true, false]"}') FROM s8 WHERE id = 6;
 json_storage_free | json_storage_free 
-------------------+-------------------
                 0 |                 0
(1 row)

-- update new value for json value of table s8
--Testcase 4142:
UPDATE s8_mysql_svr SET c1 = json_set(c1, '$.a, 10', '$.b, "wx"') WHERE id = 6;
-- select json_storage_free (stub function, explain)
--Testcase 4143:
EXPLAIN VERBOSE
SELECT json_storage_free(c1), json_storage_free('{"a": 10, "b": "wxyz", "c": "[true, false]"}') FROM s8 WHERE id = 6;
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..161.50 rows=17 width=8)
   Output: (json_storage_free(c1)), (json_storage_free('{"a": 10, "b": "wxyz", "c": "[true, false]"}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_storage_free(c1), public.json_storage_free('{"a": 10, "b": "wxyz", "c": "[true, false]"}'::json) FROM public.s8mysql WHERE ((id = 6))
(4 rows)

-- select json_storage_free (stub function, result)
--Testcase 4144:
SELECT json_storage_free(c1), json_storage_free('{"a": 10, "b": "wxyz", "c": "[true, false]"}') FROM s8 WHERE id = 6;
 json_storage_free | json_storage_free 
-------------------+-------------------
                 2 |                 0
(1 row)

-- revert change
--Testcase 4145:
DELETE FROM s8_mysql_svr WHERE id = 6;
--Testcase 4146:
DROP FOREIGN TABLE s8_mysql_svr;
--Testcase 4147:
DROP USER MAPPING FOR CURRENT_USER SERVER mysql_svr;
--Testcase 4148:
DROP SERVER mysql_svr;
--Testcase 4149:
DROP EXTENSION mysql_fdw;
-- json_storage_size()
-- select json_storage_size (builtin function, explain)
--Testcase 4150:
EXPLAIN VERBOSE
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2780.67 rows=3413 width=12)
   Output: (json_storage_size(c1)), (json_storage_size(json_build_array(c1, 'a', c2))), (json_storage_size('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_storage_size(c1), public.json_storage_size(json_build_array(c1, 'a', c2)), public.json_storage_size('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql
(4 rows)

-- select json_storage_size (builtin function, result)
--Testcase 4151:
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8;
 json_storage_size | json_storage_size | json_storage_size 
-------------------+-------------------+-------------------
                34 |                49 |                33
                 5 |                20 |                33
                 5 |                20 |                33
                35 |                50 |                33
                41 |                56 |                33
                82 |                97 |                33
(6 rows)

-- select json_storage_size (builtin function, not pushdown constraints, explain)
--Testcase 4152:
EXPLAIN VERBOSE
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE to_hex(id) = '2';
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..241.99 rows=17 width=12)
   Output: (json_storage_size(c1)), (json_storage_size(json_build_array(c1, 'a', c2))), (json_storage_size('{"a": 1, "b": {"c": 30}}'::json))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_storage_size(c1), public.json_storage_size(json_build_array(c1, 'a', c2)), public.json_storage_size('{"a": 1, "b": {"c": 30}}'::json), id FROM public.s8mysql
(5 rows)

-- select json_storage_size (builtin function, not pushdown constraints, result)
--Testcase 4153:
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE to_hex(id) = '2';
 json_storage_size | json_storage_size | json_storage_size 
-------------------+-------------------+-------------------
                 5 |                20 |                33
(1 row)

-- select json_storage_size (builtin function, pushdown constraints, explain)
--Testcase 4154:
EXPLAIN VERBOSE
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE id != 0;
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2776.07 rows=3396 width=12)
   Output: (json_storage_size(c1)), (json_storage_size(json_build_array(c1, 'a', c2))), (json_storage_size('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_storage_size(c1), public.json_storage_size(json_build_array(c1, 'a', c2)), public.json_storage_size('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_storage_size (builtin function, pushdown constraints, result)
--Testcase 4155:
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE id != 0;
 json_storage_size | json_storage_size | json_storage_size 
-------------------+-------------------+-------------------
                 5 |                20 |                33
                 5 |                20 |                33
                35 |                50 |                33
                41 |                56 |                33
                82 |                97 |                33
(5 rows)

-- select json_storage_size (builtin function, json_storage_size in constraints, explain)
--Testcase 4156:
EXPLAIN VERBOSE
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_storage_size(c1) != 1;
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3629.32 rows=3396 width=12)
   Output: (json_storage_size(c1)), (json_storage_size(json_build_array(c1, 'a', c2))), (json_storage_size('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_storage_size(c1), public.json_storage_size(json_build_array(c1, 'a', c2)), public.json_storage_size('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql WHERE ((public.json_storage_size(c1) <> 1))
(4 rows)

-- select json_storage_size (builtin function, json_storage_size in constraints, result)
--Testcase 4157:
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_storage_size(c1) != 1;
 json_storage_size | json_storage_size | json_storage_size 
-------------------+-------------------+-------------------
                34 |                49 |                33
                 5 |                20 |                33
                 5 |                20 |                33
                35 |                50 |                33
                41 |                56 |                33
                82 |                97 |                33
(6 rows)

-- select json_storage_size (builtin function, json_storage_size in constraints, explain)
--Testcase 4158:
EXPLAIN VERBOSE
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_storage_size('{"a": 1, "b": {"c": 30}}') = 33;
                                                                                                                               QUERY PLAN                                                                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1019.04 rows=17 width=12)
   Output: (json_storage_size(c1)), (json_storage_size(json_build_array(c1, 'a', c2))), (json_storage_size('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_storage_size(c1), public.json_storage_size(json_build_array(c1, 'a', c2)), public.json_storage_size('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql WHERE ((public.json_storage_size('{"a": 1, "b": {"c": 30}}'::json) = 33))
(4 rows)

-- select json_storage_size (builtin function, json_storage_size in constraints, result)
--Testcase 4159:
SELECT json_storage_size(c1), json_storage_size(json_build_array(c1, 'a', c2)), json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_storage_size('{"a": 1, "b": {"c": 30}}') = 33;
 json_storage_size | json_storage_size | json_storage_size 
-------------------+-------------------+-------------------
                34 |                49 |                33
                 5 |                20 |                33
                 5 |                20 |                33
                35 |                50 |                33
                41 |                56 |                33
                82 |                97 |                33
(6 rows)

-- select json_storage_size as nest function with agg (pushdown, explain)
--Testcase 4160:
EXPLAIN VERBOSE
SELECT sum(id),json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8;
                                                   QUERY PLAN                                                   
----------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (sum(id)), (json_storage_size('{"a": 1, "b": {"c": 30}}'::json))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_storage_size('{"a": 1, "b": {"c": 30}}'::json) FROM public.s8mysql
(6 rows)

-- select json_storage_size as nest function with agg (pushdown, result)
--Testcase 4161:
SELECT sum(id),json_storage_size('{"a": 1, "b": {"c": 30}}') FROM s8;
 sum | json_storage_size 
-----+-------------------
  15 |                33
(1 row)

-- select json_storage_size with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4162:
EXPLAIN VERBOSE
SELECT json_storage_size(json_build_array(c1, 'a', c2)), pi(), 4.1 FROM s8;
                                                                  QUERY PLAN                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (json_storage_size(json_build_array(c1, 'a', c2))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_storage_size(json_build_array(c1, 'a', c2)), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_storage_size with non pushdown func and explicit constant (result)
--Testcase 4163:
SELECT json_storage_size(json_build_array(c1, 'a', c2)), pi(), 4.1 FROM s8;
 json_storage_size |        pi         | ?column? 
-------------------+-------------------+----------
                49 | 3.141592653589793 |      4.1
                20 | 3.141592653589793 |      4.1
                20 | 3.141592653589793 |      4.1
                50 | 3.141592653589793 |      4.1
                56 | 3.141592653589793 |      4.1
                97 | 3.141592653589793 |      4.1
(6 rows)

-- select json_storage_size with order by (EXPLAIN)
--Testcase 4164:
EXPLAIN VERBOSE
SELECT id, json_storage_size(c1) FROM s8 ORDER BY json_storage_size(c1);
                                    QUERY PLAN                                     
-----------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=8)
   Output: id, (json_storage_size(c1))
   Sort Key: (json_storage_size(s8.c1))
   ->  Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=8)
         Output: id, (json_storage_size(c1))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.json_storage_size(c1) FROM public.s8mysql
(7 rows)

-- select json_storage_size with order by (result)
--Testcase 4165:
SELECT id, json_storage_size(c1) FROM s8 ORDER BY json_storage_size(c1);
 id | json_storage_size 
----+-------------------
  1 |                 5
  2 |                 5
  0 |                34
  3 |                35
  4 |                41
  5 |                82
(6 rows)

-- select json_storage_size with order by index (result)
--Testcase 4166:
SELECT id, json_storage_size(c1) FROM s8 ORDER BY 2, 1;
 id | json_storage_size 
----+-------------------
  1 |                 5
  2 |                 5
  0 |                34
  3 |                35
  4 |                41
  5 |                82
(6 rows)

-- select json_storage_size with order by index (result)
--Testcase 4167:
SELECT id, json_storage_size(c1) FROM s8 ORDER BY 1, 2;
 id | json_storage_size 
----+-------------------
  0 |                34
  1 |                 5
  2 |                 5
  3 |                35
  4 |                41
  5 |                82
(6 rows)

-- select json_storage_size with group by (EXPLAIN)
--Testcase 4168:
EXPLAIN VERBOSE
SELECT count(id), json_storage_size(c1) FROM s8 group by json_storage_size(c1);
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_storage_size(c1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_storage_size(c1) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_storage_size with group by (result)
--Testcase 4169:
SELECT count(id), json_storage_size(c1) FROM s8 group by json_storage_size(c1);
 count | json_storage_size 
-------+-------------------
     1 |                34
     2 |                 5
     1 |                35
     1 |                41
     1 |                82
(5 rows)

-- select json_storage_size with group by index (result)
--Testcase 4170:
SELECT id, json_storage_size(c1) FROM s8 group by 2, 1;
 id | json_storage_size 
----+-------------------
  0 |                34
  1 |                 5
  2 |                 5
  3 |                35
  4 |                41
  5 |                82
(6 rows)

-- select json_storage_size with group by index (result)
--Testcase 4171:
SELECT id, json_storage_size(c1) FROM s8 group by 1, 2;
 id | json_storage_size 
----+-------------------
  0 |                34
  1 |                 5
  2 |                 5
  3 |                35
  4 |                41
  5 |                82
(6 rows)

-- select json_storage_size with group by having (EXPLAIN)
--Testcase 4172:
EXPLAIN VERBOSE
SELECT count(c2), json_storage_size(c1) FROM s8 group by json_storage_size(c1) HAVING count(c2) > 0;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_storage_size(c1))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_storage_size(c1) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_storage_size with group by having (result)
--Testcase 4173:
SELECT count(c2), json_storage_size(c1) FROM s8 group by json_storage_size(c1) HAVING count(c2) > 0;
 count | json_storage_size 
-------+-------------------
     1 |                34
     2 |                 5
     1 |                35
     1 |                41
     1 |                82
(5 rows)

-- select json_storage_size with group by index having (result)
--Testcase 4174:
SELECT c2, json_storage_size(c1) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_storage_size 
----+-------------------
  1 |                34
  2 |                 5
  3 |                 5
  4 |                35
  5 |                41
  5 |                82
(6 rows)

-- select json_storage_size with group by index having (result)
--Testcase 4175:
SELECT c2, json_storage_size(c1) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_storage_size 
----+-------------------
  1 |                34
  2 |                 5
  3 |                 5
  4 |                35
  5 |                41
  5 |                82
(6 rows)

-- select json_storage_size and as
--Testcase 4176:
SELECT json_storage_size(json_build_array(c1, 'a', c2)) as json_storage_size1 FROM s8;
 json_storage_size1 
--------------------
                 49
                 20
                 20
                 50
                 56
                 97
(6 rows)

-- mysql_json_table
-- select mysql_json_table (explain)
--Testcase 4177:
EXPLAIN VERBOSE
SELECT mysql_json_table(c1,'$',
       ARRAY['id VARCHAR(100) PATH "$.id"', '_type text PATH "$.type"', '_schema text PATH "$.$schema"', '_required json PATH "$.required"', '_properties json PATH "$.properties"', '_description text PATH "$.description"'],
       ARRAY['id', '_type', '_schema', '_required', '_properties', '_description'])
       FROM s9;
                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..1065.64 rows=3413 width=32)
   Output: (mysql_json_table(c1, '$'::text, '{"id VARCHAR(100) PATH \"$.id\"","_type text PATH \"$.type\"","_schema text PATH \"$.$schema\"","_required json PATH \"$.required\"","_properties json PATH \"$.properties\"","_description text PATH \"$.description\""}'::text[], '{id,_type,_schema,_required,_properties,_description}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_json_table(c1, '$'::text, E'{"id VARCHAR(100) PATH \\"$.id\\"","_type text PATH \\"$.type\\"","_schema text PATH \\"$.$schema\\"","_required json PATH \\"$.required\\"","_properties json PATH \\"$.properties\\"","_description text PATH \\"$.description\\""}'::text[], '{id,_type,_schema,_required,_properties,_description}'::text[]) FROM public.s9mysql
(4 rows)

-- select mysql_json_table (result)
--Testcase 4178:
SELECT mysql_json_table(c1,'$',
       ARRAY['id VARCHAR(100) PATH "$.id"', '_type text PATH "$.type"', '_schema text PATH "$.$schema"', '_required json PATH "$.required"', '_properties json PATH "$.properties"', '_description text PATH "$.description"'],
       ARRAY['id', '_type', '_schema', '_required', '_properties', '_description'])
       FROM s9;
                                                                                                                                           mysql_json_table                                                                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ("http://json-schema.org/geo","object","http://json-schema.org/draft-04/schema#","[\"latitude\", \"longitude\"]","{\"latitude\": {\"type\": \"number\", \"maximum\": 90, \"minimum\": -90}, \"longitude\": {\"type\": \"number\", \"maximum\": 180, \"minimum\": -180}}","A geographical coordinate")
 ("http://json-schema.org/geo","object","http://json-schema.org/draft-04/schema#",,"{\"latitude\": {\"type\": \"number\", \"maximum\": 9, \"minimum\": -9}, \"longitude\": {\"type\": \"number\", \"maximum\": 18, \"minimum\": -18}}","A geographical coordinate")
(2 rows)

--Testcase 4179:
CREATE TABLE loc_tbl (
  id text,
  _type text,
  _schema text,
  _required json,
  _properties json,
  _description text
);
-- select mysql_json_table (result, access record)
--Testcase 4180:
SELECT * FROM (
  SELECT (mysql_json_table(c1,'$',
          ARRAY['id VARCHAR(100) PATH "$.id"', '_type text PATH "$.type"', '_schema text PATH "$.$schema"', '_required json PATH "$.required"', '_properties json PATH "$.properties"', '_description text PATH "$.description"'],
          ARRAY['id', '_type', '_schema', '_required', '_properties', '_description'])::loc_tbl).*
          FROM s9
) t;
             id             | _type  |                 _schema                 |         _required         |                                                            _properties                                                            |       _description        
----------------------------+--------+-----------------------------------------+---------------------------+-----------------------------------------------------------------------------------------------------------------------------------+---------------------------
 http://json-schema.org/geo | object | http://json-schema.org/draft-04/schema# | ["latitude", "longitude"] | {"latitude": {"type": "number", "maximum": 90, "minimum": -90}, "longitude": {"type": "number", "maximum": 180, "minimum": -180}} | A geographical coordinate
 http://json-schema.org/geo | object | http://json-schema.org/draft-04/schema# |                           | {"latitude": {"type": "number", "maximum": 9, "minimum": -9}, "longitude": {"type": "number", "maximum": 18, "minimum": -18}}     | A geographical coordinate
(2 rows)

--Testcase 4181:
DROP TABLE loc_tbl;
-- select mysql_json_table (pushed down constraints, explain)
--Testcase 4182:
EXPLAIN VERBOSE
SELECT mysql_json_table(c1,'$',
       ARRAY['id VARCHAR(100) PATH "$.id"', '_type text PATH "$.type"', '_schema text PATH "$.$schema"', '_required json PATH "$.required"', '_properties json PATH "$.properties"', '_description text PATH "$.description"'],
       ARRAY['id', '_type', '_schema', '_required', '_properties', '_description'])
       FROM s9 WHERE json_depth(c1) > 1;
                                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..1313.17 rows=1138 width=32)
   Output: (mysql_json_table(c1, '$'::text, '{"id VARCHAR(100) PATH \"$.id\"","_type text PATH \"$.type\"","_schema text PATH \"$.$schema\"","_required json PATH \"$.required\"","_properties json PATH \"$.properties\"","_description text PATH \"$.description\""}'::text[], '{id,_type,_schema,_required,_properties,_description}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_json_table(c1, '$'::text, E'{"id VARCHAR(100) PATH \\"$.id\\"","_type text PATH \\"$.type\\"","_schema text PATH \\"$.$schema\\"","_required json PATH \\"$.required\\"","_properties json PATH \\"$.properties\\"","_description text PATH \\"$.description\\""}'::text[], '{id,_type,_schema,_required,_properties,_description}'::text[]) FROM public.s9mysql WHERE ((public.json_depth(c1) > 1))
(4 rows)

-- select mysql_json_table (pushed down constraints, result)
--Testcase 4183:
SELECT mysql_json_table(c1,'$',
       ARRAY['id VARCHAR(100) PATH "$.id"', '_type text PATH "$.type"', '_schema text PATH "$.$schema"', '_required json PATH "$.required"', '_properties json PATH "$.properties"', '_description text PATH "$.description"'],
       ARRAY['id', '_type', '_schema', '_required', '_properties', '_description'])
       FROM s9 WHERE json_depth(c1) > 1;
                                                                                                                                           mysql_json_table                                                                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ("http://json-schema.org/geo","object","http://json-schema.org/draft-04/schema#","[\"latitude\", \"longitude\"]","{\"latitude\": {\"type\": \"number\", \"maximum\": 90, \"minimum\": -90}, \"longitude\": {\"type\": \"number\", \"maximum\": 180, \"minimum\": -180}}","A geographical coordinate")
 ("http://json-schema.org/geo","object","http://json-schema.org/draft-04/schema#",,"{\"latitude\": {\"type\": \"number\", \"maximum\": 9, \"minimum\": -9}, \"longitude\": {\"type\": \"number\", \"maximum\": 18, \"minimum\": -18}}","A geographical coordinate")
(2 rows)

--Testcase 4184:
CREATE TABLE loc_tbl (
  id text,
  _type text,
  _schema text,
  _required json,
  _properties json,
  _description text
);
-- select mysql_json_table (pushed down constraints, result, access record)
--Testcase 4185:
SELECT id, _type FROM (
  SELECT (mysql_json_table(c1,'$',
          ARRAY['id VARCHAR(100) PATH "$.id"', '_type text PATH "$.type"', '_schema text PATH "$.$schema"', '_required json PATH "$.required"', '_properties json PATH "$.properties"', '_description text PATH "$.description"'],
          ARRAY['id', '_type', '_schema', '_required', '_properties', '_description'])::loc_tbl).*
          FROM s9 WHERE json_depth(c1) > 1
) t;
             id             | _type  
----------------------------+--------
 http://json-schema.org/geo | object
 http://json-schema.org/geo | object
(2 rows)

--Testcase 4186:
DROP TABLE loc_tbl;
-- mysql_json_table with nested path (explain)
--Testcase 4187:
EXPLAIN VERBOSE
SELECT mysql_json_table(c1,'$',
       ARRAY['id VARCHAR(100) PATH "$.id"', 'NESTED PATH "$.properties.*" COLUMNS(maximum int PATH "$.maximum", minimum int PATH "$.minimum")'],
       ARRAY['id', 'maximum', 'minimum']), c1
       FROM s9;
                                                                                                                                      QUERY PLAN                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..1065.64 rows=3413 width=64)
   Output: (mysql_json_table(c1, '$'::text, '{"id VARCHAR(100) PATH \"$.id\"","NESTED PATH \"$.properties.*\" COLUMNS(maximum int PATH \"$.maximum\", minimum int PATH \"$.minimum\")"}'::text[], '{id,maximum,minimum}'::text[])), c1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.mysql_json_table(c1, '$'::text, E'{"id VARCHAR(100) PATH \\"$.id\\"","NESTED PATH \\"$.properties.*\\" COLUMNS(maximum int PATH \\"$.maximum\\", minimum int PATH \\"$.minimum\\")"}'::text[], '{id,maximum,minimum}'::text[]), c1 FROM public.s9mysql
(4 rows)

-- mysql_json_table with nested path (value)
--Testcase 4188:
SELECT mysql_json_table(c1,'$',
       ARRAY['id VARCHAR(100) PATH "$.id"', 'NESTED PATH "$.properties.*" COLUMNS(maximum int PATH "$.maximum", minimum int PATH "$.minimum")'],
       ARRAY['id', 'maximum', 'minimum']), c1
       FROM s9;
              mysql_json_table               |                                                                                                                                                                        c1                                                                                                                                                                        
---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ("http://json-schema.org/geo","90","-90")   | {"id": "http://json-schema.org/geo", "type": "object", "$schema": "http://json-schema.org/draft-04/schema#", "required": ["latitude", "longitude"], "properties": {"latitude": {"type": "number", "maximum": 90, "minimum": -90}, "longitude": {"type": "number", "maximum": 180, "minimum": -180}}, "description": "A geographical coordinate"}
 ("http://json-schema.org/geo","180","-180") | {"id": "http://json-schema.org/geo", "type": "object", "$schema": "http://json-schema.org/draft-04/schema#", "required": ["latitude", "longitude"], "properties": {"latitude": {"type": "number", "maximum": 90, "minimum": -90}, "longitude": {"type": "number", "maximum": 180, "minimum": -180}}, "description": "A geographical coordinate"}
 ("http://json-schema.org/geo","9","-9")     | {"id": "http://json-schema.org/geo", "type": "object", "$schema": "http://json-schema.org/draft-04/schema#", "properties": {"latitude": {"type": "number", "maximum": 9, "minimum": -9}, "longitude": {"type": "number", "maximum": 18, "minimum": -18}}, "description": "A geographical coordinate"}
 ("http://json-schema.org/geo","18","-18")   | {"id": "http://json-schema.org/geo", "type": "object", "$schema": "http://json-schema.org/draft-04/schema#", "properties": {"latitude": {"type": "number", "maximum": 9, "minimum": -9}, "longitude": {"type": "number", "maximum": 18, "minimum": -18}}, "description": "A geographical coordinate"}
(4 rows)

--Testcase 4189:
CREATE TABLE loc_tbl (
  id text,
  maximum int,
  minimum int
);
-- mysql_json_table with nested path (value, access record)
--Testcase 4190:
SELECT (t1::loc_tbl).*, c1 FROM (
SELECT mysql_json_table(c1,'$',
       ARRAY['id VARCHAR(100) PATH "$.id"', 'NESTED PATH "$.properties.*" COLUMNS(maximum int PATH "$.maximum", minimum int PATH "$.minimum")'],
       ARRAY['id', 'maximum', 'minimum']) AS t1, c1
       FROM s9
) t;
             id             | maximum | minimum |                                                                                                                                                                        c1                                                                                                                                                                        
----------------------------+---------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 http://json-schema.org/geo |      90 |     -90 | {"id": "http://json-schema.org/geo", "type": "object", "$schema": "http://json-schema.org/draft-04/schema#", "required": ["latitude", "longitude"], "properties": {"latitude": {"type": "number", "maximum": 90, "minimum": -90}, "longitude": {"type": "number", "maximum": 180, "minimum": -180}}, "description": "A geographical coordinate"}
 http://json-schema.org/geo |     180 |    -180 | {"id": "http://json-schema.org/geo", "type": "object", "$schema": "http://json-schema.org/draft-04/schema#", "required": ["latitude", "longitude"], "properties": {"latitude": {"type": "number", "maximum": 90, "minimum": -90}, "longitude": {"type": "number", "maximum": 180, "minimum": -180}}, "description": "A geographical coordinate"}
 http://json-schema.org/geo |       9 |      -9 | {"id": "http://json-schema.org/geo", "type": "object", "$schema": "http://json-schema.org/draft-04/schema#", "properties": {"latitude": {"type": "number", "maximum": 9, "minimum": -9}, "longitude": {"type": "number", "maximum": 18, "minimum": -18}}, "description": "A geographical coordinate"}
 http://json-schema.org/geo |      18 |     -18 | {"id": "http://json-schema.org/geo", "type": "object", "$schema": "http://json-schema.org/draft-04/schema#", "properties": {"latitude": {"type": "number", "maximum": 9, "minimum": -9}, "longitude": {"type": "number", "maximum": 18, "minimum": -18}}, "description": "A geographical coordinate"}
(4 rows)

--Testcase 4191:
DROP TABLE loc_tbl;
-- select mysql_json_table constant argument (explain)
--Testcase 4192:
EXPLAIN VERBOSE
SELECT id, mysql_json_table('[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]','$[*]',
       ARRAY['xval VARCHAR(100) PATH "$.x"', ' yval VARCHAR(100) PATH "$.y"'],
       ARRAY['xval', 'yval'])
       FROM s9 WHERE id = 0;
                                                                                                                                   QUERY PLAN                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s9  (cost=100.00..157.25 rows=17 width=36)
   Output: id, (mysql_json_table('[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]'::json, '$[*]'::text, '{"xval VARCHAR(100) PATH \"$.x\""," yval VARCHAR(100) PATH \"$.y\""}'::text[], '{xval,yval}'::text[]))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT id, public.mysql_json_table('[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]'::json, '$[*]'::text, E'{"xval VARCHAR(100) PATH \\"$.x\\""," yval VARCHAR(100) PATH \\"$.y\\""}'::text[], '{xval,yval}'::text[]) FROM public.s9mysql WHERE ((id = 0))
(4 rows)

-- select mysql_json_table constant argument (result)
--Testcase 4193:
SELECT id, mysql_json_table('[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]','$[*]',
       ARRAY['xval VARCHAR(100) PATH "$.x"', ' yval VARCHAR(100) PATH "$.y"'],
       ARRAY['xval', 'yval'])
       FROM s9 WHERE id = 0;
 id | mysql_json_table 
----+------------------
  0 | ("2","8")
  0 | ("3","7")
  0 | ("4","6")
(3 rows)

--Testcase 4194:
CREATE TABLE loc_tbl (
  xval int,
  yval int
);
-- select mysql_json_table constant argument (result)
--Testcase 4195:
SELECT (t1::loc_tbl).*, id FROM (
SELECT id, mysql_json_table('[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]','$[*]',
       ARRAY['xval VARCHAR(100) PATH "$.x"', ' yval VARCHAR(100) PATH "$.y"'],
       ARRAY['xval', 'yval']) AS t1, c1
       FROM s9 WHERE id = 0
) t;
 xval | yval | id 
------+------+----
    2 |    8 |  0
    3 |    7 |  0
    4 |    6 |  0
(3 rows)

--Testcase 4196:
DROP TABLE loc_tbl;
-- JSON_TYPE()
-- select json_type (builtin function, explain)
--Testcase 4197:
EXPLAIN VERBOSE
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8;
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4495.70 rows=3413 width=160)
   Output: (json_type(c1)), (json_type(json_build_array(c1, '1'))), (json_type(json_build_object('a', '1', 'b', c2))), (json_type('{"a":1,"b":10,"d":10}'::json)), (json_type('[1,3,5,7]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_type(c1), public.json_type(json_build_array(c1, '1')), public.json_type(json_build_object('a', '1', 'b', c2)), public.json_type('{"a":1,"b":10,"d":10}'::json), public.json_type('[1,3,5,7]'::json) FROM public.s8mysql
(4 rows)

-- select json_type (builtin function, result)
--Testcase 4198:
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8;
 json_type | json_type | json_type | json_type | json_type 
-----------+-----------+-----------+-----------+-----------
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
(6 rows)

-- select json_type (builtin function, not pushdown constraints, explain)
--Testcase 4199:
EXPLAIN VERBOSE
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..250.53 rows=17 width=160)
   Output: (json_type(c1)), (json_type(json_build_array(c1, '1'))), (json_type(json_build_object('a', '1', 'b', c2))), (json_type('{"a":1,"b":10,"d":10}'::json)), (json_type('[1,3,5,7]'::json))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_type(c1), public.json_type(json_build_array(c1, '1')), public.json_type(json_build_object('a', '1', 'b', c2)), public.json_type('{"a":1,"b":10,"d":10}'::json), public.json_type('[1,3,5,7]'::json), id FROM public.s8mysql
(5 rows)

-- select json_type (builtin function, not pushdown constraints, result)
--Testcase 4200:
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8 WHERE to_hex(id) = '2';
 json_type | json_type | json_type | json_type | json_type 
-----------+-----------+-----------+-----------+-----------
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
(1 row)

-- select json_type (builtin function, pushdown constraints, explain)
--Testcase 4201:
EXPLAIN VERBOSE
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8 WHERE id != 0;
                                                                                                                                  QUERY PLAN                                                                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4482.56 rows=3396 width=160)
   Output: (json_type(c1)), (json_type(json_build_array(c1, '1'))), (json_type(json_build_object('a', '1', 'b', c2))), (json_type('{"a":1,"b":10,"d":10}'::json)), (json_type('[1,3,5,7]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_type(c1), public.json_type(json_build_array(c1, '1')), public.json_type(json_build_object('a', '1', 'b', c2)), public.json_type('{"a":1,"b":10,"d":10}'::json), public.json_type('[1,3,5,7]'::json) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_type (builtin function, pushdown constraints, result)
--Testcase 4202:
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8 WHERE id != 0;
 json_type | json_type | json_type | json_type | json_type 
-----------+-----------+-----------+-----------+-----------
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
(5 rows)

-- select json_type (builtin function, json_type in constraints, explain)
--Testcase 4203:
EXPLAIN VERBOSE
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8 WHERE json_type(c1) NOT LIKE '$';
                                                                                                                                               QUERY PLAN                                                                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..5335.81 rows=3396 width=160)
   Output: (json_type(c1)), (json_type(json_build_array(c1, '1'))), (json_type(json_build_object('a', '1', 'b', c2))), (json_type('{"a":1,"b":10,"d":10}'::json)), (json_type('[1,3,5,7]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_type(c1), public.json_type(json_build_array(c1, '1')), public.json_type(json_build_object('a', '1', 'b', c2)), public.json_type('{"a":1,"b":10,"d":10}'::json), public.json_type('[1,3,5,7]'::json) FROM public.s8mysql WHERE ((public.json_type(c1) !~~ '$'::text))
(4 rows)

-- select json_type (builtin function, json_type in constraints, result)
--Testcase 4204:
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8 WHERE json_type(c1) NOT LIKE '$';
 json_type | json_type | json_type | json_type | json_type 
-----------+-----------+-----------+-----------+-----------
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
(6 rows)

-- select json_type (builtin function, json_type in constraints, explain)
--Testcase 4205:
EXPLAIN VERBOSE
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8 where json_type('[1,3,5,7]') LIKE 'ARRAY';
                                                                                                                                                        QUERY PLAN                                                                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1027.59 rows=17 width=160)
   Output: (json_type(c1)), (json_type(json_build_array(c1, '1'))), (json_type(json_build_object('a', '1', 'b', c2))), (json_type('{"a":1,"b":10,"d":10}'::json)), (json_type('[1,3,5,7]'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_type(c1), public.json_type(json_build_array(c1, '1')), public.json_type(json_build_object('a', '1', 'b', c2)), public.json_type('{"a":1,"b":10,"d":10}'::json), public.json_type('[1,3,5,7]'::json) FROM public.s8mysql WHERE ((public.json_type('[1,3,5,7]'::json) ~~ 'ARRAY'::text))
(4 rows)

-- select json_type (builtin function, json_type in constraints, result)
--Testcase 4206:
SELECT json_type(c1), json_type(json_build_array(c1, '1')), json_type(json_build_object('a', '1', 'b', c2)),json_type('{"a":1,"b":10,"d":10}'),json_type('[1,3,5,7]') FROM s8 where json_type('[1,3,5,7]') LIKE 'ARRAY';
 json_type | json_type | json_type | json_type | json_type 
-----------+-----------+-----------+-----------+-----------
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 OBJECT    | ARRAY     | OBJECT    | OBJECT    | ARRAY
 ARRAY     | ARRAY     | OBJECT    | OBJECT    | ARRAY
(6 rows)

-- select json_type as nest function with agg (pushdown, explain)
--Testcase 4207:
EXPLAIN VERBOSE
SELECT sum(id),json_type(json_build_object('a', '1', 'b',sum(id))) FROM s8;
                                                   QUERY PLAN                                                    
-----------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_type(json_build_object('a', '1', 'b', sum(id))))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_type(json_build_object('a', '1', 'b', sum(id))) FROM public.s8mysql
(6 rows)

-- select json_type as nest function with agg (pushdown, result)
--Testcase 4208:
SELECT sum(id),json_type(json_build_object('a', '1', 'b',sum(id))) FROM s8;
 sum | json_type 
-----+-----------
  15 | OBJECT
(1 row)

-- select json_type with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4209:
EXPLAIN VERBOSE
SELECT json_type(json_build_object('a', '1', 'b', c2)), pi(), 4.1 FROM s8;
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=72)
   Output: (json_type(json_build_object('a', '1', 'b', c2))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_type(json_build_object('a', '1', 'b', c2)), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_type with non pushdown func and explicit constant (result)
--Testcase 4210:
SELECT json_type(json_build_object('a', '1', 'b', c2)), pi(), 4.1 FROM s8;
 json_type |        pi         | ?column? 
-----------+-------------------+----------
 OBJECT    | 3.141592653589793 |      4.1
 OBJECT    | 3.141592653589793 |      4.1
 OBJECT    | 3.141592653589793 |      4.1
 OBJECT    | 3.141592653589793 |      4.1
 OBJECT    | 3.141592653589793 |      4.1
 OBJECT    | 3.141592653589793 |      4.1
(6 rows)

-- select json_type with order by index (result)
--Testcase 4211:
SELECT id, json_type(c1) FROM s8 ORDER BY 2, 1;
 id | json_type 
----+-----------
  0 | ARRAY
  1 | ARRAY
  5 | ARRAY
  2 | OBJECT
  3 | OBJECT
  4 | OBJECT
(6 rows)

-- select json_type with order by index (result)
--Testcase 4212:
SELECT id, json_type(c1) FROM s8 ORDER BY 1, 2;
 id | json_type 
----+-----------
  0 | ARRAY
  1 | ARRAY
  2 | OBJECT
  3 | OBJECT
  4 | OBJECT
  5 | ARRAY
(6 rows)

-- select json_type with group by (EXPLAIN)
--Testcase 4213:
EXPLAIN VERBOSE
SELECT count(id), json_type(c1) FROM s8 group by json_type(c1);
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(id)), (json_type(c1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_type(c1) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_type with group by (result)
--Testcase 4214:
SELECT count(id), json_type(c1) FROM s8 group by json_type(c1);
 count | json_type 
-------+-----------
     3 | ARRAY
     3 | OBJECT
(2 rows)

-- select json_type with group by index (result)
--Testcase 4215:
SELECT id, json_type(c1) FROM s8 group by 2, 1;
 id | json_type 
----+-----------
  0 | ARRAY
  1 | ARRAY
  2 | OBJECT
  3 | OBJECT
  4 | OBJECT
  5 | ARRAY
(6 rows)

-- select json_type with group by index (result)
--Testcase 4216:
SELECT id, json_type(c1) FROM s8 group by 1, 2;
 id | json_type 
----+-----------
  0 | ARRAY
  1 | ARRAY
  2 | OBJECT
  3 | OBJECT
  4 | OBJECT
  5 | ARRAY
(6 rows)

-- select json_type with group by having (EXPLAIN)
--Testcase 4217:
EXPLAIN VERBOSE
SELECT count(c2), json_type(c1) FROM s8 group by json_type(c1) HAVING count(c2) > 0;
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(c2)), (json_type(c1))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_type(c1) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_type with group by having (result)
--Testcase 4218:
SELECT count(c2), json_type(c1) FROM s8 group by json_type(c1) HAVING count(c2) > 0;
 count | json_type 
-------+-----------
     3 | ARRAY
     3 | OBJECT
(2 rows)

-- select json_type with group by index having (result)
--Testcase 4219:
SELECT c2, json_type(c1) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_type 
----+-----------
  1 | ARRAY
  2 | ARRAY
  3 | OBJECT
  4 | OBJECT
  5 | OBJECT
  5 | ARRAY
(6 rows)

-- select json_type with group by index having (result)
--Testcase 4220:
SELECT c2, json_type(c1) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_type 
----+-----------
  1 | ARRAY
  2 | ARRAY
  3 | OBJECT
  4 | OBJECT
  5 | OBJECT
  5 | ARRAY
(6 rows)

-- select json_type and as
--Testcase 4221:
SELECT json_type(json_build_object('a', '1', 'b', c2)) as json_type1 FROM s8;
 json_type1 
------------
 OBJECT
 OBJECT
 OBJECT
 OBJECT
 OBJECT
 OBJECT
(6 rows)

-- select json_unquote (builtin function, explain)
--Testcase 4222:
EXPLAIN VERBOSE
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8;
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3625.39 rows=3413 width=128)
   Output: (json_unquote(c3)), (json_unquote('null'::text)), (json_unquote('"null"'::text)), (json_unquote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_unquote(c3), public.json_unquote('null'::text), public.json_unquote('"null"'::text), public.json_unquote('[1, 2, 3]'::text) FROM public.s8mysql
(4 rows)

-- select json_unquote (builtin function, result)
--Testcase 4223:
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8;
 json_unquote | json_unquote | json_unquote | json_unquote 
--------------+--------------+--------------+--------------
 This         | null         | null         | [1, 2, 3]
 is           | null         | null         | [1, 2, 3]
 text         | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
(6 rows)

-- select json_unquote (builtin function, not pushdown constraints, explain)
--Testcase 4224:
EXPLAIN VERBOSE
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8 WHERE to_hex(id) = '2';
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..246.19 rows=17 width=128)
   Output: (json_unquote(c3)), (json_unquote('null'::text)), (json_unquote('"null"'::text)), (json_unquote('[1, 2, 3]'::text))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_unquote(c3), public.json_unquote('null'::text), public.json_unquote('"null"'::text), public.json_unquote('[1, 2, 3]'::text), id FROM public.s8mysql
(5 rows)

-- select json_unquote (builtin function, not pushdown constraints, result)
--Testcase 4225:
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8 WHERE to_hex(id) = '2';
 json_unquote | json_unquote | json_unquote | json_unquote 
--------------+--------------+--------------+--------------
 text         | null         | null         | [1, 2, 3]
(1 row)

-- select json_unquote (builtin function, pushdown constraints, explain)
--Testcase 4226:
EXPLAIN VERBOSE
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8 WHERE id != 0;
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3616.58 rows=3396 width=128)
   Output: (json_unquote(c3)), (json_unquote('null'::text)), (json_unquote('"null"'::text)), (json_unquote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_unquote(c3), public.json_unquote('null'::text), public.json_unquote('"null"'::text), public.json_unquote('[1, 2, 3]'::text) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_unquote (builtin function, pushdown constraints, result)
--Testcase 4227:
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8 WHERE id != 0;
 json_unquote | json_unquote | json_unquote | json_unquote 
--------------+--------------+--------------+--------------
 is           | null         | null         | [1, 2, 3]
 text         | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
(5 rows)

-- select json_unquote (builtin function, json_unquote in constraints, explain)
--Testcase 4228:
EXPLAIN VERBOSE
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8 WHERE json_unquote(c3) NOT LIKE 'text';
                                                                                                              QUERY PLAN                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4469.83 rows=3396 width=128)
   Output: (json_unquote(c3)), (json_unquote('null'::text)), (json_unquote('"null"'::text)), (json_unquote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_unquote(c3), public.json_unquote('null'::text), public.json_unquote('"null"'::text), public.json_unquote('[1, 2, 3]'::text) FROM public.s8mysql WHERE ((public.json_unquote(c3) !~~ 'text'::text))
(4 rows)

-- select json_unquote (builtin function, json_unquote in constraints, result)
--Testcase 4229:
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8 WHERE json_unquote(c3) NOT LIKE 'text';
 json_unquote | json_unquote | json_unquote | json_unquote 
--------------+--------------+--------------+--------------
 This         | null         | null         | [1, 2, 3]
 is           | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
(5 rows)

-- select json_unquote (builtin function, json_unquote in constraints, explain)
--Testcase 4230:
EXPLAIN VERBOSE
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8 WHERE json_unquote('[1, 2, 3]') LIKE '[1, 2, 3]';
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1023.25 rows=17 width=128)
   Output: (json_unquote(c3)), (json_unquote('null'::text)), (json_unquote('"null"'::text)), (json_unquote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_unquote(c3), public.json_unquote('null'::text), public.json_unquote('"null"'::text), public.json_unquote('[1, 2, 3]'::text) FROM public.s8mysql WHERE ((public.json_unquote('[1, 2, 3]'::text) ~~ '[1, 2, 3]'::text))
(4 rows)

-- select json_unquote (builtin function, json_unquote in constraints, result)
--Testcase 4231:
SELECT json_unquote(c3), json_unquote('null'), json_unquote('"null"'), json_unquote('[1, 2, 3]') FROM s8 WHERE json_unquote('[1, 2, 3]') LIKE '[1, 2, 3]';
 json_unquote | json_unquote | json_unquote | json_unquote 
--------------+--------------+--------------+--------------
 This         | null         | null         | [1, 2, 3]
 is           | null         | null         | [1, 2, 3]
 text         | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
 scalar       | null         | null         | [1, 2, 3]
(6 rows)

-- select json_unquote as nest function with agg (pushdown, explain)
--Testcase 4232:
EXPLAIN VERBOSE
SELECT sum(id), json_unquote('[1, 2, 3]') FROM s8;
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (sum(id)), (json_unquote('[1, 2, 3]'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_unquote('[1, 2, 3]'::text) FROM public.s8mysql
(6 rows)

-- select json_unquote as nest function with agg (pushdown, result)
--Testcase 4233:
SELECT sum(id), json_unquote('[1, 2, 3]') FROM s8;
 sum | json_unquote 
-----+--------------
  15 | [1, 2, 3]
(1 row)

-- select json_unquote with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4234:
EXPLAIN VERBOSE
SELECT json_unquote('null'), pi(), 4.1 FROM s8;
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_unquote('null'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_unquote('null'::text), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_unquote with non pushdown func and explicit constant (result)
--Testcase 4235:
SELECT json_unquote('null'), pi(), 4.1 FROM s8;
 json_unquote |        pi         | ?column? 
--------------+-------------------+----------
 null         | 3.141592653589793 |      4.1
 null         | 3.141592653589793 |      4.1
 null         | 3.141592653589793 |      4.1
 null         | 3.141592653589793 |      4.1
 null         | 3.141592653589793 |      4.1
 null         | 3.141592653589793 |      4.1
(6 rows)

-- select json_unquote with order by (EXPLAIN)
--Testcase 4236:
EXPLAIN VERBOSE
SELECT id,  json_unquote(c3) FROM s8 ORDER BY json_unquote(c3);
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Sort  (cost=1265.93..1274.46 rows=3413 width=36)
   Output: id, (json_unquote(c3))
   Sort Key: (json_unquote(s8.c3))
   ->  Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=36)
         Output: id, (json_unquote(c3))
         Node: pgspider_svr / Status: Alive
           Remote SQL: SELECT id, public.json_unquote(c3) FROM public.s8mysql
(7 rows)

-- select json_unquote with order by (result)
--Testcase 4237:
SELECT id,  json_unquote(c3) FROM s8 ORDER BY json_unquote(c3);
 id | json_unquote 
----+--------------
  1 | is
  3 | scalar
  4 | scalar
  5 | scalar
  2 | text
  0 | This
(6 rows)

-- select json_unquote with order by index (result)
--Testcase 4238:
SELECT id,  json_unquote(c3) FROM s8 ORDER BY 2, 1;
 id | json_unquote 
----+--------------
  1 | is
  3 | scalar
  4 | scalar
  5 | scalar
  2 | text
  0 | This
(6 rows)

-- select json_unquote with order by index (result)
--Testcase 4239:
SELECT id,  json_unquote(c3) FROM s8 ORDER BY 1, 2;
 id | json_unquote 
----+--------------
  0 | This
  1 | is
  2 | text
  3 | scalar
  4 | scalar
  5 | scalar
(6 rows)

-- select json_unquote with group by (EXPLAIN)
--Testcase 4240:
EXPLAIN VERBOSE
SELECT count(id), json_unquote(c3) FROM s8 group by json_unquote(c3);
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(id)), (json_unquote(c3))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_unquote(c3) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_unquote with group by (result)
--Testcase 4241:
SELECT count(id), json_unquote(c3) FROM s8 group by json_unquote(c3);
 count | json_unquote 
-------+--------------
     1 | This
     1 | is
     1 | text
     3 | scalar
(4 rows)

-- select json_unquote with group by index (result)
--Testcase 4242:
SELECT id,  json_unquote(c3) FROM s8 group by 2, 1;
 id | json_unquote 
----+--------------
  0 | This
  1 | is
  2 | text
  3 | scalar
  4 | scalar
  5 | scalar
(6 rows)

-- select json_unquote with group by index (result)
--Testcase 4243:
SELECT id,  json_unquote(c3) FROM s8 group by 1, 2;
 id | json_unquote 
----+--------------
  0 | This
  1 | is
  2 | text
  3 | scalar
  4 | scalar
  5 | scalar
(6 rows)

-- select json_unquote with group by having (EXPLAIN)
--Testcase 4244:
EXPLAIN VERBOSE
SELECT count(c2), json_unquote(c3) FROM s8 group by json_unquote(c3) HAVING count(c2) > 0;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(c2)), (json_unquote(c3))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_unquote(c3) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_unquote with group by having (result)
--Testcase 4245:
SELECT count(c2), json_unquote(c3) FROM s8 group by json_unquote(c3) HAVING count(c2) > 0;
 count | json_unquote 
-------+--------------
     1 | This
     1 | is
     1 | text
     3 | scalar
(4 rows)

-- select json_unquote with group by index having (result)
--Testcase 4246:
SELECT c2,  json_unquote(c3) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_unquote 
----+--------------
  1 | This
  2 | is
  3 | text
  4 | scalar
  5 | scalar
(5 rows)

-- select json_unquote with group by index having (result)
--Testcase 4247:
SELECT c2,  json_unquote(c3) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_unquote 
----+--------------
  1 | This
  2 | is
  3 | text
  4 | scalar
  5 | scalar
(5 rows)

-- select json_unquote and as
--Testcase 4248:
SELECT json_unquote('null') as json_unquote1 FROM s8;
 json_unquote1 
---------------
 null
 null
 null
 null
 null
 null
(6 rows)

-- select json_valid (builtin function, explain)
--Testcase 4249:
EXPLAIN VERBOSE
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8;
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2780.67 rows=3413 width=12)
   Output: (json_valid(c1)), (json_valid(json_build_array(c1, 'a', c2))), (json_valid('{"a": 1, "b": {"c": 30}}'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_valid(c1), public.json_valid(json_build_array(c1, 'a', c2)), public.json_valid('{"a": 1, "b": {"c": 30}}'::text) FROM public.s8mysql
(4 rows)

-- select json_valid (builtin function, result)
--Testcase 4250:
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8;
 json_valid | json_valid | json_valid 
------------+------------+------------
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
(6 rows)

-- select json_valid (builtin function, not pushdown constraints, explain)
--Testcase 4251:
EXPLAIN VERBOSE
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE to_hex(id) = '2';
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..241.99 rows=17 width=12)
   Output: (json_valid(c1)), (json_valid(json_build_array(c1, 'a', c2))), (json_valid('{"a": 1, "b": {"c": 30}}'::text))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_valid(c1), public.json_valid(json_build_array(c1, 'a', c2)), public.json_valid('{"a": 1, "b": {"c": 30}}'::text), id FROM public.s8mysql
(5 rows)

-- select json_valid (builtin function, not pushdown constraints, result)
--Testcase 4252:
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE to_hex(id) = '2';
 json_valid | json_valid | json_valid 
------------+------------+------------
          1 |          1 |          1
(1 row)

-- select json_valid (builtin function, pushdown constraints, explain)
--Testcase 4253:
EXPLAIN VERBOSE
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE id != 0;
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2776.07 rows=3396 width=12)
   Output: (json_valid(c1)), (json_valid(json_build_array(c1, 'a', c2))), (json_valid('{"a": 1, "b": {"c": 30}}'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_valid(c1), public.json_valid(json_build_array(c1, 'a', c2)), public.json_valid('{"a": 1, "b": {"c": 30}}'::text) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_valid (builtin function, pushdown constraints, result)
--Testcase 4254:
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE id != 0;
 json_valid | json_valid | json_valid 
------------+------------+------------
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
(5 rows)

-- select json_valid (builtin function, json_valid in constraints, explain)
--Testcase 4255:
EXPLAIN VERBOSE
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_valid(c1) != 0;
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3629.32 rows=3396 width=12)
   Output: (json_valid(c1)), (json_valid(json_build_array(c1, 'a', c2))), (json_valid('{"a": 1, "b": {"c": 30}}'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_valid(c1), public.json_valid(json_build_array(c1, 'a', c2)), public.json_valid('{"a": 1, "b": {"c": 30}}'::text) FROM public.s8mysql WHERE ((public.json_valid(c1) <> 0))
(4 rows)

-- select json_valid (builtin function, json_valid in constraints, result)
--Testcase 4256:
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_valid(c1) != 0;
 json_valid | json_valid | json_valid 
------------+------------+------------
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
(6 rows)

-- select json_valid (builtin function, json_valid in constraints, explain)
--Testcase 4257:
EXPLAIN VERBOSE
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_valid('{"a": 1, "b": {"c": 30}}') = 1;
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1019.04 rows=17 width=12)
   Output: (json_valid(c1)), (json_valid(json_build_array(c1, 'a', c2))), (json_valid('{"a": 1, "b": {"c": 30}}'::text))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_valid(c1), public.json_valid(json_build_array(c1, 'a', c2)), public.json_valid('{"a": 1, "b": {"c": 30}}'::text) FROM public.s8mysql WHERE ((public.json_valid('{"a": 1, "b": {"c": 30}}'::text) = 1))
(4 rows)

-- select json_valid (builtin function, json_valid in constraints, result)
--Testcase 4258:
SELECT json_valid(c1), json_valid(json_build_array(c1, 'a', c2)), json_valid('{"a": 1, "b": {"c": 30}}') FROM s8 WHERE json_valid('{"a": 1, "b": {"c": 30}}') = 1;
 json_valid | json_valid | json_valid 
------------+------------+------------
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
          1 |          1 |          1
(6 rows)

-- select json_valid as nest function with agg (pushdown, explain)
--Testcase 4259:
EXPLAIN VERBOSE
SELECT sum(id),json_valid('{"a": 1, "b": {"c": 30}}') FROM s8;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (sum(id)), (json_valid('{"a": 1, "b": {"c": 30}}'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_valid('{"a": 1, "b": {"c": 30}}'::text) FROM public.s8mysql
(6 rows)

-- select json_valid as nest function with agg (pushdown, result)
--Testcase 4260:
SELECT sum(id),json_valid('{"a": 1, "b": {"c": 30}}') FROM s8;
 sum | json_valid 
-----+------------
  15 |          1
(1 row)

-- select json_valid with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4261:
EXPLAIN VERBOSE
SELECT json_valid(json_build_array(c1, 'a', c2)), pi(), 4.1 FROM s8;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1074.17 rows=3413 width=44)
   Output: (json_valid(json_build_array(c1, 'a', c2))), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_valid(json_build_array(c1, 'a', c2)), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_valid with non pushdown func and explicit constant (result)
--Testcase 4262:
SELECT json_valid(json_build_array(c1, 'a', c2)), pi(), 4.1 FROM s8;
 json_valid |        pi         | ?column? 
------------+-------------------+----------
          1 | 3.141592653589793 |      4.1
          1 | 3.141592653589793 |      4.1
          1 | 3.141592653589793 |      4.1
          1 | 3.141592653589793 |      4.1
          1 | 3.141592653589793 |      4.1
          1 | 3.141592653589793 |      4.1
(6 rows)

-- select json_valid with order by index (result)
--Testcase 4263:
SELECT id, json_valid(c1) FROM s8 ORDER BY 2, 1;
 id | json_valid 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
  5 |          1
(6 rows)

-- select json_valid with order by index (result)
--Testcase 4264:
SELECT id, json_valid(c1) FROM s8 ORDER BY 1, 2;
 id | json_valid 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
  5 |          1
(6 rows)

-- select json_valid with group by (EXPLAIN)
--Testcase 4265:
EXPLAIN VERBOSE
SELECT count(id), json_valid(c1) FROM s8 group by json_valid(c1);
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (json_valid(c1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_valid(c1) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_valid with group by (result)
--Testcase 4266:
SELECT count(id), json_valid(c1) FROM s8 group by json_valid(c1);
 count | json_valid 
-------+------------
     6 |          1
(1 row)

-- select json_valid with group by index (result)
--Testcase 4267:
SELECT id, json_valid(c1) FROM s8 group by 2, 1;
 id | json_valid 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
  5 |          1
(6 rows)

-- select json_valid with group by index (result)
--Testcase 4268:
SELECT id, json_valid(c1) FROM s8 group by 1, 2;
 id | json_valid 
----+------------
  0 |          1
  1 |          1
  2 |          1
  3 |          1
  4 |          1
  5 |          1
(6 rows)

-- select json_valid with group by having (EXPLAIN)
--Testcase 4269:
EXPLAIN VERBOSE
SELECT count(c2), json_valid(c1) FROM s8 group by json_valid(c1) HAVING count(c2) > 0;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (json_valid(c1))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_valid(c1) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_valid with group by having (result)
--Testcase 4270:
SELECT count(c2), json_valid(c1) FROM s8 group by json_valid(c1) HAVING count(c2) > 0;
 count | json_valid 
-------+------------
     6 |          1
(1 row)

-- select json_valid with group by index having (result)
--Testcase 4271:
SELECT c2, json_valid(c1) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_valid 
----+------------
  1 |          1
  2 |          1
  3 |          1
  4 |          1
  5 |          1
(5 rows)

-- select json_valid with group by index having (result)
--Testcase 4272:
SELECT c2, json_valid(c1) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_valid 
----+------------
  1 |          1
  2 |          1
  3 |          1
  4 |          1
  5 |          1
(5 rows)

-- select json_valid and as
--Testcase 4273:
SELECT json_valid(json_build_array(c1, 'a', c2)) as json_valid1 FROM s8;
 json_valid1 
-------------
           1
           1
           1
           1
           1
           1
(6 rows)

-- select json_value (stub function, explain)
--Testcase 4274:
EXPLAIN VERBOSE
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8;
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2789.20 rows=3413 width=96)
   Output: (json_value(c1, '$.a'::text)), (json_value(c1, '$[1]'::text)), ((json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text))::numeric)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$.a'::text), public.json_value(c1, '$[1]'::text), public.json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text)::numeric FROM public.s8mysql
(4 rows)

-- select json_value (stub function, result)
--Testcase 4275:
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8;
 json_value |      json_value      | json_value 
------------+----------------------+------------
            | [3, 4]               |       50.0
            |                      |       50.0
            |                      |       50.0
 10         |                      |       50.0
 1          |                      |       50.0
            | [{"k": "10"}, "def"] |       50.0
(6 rows)

-- select json_value (stub function, not pushdown constraints, explain)
--Testcase 4276:
EXPLAIN VERBOSE
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8 WHERE to_hex(id) = '2';
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..242.03 rows=17 width=96)
   Output: (json_value(c1, '$.a'::text)), (json_value(c1, '$[1]'::text)), ((json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text))::numeric)
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$.a'::text), public.json_value(c1, '$[1]'::text), public.json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text)::numeric, id FROM public.s8mysql
(5 rows)

-- select json_value (stub function, not pushdown constraints, result)
--Testcase 4277:
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8 WHERE to_hex(id) = '2';
 json_value | json_value | json_value 
------------+------------+------------
            |            |       50.0
(1 row)

-- select json_value (stub function, pushdown constraints, explain)
--Testcase 4278:
EXPLAIN VERBOSE
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8 WHERE id != 0;
                                                                                                                            QUERY PLAN                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..2784.56 rows=3396 width=96)
   Output: (json_value(c1, '$.a'::text)), (json_value(c1, '$[1]'::text)), ((json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text))::numeric)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$.a'::text), public.json_value(c1, '$[1]'::text), public.json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text)::numeric FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select json_value (stub function, pushdown constraints, result)
--Testcase 4279:
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8 WHERE id != 0;
 json_value |      json_value      | json_value 
------------+----------------------+------------
            |                      |       50.0
            |                      |       50.0
 10         |                      |       50.0
 1          |                      |       50.0
            | [{"k": "10"}, "def"] |       50.0
(5 rows)

-- select json_value (stub function, json_value in constraints, explain)
--Testcase 4280:
EXPLAIN VERBOSE
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8 WHERE json_value(c1, '$.a', 'default 0 on empty')::int > 1;
                                                                                                                                                              QUERY PLAN                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1904.93 rows=1138 width=96)
   Output: (json_value(c1, '$.a'::text)), (json_value(c1, '$[1]'::text)), ((json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text))::numeric)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$.a'::text), public.json_value(c1, '$[1]'::text), public.json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text)::numeric FROM public.s8mysql WHERE ((public.json_value(c1, '$.a'::text, 'default 0 on empty'::text)::integer > 1))
(4 rows)

-- select json_value (stub function, json_value in constraints, result)
--Testcase 4281:
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8 WHERE json_value(c1, '$.a', 'default 0 on empty')::int > 1;
 json_value | json_value | json_value 
------------+------------+------------
 10         |            |       50.0
(1 row)

-- select json_value (stub function, json_value in constraints, explain)
--Testcase 4282:
EXPLAIN VERBOSE
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8 WHERE json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 2)')::decimal = 49.95;
                                                                                                                                                                                         QUERY PLAN                                                                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1036.15 rows=17 width=96)
   Output: (json_value(c1, '$.a'::text)), (json_value(c1, '$[1]'::text)), ((json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text))::numeric)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$.a'::text), public.json_value(c1, '$[1]'::text), public.json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 1)'::text)::numeric FROM public.s8mysql WHERE ((public.json_value('{"item": "shoes", "price": "49.95"}'::json, '$.price'::text, 'returning decimal(10, 2)'::text)::numeric = 49.95))
(4 rows)

-- select json_value (stub function, json_value in constraints, result)
--Testcase 4283:
SELECT json_value(c1, '$.a'), json_value(c1, '$[1]'), json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 1)')::numeric FROM s8 WHERE json_value('{"item": "shoes", "price": "49.95"}', '$.price', 'returning decimal(10, 2)')::decimal = 49.95;
 json_value |      json_value      | json_value 
------------+----------------------+------------
            | [3, 4]               |       50.0
            |                      |       50.0
            |                      |       50.0
 10         |                      |       50.0
 1          |                      |       50.0
            | [{"k": "10"}, "def"] |       50.0
(6 rows)

-- select json_value (stub function, abnormal cast, explain)
--Testcase 4284:
EXPLAIN VERBOSE
SELECT json_value(c1, '$.a')::date FROM s8;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1082.70 rows=3413 width=4)
   Output: ((json_value(c1, '$.a'::text))::date)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$.a'::text)::date FROM public.s8mysql
(4 rows)

-- select json_value (stub function, abnormal cast, result)
--Testcase 4285:
SELECT json_value(c1, '$.a')::date FROM s8; -- should fail
ERROR:  PGSpider can not get data from child node : mysql_svr
CONTEXT:  remote SQL command: CLOSE c1
ERROR:  PGSpider can not get data from child node : pgspider_svr
-- select json_value (stub function, abnormal cast, explain)
--Testcase 4286:
EXPLAIN VERBOSE
SELECT json_value(c1, '$.a', 'returning date')::date FROM s8;
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1082.70 rows=3413 width=4)
   Output: ((json_value(c1, '$.a'::text, 'returning date'::text))::date)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$.a'::text, 'returning date'::text)::date FROM public.s8mysql
(4 rows)

-- select json_value (stub function, abnormal cast, result)
--Testcase 4287:
SELECT json_value(c1, '$.a', 'returning date')::date FROM s8; --empty result
 json_value 
------------
 
 
 
 
 
 
(6 rows)

-- select json_value (stub function, abnormal cast, explain)
--Testcase 4288:
EXPLAIN VERBOSE
SELECT json_value(c1, '$.a', 'returning date', 'error on error')::date FROM s8;
                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1082.70 rows=3413 width=4)
   Output: ((json_value(c1, '$.a'::text, 'returning date'::text, 'error on error'::text))::date)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$.a'::text, 'returning date'::text, 'error on error'::text)::date FROM public.s8mysql
(4 rows)

-- select json_value (stub function, abnormal cast, result)
--Testcase 4289:
SELECT json_value(c1, '$.a', 'returning date', 'error on error')::date FROM s8; -- should fail
ERROR:  PGSpider can not get data from child node : mysql_svr
CONTEXT:  remote SQL command: CLOSE c1
ERROR:  PGSpider can not get data from child node : pgspider_svr
-- select json_value with normal cast
--Testcase 4290:
SELECT json_value('{"a": "2000-01-01"}', '$.a')::timestamp, json_value('{"a": "2000-01-01"}', '$.a')::date , json_value('{"a": 1234}', '$.a')::bigint, json_value('{"a": "b"}', '$.a')::text FROM s8;
     json_value      | json_value | json_value | json_value 
---------------------+------------+------------+------------
 2000-01-01 00:00:00 | 2000-01-01 |       1234 | b
 2000-01-01 00:00:00 | 2000-01-01 |       1234 | b
 2000-01-01 00:00:00 | 2000-01-01 |       1234 | b
 2000-01-01 00:00:00 | 2000-01-01 |       1234 | b
 2000-01-01 00:00:00 | 2000-01-01 |       1234 | b
 2000-01-01 00:00:00 | 2000-01-01 |       1234 | b
(6 rows)

-- select json_value with normal cast
--Testcase 4291:
SELECT json_value('{"a": "2000-01-01"}', '$.a')::timestamptz, json_value('{"a": "12:10:20.123456"}', '$.a')::time , json_value('{"a": "12:10:20.123456"}', '$.a')::timetz FROM s8;
       json_value       |   json_value    |     json_value     
------------------------+-----------------+--------------------
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
 2000-01-01 09:00:00+09 | 12:10:20.123456 | 12:10:20.123456+00
(6 rows)

-- select json_value with type modifier (explain)
--Testcase 4292:
EXPLAIN VERBOSE
SELECT json_value('{"a": "2000-01-01 12:02:01.123456"}', '$.a')::timestamp(3), json_value('{"a": "2000-01-01 12:02:01.123456"}', '$.a')::timestamptz(3), json_value('{"a": "12:10:20.123456"}', '$.a')::time(3), json_value('{"a": "12:10:20.123456"}', '$.a')::timetz(3) FROM s8;
                                                                                                                                                                                                                       QUERY PLAN                                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3727.78 rows=3413 width=36)
   Output: ((json_value('{"a": "2000-01-01 12:02:01.123456"}'::json, '$.a'::text))::timestamp(3) without time zone), ((json_value('{"a": "2000-01-01 12:02:01.123456"}'::json, '$.a'::text))::timestamp(3) with time zone), ((json_value('{"a": "12:10:20.123456"}'::json, '$.a'::text))::time(3) without time zone), ((json_value('{"a": "12:10:20.123456"}'::json, '$.a'::text))::time(3) with time zone)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value('{"a": "2000-01-01 12:02:01.123456"}'::json, '$.a'::text)::timestamp(3) without time zone, public.json_value('{"a": "2000-01-01 12:02:01.123456"}'::json, '$.a'::text)::timestamp(3) with time zone, public.json_value('{"a": "12:10:20.123456"}'::json, '$.a'::text)::time(3) without time zone, public.json_value('{"a": "12:10:20.123456"}'::json, '$.a'::text)::time(3) with time zone FROM public.s8mysql
(4 rows)

-- select json_value with type modifier (result)
--Testcase 4293:
SELECT json_value('{"a": "2000-01-01 12:02:01.123456"}', '$.a')::timestamp(3), json_value('{"a": "2000-01-01 12:02:01.123456"}', '$.a')::timestamptz(3), json_value('{"a": "12:10:20.123456"}', '$.a')::time(3), json_value('{"a": "12:10:20.123456"}', '$.a')::timetz(3) FROM s8;
       json_value        |         json_value         |  json_value  |   json_value    
-------------------------+----------------------------+--------------+-----------------
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
 2000-01-01 12:02:01.123 | 2000-01-01 21:02:01.123+09 | 12:10:20.123 | 12:10:20.123+00
(6 rows)

-- select json_value with type modifier (explain)
--Testcase 4294:
EXPLAIN VERBOSE
SELECT json_value('{"a": 100}', '$.a')::numeric(10, 2), json_value('{"a": 100}', '$.a')::decimal(10, 2), json_unquote(json_value('{"a": "1.123456"}', '$.a'))::numeric(10, 3) FROM s8;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3702.18 rows=3413 width=48)
   Output: ((json_value('{"a": 100}'::json, '$.a'::text))::numeric(10,2)), ((json_value('{"a": 100}'::json, '$.a'::text))::numeric(10,2)), ((json_unquote(json_value('{"a": "1.123456"}'::json, '$.a'::text)))::numeric(10,3))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value('{"a": 100}'::json, '$.a'::text)::numeric(10,2), public.json_unquote(public.json_value('{"a": "1.123456"}'::json, '$.a'::text))::numeric(10,3) FROM public.s8mysql
(4 rows)

-- select json_value with type modifier (result)
--Testcase 4295:
SELECT json_value('{"a": 100}', '$.a')::numeric(10, 2), json_value('{"a": 100}', '$.a')::decimal(10, 2), json_unquote(json_value('{"a": "1.123456"}', '$.a'))::numeric(10, 3) FROM s8;
 json_value | json_value | json_unquote 
------------+------------+--------------
     100.00 |     100.00 |        1.123
     100.00 |     100.00 |        1.123
     100.00 |     100.00 |        1.123
     100.00 |     100.00 |        1.123
     100.00 |     100.00 |        1.123
     100.00 |     100.00 |        1.123
(6 rows)

-- select json_value as nest function with agg (pushdown, explain)
--Testcase 4296:
EXPLAIN VERBOSE
SELECT sum(id), json_value(json_build_object('item', 'shoe', 'price', sum(id)), '$.price')::int FROM s8;
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (sum(id)), ((json_value(json_build_object('item', 'shoe', 'price', sum(id)), '$.price'::text))::integer)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.json_value(json_build_object('item', 'shoe', 'price', sum(id)), '$.price'::text)::integer FROM public.s8mysql
(6 rows)

-- select json_value as nest function with agg (pushdown, result)
--Testcase 4297:
SELECT sum(id), json_value(json_build_object('item', 'shoe', 'price', sum(id)), '$.price')::int FROM s8;
 sum | json_value 
-----+------------
  15 |         15
(1 row)

-- select json_value with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4298:
EXPLAIN VERBOSE
SELECT json_value(c1, '$[1]'), pi(), 4.1 FROM s8;
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1065.64 rows=3413 width=72)
   Output: (json_value(c1, '$[1]'::text)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.json_value(c1, '$[1]'::text), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select json_value with non pushdown func and explicit constant (result)
--Testcase 4299:
SELECT json_value(c1, '$[1]'), pi(), 4.1 FROM s8;
      json_value      |        pi         | ?column? 
----------------------+-------------------+----------
 [3, 4]               | 3.141592653589793 |      4.1
                      | 3.141592653589793 |      4.1
                      | 3.141592653589793 |      4.1
                      | 3.141592653589793 |      4.1
                      | 3.141592653589793 |      4.1
 [{"k": "10"}, "def"] | 3.141592653589793 |      4.1
(6 rows)

-- select json_value with order by index (result)
--Testcase 4300:
SELECT id, json_value(c1, '$.a') FROM s8 ORDER BY 2, 1;
 id | json_value 
----+------------
  4 | 1
  3 | 10
  0 | 
  1 | 
  2 | 
  5 | 
(6 rows)

-- select json_value with order by index (result)
--Testcase 4301:
SELECT id, json_value(c1, '$.a') FROM s8 ORDER BY 1, 2;
 id | json_value 
----+------------
  0 | 
  1 | 
  2 | 
  3 | 10
  4 | 1
  5 | 
(6 rows)

-- select json_value with group by (EXPLAIN)
--Testcase 4302:
EXPLAIN VERBOSE
SELECT count(id), json_value(c1, '$.a') FROM s8 group by json_value(c1, '$.a');
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(id)), (json_value(c1, '$.a'::text))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.json_value(c1, '$.a'::text) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select json_value with group by (result)
--Testcase 4303:
SELECT count(id), json_value(c1, '$.a') FROM s8 group by json_value(c1, '$.a');
 count | json_value 
-------+------------
     4 | 
     1 | 10
     1 | 1
(3 rows)

-- select json_value with group by index (result)
--Testcase 4304:
SELECT id, json_value(c1, '$.a') FROM s8 group by 2, 1;
 id | json_value 
----+------------
  0 | 
  1 | 
  2 | 
  3 | 10
  4 | 1
  5 | 
(6 rows)

-- select json_value with group by index (result)
--Testcase 4305:
SELECT id, json_value(c1, '$.a') FROM s8 group by 1, 2;
 id | json_value 
----+------------
  0 | 
  1 | 
  2 | 
  3 | 10
  4 | 1
  5 | 
(6 rows)

-- select json_value with group by having (EXPLAIN)
--Testcase 4306:
EXPLAIN VERBOSE
SELECT count(c2), json_value(c1, '$.a') FROM s8 group by json_value(c1, '$.a') HAVING count(c2) > 0;
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=40)
   Output: (count(c2)), (json_value(c1, '$.a'::text))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.json_value(c1, '$.a'::text) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select json_value with group by having (result)
--Testcase 4307:
SELECT count(c2), json_value(c1, '$.a') FROM s8 group by json_value(c1, '$.a') HAVING count(c2) > 0;
 count | json_value 
-------+------------
     4 | 
     1 | 10
     1 | 1
(3 rows)

-- select json_value with group by index having (result)
--Testcase 4308:
SELECT c2, json_value(c1, '$.a') FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | json_value 
----+------------
  1 | 
  2 | 
  3 | 
  4 | 10
  5 | 1
  5 | 
(6 rows)

-- select json_value with group by index having (result)
--Testcase 4309:
SELECT c2, json_value(c1, '$.a') FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | json_value 
----+------------
  1 | 
  2 | 
  3 | 
  4 | 10
  5 | 1
  5 | 
(6 rows)

-- select json_value and as
--Testcase 4310:
SELECT json_value(c1, '$[1]') as json_value1 FROM s8;
     json_value1      
----------------------
 [3, 4]
 
 
 
 
 [{"k": "10"}, "def"]
(6 rows)

-- select member_of (builtin function, explain)
--Testcase 4311:
EXPLAIN VERBOSE
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8;
                                                                                                                  QUERY PLAN                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3633.92 rows=3413 width=16)
   Output: (member_of(5, c1)), (member_of('ab'::text, c1)), (member_of('[3,4]'::json, c1)), (member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.member_of(5, c1), public.member_of('ab'::text, c1), public.member_of('[3,4]'::json, c1), public.member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json) FROM public.s8mysql
(4 rows)

-- select member_of (builtin function, result)
--Testcase 4312:
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8;
 member_of | member_of | member_of | member_of 
-----------+-----------+-----------+-----------
         1 |         0 |         1 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
(6 rows)

-- select member_of (builtin function, not pushdown constraints, explain)
--Testcase 4313:
EXPLAIN VERBOSE
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8 WHERE to_hex(id) = '2';
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..246.24 rows=17 width=16)
   Output: (member_of(5, c1)), (member_of('ab'::text, c1)), (member_of('[3,4]'::json, c1)), (member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json))
   Filter: (to_hex(s8.id) = '2'::text)
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.member_of(5, c1), public.member_of('ab'::text, c1), public.member_of('[3,4]'::json, c1), public.member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json), id FROM public.s8mysql
(5 rows)

-- select member_of (builtin function, not pushdown constraints, result)
--Testcase 4314:
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8 WHERE to_hex(id) = '2';
 member_of | member_of | member_of | member_of 
-----------+-----------+-----------+-----------
         0 |         0 |         0 |         0
(1 row)

-- select member_of (builtin function, pushdown constraints, explain)
--Testcase 4315:
EXPLAIN VERBOSE
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8 WHERE id != 0;
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..3625.07 rows=3396 width=16)
   Output: (member_of(5, c1)), (member_of('ab'::text, c1)), (member_of('[3,4]'::json, c1)), (member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.member_of(5, c1), public.member_of('ab'::text, c1), public.member_of('[3,4]'::json, c1), public.member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json) FROM public.s8mysql WHERE ((id <> 0))
(4 rows)

-- select member_of (builtin function, pushdown constraints, result)
--Testcase 4316:
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8 WHERE id != 0;
 member_of | member_of | member_of | member_of 
-----------+-----------+-----------+-----------
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
(5 rows)

-- select member_of (builtin function, member_of in constraints, explain)
--Testcase 4317:
EXPLAIN VERBOSE
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8 WHERE member_of(5, c1) != 0;
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..4478.32 rows=3396 width=16)
   Output: (member_of(5, c1)), (member_of('ab'::text, c1)), (member_of('[3,4]'::json, c1)), (member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.member_of(5, c1), public.member_of('ab'::text, c1), public.member_of('[3,4]'::json, c1), public.member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json) FROM public.s8mysql WHERE ((public.member_of(5, c1) <> 0))
(4 rows)

-- select member_of (builtin function, member_of in constraints, result)
--Testcase 4318:
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8 WHERE member_of(5, c1) != 0;
 member_of | member_of | member_of | member_of 
-----------+-----------+-----------+-----------
         1 |         0 |         1 |         0
(1 row)

-- select member_of (builtin function, member_of in constraints, explain)
--Testcase 4319:
EXPLAIN VERBOSE
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8 WHERE member_of(json_build_object('item', 'shoes', 'price', '49.95'), '{"item": "shoes", "price": "49.95"}') = 1;
                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1031.83 rows=17 width=16)
   Output: (member_of(5, c1)), (member_of('ab'::text, c1)), (member_of('[3,4]'::json, c1)), (member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json))
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.member_of(5, c1), public.member_of('ab'::text, c1), public.member_of('[3,4]'::json, c1), public.member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json) FROM public.s8mysql WHERE ((public.member_of(json_build_object('item', 'shoes', 'price', '49.95'), '{"item": "shoes", "price": "49.95"}'::json) = 1))
(4 rows)

-- select member_of (builtin function, member_of in constraints, result)
--Testcase 4320:
SELECT member_of(5, c1), member_of('ab'::text, c1), member_of('[3,4]'::json, c1), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8 WHERE member_of(json_build_object('item', 'shoes', 'price', '49.95'), '{"item": "shoes", "price": "49.95"}') = 1;
 member_of | member_of | member_of | member_of 
-----------+-----------+-----------+-----------
         1 |         0 |         1 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
         0 |         0 |         0 |         0
(6 rows)

-- select member_of as nest function with agg (pushdown, explain)
--Testcase 4321:
EXPLAIN VERBOSE
SELECT sum(id), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8;
                                                                      QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (sum(id)), (member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT sum(id), public.member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}'::json) FROM public.s8mysql
(6 rows)

-- select member_of as nest function with agg (pushdown, result)
--Testcase 4322:
SELECT sum(id), member_of(json_build_object('item', 'shoes'), '{"item": "shoes", "price": "49.95"}') FROM s8;
 sum | member_of 
-----+-----------
  15 |         0
(1 row)

-- select member_of with non pushdown func and explicit constant (EXPLAIN)
--Testcase 4323:
EXPLAIN VERBOSE
SELECT member_of('ab'::text, c1), member_of('[3,4]'::json, c1), pi(), 4.1 FROM s8;
                                                                         QUERY PLAN                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.s8  (cost=100.00..1918.89 rows=3413 width=48)
   Output: (member_of('ab'::text, c1)), (member_of('[3,4]'::json, c1)), '3.141592653589793'::double precision, 4.1
   Node: pgspider_svr / Status: Alive
     Remote SQL: SELECT public.member_of('ab'::text, c1), public.member_of('[3,4]'::json, c1), 3.141592653589793::double precision, 4.1 FROM public.s8mysql
(4 rows)

-- select member_of with non pushdown func and explicit constant (result)
--Testcase 4324:
SELECT member_of('ab'::text, c1), member_of('[3,4]'::json, c1), pi(), 4.1 FROM s8;
 member_of | member_of |        pi         | ?column? 
-----------+-----------+-------------------+----------
         0 |         1 | 3.141592653589793 |      4.1
         0 |         0 | 3.141592653589793 |      4.1
         0 |         0 | 3.141592653589793 |      4.1
         0 |         0 | 3.141592653589793 |      4.1
         0 |         0 | 3.141592653589793 |      4.1
         0 |         0 | 3.141592653589793 |      4.1
(6 rows)

-- select member_of with order by index (result)
--Testcase 4325:
SELECT id, member_of(5, c1) FROM s8 ORDER BY 2, 1;
 id | member_of 
----+-----------
  1 |         0
  2 |         0
  3 |         0
  4 |         0
  5 |         0
  0 |         1
(6 rows)

-- select member_of with order by index (result)
--Testcase 4326:
SELECT id, member_of(5, c1) FROM s8 ORDER BY 1, 2;
 id | member_of 
----+-----------
  0 |         1
  1 |         0
  2 |         0
  3 |         0
  4 |         0
  5 |         0
(6 rows)

-- select member_of with group by (EXPLAIN)
--Testcase 4327:
EXPLAIN VERBOSE
SELECT count(id), member_of(5, c1) FROM s8 group by member_of(5, c1);
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(id)), (member_of(5, c1))
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(id), public.member_of(5, c1) FROM public.s8mysql GROUP BY 2
(6 rows)

-- select member_of with group by (result)
--Testcase 4328:
SELECT count(id), member_of(5, c1) FROM s8 group by member_of(5, c1);
 count | member_of 
-------+-----------
     1 |         1
     5 |         0
(2 rows)

-- select member_of with group by index (result)
--Testcase 4329:
SELECT id, member_of(5, c1) FROM s8 group by 2, 1;
 id | member_of 
----+-----------
  0 |         1
  1 |         0
  2 |         0
  3 |         0
  4 |         0
  5 |         0
(6 rows)

-- select member_of with group by index (result)
--Testcase 4330:
SELECT id, member_of(5, c1) FROM s8 group by 1, 2;
 id | member_of 
----+-----------
  0 |         1
  1 |         0
  2 |         0
  3 |         0
  4 |         0
  5 |         0
(6 rows)

-- select member_of with group by having (EXPLAIN)
--Testcase 4331:
EXPLAIN VERBOSE
SELECT count(c2), member_of(5, c1) FROM s8 group by member_of(5, c1) HAVING count(c2) > 0;
                                        QUERY PLAN                                        
------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=12)
   Output: (count(c2)), (member_of(5, c1))
   Filter: ((count(s8.c2)) > 0)
   Node: pgspider_svr / Status: Alive
     Agg push-down: yes
     Relations: Aggregate on (public.s8)
     Remote SQL: SELECT count(c2), public.member_of(5, c1) FROM public.s8mysql GROUP BY 2
(7 rows)

-- select member_of with group by having (result)
--Testcase 4332:
SELECT count(c2), member_of(5, c1) FROM s8 group by member_of(5, c1) HAVING count(c2) > 0;
 count | member_of 
-------+-----------
     1 |         1
     5 |         0
(2 rows)

-- select member_of with group by index having (result)
--Testcase 4333:
SELECT c2, member_of(5, c1) FROM s8 group by 2, 1 HAVING count(c2) > 0;
 c2 | member_of 
----+-----------
  1 |         1
  2 |         0
  3 |         0
  4 |         0
  5 |         0
(5 rows)

-- select member_of with group by index having (result)
--Testcase 4334:
SELECT c2, member_of(5, c1) FROM s8 group by 1, 2 HAVING count(c2) > 0;
 c2 | member_of 
----+-----------
  1 |         1
  2 |         0
  3 |         0
  4 |         0
  5 |         0
(5 rows)

-- select member_of and as
--Testcase 4335:
SELECT member_of('ab'::text, c1), member_of('[3,4]'::json, c1) as member_of1 FROM s8;
 member_of | member_of1 
-----------+------------
         0 |          1
         0 |          0
         0 |          0
         0 |          0
         0 |          0
         0 |          0
(6 rows)

--Drop all foreign tables
--Testcase 4336:
DROP FOREIGN TABLE ftextsearch__pgspider_svr__0;
--Testcase 4337:
DROP FOREIGN TABLE s3__pgspider_svr__0;
--Testcase 4338:
DROP FOREIGN TABLE time_tbl__pgspider_svr__0;
--Testcase 4339:
DROP FOREIGN TABLE s8__pgspider_svr__0;
--Testcase 4340:
DROP FOREIGN TABLE s9__pgspider_svr__0;
--Testcase 4341:
DROP FOREIGN TABLE s7a__pgspider_svr__0;
--Testcase 4342:
DROP USER MAPPING FOR CURRENT_USER SERVER pgspider_svr;
--Testcase 4343:
DROP SERVER pgspider_svr;
--Testcase 4344:
DROP EXTENSION pgspider_fdw;
--Testcase 4345:
DROP FOREIGN TABLE ftextsearch;
--Testcase 4346:
DROP FOREIGN TABLE s3;
--Testcase 4347:
DROP FOREIGN TABLE time_tbl;
--Testcase 4348:
DROP FOREIGN TABLE s7a;
--Testcase 4349:
DROP FOREIGN TABLE s8;
--Testcase 4350:
DROP FOREIGN TABLE s9;
--Testcase 4351:
DROP USER MAPPING FOR CURRENT_USER SERVER pgspider_core_svr;
--Testcase 4352:
DROP SERVER pgspider_core_svr;
--Testcase 4353:
DROP EXTENSION pgspider_core_fdw;
